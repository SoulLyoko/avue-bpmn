import{F as C0,c as vr,h as mt,s as Fm,i as be,f as I,e as Ee,g as Me,j as ge,k as ot,l as qi,m as O,n as Ds,o as Rt,q as gi,t as sn,v as Om,w as wt,x as rn,y as _t,z as Gt,A as cn,B as km,C as Nn,D as Sn,E as lt,G as Gn,H as on,I as yo,J as hs,K as ml,L as Bf,M as T0,N as A0,O as Pu,P as R0,r as P0,Q as D0,R as M0,S as B0,T as I0}from"./index.esm.11344b62.js";import{S as zM,R as GM,T as VM,aw as WM,W as UM,al as YM,ar as qM,b as KM,a0 as XM,ak as ZM,a6 as QM,a5 as JM,ah as eB,Q as tB,V as nB,d as iB,Z as rB,c as oB,a7 as aB,a1 as sB,ax as cB,$ as uB,_ as lB,ag as pB,a2 as fB,h as hB,X as dB,a8 as mB,a4 as vB,Y as gB,ap as yB,aa as EB,ae as _B,a9 as bB,ab as xB,p as wB,a as SB,ad as CB,ac as TB,af as AB,aq as RB,ai as PB,aj as DB,am as MB,s as BB,an as IB,ao as FB,at as OB,au as kB,av as NB,U as LB,a3 as $B,u as jB,as as HB,ay as zB}from"./index.esm.11344b62.js";import{q as F0,i as O0,d as vl,r as so,X as k0,x as ns,s as Fn,Y as ds,Z as Du,$ as Mu,a0 as Nm,a1 as Lm,a2 as N0,a3 as L0}from"../app.4c23674a.js";function gl(e){const t=F0(()=>O0(e)?e.value:e);async function n(p){var f;await((f=t.value)==null?void 0:f.importXML(p)),a()}function i(p){const f=new FileReader;return f.readAsText(p,"utf-8"),f.onload=()=>{n(f.result)},!1}async function r(){var f;const p=await((f=t.value)==null?void 0:f.saveXML({format:!0}));return p==null?void 0:p.xml}async function o(){const p=await r();C0.exports.saveAs(new Blob([p]),"download.xml")}function a(){var f;const p=(f=t.value)==null?void 0:f.get("canvas");p==null||p.zoom("fit-viewport",!0)}function s(){var h,d;const p=(h=t.value)==null?void 0:h.get("canvas"),f=(d=p==null?void 0:p.zoom())!=null?d:0;p==null||p.zoom(f+.1)}function c(){var h,d;const p=(h=t.value)==null?void 0:h.get("canvas"),f=(d=p==null?void 0:p.zoom())!=null?d:0;p==null||p.zoom(f-.1)}function u(){var f;((f=t.value)==null?void 0:f.get("commandStack")).undo()}function l(){var f;((f=t.value)==null?void 0:f.get("commandStack")).redo()}return{importXML:n,openXML:i,saveXML:r,downloadXml:o,fitViewport:a,zoomIn:s,zoomOut:c,undo:u,redo:l}}const $0={modeler:{type:Object},size:{type:String,default:"default"}},j0={},$m=vl({name:"BpmnTools",inheritAttrs:!1,props:$0,emits:j0,setup(e,{slots:t}){const n=so(!1),i=so(""),{modeler:r}=k0(e),{importXML:o,openXML:a,saveXML:s,downloadXml:c,fitViewport:u,zoomIn:l,zoomOut:p,undo:f,redo:h}=gl(r);async function d(){i.value=await s(),n.value=!0}async function g(){await o(i.value),n.value=!1}const y=[{label:"\u4E0B\u8F7DXML",icon:"el-icon-download",onClick:c},{label:"\u7F16\u8F91XML",icon:"el-icon-edit",onClick:d},{label:"\u81EA\u9002\u5E94\u5927\u5C0F",icon:"el-icon-rank",onClick:u},{label:"\u653E\u5927",icon:"el-icon-plus",onClick:l},{label:"\u7F29\u5C0F",icon:"el-icon-minus",onClick:p},{label:"\u540E\u9000",icon:"el-icon-arrow-left",onClick:f},{label:"\u524D\u8FDB",icon:"el-icon-arrow-right",onClick:h}],A=vr("el-tooltip"),_=vr("el-button"),w=vr("el-upload"),b=vr("el-input"),S=vr("el-drawer");return()=>{const M=C=>mt(A,{props:{content:C.label,placement:"bottom",effect:"dark"}},[mt(_,{props:{type:"info",plain:!0,icon:C.icon,size:e.size},on:{click:C.onClick}})]);return mt("div",{class:"bpmn-tools"},[mt(A,{props:{content:"\u6253\u5F00XML",placement:"bottom",effect:"dark"}},[mt("span",{},[mt(w,{class:"xml-uploader",props:{action:"",accept:".bpmn,.xml",beforeUpload:a}},[mt(_,{props:{type:"info",plain:!0,icon:"el-icon-folder-opened",size:e.size}})])])]),...y.map(M),Fm(t.default),mt(S,{props:{visible:n.value,modelValue:n.value,title:"\u7F16\u8F91XML",customClass:"xml-editor",size:"50%"},on:{"update:visible":C=>n.value=C,"update:modelValue":C=>n.value=C}},[mt(b,{props:{value:i.value,modelValue:i.value,type:"textarea",autosize:{minRows:10,maxRows:40},size:e.size},on:{input:C=>i.value=C}}),mt(_,{class:"confirm-btn",props:{type:"primary",icon:"el-icon-check",size:e.size},on:{click:g}},"\u786E\u5B9A")])])}}});function oe(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}function H0(e,t){return t={exports:{}},e(t,t.exports),t.exports}var z0=H0(function(e){var t=e.exports=function(n,i){if(i||(i=16),n===void 0&&(n=128),n<=0)return"0";for(var r=Math.log(Math.pow(2,n))/Math.log(i),o=2;r===1/0;o*=2)r=Math.log(Math.pow(2,n/o))/Math.log(i)*o;for(var a=r-Math.floor(r),s="",o=0;o<Math.floor(r);o++){var c=Math.floor(Math.random()*i).toString(i);s=c+s}if(a){var u=Math.pow(i,a),c=Math.floor(Math.random()*u).toString(i);s=c+s}var l=parseInt(s,i);return l!==1/0&&l>=Math.pow(2,n)?t(n,i):s};t.rack=function(n,i,r){var o=function(s){var c=0;do{if(c++>10)if(r)n+=r;else throw new Error("too many ID collisions, use more bits");var u=t(n,i)}while(Object.hasOwnProperty.call(a,u));return a[u]=s,u},a=o.hats={};return o.get=function(s){return o.hats[s]},o.set=function(s,c){return o.hats[s]=c,o},o.bits=n||128,o.base=i||16,o}});function un(e){if(!(this instanceof un))return new un(e);e=e||[128,36,1],this._seed=e.length?z0.rack(e[0],e[1],e[2]):e}un.prototype.next=function(e){return this._seed(e||!0)};un.prototype.nextPrefixed=function(e,t){var n;do n=e+this.next(!0);while(this.assigned(n));return this.claim(n,t),n};un.prototype.claim=function(e,t){this._seed.set(e,t||!0)};un.prototype.assigned=function(e){return this._seed.get(e)||!1};un.prototype.unclaim=function(e){delete this._seed.hats[e]};un.prototype.clear=function(){var e=this._seed.hats,t;for(t in e)this.unclaim(t)};var G0=Object.prototype.toString,V0=Object.prototype.hasOwnProperty;function W0(e){return e===void 0}function U0(e){return G0.call(e)==="[object Array]"}function Y0(e,t){return V0.call(e,t)}function If(e,t){var n,i;if(!W0(e)){var r=U0(e)?K0:q0;for(var o in e)if(Y0(e,o)&&(n=e[o],i=t(n,r(o)),i===!1))return n}}function q0(e){return e}function K0(e){return Number(e)}function qe(e){for(var t=e.style,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return If(i,function(o){!o||If(o,function(a,s){t[s]=a})}),e}function Ve(e,t,n){return arguments.length==2?e.getAttribute(t):n===null?e.removeAttribute(t):(e.setAttribute(t,n),e)}var X0=[].indexOf,yl=function(e,t){if(X0)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},Z0=/\s+/,Q0=Object.prototype.toString;function re(e){return new li(e)}function li(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}li.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=yl(t,e);return~n||t.push(e),this.el.className=t.join(" "),this};li.prototype.remove=function(e){if(Q0.call(e)=="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=yl(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this};li.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};li.prototype.toggle=function(e,t){return this.list?(typeof t!="undefined"?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(typeof t!="undefined"?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};li.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(Z0);return n[0]===""&&n.shift(),n};li.prototype.has=li.prototype.contains=function(e){return this.list?this.list.contains(e):!!~yl(this.array(),e)};function To(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e}var pr=typeof Element!="undefined"?Element.prototype:{},Ff=pr.matches||pr.matchesSelector||pr.webkitMatchesSelector||pr.mozMatchesSelector||pr.msMatchesSelector||pr.oMatchesSelector,ms=J0;function J0(e,t){if(!e||e.nodeType!==1)return!1;if(Ff)return Ff.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;i++)if(n[i]==e)return!0;return!1}function Ki(e,t,n){for(var i=n?e:e.parentNode;i&&i.nodeType!==document.DOCUMENT_NODE&&i.nodeType!==document.DOCUMENT_FRAGMENT_NODE;){if(ms(i,t))return i;i=i.parentNode}return ms(i,t)?i:null}var jm=window.addEventListener?"addEventListener":"attachEvent",e_=window.removeEventListener?"removeEventListener":"detachEvent",Hm=jm!=="addEventListener"?"on":"",t_=function(e,t,n,i){return e[jm](Hm+t,n,i||!1),n},n_=function(e,t,n,i){return e[e_](Hm+t,n,i||!1),n},J={bind:t_,unbind:n_},zm=["focus","blur"];function i_(e,t,n,i,r){return zm.indexOf(n)!==-1&&(r=!0),J.bind(e,n,function(o){var a=o.target||o.srcElement;o.delegateTarget=Ki(a,t,!0),o.delegateTarget&&i.call(e,o)},r)}function r_(e,t,n,i){return zm.indexOf(t)!==-1&&(i=!0),J.unbind(e,t,n,i)}var bt={bind:i_,unbind:r_},ce=o_,Gm=!1,Ca;typeof document!="undefined"&&(Ca=document.createElement("div"),Ca.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',Gm=!Ca.getElementsByTagName("link").length,Ca=void 0);var Qe={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:Gm?[1,"X<div>","</div>"]:[0,"",""]};Qe.td=Qe.th=[3,"<table><tbody><tr>","</tr></tbody></table>"];Qe.option=Qe.optgroup=[1,'<select multiple="multiple">',"</select>"];Qe.thead=Qe.tbody=Qe.colgroup=Qe.caption=Qe.tfoot=[1,"<table>","</table>"];Qe.polyline=Qe.ellipse=Qe.polygon=Qe.circle=Qe.text=Qe.line=Qe.path=Qe.rect=Qe.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];function o_(e,t){if(typeof e!="string")throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var i=n[1];if(i=="body"){var c=t.createElement("html");return c.innerHTML=e,c.removeChild(c.lastChild)}var r=Qe[i]||Qe._default,o=r[0],a=r[1],s=r[2],c=t.createElement("div");for(c.innerHTML=a+e+s;o--;)c=c.lastChild;if(c.firstChild==c.lastChild)return c.removeChild(c.firstChild);for(var u=t.createDocumentFragment();c.firstChild;)u.appendChild(c.removeChild(c.firstChild));return u}function xe(e,t){return t=t||document,t.querySelector(e)}function zn(e,t){return t=t||document,t.querySelectorAll(e)}function wn(e){e.parentNode&&e.parentNode.removeChild(e)}function a_(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch{}return e}function Ms(e,t){return t.appendChild(a_(e,t))}function pe(e,t){return Ms(t,e),e}var Bu=2,Vm={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":Bu,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":Bu,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function s_(e,t){return Vm[t]?e.style[t]:e.getAttributeNS(null,t)}function Wm(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=Vm[i];r?(r===Bu&&typeof n=="number"&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function c_(e,t){var n=Object.keys(t),i,r;for(i=0,r;r=n[i];i++)Wm(e,r,t[r])}function W(e,t,n){if(typeof t=="string")if(n!==void 0)Wm(e,t,n);else return s_(e,t);else c_(e,t);return e}function El(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var u_=/\s+/,l_=Object.prototype.toString;function Iu(e){return typeof e!="undefined"}function Se(e){return new pi(e)}function pi(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}pi.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=El(t,e);return~n||t.push(e),Iu(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this};pi.prototype.remove=function(e){if(l_.call(e)==="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=El(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this};pi.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};pi.prototype.toggle=function(e,t){return this.list?(Iu(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(Iu(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};pi.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(u_);return n[0]===""&&n.shift(),n};pi.prototype.has=pi.prototype.contains=function(e){return this.list?this.list.contains(e):!!~El(this.array(),e)};function Le(e){var t=e.parentNode;return t&&t.removeChild(e),e}function Ao(e){for(var t;t=e.firstChild;)Le(t);return e}function _l(e){return e.cloneNode(!0)}var bl={svg:"http://www.w3.org/2000/svg"},Of='<svg xmlns="'+bl.svg+'"';function Um(e){var t=!1;e.substring(0,4)==="<svg"?e.indexOf(bl.svg)===-1&&(e=Of+e.substring(4)):(e=Of+">"+e+"</svg>",t=!0);var n=p_(e);if(!t)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}function p_(e){var t;return t=new DOMParser,t.async=!1,t.parseFromString(e,"text/xml")}function ae(e,t){var n;return e.charAt(0)==="<"?(n=Um(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(bl.svg,e),t&&W(n,t),n}var Jc=null;function Fu(){return Jc===null&&(Jc=ae("svg")),Jc}function kf(e,t){var n,i,r=Object.keys(t);for(n=0;i=r[n];n++)e[i]=t[i];return e}function f_(e,t,n,i,r,o){var a=Fu().createSVGMatrix();switch(arguments.length){case 0:return a;case 1:return kf(a,e);case 6:return kf(a,{a:e,b:t,c:n,d:i,e:r,f:o})}}function co(e){return e?Fu().createSVGTransformFromMatrix(e):Fu().createSVGTransform()}var Nf=/([&<>]{1})/g,h_=/([\n\r"]{1})/g,d_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function eu(e,t){function n(i,r){return d_[r]||r}return e.replace(t,n)}function Ym(e,t){var n,i,r,o,a;switch(e.nodeType){case 3:t.push(eu(e.textContent,Nf));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(r=e.attributes,n=0,i=r.length;n<i;++n)o=r.item(n),t.push(" ",o.name,'="',eu(o.value,h_),'"');if(e.hasChildNodes()){for(t.push(">"),a=e.childNodes,n=0,i=a.length;n<i;++n)Ym(a.item(n),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("<!--",eu(e.nodeValue,Nf),"-->");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function m_(e,t){var n=Um(t);if(Ao(e),!!t){g_(n)||(n=n.documentElement);for(var i=y_(n.childNodes),r=0;r<i.length;r++)Ms(i[r],e)}}function v_(e){for(var t=e.firstChild,n=[];t;)Ym(t,n),t=t.nextSibling;return n.join("")}function g_(e){return e.nodeName==="#document-fragment"}function Lf(e,t){if(t!==void 0){try{m_(e,t)}catch(n){throw new Error("error parsing SVG: "+n.message)}return e}else return v_(e)}function y_(e){return Array.prototype.slice.call(e)}function E_(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}function __(e,t){var n,i;for(e.clear(),n=0;i=t[n];n++)e.appendItem(E_(e,i))}function Eo(e,t){var n=e.transform.baseVal;return t&&(Array.isArray(t)||(t=[t]),__(n,t)),n.consolidate()}var b_=/^class /;function x_(e){return b_.test(e.toString())}function xl(e){return Object.prototype.toString.call(e)==="[object Array]"}function tu(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function is(){var e=Array.prototype.slice.call(arguments);e.length===1&&xl(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var w_=/constructor\s*[^(]*\(\s*([^)]*)\)/m,S_=/^(?:async\s+)?(?:function\s*[^(]*)?(?:\(\s*([^)]*)\)|(\w+))/m,C_=/\/\*([^*]*)\*\//m;function T_(e){if(typeof e!="function")throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(x_(e)?w_:S_);if(!t)return[];var n=t[1]||t[2];return n&&n.split(",").map(function(i){var r=i.match(C_);return(r&&r[1]||i).trim()})||[]}function qm(e,t){t=t||{get:function(_,w){if(n.push(_),w===!1)return null;throw a('No provider for "'+_+'"!')}};var n=[],i=this._providers=Object.create(t._providers||null),r=this._instances=Object.create(null),o=r.injector=this,a=function(_){var w=n.join(" -> ");return n.length=0,new Error(w?_+" (Resolving: "+w+")":_)};function s(_,w){if(!i[_]&&_.indexOf(".")!==-1){for(var b=_.split("."),S=s(b.shift());b.length;)S=S[b.shift()];return S}if(tu(r,_))return r[_];if(tu(i,_)){if(n.indexOf(_)!==-1)throw n.push(_),a("Cannot resolve circular dependency!");return n.push(_),r[_]=i[_][0](i[_][1]),n.pop(),r[_]}return t.get(_,w)}function c(_,w){if(typeof w=="undefined"&&(w={}),typeof _!="function")if(xl(_))_=is(_.slice());else throw new Error('Cannot invoke "'+_+'". Expected a function!');var b=_.$inject||T_(_),S=b.map(function(M){return tu(w,M)?w[M]:s(M)});return{fn:_,dependencies:S}}function u(_){var w=c(_),b=w.fn,S=w.dependencies,M=Function.prototype.bind.apply(b,[null].concat(S));return new M}function l(_,w,b){var S=c(_,b),M=S.fn,C=S.dependencies;return M.apply(w,C)}function p(_){return is(function(w){return _.get(w)})}function f(_,w){if(w&&w.length){var b=Object.create(null),S=Object.create(null),M=[],C=[],R=[],D,F,j,z;for(var G in i)D=i[G],w.indexOf(G)!==-1&&(D[2]==="private"?(F=M.indexOf(D[3]),F===-1?(j=D[3].createChild([],w),z=p(j),M.push(D[3]),C.push(j),R.push(z),b[G]=[z,G,"private",j]):b[G]=[R[F],G,"private",C[F]]):b[G]=[D[2],D[1]],S[G]=!0),(D[2]==="factory"||D[2]==="type")&&D[1].$scope&&w.forEach(function(he){D[1].$scope.indexOf(he)!==-1&&(b[G]=[D[2],D[1]],S[he]=!0)});w.forEach(function(he){if(!S[he])throw new Error('No provider for "'+he+'". Cannot use provider from the parent!')}),_.unshift(b)}return new qm(_,o)}var h={factory:l,type:u,value:function(_){return _}};function d(_,w){var b=_.__init__||[];return function(){b.forEach(function(S){typeof S=="string"?w.get(S):w.invoke(S)})}}function g(_){var w=_.__exports__;if(w){var b=_.__modules__,S=Object.keys(_).reduce(function(F,j){return j!=="__exports__"&&j!=="__modules__"&&j!=="__init__"&&j!=="__depends__"&&(F[j]=_[j]),F},Object.create(null)),M=(b||[]).concat(S),C=f(M),R=is(function(F){return C.get(F)});w.forEach(function(F){i[F]=[R,F,"private",C]});var D=(_.__init__||[]).slice();return D.unshift(function(){C.init()}),_=Object.assign({},_,{__init__:D}),d(_,C)}return Object.keys(_).forEach(function(F){if(!(F==="__init__"||F==="__depends__")){if(_[F][2]==="private"){i[F]=_[F];return}var j=_[F][0],z=_[F][1];i[F]=[h[j],A_(j,z),j]}}),d(_,o)}function y(_,w){return _.indexOf(w)!==-1||(_=(w.__depends__||[]).reduce(y,_),_.indexOf(w)!==-1)?_:_.concat(w)}function A(_){var w=_.reduce(y,[]).map(g),b=!1;return function(){b||(b=!0,w.forEach(function(S){return S()}))}}this.get=s,this.invoke=l,this.instantiate=u,this.createChild=f,this.init=A(e)}function A_(e,t){return e!=="value"&&xl(t)&&(t=is(t.slice())),t}var R_=1e3;function Vn(e,t){var n=this;t=t||R_,e.on(["render.shape","render.connection"],t,function(i,r){var o=i.type,a=r.element,s=r.gfx,c=r.attrs;if(n.canRender(a))return o==="render.shape"?n.drawShape(s,a,c):n.drawConnection(s,a,c)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(i,r){if(n.canRender(r))return i.type==="render.getShapePath"?n.getShapePath(r):n.getConnectionPath(r)})}Vn.prototype.canRender=function(){};Vn.prototype.drawShape=function(){};Vn.prototype.drawConnection=function(){};Vn.prototype.getShapePath=function(){};Vn.prototype.getConnectionPath=function(){};function Sr(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")}function Km(e){for(var t="",n=0,i;i=e[n];n++)t+=i.x+","+i.y+" ";return t}function wl(e,t){var n=ae("polyline");return W(n,{points:Km(e)}),t&&W(n,t),n}function P_(e,t){return W(e,{points:Km(t)}),e}function Bs(e){return Ee(e,function(t){return!Me(e,function(n){return n!==t&&Xm(t,n)})})}function Xm(e,t){if(!!t){if(e===t)return t;if(!!e.parent)return Xm(e.parent,t)}}function $f(e,t,n){var i=!n||e.indexOf(t)===-1;return i&&e.push(t),i}function Xi(e,t,n){n=n||0,be(e)||(e=[e]),I(e,function(i,r){var o=t(i,r,n);be(o)&&o.length&&Xi(o,t,n+1)})}function D_(e,t,n){var i=[],r=[];return Xi(e,function(o,a,s){$f(i,o,t);var c=o.children;if((n===-1||s<n)&&c&&$f(r,c,t))return c}),i}function Ro(e,t){return D_(e,!t,-1)}function M_(e,t,n){Ds(t)&&(t=!0),ot(t)&&(n=t,t=!0),n=n||{};var i=Xr(n.allShapes),r=Xr(n.allConnections),o=Xr(n.enclosedElements),a=Xr(n.enclosedConnections),s=Xr(n.topLevel,t&&qi(e,function(l){return l.id}));function c(l){s[l.source.id]&&s[l.target.id]&&(s[l.id]=[l]),i[l.source.id]&&i[l.target.id]&&(a[l.id]=o[l.id]=l),r[l.id]=l}function u(l){if(o[l.id]=l,l.waypoints)a[l.id]=r[l.id]=l;else return i[l.id]=l,I(l.incoming,c),I(l.outgoing,c),l.children}return Xi(e,u),{allShapes:i,allConnections:r,topLevel:s,enclosedConnections:a,enclosedElements:o}}function Je(e,t){t=!!t,be(e)||(e=[e]);var n,i,r,o;return I(e,function(a){var s=a;a.waypoints&&!t&&(s=Je(a.waypoints,!0));var c=s.x,u=s.y,l=s.height||0,p=s.width||0;(c<n||n===void 0)&&(n=c),(u<i||i===void 0)&&(i=u),(c+p>r||r===void 0)&&(r=c+p),(u+l>o||o===void 0)&&(o=u+l)}),{x:n,y:i,height:o-i,width:r-n}}function B_(e,t){var n={};return I(e,function(i){var r=i;r.waypoints&&(r=Je(r)),!ge(t.y)&&r.x>t.x&&(n[i.id]=i),!ge(t.x)&&r.y>t.y&&(n[i.id]=i),r.x>t.x&&r.y>t.y&&(ge(t.width)&&ge(t.height)&&r.width+r.x<t.width+t.x&&r.height+r.y<t.height+t.y||!ge(t.width)||!ge(t.height))&&(n[i.id]=i)}),n}function Zm(e){return"waypoints"in e?"connection":"x"in e?"shape":"root"}function Qm(e){return!!(e&&e.isFrame)}function Xr(e,t){return O({},e||{},t||{})}var I_=1;function yi(e,t){Vn.call(this,e,I_),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=t.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}oe(yi,Vn);yi.prototype.canRender=function(){return!0};yi.prototype.drawShape=function(t,n,i){var r=ae("rect");return W(r,{x:0,y:0,width:n.width||0,height:n.height||0}),Qm(n)?W(r,O({},this.FRAME_STYLE,i||{})):W(r,O({},this.SHAPE_STYLE,i||{})),pe(t,r),r};yi.prototype.drawConnection=function(t,n,i){var r=wl(n.waypoints,O({},this.CONNECTION_STYLE,i||{}));return pe(t,r),r};yi.prototype.getShapePath=function(t){var n=t.x,i=t.y,r=t.width,o=t.height,a=[["M",n,i],["l",r,0],["l",0,o],["l",-r,0],["z"]];return Sr(a)};yi.prototype.getConnectionPath=function(t){var n=t.waypoints,i,r,o=[];for(i=0;r=n[i];i++)r=r.original||r,o.push([i===0?"M":"L",r.x,r.y]);return Sr(o)};yi.$inject=["eventBus","styles"];function F_(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(n,i,r){var o=this.style(i,r);return O(o,{class:n})},this.style=function(n,i){!be(n)&&!i&&(i=n,n=[]);var r=Rt(n,function(o,a){return O(o,e[a]||{})},{});return i?O(r,i):r},this.computeStyle=function(n,i,r){return be(i)||(r=i,i=[]),t.style(i||[],O({},r,n||{}))}}var O_={__init__:["defaultRenderer"],defaultRenderer:["type",yi],styles:["type",F_]};function We(e,t){if(!e||!t)return-1;var n=e.indexOf(t);return n!==-1&&e.splice(n,1),n}function Ke(e,t,n){if(!(!e||!t)){typeof n!="number"&&(n=-1);var i=e.indexOf(t);if(i!==-1){if(i===n)return;if(n!==-1)e.splice(i,1);else return}n!==-1?e.splice(n,0,t):e.push(t)}}function Sl(e,t){return!e||!t?-1:e.indexOf(t)}function Po(e,t){return!e||!t?-1:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Cl(e,t,n,i){if(typeof i=="undefined"&&(i=5),!e||!t||!n)return!1;var r=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),o=Po(e,t);return Math.abs(r/o)<=i}var Jm=2;function Ln(e,t){var n;return be(e)?n=e:n=[e,t],k_(n)?"h":N_(n)?"v":!1}function k_(e,t){var n;be(e)?n=e:n=[e,t];var i=n.slice().shift();return gi(n,function(r){return Math.abs(i.y-r.y)<=Jm})}function N_(e,t){var n;be(e)?n=e:n=[e,t];var i=n.slice().shift();return gi(n,function(r){return Math.abs(i.x-r.x)<=Jm})}function jf(e,t,n){return n=n||0,e.x>t.x-n&&e.y>t.y-n&&e.x<t.x+t.width+n&&e.y<t.y+t.height+n}function Ou(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}}var L_=/,?([a-z]),?/gi,Hf=parseFloat,ze=Math,ri=ze.PI,yn=ze.min,En=ze.max,zf=ze.pow,si=ze.abs,$_=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/ig,j_=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/ig,vs=Array.isArray||function(e){return e instanceof Array};function Tl(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function uo(e){if(typeof e=="function"||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)Tl(e,n)&&(t[n]=uo(e[n]));return t}function H_(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function z_(e){function t(){var n=Array.prototype.slice.call(arguments,0),i=n.join("\u2400"),r=t.cache=t.cache||{},o=t.count=t.count||[];return Tl(r,i)?(H_(o,i),r[i]):(o.length>=1e3&&delete r[o.shift()],o.push(i),r[i]=e.apply(0,n),r[i])}return t}function G_(e){if(!e)return null;var t=yr(e);if(t.arr)return uo(t.arr);var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=[];return vs(e)&&vs(e[0])&&(i=uo(e)),i.length||String(e).replace($_,function(r,o,a){var s=[],c=o.toLowerCase();for(a.replace(j_,function(u,l){l&&s.push(+l)}),c=="m"&&s.length>2&&(i.push([o].concat(s.splice(0,2))),c="l",o=o=="m"?"l":"L");s.length>=n[c]&&(i.push([o].concat(s.splice(0,n[c]))),!!n[c]););}),i.toString=yr.toString,t.arr=uo(i),i}function yr(e){var t=yr.ps=yr.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)Tl(t,n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function ku(e,t,n,i){return arguments.length===1&&(t=e.y,n=e.width,i=e.height,e=e.x),{x:e,y:t,width:n,height:i,x2:e+n,y2:t+i}}function ev(){return this.join(",").replace(L_,"$1")}function gs(e){var t=uo(e);return t.toString=ev,t}function Gf(e,t,n,i,r,o,a,s,c){var u=1-c,l=zf(u,3),p=zf(u,2),f=c*c,h=f*c,d=l*e+p*3*c*n+u*3*c*c*r+h*a,g=l*t+p*3*c*i+u*3*c*c*o+h*s;return{x:ys(d),y:ys(g)}}function Vf(e){var t=K_.apply(null,e);return ku(t.x0,t.y0,t.x1-t.x0,t.y1-t.y0)}function oi(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function V_(e,t){return e=ku(e),t=ku(t),oi(t,e.x,e.y)||oi(t,e.x2,e.y)||oi(t,e.x,e.y2)||oi(t,e.x2,e.y2)||oi(e,t.x,t.y)||oi(e,t.x2,t.y)||oi(e,t.x,t.y2)||oi(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}function Wf(e,t,n,i,r){var o=-3*t+9*n-9*i+3*r,a=e*o+6*t-12*n+6*i;return e*a-3*t+3*n}function Uf(e,t,n,i,r,o,a,s,c){c==null&&(c=1),c=c>1?1:c<0?0:c;for(var u=c/2,l=12,p=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],f=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],h=0,d=0;d<l;d++){var g=u*p[d]+u,y=Wf(g,e,n,r,a),A=Wf(g,t,i,o,s),_=y*y+A*A;h+=f[d]*ze.sqrt(_)}return u*h}function W_(e,t,n,i,r,o,a,s){if(!(En(e,n)<yn(r,a)||yn(e,n)>En(r,a)||En(t,i)<yn(o,s)||yn(t,i)>En(o,s))){var c=(e*i-t*n)*(r-a)-(e-n)*(r*s-o*a),u=(e*i-t*n)*(o-s)-(t-i)*(r*s-o*a),l=(e-n)*(o-s)-(t-i)*(r-a);if(!!l){var p=ys(c/l),f=ys(u/l),h=+p.toFixed(2),d=+f.toFixed(2);if(!(h<+yn(e,n).toFixed(2)||h>+En(e,n).toFixed(2)||h<+yn(r,a).toFixed(2)||h>+En(r,a).toFixed(2)||d<+yn(t,i).toFixed(2)||d>+En(t,i).toFixed(2)||d<+yn(o,s).toFixed(2)||d>+En(o,s).toFixed(2)))return{x:p,y:f}}}}function ys(e){return Math.round(e*1e11)/1e11}function U_(e,t,n){var i=Vf(e),r=Vf(t);if(!V_(i,r))return n?0:[];for(var o=Uf.apply(0,e),a=Uf.apply(0,t),s=Yf(e)?1:~~(o/5)||1,c=Yf(t)?1:~~(a/5)||1,u=[],l=[],p={},f=n?0:[],h=0;h<s+1;h++){var d=Gf.apply(0,e.concat(h/s));u.push({x:d.x,y:d.y,t:h/s})}for(h=0;h<c+1;h++)d=Gf.apply(0,t.concat(h/c)),l.push({x:d.x,y:d.y,t:h/c});for(h=0;h<s;h++)for(var g=0;g<c;g++){var y=u[h],A=u[h+1],_=l[g],w=l[g+1],b=si(A.x-y.x)<.01?"y":"x",S=si(w.x-_.x)<.01?"y":"x",M=W_(y.x,y.y,A.x,A.y,_.x,_.y,w.x,w.y),C;if(M){if(C=M.x.toFixed(9)+"#"+M.y.toFixed(9),p[C])continue;p[C]=!0;var R=y.t+si((M[b]-y[b])/(A[b]-y[b]))*(A.t-y.t),D=_.t+si((M[S]-_[S])/(w[S]-_[S]))*(w.t-_.t);R>=0&&R<=1&&D>=0&&D<=1&&(n?f++:f.push({x:M.x,y:M.y,t1:R,t2:D}))}}return f}function Y_(e,t,n){e=Kf(e),t=Kf(t);for(var i,r,o,a,s,c,u,l,p,f,h=n?0:[],d=0,g=e.length;d<g;d++){var y=e[d];if(y[0]=="M")i=s=y[1],r=c=y[2];else{y[0]=="C"?(p=[i,r].concat(y.slice(1)),i=p[6],r=p[7]):(p=[i,r,i,r,s,c,s,c],i=s,r=c);for(var A=0,_=t.length;A<_;A++){var w=t[A];if(w[0]=="M")o=u=w[1],a=l=w[2];else{w[0]=="C"?(f=[o,a].concat(w.slice(1)),o=f[6],a=f[7]):(f=[o,a,o,a,u,l,u,l],o=u,a=l);var b=U_(p,f,n);if(n)h+=b;else{for(var S=0,M=b.length;S<M;S++)b[S].segment1=d,b[S].segment2=A,b[S].bez1=p,b[S].bez2=f;h=h.concat(b)}}}}}return h}function q_(e){var t=yr(e);if(t.abs)return gs(t.abs);if((!vs(e)||!vs(e&&e[0]))&&(e=G_(e)),!e||!e.length)return[["M",0,0]];var n=[],i=0,r=0,o=0,a=0,s=0,c;e[0][0]=="M"&&(i=+e[0][1],r=+e[0][2],o=i,a=r,s++,n[0]=["M",i,r]);for(var u,l,p=s,f=e.length;p<f;p++){if(n.push(u=[]),l=e[p],c=l[0],c!=c.toUpperCase())switch(u[0]=c.toUpperCase(),u[0]){case"A":u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=+l[6]+i,u[7]=+l[7]+r;break;case"V":u[1]=+l[1]+r;break;case"H":u[1]=+l[1]+i;break;case"M":o=+l[1]+i,a=+l[2]+r;default:for(var h=1,d=l.length;h<d;h++)u[h]=+l[h]+(h%2?i:r)}else for(var g=0,y=l.length;g<y;g++)u[g]=l[g];switch(c=c.toUpperCase(),u[0]){case"Z":i=+o,r=+a;break;case"H":i=u[1];break;case"V":r=u[1];break;case"M":o=u[u.length-2],a=u[u.length-1];default:i=u[u.length-2],r=u[u.length-1]}}return n.toString=ev,t.abs=gs(n),n}function Yf(e){return e[0]===e[2]&&e[1]===e[3]&&e[4]===e[6]&&e[5]===e[7]}function Ta(e,t,n,i){return[e,t,n,i,n,i]}function qf(e,t,n,i,r,o){var a=.3333333333333333,s=2/3;return[a*e+s*n,a*t+s*i,a*r+s*n,a*o+s*i,r,o]}function tv(e,t,n,i,r,o,a,s,c,u){var l=ri*120/180,p=ri/180*(+r||0),f=[],h,d=z_(function(N,Y,U){var Q=N*ze.cos(U)-Y*ze.sin(U),ne=N*ze.sin(U)+Y*ze.cos(U);return{x:Q,y:ne}});if(u)C=u[0],R=u[1],S=u[2],M=u[3];else{h=d(e,t,-p),e=h.x,t=h.y,h=d(s,c,-p),s=h.x,c=h.y;var g=(e-s)/2,y=(t-c)/2,A=g*g/(n*n)+y*y/(i*i);A>1&&(A=ze.sqrt(A),n=A*n,i=A*i);var _=n*n,w=i*i,b=(o==a?-1:1)*ze.sqrt(si((_*w-_*y*y-w*g*g)/(_*y*y+w*g*g))),S=b*n*y/i+(e+s)/2,M=b*-i*g/n+(t+c)/2,C=ze.asin(((t-M)/i).toFixed(9)),R=ze.asin(((c-M)/i).toFixed(9));C=e<S?ri-C:C,R=s<S?ri-R:R,C<0&&(C=ri*2+C),R<0&&(R=ri*2+R),a&&C>R&&(C=C-ri*2),!a&&R>C&&(R=R-ri*2)}var D=R-C;if(si(D)>l){var F=R,j=s,z=c;R=C+l*(a&&R>C?1:-1),s=S+n*ze.cos(R),c=M+i*ze.sin(R),f=tv(s,c,n,i,r,0,a,j,z,[R,F,S,M])}D=R-C;var G=ze.cos(C),he=ze.sin(C),Ne=ze.cos(R),_e=ze.sin(R),ue=ze.tan(D/4),T=4/3*n*ue,m=4/3*i*ue,B=[e,t],k=[e+T*he,t-m*G],V=[s+T*_e,c-m*Ne],te=[s,c];if(k[0]=2*B[0]-k[0],k[1]=2*B[1]-k[1],u)return[k,V,te].concat(f);f=[k,V,te].concat(f).join().split(",");for(var L=[],H=0,ee=f.length;H<ee;H++)L[H]=H%2?d(f[H-1],f[H],p).y:d(f[H],f[H+1],p).x;return L}function K_(e,t,n,i,r,o,a,s){for(var c=[],u=[[],[]],l,p,f,h,d,g,y,A,_=0;_<2;++_){if(_==0?(p=6*e-12*n+6*r,l=-3*e+9*n-9*r+3*a,f=3*n-3*e):(p=6*t-12*i+6*o,l=-3*t+9*i-9*o+3*s,f=3*i-3*t),si(l)<1e-12){if(si(p)<1e-12)continue;h=-f/p,0<h&&h<1&&c.push(h);continue}y=p*p-4*f*l,A=ze.sqrt(y),!(y<0)&&(d=(-p+A)/(2*l),0<d&&d<1&&c.push(d),g=(-p-A)/(2*l),0<g&&g<1&&c.push(g))}for(var w=c.length,b=w,S;w--;)h=c[w],S=1-h,u[0][w]=S*S*S*e+3*S*S*h*n+3*S*h*h*r+h*h*h*a,u[1][w]=S*S*S*t+3*S*S*h*i+3*S*h*h*o+h*h*h*s;return u[0][b]=e,u[1][b]=t,u[0][b+1]=a,u[1][b+1]=s,u[0].length=u[1].length=b+2,{x0:yn.apply(0,u[0]),y0:yn.apply(0,u[1]),x1:En.apply(0,u[0]),y1:En.apply(0,u[1])}}function Kf(e){var t=yr(e);if(t.curve)return gs(t.curve);for(var n=q_(e),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r=function(h,d,g){var y,A;if(!h)return["C",d.x,d.y,d.x,d.y,d.x,d.y];switch(!(h[0]in{T:1,Q:1})&&(d.qx=d.qy=null),h[0]){case"M":d.X=h[1],d.Y=h[2];break;case"A":h=["C"].concat(tv.apply(0,[d.x,d.y].concat(h.slice(1))));break;case"S":g=="C"||g=="S"?(y=d.x*2-d.bx,A=d.y*2-d.by):(y=d.x,A=d.y),h=["C",y,A].concat(h.slice(1));break;case"T":g=="Q"||g=="T"?(d.qx=d.x*2-d.qx,d.qy=d.y*2-d.qy):(d.qx=d.x,d.qy=d.y),h=["C"].concat(qf(d.x,d.y,d.qx,d.qy,h[1],h[2]));break;case"Q":d.qx=h[1],d.qy=h[2],h=["C"].concat(qf(d.x,d.y,h[1],h[2],h[3],h[4]));break;case"L":h=["C"].concat(Ta(d.x,d.y,h[1],h[2]));break;case"H":h=["C"].concat(Ta(d.x,d.y,h[1],d.y));break;case"V":h=["C"].concat(Ta(d.x,d.y,d.x,h[1]));break;case"Z":h=["C"].concat(Ta(d.x,d.y,d.X,d.Y));break}return h},o=function(h,d){if(h[d].length>7){h[d].shift();for(var g=h[d];g.length;)a[d]="A",h.splice(d++,0,["C"].concat(g.splice(0,6)));h.splice(d,1),l=n.length}},a=[],s="",c="",u=0,l=n.length;u<l;u++){n[u]&&(s=n[u][0]),s!="C"&&(a[u]=s,u&&(c=a[u-1])),n[u]=r(n[u],i,c),a[u]!="A"&&s=="C"&&(a[u]="C"),o(n,u);var p=n[u],f=p.length;i.x=p[f-2],i.y=p[f-1],i.bx=Hf(p[f-4])||i.x,i.by=Hf(p[f-3])||i.y}return t.curve=gs(n),n}var X_=Y_,nv=X_;function iv(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}}function $n(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function le(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function Is(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}}function Z_(e){return $n({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})}function Q_(e){for(var t=e.waypoints,n=t.reduce(function(u,l,p){var f=t[p-1];if(f){var h=u[u.length-1],d=h&&h.endLength||0,g=tb(f,l);u.push({start:f,end:l,startLength:d,endLength:d+g,length:g})}return u},[]),i=n.reduce(function(u,l){return u+l.length},0),r=i/2,o=0,a=n[o];a.endLength<r;)a=n[++o];var s=(r-a.startLength)/a.length,c={x:a.start.x+(a.end.x-a.start.x)*s,y:a.start.y+(a.end.y-a.start.y)*s};return c}function ye(e){return nb(e)?Q_(e):Z_(e)}function pt(e,t,n){n=n||0,ot(n)||(n={x:n,y:n});var i=le(e),r=le(t),o=i.bottom+n.y<=r.top,a=i.left-n.x>=r.right,s=i.top-n.y>=r.bottom,c=i.right+n.x<=r.left,u=o?"top":s?"bottom":null,l=c?"left":a?"right":null;return l&&u?u+"-"+l:l||u||"intersect"}function Nu(e,t,n){var i=J_(e,t);return i.length===1||i.length===2&&Po(i[0],i[1])<1?$n(i[0]):i.length>1?(i=sn(i,function(r){var o=Math.floor(r.t2*100)||1;return o=100-o,o=(o<10?"0":"")+o,r.segment2+"#"+o}),$n(i[n?0:i.length-1])):null}function J_(e,t){return nv(e,t)}function eb(e){e=e.slice();for(var t=0,n,i,r;e[t];)n=e[t],i=e[t-1],r=e[t+1],Po(n,r)===0||Cl(i,r,n)?e.splice(t,1):t++;return e}function tb(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function nb(e){return!!e.waypoints}function rs(e,t){return Math.round(e*t)/t}function Xf(e){return ge(e)?e+"px":e}function ib(e){for(;e.parent;)e=e.parent;return e}function rb(e){e=O({},{width:"100%",height:"100%"},e);var t=e.container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),qe(n,{position:"relative",overflow:"hidden",width:Xf(e.width),height:Xf(e.height)}),t.appendChild(n),n}function rv(e,t,n){var i=ae("g");Se(i).add(t);var r=n!==void 0?n:e.childNodes.length-1;return e.insertBefore(i,e.childNodes[r]||null),i}var ob="base",ov=0,ab=1,sb={shape:["x","y","width","height"],connection:["waypoints"]};function ve(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._rootsIdx=0,this._layers={},this._planes=[],this._rootElement=null,this._init(e||{})}ve.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"];ve.prototype._init=function(e){var t=this._eventBus,n=this._container=rb(e),i=this._svg=ae("svg");W(i,{width:"100%",height:"100%"}),pe(n,i);var r=this._viewport=rv(i,"viewport");e.deferUpdate!==!1&&(this._viewboxChanged=Om(wt(this._viewboxChanged,this),300)),t.on("diagram.init",function(){t.fire("canvas.init",{svg:i,viewport:r})},this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","root.set"],function(){delete this._cachedViewbox},this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)};ve.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._rootElement,delete this._viewport};ve.prototype._clear=function(){var e=this,t=this._elementRegistry.getAll();t.forEach(function(n){var i=Zm(n);i==="root"?e.removeRootElement(n):e._removeElement(n,i)}),this._planes=[],this._rootElement=null,delete this._cachedViewbox};ve.prototype.getDefaultLayer=function(){return this.getLayer(ob,ov)};ve.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),typeof t!="undefined"&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group};ve.prototype._getChildIndex=function(e){return Rt(this._layers,function(t,n){return n.visible&&e>=n.index&&t++,t},0)};ve.prototype._createLayer=function(e,t){typeof t=="undefined"&&(t=ab);var n=this._getChildIndex(t);return{group:rv(this._viewport,"layer-"+e,n),index:t,visible:!0}};ve.prototype.showLayer=function(e){if(!e)throw new Error("must specify a name");var t=this._layers[e];if(!t)throw new Error("layer <"+e+"> does not exist");var n=this._viewport,i=t.group,r=t.index;if(t.visible)return i;var o=this._getChildIndex(r);return n.insertBefore(i,n.childNodes[o]||null),t.visible=!0,i};ve.prototype.hideLayer=function(e){if(!e)throw new Error("must specify a name");var t=this._layers[e];if(!t)throw new Error("layer <"+e+"> does not exist");var n=t.group;return t.visible&&(Le(n),t.visible=!1),n};ve.prototype._removeLayer=function(e){var t=this._layers[e];t&&(delete this._layers[e],Le(t.group))};ve.prototype.getActiveLayer=function(){var e=this._findPlaneForRoot(this.getRootElement());return e?e.layer:null};ve.prototype.findRoot=function(e){if(typeof e=="string"&&(e=this._elementRegistry.get(e)),!!e){var t=this._findPlaneForRoot(ib(e))||{};return t.rootElement}};ve.prototype.getRootElements=function(){return this._planes.map(function(e){return e.rootElement})};ve.prototype._findPlaneForRoot=function(e){return Me(this._planes,function(t){return t.rootElement===e})};ve.prototype.getContainer=function(){return this._container};ve.prototype._updateMarker=function(e,t,n){var i;e.id||(e=this._elementRegistry.get(e)),i=this._elementRegistry._elements[e.id],i&&(I([i.gfx,i.secondaryGfx],function(r){r&&(n?Se(r).add(t):Se(r).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))};ve.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)};ve.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)};ve.prototype.hasMarker=function(e,t){e.id||(e=this._elementRegistry.get(e));var n=this.getGraphics(e);return Se(n).has(t)};ve.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)};ve.prototype.getRootElement=function(){var e=this._rootElement;return e||this._planes.length?e:this.setRootElement(this.addRootElement(null))};ve.prototype.addRootElement=function(e){var t=this._rootsIdx++;e||(e={id:"__implicitroot_"+t,children:[],isImplicit:!0});var n=e.layer="root-"+t;this._ensureValid("root",e);var i=this.getLayer(n,ov);return this.hideLayer(n),this._addRoot(e,i),this._planes.push({rootElement:e,layer:i}),e};ve.prototype.removeRootElement=function(e){typeof e=="string"&&(e=this._elementRegistry.get(e));var t=this._findPlaneForRoot(e);if(!!t)return this._removeRoot(e),this._removeLayer(e.layer),this._planes=this._planes.filter(function(n){return n.rootElement!==e}),this._rootElement===e&&(this._rootElement=null),e};ve.prototype.setRootElement=function(e,t){if(rn(t))throw new Error("override not supported");if(e!==this._rootElement){var n;if(!e)throw new Error("rootElement required");return n=this._findPlaneForRoot(e),n||(e=this.addRootElement(e)),this._setRoot(e),e}};ve.prototype._removeRoot=function(e){var t=this._elementRegistry,n=this._eventBus;n.fire("root.remove",{element:e}),n.fire("root.removed",{element:e}),t.remove(e)};ve.prototype._addRoot=function(e,t){var n=this._elementRegistry,i=this._eventBus;i.fire("root.add",{element:e}),n.add(e,t),i.fire("root.added",{element:e,gfx:t})};ve.prototype._setRoot=function(e,t){var n=this._rootElement;n&&(this._elementRegistry.updateGraphics(n,null,!0),this.hideLayer(n.layer)),e&&(t||(t=this._findPlaneForRoot(e).layer),this._elementRegistry.updateGraphics(e,this._svg,!0),this.showLayer(e.layer)),this._rootElement=e,this._eventBus.fire("root.set",{element:e})};ve.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element <"+t.id+"> already exists");var n=sb[e],i=gi(n,function(r){return typeof t[r]!="undefined"});if(!i)throw new Error("must supply { "+n.join(", ")+" } with "+e)};ve.prototype._setParent=function(e,t,n){Ke(t.children,e,n),e.parent=t};ve.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();var r=this._eventBus,o=this._graphicsFactory;this._ensureValid(e,t),r.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i);var a=o.create(e,t,i);return this._elementRegistry.add(t,a),o.update(e,t,a),r.fire(e+".added",{element:t,gfx:a}),t};ve.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)};ve.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)};ve.prototype._removeElement=function(e,t){var n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(e=n.get(e.id||e),!!e)return r.fire(t+".remove",{element:e}),i.remove(e),We(e.parent&&e.parent.children,e),e.parent=null,r.fire(t+".removed",{element:e}),n.remove(e),e};ve.prototype.removeShape=function(e){return this._removeElement(e,"shape")};ve.prototype.removeConnection=function(e){return this._removeElement(e,"connection")};ve.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)};ve.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()};ve.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})};ve.prototype.viewbox=function(e){if(e===void 0&&this._cachedViewbox)return this._cachedViewbox;var t=this._viewport,n,i=this.getSize(),r,o,a,s,c,u;if(e)this._changeViewbox(function(){s=Math.min(i.width/e.width,i.height/e.height);var l=this._svg.createSVGMatrix().scale(s).translate(-e.x,-e.y);Eo(t,l)});else return o=this._rootElement?this.getActiveLayer():null,n=o&&o.getBBox()||{},a=Eo(t),r=a?a.matrix:f_(),s=rs(r.a,1e3),c=rs(-r.e||0,1e3),u=rs(-r.f||0,1e3),e=this._cachedViewbox={x:c?c/s:0,y:u?u/s:0,width:i.width/s,height:i.height/s,scale:s,inner:{width:n.width||0,height:n.height||0,x:n.x||0,y:n.y||0},outer:i},e;return e};ve.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=O({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),av(t,n)}),{x:n.e,y:n.f}};ve.prototype.scrollToElement=function(e,t){var n=100;typeof e=="string"&&(e=this._elementRegistry.get(e));var i=this.findRoot(e);i!==this.getRootElement()&&this.setRootElement(i),t||(t={}),typeof t=="number"&&(n=t),t={top:t.top||n,right:t.right||n,bottom:t.bottom||n,left:t.left||n};var r=Je(e),o=le(r),a=this.viewbox(),s=this.zoom(),c,u;a.y+=t.top/s,a.x+=t.left/s,a.width-=(t.right+t.left)/s,a.height-=(t.bottom+t.top)/s;var l=le(a),p=r.width<a.width&&r.height<a.height;if(!p)c=r.x-a.x,u=r.y-a.y;else{var f=Math.max(0,o.right-l.right),h=Math.min(0,o.left-l.left),d=Math.max(0,o.bottom-l.bottom),g=Math.min(0,o.top-l.top);c=f||h,u=d||g}this.scroll({dx:-c*s,dy:-u*s})};ve.prototype.zoom=function(e,t){if(!e)return this.viewbox(e).scale;if(e==="fit-viewport")return this._fitViewport(t);var n,i;return this._changeViewbox(function(){typeof t!="object"&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),i=this._setZoom(e,t)}),rs(i.a,1e3)};function av(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}ve.prototype._fitViewport=function(e){var t=this.viewbox(),n=t.outer,i=t.inner,r,o;return i.x>=0&&i.y>=0&&i.x+i.width<=n.width&&i.y+i.height<=n.height&&!e?o={x:0,y:0,width:Math.max(i.width+i.x,n.width),height:Math.max(i.height+i.y,n.height)}:(r=Math.min(1,n.width/i.width,n.height/i.height),o={x:i.x+(e?i.width/2-n.width/r/2:0),y:i.y+(e?i.height/2-n.height/r/2:0),width:n.width/r,height:n.height/r}),this.viewbox(o),this.viewbox(!1).scale};ve.prototype._setZoom=function(e,t){var n=this._svg,i=this._viewport,r=n.createSVGMatrix(),o=n.createSVGPoint(),a,s,c,u,l;c=i.getCTM();var p=c.a;return t?(a=O(o,t),s=a.matrixTransform(c.inverse()),u=r.translate(s.x,s.y).scale(1/p*e).translate(-s.x,-s.y),l=c.multiply(u)):l=r.scale(e),av(this._viewport,l),l};ve.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}};ve.prototype.getAbsoluteBBox=function(e){var t=this.viewbox(),n;if(e.waypoints){var i=this.getGraphics(e);n=i.getBBox()}else n=e;var r=n.x*t.scale-t.x*t.scale,o=n.y*t.scale-t.y*t.scale,a=n.width*t.scale,s=n.height*t.scale;return{x:r,y:o,width:a,height:s}};ve.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var Er="data-element-id";function Ot(e){this._elements={},this._eventBus=e}Ot.$inject=["eventBus"];Ot.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),W(t,Er,i),n&&W(n,Er,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}};Ot.prototype.remove=function(e){var t=this._elements,n=e.id||e,i=n&&t[n];i&&(W(i.gfx,Er,""),i.secondaryGfx&&W(i.secondaryGfx,Er,""),delete t[n])};Ot.prototype.updateId=function(e,t){this._validateId(t),typeof e=="string"&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)};Ot.prototype.updateGraphics=function(e,t,n){var i=e.id||e,r=this._elements[i];return n?r.secondaryGfx=t:r.gfx=t,t&&W(t,Er,i),t};Ot.prototype.get=function(e){var t;typeof e=="string"?t=e:t=e&&W(e,Er);var n=this._elements[t];return n&&n.element};Ot.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t};Ot.prototype.find=function(e){for(var t=this._elements,n=Object.keys(t),i=0;i<n.length;i++){var r=n[i],o=t[r],a=o.element,s=o.gfx;if(e(a,s))return a}};Ot.prototype.getAll=function(){return this.filter(function(e){return e})};Ot.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var i=t[n],r=i.element,o=i.gfx;return e(r,o)})};Ot.prototype.getGraphics=function(e,t){var n=e.id||e,i=this._elements[n];return i&&(t?i.secondaryGfx:i.gfx)};Ot.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var Al={exports:{}},Fs={};function cb(e,t,n,i){var r=n.inverse;return Object.defineProperty(e,"remove",{value:function(o){var a=this.indexOf(o);return a!==-1&&(this.splice(a,1),t.unset(o,r,i)),o}}),Object.defineProperty(e,"contains",{value:function(o){return this.indexOf(o)!==-1}}),Object.defineProperty(e,"add",{value:function(o,a){var s=this.indexOf(o);if(typeof a=="undefined"){if(s!==-1)return;a=this.length}s!==-1&&this.splice(s,1),this.splice(a,0,o),s===-1&&t.set(o,r,i)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e}function ub(e){return e.__refs_collection===!0}Fs.extend=cb;Fs.isExtended=ub;var sv=Fs;function lb(e,t){return Object.prototype.hasOwnProperty.call(e,t.name||t)}function cv(e,t,n){var i=sv.extend(n[t.name]||[],e,t,n);Object.defineProperty(n,t.name,{enumerable:t.enumerable,value:i}),i.length&&i.forEach(function(r){e.set(r,t.inverse,n)})}function pb(e,t,n){var i=t.inverse,r=n[t.name];Object.defineProperty(n,t.name,{configurable:t.configurable,enumerable:t.enumerable,get:function(){return r},set:function(o){if(o!==r){var a=r;r=null,a&&e.unset(a,i,n),r=o,e.set(r,i,n)}}})}function fi(e,t){if(!(this instanceof fi))return new fi(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}fi.prototype.bind=function(e,t){if(typeof t=="string"){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?cv(this,t,e):pb(this,t,e)};fi.prototype.ensureRefsCollection=function(e,t){var n=e[t.name];return sv.isExtended(n)||cv(this,t,e),n};fi.prototype.ensureBound=function(e,t){lb(e,t)||this.bind(e,t)};fi.prototype.unset=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(n):e[t.name]=void 0)};fi.prototype.set=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(n):e[t.name]=n)};var fb=fi;Al.exports=fb;Al.exports.Collection=Fs;var Do=Al.exports,uv=new Do({name:"children",enumerable:!0,collection:!0},{name:"parent"}),lv=new Do({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),Zf=new Do({name:"attachers",collection:!0},{name:"host"}),pv=new Do({name:"outgoing",collection:!0},{name:"source"}),fv=new Do({name:"incoming",collection:!0},{name:"target"});function Mo(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),uv.bind(this,"parent"),lv.bind(this,"labels"),pv.bind(this,"outgoing"),fv.bind(this,"incoming")}function Cr(){Mo.call(this),uv.bind(this,"children"),Zf.bind(this,"host"),Zf.bind(this,"attachers")}oe(Cr,Mo);function hv(){Cr.call(this)}oe(hv,Cr);function Os(){Cr.call(this),lv.bind(this,"labelTarget")}oe(Os,Cr);function dv(){Mo.call(this),pv.bind(this,"source"),fv.bind(this,"target")}oe(dv,Mo);var hb={connection:dv,shape:Cr,label:Os,root:hv};function db(e,t){var n=hb[e];if(!n)throw new Error("unknown type: <"+e+">");return O(new n,t)}function Wn(){this._uid=12}Wn.prototype.createRoot=function(e){return this.create("root",e)};Wn.prototype.createLabel=function(e){return this.create("label",e)};Wn.prototype.createShape=function(e){return this.create("shape",e)};Wn.prototype.createConnection=function(e){return this.create("connection",e)};Wn.prototype.create=function(e,t){return t=O({},t||{}),t.id||(t.id=e+"_"+this._uid++),db(e,t)};var Es="__fn",mv=1e3,mb=Array.prototype.slice;function Pt(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}Pt.prototype.on=function(e,t,n,i){if(e=be(e)?e:[e],_t(t)&&(i=n,n=t,t=mv),!ge(t))throw new Error("priority must be a number");var r=n;i&&(r=wt(n,i),r[Es]=n[Es]||n);var o=this;e.forEach(function(a){o._addListener(a,{priority:t,callback:r,next:null})})};Pt.prototype.once=function(e,t,n,i){var r=this;if(_t(t)&&(i=n,n=t,t=mv),!ge(t))throw new Error("priority must be a number");function o(){o.__isTomb=!0;var a=n.apply(i,arguments);return r.off(e,o),a}o[Es]=n,this.on(e,t,o)};Pt.prototype.off=function(e,t){e=be(e)?e:[e];var n=this;e.forEach(function(i){n._removeListener(i,t)})};Pt.prototype.createEvent=function(e){var t=new Bo;return t.init(e),t};Pt.prototype.fire=function(e,t){var n,i,r,o;if(o=mb.call(arguments),typeof e=="object"&&(t=e,e=t.type),!e)throw new Error("no event type specified");if(i=this._listeners[e],!!i){t instanceof Bo?n=t:n=this.createEvent(t),o[0]=n;var a=n.type;e!==a&&(n.type=e);try{r=this._invokeListeners(n,o,i)}finally{e!==a&&(n.type=a)}return r===void 0&&n.defaultPrevented&&(r=!1),r}};Pt.prototype.handleError=function(e){return this.fire("error",{error:e})===!1};Pt.prototype._destroy=function(){this._listeners={}};Pt.prototype._invokeListeners=function(e,t,n){for(var i;n&&!e.cancelBubble;)i=this._invokeListener(e,t,n),n=n.next;return i};Pt.prototype._invokeListener=function(e,t,n){var i;if(n.callback.__isTomb)return i;try{i=vb(n.callback,t),i!==void 0&&(e.returnValue=i,e.stopPropagation()),i===!1&&e.preventDefault()}catch(r){if(!this.handleError(r))throw console.error("unhandled error in event listener",r),r}return i};Pt.prototype._addListener=function(e,t){var n=this._getListeners(e),i;if(!n){this._setListeners(e,t);return}for(;n;){if(n.priority<t.priority){t.next=n,i?i.next=t:this._setListeners(e,t);return}i=n,n=n.next}i.next=t};Pt.prototype._getListeners=function(e){return this._listeners[e]};Pt.prototype._setListeners=function(e,t){this._listeners[e]=t};Pt.prototype._removeListener=function(e,t){var n=this._getListeners(e),i,r,o;if(!t){this._setListeners(e,null);return}for(;n;)i=n.next,o=n.callback,(o===t||o[Es]===t)&&(r?r.next=i:this._setListeners(e,i)),r=n,n=i};function Bo(){}Bo.prototype.stopPropagation=function(){this.cancelBubble=!0};Bo.prototype.preventDefault=function(){this.defaultPrevented=!0};Bo.prototype.init=function(e){O(this,e||{})};function vb(e,t){return e.apply(null,t)}function _o(e){return e.childNodes[0]}function gb(e){return e.parentNode.childNodes[1]}function Lu(e,t,n,i,r){var o=co();o.setTranslate(t,n);var a=co();a.setRotate(i||0,0,0);var s=co();s.setScale(r||1,r||1),Eo(e,[o,a,s])}function At(e,t,n){var i=co();i.setTranslate(t,n),Eo(e,i)}function vv(e,t){var n=co();n.setRotate(t,0,0),Eo(e,n)}function kt(e,t){this._eventBus=e,this._elementRegistry=t}kt.$inject=["eventBus","elementRegistry"];kt.prototype._getChildrenContainer=function(e){var t=this._elementRegistry.getGraphics(e),n;return e.parent?(n=gb(t),n||(n=ae("g"),Se(n).add("djs-children"),pe(t.parentNode,n))):n=t,n};kt.prototype._clear=function(e){var t=_o(e);return To(t),t};kt.prototype._createContainer=function(e,t,n,i){var r=ae("g");Se(r).add("djs-group"),typeof n!="undefined"?gv(r,t,t.childNodes[n]):pe(t,r);var o=ae("g");Se(o).add("djs-element"),Se(o).add("djs-"+e),i&&Se(o).add("djs-frame"),pe(r,o);var a=ae("g");return Se(a).add("djs-visual"),pe(o,a),o};kt.prototype.create=function(e,t,n){var i=this._getChildrenContainer(t.parent);return this._createContainer(e,i,n,Qm(t))};kt.prototype.updateContainments=function(e){var t=this,n=this._elementRegistry,i;i=Rt(e,function(r,o){return o.parent&&(r[o.parent.id]=o.parent),r},{}),I(i,function(r){var o=r.children;if(!!o){var a=t._getChildrenContainer(r);I(o.slice().reverse(),function(s){var c=n.getGraphics(s);gv(c.parentNode,a)})}})};kt.prototype.drawShape=function(e,t){var n=this._eventBus;return n.fire("render.shape",{gfx:e,element:t})};kt.prototype.getShapePath=function(e){var t=this._eventBus;return t.fire("render.getShapePath",e)};kt.prototype.drawConnection=function(e,t){var n=this._eventBus;return n.fire("render.connection",{gfx:e,element:t})};kt.prototype.getConnectionPath=function(e){var t=this._eventBus;return t.fire("render.getConnectionPath",e)};kt.prototype.update=function(e,t,n){if(!!t.parent){var i=this._clear(n);if(e==="shape")this.drawShape(i,t),At(n,t.x,t.y);else if(e==="connection")this.drawConnection(i,t);else throw new Error("unknown type: "+e);t.hidden?W(n,"display","none"):W(n,"display","block")}};kt.prototype.remove=function(e){var t=this._elementRegistry.getGraphics(e);Le(t.parentNode)};function gv(e,t,n){var i=n||t.firstChild;e!==i&&t.insertBefore(e,i)}var yb={__depends__:[O_],__init__:["canvas"],canvas:["type",ve],elementRegistry:["type",Ot],elementFactory:["type",Wn],eventBus:["type",Pt],graphicsFactory:["type",kt]};function Eb(e){var t=new qm(e);return t.init(),t}function _b(e){e=e||{};var t={config:["value",e]},n=[t,yb].concat(e.modules||[]);return Eb(n)}function Tr(e,t){this.injector=t=t||_b(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}Tr.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")};Tr.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};function Rl(){}Rl.prototype.get=function(e){return this.$model.properties.get(this,e)};Rl.prototype.set=function(e,t){this.$model.properties.set(this,e,t)};function yv(e,t){this.model=e,this.properties=t}yv.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(Rl.prototype);I(e.properties,function(a){!a.isMany&&a.default!==void 0&&(i[a.name]=a.default)}),n.defineModel(i,t),n.defineDescriptor(i,e);var r=e.ns.name;function o(a){n.define(this,"$type",{value:r,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),I(a,wt(function(s,c){this.set(c,s)},this))}return o.prototype=i,o.hasType=i.$instanceOf=this.model.hasType,n.defineModel(o,t),n.defineDescriptor(o,e),o};var bb={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},Ev={String:function(e){return e},Boolean:function(e){return e==="true"},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e)}};function Pl(e,t){var n=Ev[e];return n?n(t):t}function $u(e){return!!bb[e]}function _v(e){return!!Ev[e]}function xt(e,t){var n=e.split(/:/),i,r;if(n.length===1)i=e,r=t;else if(n.length===2)i=n[1],r=n[0];else throw new Error("expected <prefix:localName> or <localName>, got "+e);return e=(r?r+":":"")+i,{name:e,prefix:r,localName:i}}function Vt(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}Vt.prototype.build=function(){return cn(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])};Vt.prototype.addProperty=function(e,t,n){typeof t=="boolean"&&(n=t,t=void 0),this.addNamedProperty(e,n!==!1);var i=this.properties;t!==void 0?i.splice(t,0,e):i.push(e)};Vt.prototype.replaceProperty=function(e,t,n){var i=e.ns,r=this.properties,o=this.propertiesByName,a=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=r.indexOf(e);if(s===-1)throw new Error("property <"+i.name+"> not found in property list");r.splice(s,1),this.addProperty(t,n?void 0:s,a),o[i.name]=o[i.localName]=t};Vt.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,r=t.split("#"),o=xt(r[0],i),a=xt(r[1],o.prefix).name,s=this.propertiesByName[a];if(s)this.replaceProperty(s,e,n);else throw new Error("refined property <"+a+"> not found");delete e.redefines};Vt.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e};Vt.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]};Vt.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e};Vt.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e};Vt.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")};Vt.prototype.hasProperty=function(e){return this.propertiesByName[e]};Vt.prototype.addTrait=function(e,t){var n=this.allTypesByName,i=this.allTypes,r=e.name;r in n||(I(e.properties,wt(function(o){o=O({},o,{name:o.ns.localName,inherited:t}),Object.defineProperty(o,"definedBy",{value:e});var a=o.replaces,s=o.redefines;a||s?this.redefineProperty(o,a||s,a):(o.isBody&&this.setBodyProperty(o),o.isId&&this.setIdProperty(o),this.addProperty(o))},this)),i.push(e),n[r]=e)};function Ei(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,I(e,wt(this.registerPackage,this))}Ei.prototype.getPackage=function(e){return this.packageMap[e]};Ei.prototype.getPackages=function(){return this.packages};Ei.prototype.registerPackage=function(e){e=O({},e);var t=this.packageMap;Qf(t,e,"prefix"),Qf(t,e,"uri"),I(e.types,wt(function(n){this.registerType(n,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)};Ei.prototype.registerType=function(e,t){e=O({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:O(e.meta||{})});var n=xt(e.name,t.prefix),i=n.name,r={};I(e.properties,wt(function(o){var a=xt(o.name,n.prefix),s=a.name;$u(o.type)||(o.type=xt(o.type,a.prefix).name),O(o,{ns:a,name:s}),r[s]=o},this)),O(e,{ns:n,name:i,propertiesByName:r}),I(e.extends,wt(function(o){var a=this.typeMap[o];a.traits=a.traits||[],a.traits.push(i)},this)),this.definePackage(e,t),this.typeMap[i]=e};Ei.prototype.mapTypes=function(e,t,n){var i=$u(e.name)?{name:e.name}:this.typeMap[e.name],r=this;function o(s){return a(s,!0)}function a(s,c){var u=xt(s,$u(s)?"":e.prefix);r.mapTypes(u,t,c)}if(!i)throw new Error("unknown type <"+e.name+">");I(i.superClass,n?o:a),t(i,!n),I(i.traits,o)};Ei.prototype.getEffectiveDescriptor=function(e){var t=xt(e),n=new Vt(t);this.mapTypes(t,function(r,o){n.addTrait(r,o)});var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i};Ei.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})};function Qf(e,t,n){var i=t[n];if(i in e)throw new Error("package with "+n+" <"+i+"> already defined")}function Ar(e){this.model=e}Ar.prototype.set=function(e,t,n){var i=this.model.getPropertyDescriptor(e,t),r=i&&i.name;xb(n)?i?delete e[r]:delete e.$attrs[t]:i?r in e?e[r]=n:bv(e,i,n):e.$attrs[t]=n};Ar.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var i=n.name;return!e[i]&&n.isMany&&bv(e,n,[]),e[i]};Ar.prototype.define=function(e,t,n){if(!n.writable){var i=n.value;n=O({},n,{get:function(){return i}}),delete n.value}Object.defineProperty(e,t,n)};Ar.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})};Ar.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})};function xb(e){return typeof e=="undefined"}function bv(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}function Wt(e){this.properties=new Ar(this),this.factory=new yv(this,this.properties),this.registry=new Ei(e,this.properties),this.typeCache={}}Wt.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)};Wt.prototype.getType=function(e){var t=this.typeCache,n=Gt(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i};Wt.prototype.createAny=function(e,t,n){var i=xt(e),r={$type:e,$instanceOf:function(a){return a===this.$type}},o={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(r,o),this.properties.defineModel(r,this),this.properties.define(r,"$parent",{enumerable:!1,writable:!0}),this.properties.define(r,"$instanceOf",{enumerable:!1,writable:!0}),I(n,function(a,s){ot(a)&&a.value!==void 0?r[a.name]=a.value:r[s]=a}),r};Wt.prototype.getPackage=function(e){return this.registry.getPackage(e)};Wt.prototype.getPackages=function(){return this.registry.getPackages()};Wt.prototype.getElementDescriptor=function(e){return e.$descriptor};Wt.prototype.hasType=function(e,t){t===void 0&&(t=e,e=this);var n=e.$model.getElementDescriptor(e);return t in n.allTypesByName};Wt.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]};Wt.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var Jf=String.fromCharCode,wb=Object.prototype.hasOwnProperty,Sb=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/ig,lo={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};Object.keys(lo).forEach(function(e){lo[e.toUpperCase()]=lo[e]});function Cb(e,t,n,i){return i?wb.call(lo,i)?lo[i]:"&"+i+";":Jf(t||parseInt(n,16))}function ki(e){return e.length>3&&e.indexOf("&")!==-1?e.replace(Sb,Cb):e}var Tb="http://www.w3.org/2001/XMLSchema-instance",Ab="xsi",eh="xsi:type",th="non-whitespace outside of root node";function fr(e){return new Error(e)}function nh(e){return"missing namespace for prefix <"+e+">"}function Aa(e){return{get:e,enumerable:!0}}function Rb(e){var t={},n;for(n in e)t[n]=e[n];return t}function ju(e){return e+"$uri"}function Pb(e){var t={},n,i;for(n in e)i=e[n],t[i]=i,t[ju(i)]=n;return t}function ih(){return{line:0,column:0}}function Db(e){throw e}function xv(e){if(!this)return new xv(e);var t=e&&e.proxy,n,i,r,o,a=Db,s,c,u,l,p=ih,f=!1,h=!1,d=null,g=!1,y;function A(b){b instanceof Error||(b=fr(b)),d=b,a(b,p)}function _(b){!s||(b instanceof Error||(b=fr(b)),s(b,p))}this.on=function(b,S){if(typeof S!="function")throw fr("required args <name, cb>");switch(b){case"openTag":i=S;break;case"text":n=S;break;case"closeTag":r=S;break;case"error":a=S;break;case"warn":s=S;break;case"cdata":o=S;break;case"attention":l=S;break;case"question":u=S;break;case"comment":c=S;break;default:throw fr("unsupported event: "+b)}return this},this.ns=function(b){if(typeof b=="undefined"&&(b={}),typeof b!="object")throw fr("required args <nsMap={}>");var S={},M;for(M in b)S[M]=b[M];return S[Tb]=Ab,h=!0,y=S,this},this.parse=function(b){if(typeof b!="string")throw fr("required args <xml=string>");return d=null,w(b),p=ih,g=!1,d},this.stop=function(){g=!0};function w(b){var S=h?[]:null,M=h?Pb(y):null,C,R=[],D=0,F=!1,j=!1,z=0,G=0,he,Ne,_e,ue,T,m,B,k,V,te="",L=0,H;function ee(){if(H!==null)return H;var Y,U,Q,ne=h&&M.xmlns,se=h&&f?[]:null,de=L,Te=te,Ye=Te.length,tt,nt,we,Mt,Ie,et={},va={},Bt,fe,Fe;e:for(;de<Ye;de++)if(Bt=!1,fe=Te.charCodeAt(de),!(fe===32||fe<14&&fe>8)){for((fe<65||fe>122||fe>90&&fe<97)&&fe!==95&&fe!==58&&(_("illegal first char attribute name"),Bt=!0),Fe=de+1;Fe<Ye;Fe++)if(fe=Te.charCodeAt(Fe),!(fe>96&&fe<123||fe>64&&fe<91||fe>47&&fe<59||fe===46||fe===45||fe===95)){if(fe===32||fe<14&&fe>8){_("missing attribute value"),de=Fe;continue e}if(fe===61)break;_("illegal attribute name char"),Bt=!0}if(Ie=Te.substring(de,Fe),Ie==="xmlns:xmlns"&&(_("illegal declaration of xmlns"),Bt=!0),fe=Te.charCodeAt(Fe+1),fe===34)Fe=Te.indexOf('"',de=Fe+2),Fe===-1&&(Fe=Te.indexOf("'",de),Fe!==-1&&(_("attribute value quote missmatch"),Bt=!0));else if(fe===39)Fe=Te.indexOf("'",de=Fe+2),Fe===-1&&(Fe=Te.indexOf('"',de),Fe!==-1&&(_("attribute value quote missmatch"),Bt=!0));else for(_("missing attribute value quotes"),Bt=!0,Fe=Fe+1;Fe<Ye&&(fe=Te.charCodeAt(Fe+1),!(fe===32||fe<14&&fe>8));Fe++);for(Fe===-1&&(_("missing closing quotes"),Fe=Ye,Bt=!0),Bt||(we=Te.substring(de,Fe)),de=Fe;Fe+1<Ye&&(fe=Te.charCodeAt(Fe+1),!(fe===32||fe<14&&fe>8));Fe++)de===Fe&&(_("illegal character after attribute end"),Bt=!0);if(de=Fe+1,Bt)continue e;if(Ie in va){_("attribute <"+Ie+"> already defined");continue}if(va[Ie]=!0,!h){et[Ie]=we;continue}if(f){if(nt=Ie==="xmlns"?"xmlns":Ie.charCodeAt(0)===120&&Ie.substr(0,6)==="xmlns:"?Ie.substr(6):null,nt!==null){if(Y=ki(we),U=ju(nt),Mt=y[Y],!Mt){if(nt==="xmlns"||U in M&&M[U]!==Y)do Mt="ns"+D++;while(typeof M[Mt]!="undefined");else Mt=nt;y[Y]=Mt}M[nt]!==Mt&&(tt||(M=Rb(M),tt=!0),M[nt]=Mt,nt==="xmlns"&&(M[ju(Mt)]=Y,ne=Mt),M[U]=Y),et[Ie]=we;continue}se.push(Ie,we);continue}if(fe=Ie.indexOf(":"),fe===-1){et[Ie]=we;continue}if(!(Q=M[Ie.substring(0,fe)])){_(nh(Ie.substring(0,fe)));continue}Ie=ne===Q?Ie.substr(fe+1):Q+Ie.substr(fe),Ie===eh&&(fe=we.indexOf(":"),fe!==-1?(Q=we.substring(0,fe),Q=M[Q]||Q,we=Q+we.substring(fe)):we=ne+":"+we),et[Ie]=we}if(f)for(de=0,Ye=se.length;de<Ye;de++){if(Ie=se[de++],we=se[de],fe=Ie.indexOf(":"),fe!==-1){if(!(Q=M[Ie.substring(0,fe)])){_(nh(Ie.substring(0,fe)));continue}Ie=ne===Q?Ie.substr(fe+1):Q+Ie.substr(fe),Ie===eh&&(fe=we.indexOf(":"),fe!==-1?(Q=we.substring(0,fe),Q=M[Q]||Q,we=Q+we.substring(fe)):we=ne+":"+we)}et[Ie]=we}return H=et}function N(){for(var Y=/(\r\n|\r|\n)/g,U=0,Q=0,ne=0,se=G,de,Te;z>=ne&&(de=Y.exec(b),!(!de||(se=de[0].length+de.index,se>z)));)U+=1,ne=se;return z==-1?(Q=se,Te=b.substring(G)):G===0?Te=b.substring(G,z):(Q=z-ne,Te=G==-1?b.substring(z):b.substring(z,G+1)),{data:Te,line:U,column:Q}}for(p=N,t&&(V=Object.create({},{name:Aa(function(){return B}),originalName:Aa(function(){return k}),attrs:Aa(ee),ns:Aa(function(){return M})}));G!==-1;){if(b.charCodeAt(G)===60?z=G:z=b.indexOf("<",G),z===-1){if(R.length)return A("unexpected end of file");if(G===0)return A("missing start tag");G<b.length&&b.substring(G).trim()&&_(th);return}if(G!==z){if(R.length){if(n&&(n(b.substring(G,z),ki,p),g))return}else if(b.substring(G,z).trim()&&(_(th),g))return}if(ue=b.charCodeAt(z+1),ue===33){if(_e=b.charCodeAt(z+2),_e===91&&b.substr(z+3,6)==="CDATA["){if(G=b.indexOf("]]>",z),G===-1)return A("unclosed cdata");if(o&&(o(b.substring(z+9,G),p),g))return;G+=3;continue}if(_e===45&&b.charCodeAt(z+3)===45){if(G=b.indexOf("-->",z),G===-1)return A("unclosed comment");if(c&&(c(b.substring(z+4,G),ki,p),g))return;G+=3;continue}}if(ue===63){if(G=b.indexOf("?>",z),G===-1)return A("unclosed question");if(u&&(u(b.substring(z,G+2),p),g))return;G+=2;continue}for(he=z+1;;he++){if(T=b.charCodeAt(he),isNaN(T))return G=-1,A("unclosed tag");if(T===34)_e=b.indexOf('"',he+1),he=_e!==-1?_e:he;else if(T===39)_e=b.indexOf("'",he+1),he=_e!==-1?_e:he;else if(T===62){G=he;break}}if(ue===33){if(l&&(l(b.substring(z,G+1),ki,p),g))return;G+=1;continue}if(H={},ue===47){if(F=!1,j=!0,!R.length)return A("missing open tag");if(he=B=R.pop(),_e=z+2+he.length,b.substring(z+2,_e)!==he)return A("closing tag mismatch");for(;_e<G;_e++)if(ue=b.charCodeAt(_e),!(ue===32||ue>8&&ue<14))return A("close tag")}else{if(b.charCodeAt(G-1)===47?(he=B=b.substring(z+1,G-1),F=!0,j=!0):(he=B=b.substring(z+1,G),F=!0,j=!1),!(ue>96&&ue<123||ue>64&&ue<91||ue===95||ue===58))return A("illegal first char nodeName");for(_e=1,Ne=he.length;_e<Ne;_e++)if(ue=he.charCodeAt(_e),!(ue>96&&ue<123||ue>64&&ue<91||ue>47&&ue<59||ue===45||ue===95||ue==46)){if(ue===32||ue<14&&ue>8){B=he.substring(0,_e),H=null;break}return A("invalid nodeName")}j||R.push(B)}if(h){if(C=M,F&&(j||S.push(C),H===null&&(f=he.indexOf("xmlns",_e)!==-1)&&(L=_e,te=he,ee(),f=!1)),k=B,ue=B.indexOf(":"),ue!==-1){if(m=M[B.substring(0,ue)],!m)return A("missing namespace on <"+k+">");B=B.substr(ue+1)}else m=M.xmlns;m&&(B=m+":"+B)}if(F&&(L=_e,te=he,i&&(t?i(V,ki,j,p):i(B,ee,ki,j,p),g)))return;if(j){if(r&&(r(t?V:B,ki,F,p),g))return;h&&(F?M=C:M=S.pop())}G+=1}}}function wv(e){return e.xml&&e.xml.tagAlias==="lowerCase"}var Mb={xsi:"http://www.w3.org/2001/XMLSchema-instance",xml:"http://www.w3.org/XML/1998/namespace"},ks="xsi:type";function Sv(e){return e.xml&&e.xml.serialize}function Cv(e){return Sv(e)===ks}function Bb(e){return Sv(e)==="property"}function Ib(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Tv(e,t){return wv(t)?e.prefix+":"+Ib(e.localName):e.name}function Fb(e,t){var n=e.name,i=e.localName,r=t.xml&&t.xml.typePrefix;return r&&i.indexOf(r)===0?e.prefix+":"+i.slice(r.length):n}function Ob(e,t){var n=xt(e),i=t.getPackage(n.prefix);return Fb(n,i)}function hi(e){return new Error(e)}function jn(e){return e.$descriptor}function kb(e){O(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(t){this.references.push(t)},this.addElement=function(t){if(!t)throw hi("expected element");var n=this.elementsById,i=jn(t),r=i.idProperty,o;if(r&&(o=t.get(r.name),o)){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(o))throw new Error("illegal ID <"+o+">");if(n[o])throw hi("duplicate ID <"+o+">");n[o]=t}},this.addWarning=function(t){this.warnings.push(t)}}function Io(){}Io.prototype.handleEnd=function(){};Io.prototype.handleText=function(){};Io.prototype.handleNode=function(){};function Dl(){}Dl.prototype=Object.create(Io.prototype);Dl.prototype.handleNode=function(){return this};function Rr(){}Rr.prototype=Object.create(Io.prototype);Rr.prototype.handleText=function(e){this.body=(this.body||"")+e};function Fo(e,t){this.property=e,this.context=t}Fo.prototype=Object.create(Rr.prototype);Fo.prototype.handleNode=function(e){if(this.element)throw hi("expected no sub nodes");return this.element=this.createReference(e),this};Fo.prototype.handleEnd=function(){this.element.id=this.body};Fo.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}};function Ml(e,t){this.element=t,this.propertyDesc=e}Ml.prototype=Object.create(Rr.prototype);Ml.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=Pl(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)};function Ns(){}Ns.prototype=Object.create(Rr.prototype);Ns.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t};function vt(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}vt.prototype=Object.create(Ns.prototype);vt.prototype.addReference=function(e){this.context.addReference(e)};vt.prototype.handleText=function(e){var t=this.element,n=jn(t),i=n.bodyProperty;if(!i)throw hi("unexpected body text <"+e+">");Rr.prototype.handleText.call(this,e)};vt.prototype.handleEnd=function(){var e=this.body,t=this.element,n=jn(t),i=n.bodyProperty;i&&e!==void 0&&(e=Pl(i.type,e),t.set(i.name,e))};vt.prototype.createElement=function(e){var t=e.attributes,n=this.type,i=jn(n),r=this.context,o=new n({}),a=this.model,s;return I(t,function(c,u){var l=i.propertiesByName[u],p;l&&l.isReference?l.isMany?(p=c.split(" "),I(p,function(f){r.addReference({element:o,property:l.ns.name,id:f})})):r.addReference({element:o,property:l.ns.name,id:c}):(l?c=Pl(l.type,c):u!=="xmlns"&&(s=xt(u,i.ns.prefix),a.getPackage(s.prefix)&&r.addWarning({message:"unknown attribute <"+u+">",element:o,property:u,value:c})),o.set(u,c))}),o};vt.prototype.getPropertyForNode=function(e){var t=e.name,n=xt(t),i=this.type,r=this.model,o=jn(i),a=n.name,s=o.propertiesByName[a],c,u;if(s&&!s.isAttr)return Cv(s)&&(c=e.attributes[ks],c)?(c=Ob(c,r),u=r.getType(c),O({},s,{effectiveType:jn(u).name})):s;var l=r.getPackage(n.prefix);if(l){if(c=Tv(n,l),u=r.getType(c),s=Me(o.properties,function(p){return!p.isVirtual&&!p.isReference&&!p.isAttribute&&u.hasType(p.type)}),s)return O({},s,{effectiveType:jn(u).name})}else if(s=Me(o.properties,function(p){return!p.isReference&&!p.isAttribute&&p.type==="Element"}),s)return s;throw hi("unrecognized element <"+n.name+">")};vt.prototype.toString=function(){return"ElementDescriptor["+jn(this.type).name+"]"};vt.prototype.valueHandler=function(e,t){return new Ml(e,t)};vt.prototype.referenceHandler=function(e){return new Fo(e,this.context)};vt.prototype.handler=function(e){return e==="Element"?new _r(this.model,e,this.context):new vt(this.model,e,this.context)};vt.prototype.handleChild=function(e){var t,n,i,r;if(t=this.getPropertyForNode(e),i=this.element,n=t.effectiveType||t.type,_v(n))return this.valueHandler(t,i);t.isReference?r=this.referenceHandler(t).handleNode(e):r=this.handler(n).handleNode(e);var o=r.element;return o!==void 0&&(t.isMany?i.get(t.name).push(o):i.set(t.name,o),t.isReference?(O(o,{element:i}),this.context.addReference(o)):o.$parent=i),r};function Bl(e,t,n){vt.call(this,e,t,n)}Bl.prototype=Object.create(vt.prototype);Bl.prototype.createElement=function(e){var t=e.name,n=xt(t),i=this.model,r=this.type,o=i.getPackage(n.prefix),a=o&&Tv(n,o)||t;if(!r.hasType(a))throw hi("unexpected element <"+e.originalName+">");return vt.prototype.createElement.call(this,e)};function _r(e,t,n){this.model=e,this.context=n}_r.prototype=Object.create(Ns.prototype);_r.prototype.createElement=function(e){var t=e.name,n=xt(t),i=n.prefix,r=e.ns[i+"$uri"],o=e.attributes;return this.model.createAny(t,r,o)};_r.prototype.handleChild=function(e){var t=new _r(this.model,"Element",this.context).handleNode(e),n=this.element,i=t.element,r;return i!==void 0&&(r=n.$children=n.$children||[],r.push(i),i.$parent=n),t};_r.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)};function Il(e){e instanceof Wt&&(e={model:e}),O(this,{lax:!1},e)}Il.prototype.fromXML=function(e,t,n){var i=t.rootHandler;t instanceof vt?(i=t,t={}):typeof t=="string"?(i=this.handler(t),t={}):typeof i=="string"&&(i=this.handler(i));var r=this.model,o=this.lax,a=new kb(O({},t,{rootHandler:i})),s=new xv({proxy:!0}),c=Nb();i.context=a,c.push(i);function u(S,M,C){var R=M(),D=R.line,F=R.column,j=R.data;j.charAt(0)==="<"&&j.indexOf(" ")!==-1&&(j=j.slice(0,j.indexOf(" "))+">");var z="unparsable content "+(j?j+" ":"")+`detected
	line: `+D+`
	column: `+F+`
	nested error: `+S.message;if(C)return a.addWarning({message:z,error:S}),!0;throw hi(z)}function l(S,M){return u(S,M,!0)}function p(){var S=a.elementsById,M=a.references,C,R;for(C=0;R=M[C];C++){var D=R.element,F=S[R.id],j=jn(D).propertiesByName[R.property];if(F||a.addWarning({message:"unresolved reference <"+R.id+">",element:R.element,property:R.property,value:R.id}),j.isMany){var z=D.get(j.name),G=z.indexOf(R);G===-1&&(G=z.length),F?z[G]=F:z.splice(G,1)}else D.set(j.name,F)}}function f(){c.pop().handleEnd()}var h=/^<\?xml /i,d=/ encoding="([^"]+)"/i,g=/^utf-8$/i;function y(S){if(!!h.test(S)){var M=d.exec(S),C=M&&M[1];!C||g.test(C)||a.addWarning({message:"unsupported document encoding <"+C+">, falling back to UTF-8"})}}function A(S,M){var C=c.peek();try{c.push(C.handleNode(S))}catch(R){u(R,M,o)&&c.push(new Dl)}}function _(S,M){try{c.peek().handleText(S)}catch(C){l(C,M)}}function w(S,M){!S.trim()||_(S,M)}var b=r.getPackages().reduce(function(S,M){return S[M.uri]=M.prefix,S},{"http://www.w3.org/XML/1998/namespace":"xml"});return s.ns(b).on("openTag",function(S,M,C,R){var D=S.attrs||{},F=Object.keys(D).reduce(function(z,G){var he=M(D[G]);return z[G]=he,z},{}),j={name:S.name,originalName:S.originalName,attributes:F,ns:S.ns};A(j,R)}).on("question",y).on("closeTag",f).on("cdata",_).on("text",function(S,M,C){w(M(S),C)}).on("error",u).on("warn",l),new Promise(function(S,M){var C;try{s.parse(e),p()}catch(z){C=z}var R=i.element;!C&&!R&&(C=hi("failed to parse document as <"+i.type.$descriptor.name+">"));var D=a.warnings,F=a.references,j=a.elementsById;return C?(C.warnings=D,M(C)):S({rootElement:R,elementsById:j,references:F,warnings:D})})};Il.prototype.handler=function(e){return new Bl(this.model,e)};function Nb(){var e=[];return Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e}var Lb=`<?xml version="1.0" encoding="UTF-8"?>
`,$b=/<|>|'|"|&|\n\r|\n/g,Av=/<|>|&/g;function jb(e){var t={},n={},i={},r=[],o=[];this.byUri=function(a){return n[a]||e&&e.byUri(a)},this.add=function(a,s){n[a.uri]=a,s?r.push(a):o.push(a),this.mapPrefix(a.prefix,a.uri)},this.uriByPrefix=function(a){return t[a||"xmlns"]},this.mapPrefix=function(a,s){t[a||"xmlns"]=s},this.getNSKey=function(a){return a.prefix!==void 0?a.uri+"|"+a.prefix:a.uri},this.logUsed=function(a){var s=a.uri,c=this.getNSKey(a);i[c]=this.byUri(s),e&&e.logUsed(a)},this.getUsed=function(a){function s(l){var p=c.getNSKey(l);return i[p]}var c=this,u=[].concat(r,o);return u.filter(s)}}function Hb(e){return e.charAt(0).toLowerCase()+e.slice(1)}function zb(e,t){return wv(t)?Hb(e):e}function Rv(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function Pv(e){return Gt(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function Gb(e){return e.getUsed().filter(function(t){return t.prefix!=="xml"}).map(function(t){var n="xmlns"+(t.prefix?":"+t.prefix:"");return{name:n,value:t.uri}})}function Vb(e,t){return t.isGeneric?O({localName:t.ns.localName},e):O({localName:zb(t.ns.localName,t.$pkg)},e)}function Wb(e,t){return O({localName:t.ns.localName},e)}function Ub(e){var t=e.$descriptor;return Ee(t.properties,function(n){var i=n.name;if(n.isVirtual||!Nn(e,i))return!1;var r=e[i];return r===n.default||r===null?!1:n.isMany?r.length:!0})}var Yb={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},qb={"<":"lt",">":"gt","&":"amp"};function Dv(e,t,n){return e=Gt(e)?e:""+e,e.replace(t,function(i){return"&"+n[i]+";"})}function Kb(e){return Dv(e,$b,Yb)}function Xb(e){return Dv(e,Av,qb)}function Zb(e){return Ee(e,function(t){return t.isAttr})}function Qb(e){return Ee(e,function(t){return!t.isAttr})}function Fl(e){this.tagName=e}Fl.prototype.build=function(e){return this.element=e,this};Fl.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()};function Ui(){}Ui.prototype.serializeValue=Ui.prototype.serializeTo=function(e){e.append(this.escape?Xb(this.value):this.value)};Ui.prototype.build=function(e,t){return this.value=t,e.type==="String"&&t.search(Av)!==-1&&(this.escape=!0),this};function Ol(e){this.tagName=e}Rv(Ol,Ui);Ol.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()};function $e(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}$e.prototype.build=function(e){this.element=e;var t=e.$descriptor,n=this.propertyDescriptor,i,r,o=t.isGeneric;return o?i=this.parseGeneric(e):i=this.parseNsAttributes(e),n?this.ns=this.nsPropertyTagName(n):this.ns=this.nsTagName(t),this.tagName=this.addTagName(this.ns),o||(r=Ub(e),this.parseAttributes(Zb(r)),this.parseContainments(Qb(r))),this.parseGenericAttributes(e,i),this};$e.prototype.nsTagName=function(e){var t=this.logNamespaceUsed(e.ns);return Vb(t,e)};$e.prototype.nsPropertyTagName=function(e){var t=this.logNamespaceUsed(e.ns);return Wb(t,e)};$e.prototype.isLocalNs=function(e){return e.uri===this.ns.uri};$e.prototype.nsAttributeName=function(e){var t;if(Gt(e)?t=xt(e):t=e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:O({localName:t.localName},n)};$e.prototype.parseGeneric=function(e){var t=this,n=this.body,i=[];return I(e,function(r,o){var a;o==="$body"?n.push(new Ui().build({type:"String"},r)):o==="$children"?I(r,function(s){n.push(new $e(t).build(s))}):o.indexOf("$")!==0&&(a=t.parseNsAttribute(e,o,r),a&&i.push({name:o,value:r}))}),i};$e.prototype.parseNsAttribute=function(e,t,n){var i=e.$model,r=xt(t),o;if(r.prefix==="xmlns"&&(o={prefix:r.localName,uri:n}),!r.prefix&&r.localName==="xmlns"&&(o={uri:n}),!o)return{name:t,value:n};if(i&&i.getPackage(n))this.logNamespace(o,!0,!0);else{var a=this.logNamespaceUsed(o,!0);this.getNamespaces().logUsed(a)}};$e.prototype.parseNsAttributes=function(e,t){var n=this,i=e.$attrs,r=[];return I(i,function(o,a){var s=n.parseNsAttribute(e,a,o);s&&r.push(s)}),r};$e.prototype.parseGenericAttributes=function(e,t){var n=this;I(t,function(i){if(i.name!==ks)try{n.addAttribute(n.nsAttributeName(i.name),i.value)}catch(r){console.warn("missing namespace information for ",i.name,"=",i.value,"on",e,r)}})};$e.prototype.parseContainments=function(e){var t=this,n=this.body,i=this.element;I(e,function(r){var o=i.get(r.name),a=r.isReference,s=r.isMany;if(s||(o=[o]),r.isBody)n.push(new Ui().build(r,o[0]));else if(_v(r.type))I(o,function(l){n.push(new Ol(t.addTagName(t.nsPropertyTagName(r))).build(r,l))});else if(a)I(o,function(l){n.push(new Fl(t.addTagName(t.nsPropertyTagName(r))).build(l))});else{var c=Cv(r),u=Bb(r);I(o,function(l){var p;c?p=new Ls(t,r):u?p=new $e(t,r):p=new $e(t),n.push(p.build(l))})}})};$e.prototype.getNamespaces=function(e){var t=this.namespaces,n=this.parent,i;return t||(i=n&&n.getNamespaces(),e||!i?this.namespaces=t=new jb(i):t=i),t};$e.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),r=e.uri,o=e.prefix,a=i.byUri(r);return(!a||n)&&i.add(e,t),i.mapPrefix(o,r),e};$e.prototype.logNamespaceUsed=function(e,t){var n=this.element,i=n.$model,r=this.getNamespaces(t),o=e.prefix,a=e.uri,s,c,u;if(!o&&!a)return{localName:e.localName};if(u=Mb[o]||i&&(i.getPackage(o)||{}).uri,a=a||u||r.uriByPrefix(o),!a)throw new Error("no namespace uri given for prefix <"+o+">");if(e=r.byUri(a),!e){for(s=o,c=1;r.uriByPrefix(s);)s=o+"_"+c++;e=this.logNamespace({prefix:s,uri:a},u===a)}return o&&r.mapPrefix(o,a),e};$e.prototype.parseAttributes=function(e){var t=this,n=this.element;I(e,function(i){var r=n.get(i.name);if(i.isReference)if(!i.isMany)r=r.id;else{var o=[];I(r,function(a){o.push(a.id)}),r=o.join(" ")}t.addAttribute(t.nsAttributeName(i),r)})};$e.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),Pv(e)};$e.prototype.addAttribute=function(e,t){var n=this.attrs;Gt(t)&&(t=Kb(t));var i=km(n,function(o){return o.name.localName===e.localName&&o.name.uri===e.uri&&o.name.prefix===e.prefix}),r={name:e,value:t};i!==-1?n.splice(i,1,r):n.push(r)};$e.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=Gb(n).concat(t)),I(t,function(i){e.append(" ").append(Pv(i.name)).append('="').append(i.value).append('"')})};$e.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==Ui;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),I(this.body,function(i){i.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()};function Ls(e,t){$e.call(this,e,t)}Rv(Ls,$e);Ls.prototype.parseNsAttributes=function(e){var t=$e.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var r=e.$model.getPackage(i.uri),o=r.xml&&r.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(ks),(i.prefix?i.prefix+":":"")+o+n.ns.localName),t};Ls.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri};function Jb(){this.value="",this.write=function(e){this.value+=e}}function ex(e,t){var n=[""];this.append=function(i){return e.write(i),this},this.appendNewLine=function(){return t&&e.write(`
`),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}function tx(e){e=O({format:!1,preamble:!0},e||{});function t(n,i){var r=i||new Jb,o=new ex(r,e.format);if(e.preamble&&o.append(Lb),new $e().build(n).serializeTo(o),!i)return r.value}return{toXML:t}}function $s(e,t){Wt.call(this,e,t)}$s.prototype=Object.create(Wt.prototype);$s.prototype.fromXML=function(e,t,n){Gt(t)||(n=t,t="bpmn:Definitions");var i=new Il(O({model:this,lax:!0},n)),r=i.handler(t);return i.fromXML(e,r)};$s.prototype.toXML=function(e,t){var n=new tx(t);return new Promise(function(i,r){try{var o=n.toXML(e);return i({xml:o})}catch(a){return r(a)}})};var nx="BPMN20",ix="http://www.omg.org/spec/BPMN/20100524/MODEL",rx="bpmn",ox=[],ax=[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",isMany:!0,replaces:"FlowElementsContainer#laneSets",type:"LaneSet"},{name:"flowElements",isMany:!0,replaces:"FlowElementsContainer#flowElements",type:"FlowElement"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean",default:!0},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isAttr:!0,isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}},{name:"assignment",type:"Assignment",isMany:!0}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",isBody:!0,type:"String"}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isMany:!0,isVirtual:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Integer",isAttr:!0}]},{name:"CallActivity",superClass:["Activity","InteractionNode"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],sx=[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],cx={tagAlias:"lowerCase",typePrefix:"t"},ux={name:nx,uri:ix,prefix:rx,associations:ox,types:ax,enumerations:sx,xml:cx},lx="BPMNDI",px="http://www.omg.org/spec/BPMN/20100524/DI",fx="bpmndi",hx=[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],dx=[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],mx=[],vx={name:lx,uri:px,prefix:fx,types:hx,enumerations:dx,associations:mx},gx="DC",yx="http://www.omg.org/spec/DD/20100524/DC",Ex="dc",_x=[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],bx=[],xx={name:gx,uri:yx,prefix:Ex,types:_x,associations:bx},wx="DI",Sx="http://www.omg.org/spec/DD/20100524/DI",Cx="di",Tx=[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"}]},{name:"Extension",properties:[{name:"values",isMany:!0,type:"Element"}]}],Ax=[],Rx={tagAlias:"lowerCase"},Px={name:wx,uri:Sx,prefix:Cx,types:Tx,associations:Ax,xml:Rx},Dx="bpmn.io colors for BPMN",Mx="http://bpmn.io/schema/bpmn/biocolor/1.0",Bx="bioc",Ix=[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],Fx=[],Ox=[],kx={name:Dx,uri:Mx,prefix:Bx,types:Ix,enumerations:Fx,associations:Ox},Nx="BPMN in Color",Lx="http://www.omg.org/spec/BPMN/non-normative/color/1.0",$x="color",jx=[{name:"ColoredLabel",extends:["bpmndi:BPMNLabel"],properties:[{name:"color",isAttr:!0,type:"String"}]},{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"background-color",isAttr:!0,type:"String"},{name:"border-color",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"border-color",isAttr:!0,type:"String"}]}],Hx=[],zx=[],Gx={name:Nx,uri:Lx,prefix:$x,types:jx,enumerations:Hx,associations:zx},Vx={bpmn:ux,bpmndi:vx,dc:xx,di:Px,bioc:kx,color:Gx};function Wx(e,t){var n=O({},Vx,e);return new $s(n,t)}function ut(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}function Pr(e){return function(){if(!window.Promise)throw new Error("Promises is not supported in this environment. Please polyfill Promise.");var t=arguments.length;if(t>=1&&_t(arguments[t-1])){var n=arguments[t-1];console.warn(new Error("Passing callbacks to "+e.name+" is deprecated and will be removed in a future major release. Please switch to promises: https://bpmn.io/l/moving-to-promises.html"));var i=Array.prototype.slice.call(arguments,0,-1);e.apply(this,i).then(function(r){var o=Object.keys(r)[0];return n(null,r[o])},function(r){return n(r,r.warnings)})}else return e.apply(this,arguments)}}var Ux="Tried to access di from the businessObject. The di is available through the diagram element only. For more information, see https://github.com/bpmn-io/bpmn-js/issues/1472";function Mv(e){Nn(e,"di")||Object.defineProperty(e,"di",{enumerable:!1,get:function(){throw new Error(Ux)}})}function Et(e,t){return e.$instanceOf(t)}function Yx(e){return Me(e.rootElements,function(t){return Et(t,"bpmn:Process")||Et(t,"bpmn:Collaboration")})}function qx(e,t){var n={},i=[],r={};function o(L,H){return function(ee){L(ee,H)}}function a(L){n[L.id]=L}function s(L){return n[L.id]}function c(L,H){var ee=L.gfx;if(ee)throw new Error(t("already rendered {element}",{element:ut(L)}));return e.element(L,r[L.id],H)}function u(L,H){return e.root(L,r[L.id],H)}function l(L,H){try{var ee=r[L.id]&&c(L,H);return a(L),ee}catch(N){p(N.message,{element:L,error:N}),console.error(t("failed to import {element}",{element:ut(L)})),console.error(N)}}function p(L,H){e.error(L,H)}function f(L){var H=L.bpmnElement;H?r[H.id]?p(t("multiple DI elements defined for {element}",{element:ut(H)}),{element:H}):(r[H.id]=L,Mv(H)):p(t("no bpmnElement referenced in {element}",{element:ut(L)}),{element:L})}function h(L){d(L.plane)}function d(L){f(L),I(L.planeElement,g)}function g(L){f(L)}function y(L,H){var ee=L.diagrams;if(H&&ee.indexOf(H)===-1)throw new Error(t("diagram not part of bpmn:Definitions"));if(!H&&ee&&ee.length&&(H=ee[0]),!H)throw new Error(t("no diagram to display"));r={},h(H);var N=H.plane;if(!N)throw new Error(t("no plane for {element}",{element:ut(H)}));var Y=N.bpmnElement;if(!Y)if(Y=Yx(L),Y)p(t("correcting missing bpmnElement on {plane} to {rootElement}",{plane:ut(N),rootElement:ut(Y)})),N.bpmnElement=Y,f(N);else throw new Error(t("no process or collaboration to display"));var U=u(Y,N);if(Et(Y,"bpmn:Process")||Et(Y,"bpmn:SubProcess"))_(Y,U);else if(Et(Y,"bpmn:Collaboration"))V(Y,U),w(L.rootElements,U);else throw new Error(t("unsupported bpmnElement for {plane}: {rootElement}",{plane:ut(N),rootElement:ut(Y)}));A()}function A(){for(var L;i.length;)L=i.shift(),L()}function _(L,H){m(L,H),j(L.ioSpecification,H),F(L.artifacts,H),a(L)}function w(L,H){var ee=Ee(L,function(N){return!s(N)&&Et(N,"bpmn:Process")&&N.laneSets});ee.forEach(o(_,H))}function b(L,H){l(L,H)}function S(L,H){I(L,o(b,H))}function M(L,H){l(L,H)}function C(L,H){l(L,H)}function R(L,H){l(L,H)}function D(L,H){l(L,H)}function F(L,H){I(L,function(ee){Et(ee,"bpmn:Association")?i.push(function(){D(ee,H)}):D(ee,H)})}function j(L,H){!L||(I(L.dataInputs,o(C,H)),I(L.dataOutputs,o(R,H)))}function z(L,H){m(L,H),F(L.artifacts,H)}function G(L,H){var ee=l(L,H);Et(L,"bpmn:SubProcess")&&z(L,ee||H),Et(L,"bpmn:Activity")&&j(L.ioSpecification,H),i.push(function(){I(L.dataInputAssociations,o(M,H)),I(L.dataOutputAssociations,o(M,H))})}function he(L,H){l(L,H)}function Ne(L,H){l(L,H)}function _e(L,H){i.push(function(){var ee=l(L,H);L.childLaneSet&&ue(L.childLaneSet,ee||H),te(L)})}function ue(L,H){I(L.lanes,o(_e,H))}function T(L,H){I(L,o(ue,H))}function m(L,H){B(L.flowElements,H),L.laneSets&&T(L.laneSets,H)}function B(L,H){I(L,function(ee){Et(ee,"bpmn:SequenceFlow")?i.push(function(){he(ee,H)}):Et(ee,"bpmn:BoundaryEvent")?i.unshift(function(){G(ee,H)}):Et(ee,"bpmn:FlowNode")?G(ee,H):Et(ee,"bpmn:DataObject")||(Et(ee,"bpmn:DataStoreReference")||Et(ee,"bpmn:DataObjectReference")?Ne(ee,H):p(t("unrecognized flowElement {element} in context {context}",{element:ut(ee),context:H?ut(H.businessObject):"null"}),{element:ee,context:H}))})}function k(L,H){var ee=l(L,H),N=L.processRef;N&&_(N,ee||H)}function V(L,H){I(L.participants,o(k,H)),F(L.artifacts,H),i.push(function(){S(L.messageFlows,H)})}function te(L){I(L.flowNodeRef,function(H){var ee=H.get("lanes");ee&&ee.push(L)})}return{handleDeferred:A,handleDefinitions:y,handleSubProcess:z,registerDi:f}}function v(e,t){var n=X(e);return n&&typeof n.$instanceOf=="function"&&n.$instanceOf(t)}function De(e,t){return Sn(t,function(n){return v(e,n)})}function X(e){return e&&e.businessObject||e}function Ce(e){return e&&e.di}function Kx(e,t,n){var i,r,o,a,s,c=[];function u(l,p){var f={root:function(y,A){return i.add(y,A)},element:function(y,A,_){return i.add(y,A,_)},error:function(y,A){c.push({message:y,context:A})}},h=new qx(f,o);p=p||l.diagrams&&l.diagrams[0];var d=Xx(l,p);if(!d)throw new Error(o("no diagram to display"));I(d,function(y){h.handleDefinitions(l,y)});var g=p.plane.bpmnElement.id;a.setRootElement(a.findRoot(g+"_plane")||a.findRoot(g))}return new Promise(function(l,p){try{return i=e.get("bpmnImporter"),r=e.get("eventBus"),o=e.get("translate"),a=e.get("canvas"),r.fire("import.render.start",{definitions:t}),u(t,n),r.fire("import.render.complete",{error:s,warnings:c}),l({warnings:c})}catch(f){return f.warnings=c,p(f)}})}function Xx(e,t){if(!!t){var n=t.plane.bpmnElement,i=n;!v(n,"bpmn:Process")&&!v(n,"bpmn:Collaboration")&&(i=Zx(n));var r;v(i,"bpmn:Collaboration")?r=i:r=Me(e.rootElements,function(u){if(!!v(u,"bpmn:Collaboration"))return Me(u.participants,function(l){return l.processRef===i})});var o=[i];r&&(o=lt(r.participants,function(u){return u.processRef}),o.push(r));var a=Bv(o),s=[t],c=[n];return I(e.diagrams,function(u){var l=u.plane.bpmnElement;a.indexOf(l)!==-1&&c.indexOf(l)===-1&&(s.push(u),c.push(l))}),s}}function Bv(e){var t=[];return I(e,function(n){!n||(t.push(n),t=t.concat(Bv(n.flowElements)))}),t}function Zx(e){for(var t=e;t;){if(v(t,"bpmn:Process"))return t;t=t.$parent}}var Qx='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>',Iv=Qx,Fv={verticalAlign:"middle"},Ov={color:"#404040"},Jx={zIndex:"1001",position:"fixed",top:"0",left:"0",right:"0",bottom:"0"},e1={width:"100%",height:"100%",background:"rgba(40,40,40,0.2)"},t1={position:"absolute",left:"50%",top:"40%",transform:"translate(-50%)",width:"260px",padding:"10px",background:"white",boxShadow:"0 1px 4px rgba(0,0,0,0.3)",fontFamily:"Helvetica, Arial, sans-serif",fontSize:"14px",display:"flex",lineHeight:"1.3"},n1='<div class="bjs-powered-by-lightbox"><div class="backdrop"></div><div class="notice"><a href="https://bpmn.io" target="_blank" rel="noopener" class="link">'+Iv+'</a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>',_n;function i1(){_n=ce(n1),qe(_n,Jx),qe(xe("svg",_n),Fv),qe(xe(".backdrop",_n),e1),qe(xe(".notice",_n),t1),qe(xe(".link",_n),Ov,{margin:"15px 20px 15px 10px",alignSelf:"center"})}function r1(){_n||(i1(),bt.bind(_n,".backdrop","click",function(e){document.body.removeChild(_n)})),document.body.appendChild(_n)}function je(e){e=O({},a1,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),c1(this._container),this._init(this._container,this._moddle,e)}oe(je,Tr);je.prototype.importXML=Pr(function(t,n){var i=this;function r(o){var a=i.get("eventBus").createEvent(o);return Object.defineProperty(a,"context",{enumerable:!0,get:function(){return console.warn(new Error("import.parse.complete <context> is deprecated and will be removed in future library versions")),{warnings:o.warnings,references:o.references,elementsById:o.elementsById}}}),a}return new Promise(function(o,a){t=i._emit("import.parse.start",{xml:t})||t,i._moddle.fromXML(t,"bpmn:Definitions").then(function(s){var c=s.rootElement,u=s.references,l=s.warnings,p=s.elementsById;c=i._emit("import.parse.complete",r({error:null,definitions:c,elementsById:p,references:u,warnings:l}))||c,i.importDefinitions(c,n).then(function(f){var h=[].concat(l,f.warnings||[]);return i._emit("import.done",{error:null,warnings:h}),o({warnings:h})}).catch(function(f){var h=[].concat(l,f.warnings||[]);return i._emit("import.done",{error:f,warnings:h}),a(os(f,h))})}).catch(function(s){return i._emit("import.parse.complete",{error:s}),s=o1(s),i._emit("import.done",{error:s,warnings:s.warnings}),a(s)})})});je.prototype.importDefinitions=Pr(function(t,n){var i=this;return new Promise(function(r,o){i._setDefinitions(t),i.open(n).then(function(a){var s=a.warnings;return r({warnings:s})}).catch(function(a){return o(a)})})});je.prototype.open=Pr(function(t){var n=this._definitions,i=t,r=this;return new Promise(function(o,a){if(!n){var s=new Error("no XML imported");return a(os(s,[]))}if(typeof t=="string"&&(i=s1(n,t),!i)){var c=new Error("BPMNDiagram <"+t+"> not found");return a(os(c,[]))}try{r.clear()}catch(u){return a(os(u,[]))}Kx(r,n,i).then(function(u){var l=u.warnings;return o({warnings:l})}).catch(function(u){return a(u)})})});je.prototype.saveXML=Pr(function(t){t=t||{};var n=this,i=this._definitions;return new Promise(function(r){if(!i)return r({error:new Error("no definitions loaded")});i=n._emit("saveXML.start",{definitions:i})||i,n._moddle.toXML(i,t).then(function(o){var a=o.xml;return a=n._emit("saveXML.serialized",{xml:a})||a,r({xml:a})})}).catch(function(r){return{error:r}}).then(function(r){n._emit("saveXML.done",r);var o=r.error;return o?Promise.reject(o):r})});je.prototype.saveSVG=Pr(function(t){var n=this;return new Promise(function(i,r){n._emit("saveSVG.start");var o,a;try{var s=n.get("canvas"),c=s.getActiveLayer(),u=xe("defs",s._svg),l=Lf(c),p=u?"<defs>"+Lf(u)+"</defs>":"",f=c.getBBox();o=`<?xml version="1.0" encoding="utf-8"?>
<!-- created with bpmn-js / http://bpmn.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="`+f.width+'" height="'+f.height+'" viewBox="'+f.x+" "+f.y+" "+f.width+" "+f.height+'" version="1.1">'+p+l+"</svg>"}catch(h){a=h}return n._emit("saveSVG.done",{error:a,svg:o}),a?r(a):i({svg:o})})});je.prototype._setDefinitions=function(e){this._definitions=e};je.prototype.getModules=function(){return this._modules};je.prototype.clear=function(){!this.getDefinitions()||Tr.prototype.clear.call(this)};je.prototype.destroy=function(){Tr.prototype.destroy.call(this),wn(this._container)};je.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)};je.prototype.off=function(e,t){this.get("eventBus").off(e,t)};je.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),typeof e=="string"&&(e=xe(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()};je.prototype.getDefinitions=function(){return this._definitions};je.prototype.detach=function(){var e=this._container,t=e.parentNode;!t||(this._emit("detach",{}),t.removeChild(e))};je.prototype._init=function(e,t,n){var i=n.modules||this.getModules(),r=n.additionalModules||[],o=[{bpmnjs:["value",this],moddle:["value",t]}],a=[].concat(o,i,r),s=O(Gn(n,["additionalModules"]),{canvas:O({},n.canvas,{container:e}),modules:a});Tr.call(this,s),n&&n.container&&this.attachTo(n.container)};je.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)};je.prototype._createContainer=function(e){var t=ce('<div class="bjs-container"></div>');return qe(t,{width:rh(e.width),height:rh(e.height),position:e.position}),t};je.prototype._createModdle=function(e){var t=O({},this._moddleExtensions,e.moddleExtensions);return new Wx(t)};je.prototype._modules=[];function os(e,t){return e.warnings=t,e}function o1(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/,n=t.exec(e.message);return n&&(e.message="unparsable content <"+n[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+n[2]),e}var a1={width:"100%",height:"100%",position:"relative"};function rh(e){return e+(ge(e)?"px":"")}function s1(e,t){return t&&Me(e.diagrams,function(n){return n.id===t})||null}function c1(e){var t=Iv,n='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" >'+t+"</a>",i=ce(n);qe(xe("svg",i),Fv),qe(i,Ov,{position:"absolute",bottom:"15px",right:"15px",zIndex:"100"}),e.appendChild(i),J.bind(i,"click",function(r){r1(),r.preventDefault()})}function Oo(e){je.call(this,e),this.on("import.parse.complete",function(t){t.error||this._collectIds(t.definitions,t.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}oe(Oo,je);Oo.prototype._createModdle=function(e){var t=je.prototype._createModdle.call(this,e);return t.ids=new un([32,36,1]),t};Oo.prototype._collectIds=function(e,t){var n=e.$model,i=n.ids,r;i.clear();for(r in t)i.claim(r,t[r])};function Re(e,t){return v(e,"bpmn:CallActivity")?!1:v(e,"bpmn:SubProcess")?(t=t||Ce(e),t&&v(t,"bpmndi:BPMNPlane")?!0:t&&!!t.isExpanded):v(e,"bpmn:Participant")?!!X(e).processRef:!0}function u1(e){return e&&X(e).isInterrupting!==!1}function It(e){return e&&!!X(e).triggeredByEvent}function js(e,t){var n=X(e),i=!1;return n.eventDefinitions&&I(n.eventDefinitions,function(r){v(r,t)&&(i=!0)}),i}function l1(e){return js(e,"bpmn:ErrorEventDefinition")}function p1(e){return js(e,"bpmn:EscalationEventDefinition")}function f1(e){return js(e,"bpmn:CompensateEventDefinition")}function kv(e){if(v(e,"bpmn:FlowElement")||v(e,"bpmn:Participant")||v(e,"bpmn:Lane")||v(e,"bpmn:SequenceFlow")||v(e,"bpmn:MessageFlow")||v(e,"bpmn:DataInput")||v(e,"bpmn:DataOutput"))return"name";if(v(e,"bpmn:TextAnnotation"))return"text";if(v(e,"bpmn:Group"))return"categoryValueRef"}function h1(e){var t=e.categoryValueRef;return t&&t.value||""}function ln(e){var t=e.businessObject,n=kv(t);if(n)return n==="categoryValueRef"?h1(t):t[n]||""}function d1(e,t,n){var i=e.businessObject,r=kv(i);return r&&(r==="categoryValueRef"?i.categoryValueRef.value=t:i[r]=t),e}var Bn="hsl(225, 10%, 15%)";function vn(e,t,n){function i(r,o){return gi(o,function(a,s){return r[s]==a})}return Sn(e.eventDefinitions,function(r){return r.$type===t&&i(e,n)})}function m1(e){return e.$type==="bpmn:IntermediateThrowEvent"||e.$type==="bpmn:EndEvent"}function v1(e){var t=e.dataObjectRef;return e.isCollection||t&&t.isCollection}function dt(e){return e.businessObject}function Ae(e,t){var n=Ce(e);return n.get("color:background-color")||n.get("bioc:fill")||t||"white"}function Z(e,t){var n=Ce(e);return n.get("color:border-color")||n.get("bioc:stroke")||t||Bn}function Zr(e,t,n){var i=Ce(e),r=i.get("label");return r&&r.get("color:color")||t||Z(e,n)}function g1(e){var t=e.x+e.width/2,n=e.y+e.height/2,i=e.width/2,r=[["M",t,n],["m",0,-i],["a",i,i,0,1,1,0,2*i],["a",i,i,0,1,1,0,-2*i],["z"]];return Sr(r)}function y1(e,t){var n=e.x,i=e.y,r=e.width,o=e.height,a=[["M",n+t,i],["l",r-t*2,0],["a",t,t,0,0,1,t,t],["l",0,o-t*2],["a",t,t,0,0,1,-t,t],["l",t*2-r,0],["a",t,t,0,0,1,-t,-t],["l",0,t*2-o],["a",t,t,0,0,1,t,-t],["z"]];return Sr(a)}function E1(e){var t=e.width,n=e.height,i=e.x,r=e.y,o=t/2,a=n/2,s=[["M",i+o,r],["l",o,a],["l",-o,a],["l",-o,-a],["z"]];return Sr(s)}function _1(e){var t=e.x,n=e.y,i=e.width,r=e.height,o=[["M",t,n],["l",i,0],["l",0,r],["l",-i,0],["z"]];return Sr(o)}var b1=new un,as=10,nu=3,hr=.95,x1=.35,w1=10;function Zi(e,t,n,i,r,o,a){Vn.call(this,t,a);var s=e&&e.defaultFillColor,c=e&&e.defaultStrokeColor,u=e&&e.defaultLabelColor,l=b1.next(),p={},f=n.computeStyle;function h(T,m){var B=O({fill:Bn,strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},m.attrs),k=m.ref||{x:0,y:0},V=m.scale||1;B.strokeDasharray==="none"&&(B.strokeDasharray=[1e4,1]);var te=ae("marker");W(m.element,B),pe(te,m.element),W(te,{id:T,viewBox:"0 0 20 20",refX:k.x,refY:k.y,markerWidth:20*V,markerHeight:20*V,orient:"auto"});var L=xe("defs",r._svg);L||(L=ae("defs"),pe(r._svg,L)),pe(L,te),p[T]=te}function d(T){return T.replace(/[^0-9a-zA-z]+/g,"_")}function g(T,m,B){var k=T+"-"+d(m)+"-"+d(B)+"-"+l;return p[k]||y(k,T,m,B),"url(#"+k+")"}function y(T,m,B,k){if(m==="sequenceflow-end"){var V=ae("path");W(V,{d:"M 1 5 L 11 10 L 1 15 Z"}),h(T,{element:V,ref:{x:11,y:10},scale:.5,attrs:{fill:k,stroke:k}})}if(m==="messageflow-start"){var te=ae("circle");W(te,{cx:6,cy:6,r:3.5}),h(T,{element:te,attrs:{fill:B,stroke:k},ref:{x:6,y:6}})}if(m==="messageflow-end"){var L=ae("path");W(L,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),h(T,{element:L,attrs:{fill:B,stroke:k,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if(m==="association-start"){var H=ae("path");W(H,{d:"M 11 5 L 1 10 L 11 15"}),h(T,{element:H,attrs:{fill:"none",stroke:k,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if(m==="association-end"){var ee=ae("path");W(ee,{d:"M 1 5 L 11 10 L 1 15"}),h(T,{element:ee,attrs:{fill:"none",stroke:k,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if(m==="conditional-flow-marker"){var N=ae("path");W(N,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),h(T,{element:N,attrs:{fill:B,stroke:k},ref:{x:-1,y:10},scale:.5})}if(m==="conditional-default-flow-marker"){var Y=ae("path");W(Y,{d:"M 6 4 L 10 16"}),h(T,{element:Y,attrs:{stroke:k},ref:{x:0,y:10},scale:.5})}}function A(T,m,B,k,V){ot(k)&&(V=k,k=0),k=k||0,V=f(V,{stroke:Bn,strokeWidth:2,fill:"white"}),V.fill==="none"&&delete V.fillOpacity;var te=m/2,L=B/2,H=ae("circle");return W(H,{cx:te,cy:L,r:Math.round((m+B)/4-k)}),W(H,V),pe(T,H),H}function _(T,m,B,k,V,te){ot(V)&&(te=V,V=0),V=V||0,te=f(te,{stroke:Bn,strokeWidth:2,fill:"white"});var L=ae("rect");return W(L,{x:V,y:V,width:m-V*2,height:B-V*2,rx:k,ry:k}),W(L,te),pe(T,L),L}function w(T,m,B,k){var V=m/2,te=B/2,L=[{x:V,y:0},{x:m,y:te},{x:V,y:B},{x:0,y:te}],H=L.map(function(N){return N.x+","+N.y}).join(" ");k=f(k,{stroke:Bn,strokeWidth:2,fill:"white"});var ee=ae("polygon");return W(ee,{points:H}),W(ee,k),pe(T,ee),ee}function b(T,m,B){B=f(B,["no-fill"],{stroke:Bn,strokeWidth:2,fill:"none"});var k=wl(m,B);return pe(T,k),k}function S(T,m,B){B=f(B,["no-fill"],{strokeWidth:2,stroke:Bn});var k=ae("path");return W(k,{d:m}),W(k,B),pe(T,k),k}function M(T,m,B,k){return S(m,B,O({"data-marker":T},k))}function C(T){return Ne[T]}function R(T){return function(m,B){return C(T)(m,B)}}function D(T,m){var B=dt(T),k=m1(B);return B.eventDefinitions&&B.eventDefinitions.length>1?B.parallelMultiple?C("bpmn:ParallelMultipleEventDefinition")(m,T,k):C("bpmn:MultipleEventDefinition")(m,T,k):vn(B,"bpmn:MessageEventDefinition")?C("bpmn:MessageEventDefinition")(m,T,k):vn(B,"bpmn:TimerEventDefinition")?C("bpmn:TimerEventDefinition")(m,T,k):vn(B,"bpmn:ConditionalEventDefinition")?C("bpmn:ConditionalEventDefinition")(m,T):vn(B,"bpmn:SignalEventDefinition")?C("bpmn:SignalEventDefinition")(m,T,k):vn(B,"bpmn:EscalationEventDefinition")?C("bpmn:EscalationEventDefinition")(m,T,k):vn(B,"bpmn:LinkEventDefinition")?C("bpmn:LinkEventDefinition")(m,T,k):vn(B,"bpmn:ErrorEventDefinition")?C("bpmn:ErrorEventDefinition")(m,T,k):vn(B,"bpmn:CancelEventDefinition")?C("bpmn:CancelEventDefinition")(m,T,k):vn(B,"bpmn:CompensateEventDefinition")?C("bpmn:CompensateEventDefinition")(m,T,k):vn(B,"bpmn:TerminateEventDefinition")?C("bpmn:TerminateEventDefinition")(m,T,k):null}function F(T,m,B){B=O({size:{width:100}},B);var k=o.createText(m||"",B);return Se(k).add("djs-label"),pe(T,k),k}function j(T,m,B){var k=dt(m);return F(T,k.name,{box:m,align:B,padding:5,style:{fill:Zr(m,u,c)}})}function z(T,m){var B={width:90,height:30,x:m.width/2+m.x,y:m.height/2+m.y};return F(T,ln(m),{box:B,fitBox:!0,style:O({},o.getExternalStyle(),{fill:Zr(m,u,c)})})}function G(T,m,B){var k=F(T,m,{box:{height:30,width:B.height},align:"center-middle",style:{fill:Zr(B,u,c)}}),V=-1*B.height;Lu(k,0,-V,270)}function he(T){for(var m=T.waypoints,B="m  "+m[0].x+","+m[0].y,k=1;k<m.length;k++)B+="L"+m[k].x+","+m[k].y+" ";return B}var Ne=this.handlers={"bpmn:Event":function(T,m,B){return"fillOpacity"in B||(B.fillOpacity=hr),A(T,m.width,m.height,B)},"bpmn:StartEvent":function(T,m){var B={fill:Ae(m,s),stroke:Z(m,c)},k=dt(m);k.isInterrupting||(B={strokeDasharray:"6",strokeLinecap:"round",fill:Ae(m,s),stroke:Z(m,c)});var V=C("bpmn:Event")(T,m,B);return D(m,T),V},"bpmn:MessageEventDefinition":function(T,m,B){var k=i.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:m.width,containerHeight:m.height,position:{mx:.235,my:.315}}),V=B?Z(m,c):Ae(m,s),te=B?Ae(m,s):Z(m,c),L=S(T,k,{strokeWidth:1,fill:V,stroke:te});return L},"bpmn:TimerEventDefinition":function(T,m){var B=A(T,m.width,m.height,.2*m.height,{strokeWidth:2,fill:Ae(m,s),stroke:Z(m,c)}),k=i.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.5}});S(T,k,{strokeWidth:2,strokeLinecap:"square",stroke:Z(m,c)});for(var V=0;V<12;V++){var te=i.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.5}}),L=m.width/2,H=m.height/2;S(T,te,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+V*30+","+H+","+L+")",stroke:Z(m,c)})}return B},"bpmn:EscalationEventDefinition":function(T,m,B){var k=i.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.2}}),V=B?Z(m,c):"none";return S(T,k,{strokeWidth:1,fill:V,stroke:Z(m,c)})},"bpmn:ConditionalEventDefinition":function(T,m){var B=i.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.222}});return S(T,B,{strokeWidth:1,stroke:Z(m,c)})},"bpmn:LinkEventDefinition":function(T,m,B){var k=i.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.57,my:.263}}),V=B?Z(m,c):"none";return S(T,k,{strokeWidth:1,fill:V,stroke:Z(m,c)})},"bpmn:ErrorEventDefinition":function(T,m,B){var k=i.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:m.width,containerHeight:m.height,position:{mx:.2,my:.722}}),V=B?Z(m,c):"none";return S(T,k,{strokeWidth:1,fill:V,stroke:Z(m,c)})},"bpmn:CancelEventDefinition":function(T,m,B){var k=i.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.638,my:-.055}}),V=B?Z(m,c):"none",te=S(T,k,{strokeWidth:1,fill:V,stroke:Z(m,c)});return vv(te,45),te},"bpmn:CompensateEventDefinition":function(T,m,B){var k=i.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.22,my:.5}}),V=B?Z(m,c):"none";return S(T,k,{strokeWidth:1,fill:V,stroke:Z(m,c)})},"bpmn:SignalEventDefinition":function(T,m,B){var k=i.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:m.width,containerHeight:m.height,position:{mx:.5,my:.2}}),V=B?Z(m,c):"none";return S(T,k,{strokeWidth:1,fill:V,stroke:Z(m,c)})},"bpmn:MultipleEventDefinition":function(T,m,B){var k=i.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:m.width,containerHeight:m.height,position:{mx:.222,my:.36}}),V=B?Z(m,c):"none";return S(T,k,{strokeWidth:1,fill:V})},"bpmn:ParallelMultipleEventDefinition":function(T,m){var B=i.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:m.width,containerHeight:m.height,position:{mx:.458,my:.194}});return S(T,B,{strokeWidth:1,fill:Z(m,c),stroke:Z(m,c)})},"bpmn:EndEvent":function(T,m){var B=C("bpmn:Event")(T,m,{strokeWidth:4,fill:Ae(m,s),stroke:Z(m,c)});return D(m,T),B},"bpmn:TerminateEventDefinition":function(T,m){var B=A(T,m.width,m.height,8,{strokeWidth:4,fill:Z(m,c),stroke:Z(m,c)});return B},"bpmn:IntermediateEvent":function(T,m){var B=C("bpmn:Event")(T,m,{strokeWidth:1,fill:Ae(m,s),stroke:Z(m,c)});return A(T,m.width,m.height,nu,{strokeWidth:1,fill:Ae(m,"none"),stroke:Z(m,c)}),D(m,T),B},"bpmn:IntermediateCatchEvent":R("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":R("bpmn:IntermediateEvent"),"bpmn:Activity":function(T,m,B){return B=B||{},"fillOpacity"in B||(B.fillOpacity=hr),_(T,m.width,m.height,as,B)},"bpmn:Task":function(T,m){var B={fill:Ae(m,s),stroke:Z(m,c)},k=C("bpmn:Activity")(T,m,B);return j(T,m,"center-middle"),_e(T,m),k},"bpmn:ServiceTask":function(T,m){var B=C("bpmn:Task")(T,m),k=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}});S(T,k,{strokeWidth:1,fill:Ae(m,s),stroke:Z(m,c)});var V=i.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}});S(T,V,{strokeWidth:0,fill:Ae(m,s)});var te=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}});return S(T,te,{strokeWidth:1,fill:Ae(m,s),stroke:Z(m,c)}),B},"bpmn:UserTask":function(T,m){var B=C("bpmn:Task")(T,m),k=15,V=12,te=i.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:k,y:V}});S(T,te,{strokeWidth:.5,fill:Ae(m,s),stroke:Z(m,c)});var L=i.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:k,y:V}});S(T,L,{strokeWidth:.5,fill:Ae(m,s),stroke:Z(m,c)});var H=i.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:k,y:V}});return S(T,H,{strokeWidth:.5,fill:Z(m,c),stroke:Z(m,c)}),B},"bpmn:ManualTask":function(T,m){var B=C("bpmn:Task")(T,m),k=i.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}});return S(T,k,{strokeWidth:.5,fill:Ae(m,s),stroke:Z(m,c)}),B},"bpmn:SendTask":function(T,m){var B=C("bpmn:Task")(T,m),k=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}});return S(T,k,{strokeWidth:1,fill:Z(m,c),stroke:Ae(m,s)}),B},"bpmn:ReceiveTask":function(T,m){var B=dt(m),k=C("bpmn:Task")(T,m),V;return B.instantiate?(A(T,28,28,20*.22,{strokeWidth:1}),V=i.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):V=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),S(T,V,{strokeWidth:1,fill:Ae(m,s),stroke:Z(m,c)}),k},"bpmn:ScriptTask":function(T,m){var B=C("bpmn:Task")(T,m),k=i.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}});return S(T,k,{strokeWidth:1,stroke:Z(m,c)}),B},"bpmn:BusinessRuleTask":function(T,m){var B=C("bpmn:Task")(T,m),k=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}),V=S(T,k);W(V,{strokeWidth:1,fill:Ae(m,"#aaaaaa"),stroke:Z(m,c)});var te=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}),L=S(T,te);return W(L,{strokeWidth:1,stroke:Z(m,c)}),B},"bpmn:SubProcess":function(T,m,B){B=O({fill:Ae(m,s),stroke:Z(m,c)},B);var k=C("bpmn:Activity")(T,m,B),V=Re(m);return It(m)&&W(k,{strokeDasharray:"1,2"}),j(T,m,V?"center-top":"center-middle"),V?_e(T,m):_e(T,m,["SubProcessMarker"]),k},"bpmn:AdHocSubProcess":function(T,m){return C("bpmn:SubProcess")(T,m)},"bpmn:Transaction":function(T,m){var B=C("bpmn:SubProcess")(T,m),k=n.style(["no-fill","no-events"],{stroke:Z(m,c)});return _(T,m.width,m.height,as-2,nu,k),B},"bpmn:CallActivity":function(T,m){return C("bpmn:SubProcess")(T,m,{strokeWidth:5})},"bpmn:Participant":function(T,m){var B={fillOpacity:hr,fill:Ae(m,s),stroke:Z(m,c)},k=C("bpmn:Lane")(T,m,B),V=Re(m);if(V){b(T,[{x:30,y:0},{x:30,y:m.height}],{stroke:Z(m,c)});var te=dt(m).name;G(T,te,m)}else{var L=dt(m).name;F(T,L,{box:m,align:"center-middle",style:{fill:Zr(m,u,c)}})}var H=!!dt(m).participantMultiplicity;return H&&C("ParticipantMultiplicityMarker")(T,m),k},"bpmn:Lane":function(T,m,B){var k=_(T,m.width,m.height,0,O({fill:Ae(m,s),fillOpacity:x1,stroke:Z(m,c)},B)),V=dt(m);if(V.$type==="bpmn:Lane"){var te=V.name;G(T,te,m)}return k},"bpmn:InclusiveGateway":function(T,m){var B=C("bpmn:Gateway")(T,m);return A(T,m.width,m.height,m.height*.24,{strokeWidth:2.5,fill:Ae(m,s),stroke:Z(m,c)}),B},"bpmn:ExclusiveGateway":function(T,m){var B=C("bpmn:Gateway")(T,m),k=i.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:m.width,containerHeight:m.height,position:{mx:.32,my:.3}});return Ce(m).isMarkerVisible&&S(T,k,{strokeWidth:1,fill:Z(m,c),stroke:Z(m,c)}),B},"bpmn:ComplexGateway":function(T,m){var B=C("bpmn:Gateway")(T,m),k=i.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:m.width,containerHeight:m.height,position:{mx:.46,my:.26}});return S(T,k,{strokeWidth:1,fill:Z(m,c),stroke:Z(m,c)}),B},"bpmn:ParallelGateway":function(T,m){var B=C("bpmn:Gateway")(T,m),k=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:m.width,containerHeight:m.height,position:{mx:.46,my:.2}});return S(T,k,{strokeWidth:1,fill:Z(m,c),stroke:Z(m,c)}),B},"bpmn:EventBasedGateway":function(T,m){var B=dt(m),k=C("bpmn:Gateway")(T,m);A(T,m.width,m.height,m.height*.2,{strokeWidth:1,fill:"none",stroke:Z(m,c)});var V=B.eventGatewayType,te=!!B.instantiate;function L(){var Y=i.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:m.width,containerHeight:m.height,position:{mx:.36,my:.44}}),U={strokeWidth:2,fill:Ae(m,"none"),stroke:Z(m,c)};S(T,Y,U)}if(V==="Parallel"){var H=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:m.width,containerHeight:m.height,position:{mx:.474,my:.296}}),ee=S(T,H);W(ee,{strokeWidth:1,fill:"none"})}else if(V==="Exclusive"){if(!te){var N=A(T,m.width,m.height,m.height*.26);W(N,{strokeWidth:1,fill:"none",stroke:Z(m,c)})}L()}return k},"bpmn:Gateway":function(T,m){var B={fill:Ae(m,s),fillOpacity:hr,stroke:Z(m,c)};return w(T,m.width,m.height,B)},"bpmn:SequenceFlow":function(T,m){var B=he(m),k=Ae(m,s),V=Z(m,c),te={strokeLinejoin:"round",markerEnd:g("sequenceflow-end",k,V),stroke:Z(m,c)},L=S(T,B,te),H=dt(m),ee;return m.source&&(ee=m.source.businessObject,H.conditionExpression&&ee.$instanceOf("bpmn:Activity")&&W(L,{markerStart:g("conditional-flow-marker",k,V)}),ee.default&&(ee.$instanceOf("bpmn:Gateway")||ee.$instanceOf("bpmn:Activity"))&&ee.default===H&&W(L,{markerStart:g("conditional-default-flow-marker",k,V)})),L},"bpmn:Association":function(T,m,B){var k=dt(m),V=Ae(m,s),te=Z(m,c);return B=O({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:Z(m,c)},B||{}),(k.associationDirection==="One"||k.associationDirection==="Both")&&(B.markerEnd=g("association-end",V,te)),k.associationDirection==="Both"&&(B.markerStart=g("association-start",V,te)),b(T,m.waypoints,B)},"bpmn:DataInputAssociation":function(T,m){var B=Ae(m,s),k=Z(m,c);return C("bpmn:Association")(T,m,{markerEnd:g("association-end",B,k)})},"bpmn:DataOutputAssociation":function(T,m){var B=Ae(m,s),k=Z(m,c);return C("bpmn:Association")(T,m,{markerEnd:g("association-end",B,k)})},"bpmn:MessageFlow":function(T,m){var B=dt(m),k=Ce(m),V=Ae(m,s),te=Z(m,c),L=he(m),H={markerEnd:g("messageflow-end",V,te),markerStart:g("messageflow-start",V,te),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:Z(m,c)},ee=S(T,L,H);if(B.messageRef){var N=ee.getPointAtLength(ee.getTotalLength()/2),Y=i.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:N.x,y:N.y}}),U={strokeWidth:1};k.messageVisibleKind==="initiating"?(U.fill="white",U.stroke=Bn):(U.fill="#888",U.stroke="white");var Q=S(T,Y,U),ne=B.messageRef.name,se=F(T,ne,{align:"center-top",fitBox:!0,style:{fill:Z(m,u)}}),de=Q.getBBox(),Te=se.getBBox(),Ye=N.x-Te.width/2,tt=N.y+de.height/2+w1;Lu(se,Ye,tt,0)}return ee},"bpmn:DataObject":function(T,m){var B=i.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.474,my:.296}}),k=S(T,B,{fill:Ae(m,s),fillOpacity:hr,stroke:Z(m,c)}),V=dt(m);return v1(V)&&ue(T,m),k},"bpmn:DataObjectReference":R("bpmn:DataObject"),"bpmn:DataInput":function(T,m){var B=i.getRawPath("DATA_ARROW"),k=C("bpmn:DataObject")(T,m);return S(T,B,{strokeWidth:1}),k},"bpmn:DataOutput":function(T,m){var B=i.getRawPath("DATA_ARROW"),k=C("bpmn:DataObject")(T,m);return S(T,B,{strokeWidth:1,fill:Bn}),k},"bpmn:DataStoreReference":function(T,m){var B=i.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:0,my:.133}}),k=S(T,B,{strokeWidth:2,fill:Ae(m,s),fillOpacity:hr,stroke:Z(m,c)});return k},"bpmn:BoundaryEvent":function(T,m){var B=dt(m),k=B.cancelActivity,V={strokeWidth:1,fill:Ae(m,s),stroke:Z(m,c)};k||(V.strokeDasharray="6",V.strokeLinecap="round");var te=O({},V,{fillOpacity:1}),L=O({},V,{fill:"none"}),H=C("bpmn:Event")(T,m,te);return A(T,m.width,m.height,nu,L),D(m,T),H},"bpmn:Group":function(T,m){var B=_(T,m.width,m.height,as,{stroke:Z(m,c),strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"});return B},label:function(T,m){return z(T,m)},"bpmn:TextAnnotation":function(T,m){var B={fill:"none",stroke:"none"},k=_(T,m.width,m.height,0,0,B),V=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:0,my:0}});S(T,V,{stroke:Z(m,c)});var te=dt(m).text||"";return F(T,te,{box:m,align:"left-top",padding:5,style:{fill:Zr(m,u,c)}}),k},ParticipantMultiplicityMarker:function(T,m){var B=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:m.width/2/m.width,my:(m.height-15)/m.height}});M("participant-multiplicity",T,B,{strokeWidth:2,fill:Ae(m,s),stroke:Z(m,c)})},SubProcessMarker:function(T,m){var B=_(T,14,14,0,{strokeWidth:1,fill:Ae(m,s),stroke:Z(m,c)});At(B,m.width/2-7.5,m.height-20);var k=i.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2-7.5)/m.width,my:(m.height-20)/m.height}});M("sub-process",T,k,{fill:Ae(m,s),stroke:Z(m,c)})},ParallelMarker:function(T,m,B){var k=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+B.parallel)/m.width,my:(m.height-20)/m.height}});M("parallel",T,k,{fill:Ae(m,s),stroke:Z(m,c)})},SequentialMarker:function(T,m,B){var k=i.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+B.seq)/m.width,my:(m.height-19)/m.height}});M("sequential",T,k,{fill:Ae(m,s),stroke:Z(m,c)})},CompensationMarker:function(T,m,B){var k=i.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+B.compensation)/m.width,my:(m.height-13)/m.height}});M("compensation",T,k,{strokeWidth:1,fill:Ae(m,s),stroke:Z(m,c)})},LoopMarker:function(T,m,B){var k=i.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+B.loop)/m.width,my:(m.height-7)/m.height}});M("loop",T,k,{strokeWidth:1,fill:Ae(m,s),stroke:Z(m,c),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(T,m,B){var k=i.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:(m.width/2+B.adhoc)/m.width,my:(m.height-15)/m.height}});M("adhoc",T,k,{strokeWidth:1,fill:Z(m,c),stroke:Z(m,c)})}};function _e(T,m,B){var k=dt(m),V=B&&B.indexOf("SubProcessMarker")!==-1,te;V?te={seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:te={seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},I(B,function(ee){C(ee)(T,m,te)}),k.isForCompensation&&C("CompensationMarker")(T,m,te),k.$type==="bpmn:AdHocSubProcess"&&C("AdhocMarker")(T,m,te);var L=k.loopCharacteristics,H=L&&L.isSequential;L&&(H===void 0&&C("LoopMarker")(T,m,te),H===!1&&C("ParallelMarker")(T,m,te),H===!0&&C("SequentialMarker")(T,m,te))}function ue(T,m){var B=(m.height-18)/m.height,k=i.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:m.width,containerHeight:m.height,position:{mx:.33,my:B}});S(T,k,{strokeWidth:2})}this._drawPath=S,this._renderer=C}oe(Zi,Vn);Zi.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"];Zi.prototype.canRender=function(e){return v(e,"bpmn:BaseElement")};Zi.prototype.drawShape=function(e,t){var n=t.type,i=this._renderer(n);return i(e,t)};Zi.prototype.drawConnection=function(e,t){var n=t.type,i=this._renderer(n);return i(e,t)};Zi.prototype.getShapePath=function(e){return v(e,"bpmn:Event")?g1(e):v(e,"bpmn:Activity")?y1(e,as):v(e,"bpmn:Gateway")?E1(e):_1(e)};var S1=0,C1={width:150,height:50};function T1(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}function A1(e){return ot(e)?O({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}function R1(e,t){t.textContent=e;var n;try{var i,r=e==="";return t.textContent=r?"dummy":e,n=t.getBBox(),i={width:n.width+n.x*2,height:n.height},r&&(i.width=0),i}catch{return{width:0,height:0}}}function P1(e,t,n){for(var i=e.shift(),r=i,o;;){if(o=R1(r,n),o.width=r?o.width:0,r===" "||r===""||o.width<Math.round(t)||r.length<2)return D1(e,r,i,o);r=B1(r,o.width,t)}}function D1(e,t,n,i){if(t.length<n.length){var r=n.slice(t.length).trim();e.unshift(r)}return{width:i.width,height:i.height,text:t}}var oh="\xAD";function M1(e,t){var n=e.split(/(\s|-|\u00AD)/g),i,r=[],o=0;if(n.length>1)for(;i=n.shift();)if(i.length+o<t)r.push(i),o+=i.length;else{(i==="-"||i===oh)&&r.pop();break}var a=r[r.length-1];return a&&a===oh&&(r[r.length-1]="-"),r.join("")}function B1(e,t,n){var i=Math.max(e.length*(n/t),1),r=M1(e,i);return r||(r=e.slice(0,Math.max(Math.round(i-1),1))),r}function I1(){var e=document.getElementById("helper-svg");return e||(e=ae("svg"),W(e,{id:"helper-svg"}),qe(e,{visibility:"hidden",position:"fixed",width:0,height:0}),document.body.appendChild(e)),e}function Hs(e){this._config=O({},{size:C1,padding:S1,style:{},align:"center-top"},e||{})}Hs.prototype.createText=function(e,t){return this.layoutText(e,t).element};Hs.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions};Hs.prototype.layoutText=function(e,t){var n=O({},this._config.size,t.box),i=O({},this._config.style,t.style),r=T1(t.align||this._config.align),o=A1(t.padding!==void 0?t.padding:this._config.padding),a=t.fitBox||!1,s=F1(i),c=e.split(/\u00AD?\r?\n/),u=[],l=n.width-o.left-o.right,p=ae("text");W(p,{x:0,y:0}),W(p,i);var f=I1();for(pe(f,p);c.length;)u.push(P1(c,l,p));r.vertical==="middle"&&(o.top=o.bottom=0);var h=Rt(u,function(_,w,b){return _+(s||w.height)},0)+o.top+o.bottom,d=Rt(u,function(_,w,b){return w.width>_?w.width:_},0),g=o.top;r.vertical==="middle"&&(g+=(n.height-h)/2),g-=(s||u[0].height)/4;var y=ae("text");W(y,i),I(u,function(_){var w;switch(g+=s||_.height,r.horizontal){case"left":w=o.left;break;case"right":w=(a?d:l)-o.right-_.width;break;default:w=Math.max(((a?d:l)-_.width)/2+o.left,0)}var b=ae("tspan");W(b,{x:w,y:g}),b.textContent=_.text,pe(y,b)}),Le(p);var A={width:d,height:h};return{dimensions:A,element:y}};function F1(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}var O1=12,k1=1.2,N1=30;function Nv(e){var t=O({fontFamily:"Arial, sans-serif",fontSize:O1,fontWeight:"normal",lineHeight:k1},e&&e.defaultStyle||{}),n=parseInt(t.fontSize,10)-1,i=O({},t,{fontSize:n},e&&e.externalStyle||{}),r=new Hs({style:t});this.getExternalLabelBounds=function(o,a){var s=r.getDimensions(a,{box:{width:90,height:30,x:o.width/2+o.x,y:o.height/2+o.y},style:i});return{x:Math.round(o.x+o.width/2-s.width/2),y:Math.round(o.y),width:Math.ceil(s.width),height:Math.ceil(s.height)}},this.getTextAnnotationBounds=function(o,a){var s=r.getDimensions(a,{box:o,style:t,align:"left-top",padding:5});return{x:o.x,y:o.y,width:o.width,height:Math.max(N1,Math.round(s.height))}},this.createText=function(o,a){return r.createText(o,a||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return i}}Nv.$inject=["config.textRenderer"];function L1(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(t){return this.pathMap[t].d},this.getScaledPath=function(t,n){var i=this.pathMap[t],r,o;n.abspos?(r=n.abspos.x,o=n.abspos.y):(r=n.containerWidth*n.position.mx,o=n.containerHeight*n.position.my);var a={};if(n.position){for(var s=n.containerHeight/i.height*n.yScaleFactor,c=n.containerWidth/i.width*n.xScaleFactor,u=0;u<i.heightElements.length;u++)a["y"+u]=i.heightElements[u]*s;for(var l=0;l<i.widthElements.length;l++)a["x"+l]=i.widthElements[l]*c}var p=z1(i.d,{mx:r,my:o,e:a});return p}}var $1=/\{([^{}]+)\}/g,j1=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;function H1(e,t,n){var i=n;return t.replace(j1,function(r,o,a,s,c){o=o||s,i&&(o in i&&(i=i[o]),typeof i=="function"&&c&&(i=i()))}),i=(i==null||i==n?e:i)+"",i}function z1(e,t){return String(e).replace($1,function(n,i){return H1(n,i,t)})}var G1={__init__:["bpmnRenderer"],bpmnRenderer:["type",Zi],textRenderer:["type",Nv],pathMap:["type",L1]};function V1(e,t){return t=t||{},e.replace(/{([^}]+)}/g,function(n,i){return t[i]||"{"+i+"}"})}var zs={translate:["value",V1]},bo={width:90,height:20},ah=15;function Yi(e){return v(e,"bpmn:Event")||v(e,"bpmn:Gateway")||v(e,"bpmn:DataStoreReference")||v(e,"bpmn:DataObjectReference")||v(e,"bpmn:DataInput")||v(e,"bpmn:DataOutput")||v(e,"bpmn:SequenceFlow")||v(e,"bpmn:MessageFlow")||v(e,"bpmn:Group")}function Gs(e){return rt(e.label)}function W1(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)],r=U1(e),o=Math.atan((i.y-n.y)/(i.x-n.x)),a=r.x,s=r.y;return Math.abs(o)<Math.PI/2?s-=ah:a+=ah,{x:a,y:s}}function U1(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)];return{x:n.x+(i.x-n.x)/2,y:n.y+(i.y-n.y)/2}}function Vs(e){return e.waypoints?W1(e.waypoints):v(e,"bpmn:Group")?{x:e.x+e.width/2,y:e.y+bo.height/2}:{x:e.x+e.width/2,y:e.y+e.height+bo.height/2}}function Y1(e,t){var n,i,r,o=e.label;return o&&o.bounds?(r=o.bounds,i={width:Math.max(bo.width,r.width),height:r.height},n={x:r.x+r.width/2,y:r.y+r.height/2}):(n=Vs(t),i=bo),O({x:n.x-i.width/2,y:n.y-i.height/2},i)}function rt(e){return e&&!!e.labelTarget}function ss(e,t,n){return O({id:e.id,type:e.$type,businessObject:e,di:t},n)}function q1(e,t,n){var i=e.waypoint;return!i||i.length<2?[ye(t),ye(n)]:i.map(function(r){return{x:r.x,y:r.y}})}function Lv(e,t,n,i){return new Error(e("element {element} referenced by {referenced}#{property} not yet drawn",{element:ut(n),referenced:ut(t),property:i}))}function Un(e,t,n,i,r,o){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i,this._translate=r,this._textRenderer=o}Un.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"];Un.prototype.add=function(e,t,n){var i,r=this._translate,o,a;if(v(t,"bpmndi:BPMNPlane")){var s=v(e,"bpmn:SubProcess")?{id:e.id+"_plane"}:{};i=this._elementFactory.createRoot(ss(e,t,s)),this._canvas.addRootElement(i)}else if(v(t,"bpmndi:BPMNShape")){var c=!Re(e,t),u=X1(e);o=n&&(n.hidden||n.collapsed);var l=t.bounds;i=this._elementFactory.createShape(ss(e,t,{collapsed:c,hidden:o,x:Math.round(l.x),y:Math.round(l.y),width:Math.round(l.width),height:Math.round(l.height),isFrame:u})),v(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,i),v(e,"bpmn:Lane")&&(a=0),v(e,"bpmn:DataStoreReference")&&(K1(n,ye(l))||(n=this._canvas.findRoot(n))),this._canvas.addShape(i,n,a)}else if(v(t,"bpmndi:BPMNEdge")){var p=this._getSource(e),f=this._getTarget(e);o=n&&(n.hidden||n.collapsed),i=this._elementFactory.createConnection(ss(e,t,{hidden:o,source:p,target:f,waypoints:q1(t,p,f)})),v(e,"bpmn:DataAssociation")&&(n=this._canvas.findRoot(n)),this._canvas.addConnection(i,n,a)}else throw new Error(r("unknown di {di} for element {semantic}",{di:ut(t),semantic:ut(e)}));return Yi(e)&&ln(i)&&this.addLabel(e,t,i),this._eventBus.fire("bpmnElement.added",{element:i}),i};Un.prototype._attachBoundary=function(e,t){var n=this._translate,i=e.attachedToRef;if(!i)throw new Error(n("missing {semantic}#attachedToRef",{semantic:ut(e)}));var r=this._elementRegistry.get(i.id),o=r&&r.attachers;if(!r)throw Lv(n,e,i,"attachedToRef");t.host=r,o||(r.attachers=o=[]),o.indexOf(t)===-1&&o.push(t)};Un.prototype.addLabel=function(e,t,n){var i,r,o;return i=Y1(t,n),r=ln(n),r&&(i=this._textRenderer.getExternalLabelBounds(i,r)),o=this._elementFactory.createLabel(ss(e,t,{id:e.id+"_label",labelTarget:n,type:"label",hidden:n.hidden||!ln(n),x:Math.round(i.x),y:Math.round(i.y),width:Math.round(i.width),height:Math.round(i.height)})),this._canvas.addShape(o,n.parent)};Un.prototype._getEnd=function(e,t){var n,i,r=e.$type,o=this._translate;if(i=e[t+"Ref"],t==="source"&&r==="bpmn:DataInputAssociation"&&(i=i&&i[0]),(t==="source"&&r==="bpmn:DataOutputAssociation"||t==="target"&&r==="bpmn:DataInputAssociation")&&(i=e.$parent),n=i&&this._getElement(i),n)return n;throw i?Lv(o,e,i,t+"Ref"):new Error(o("{semantic}#{side} Ref not specified",{semantic:ut(e),side:t}))};Un.prototype._getSource=function(e){return this._getEnd(e,"source")};Un.prototype._getTarget=function(e){return this._getEnd(e,"target")};Un.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};function K1(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function X1(e){return v(e,"bpmn:Group")}var Z1={__depends__:[zs],bpmnImporter:["type",Un]},Q1={__depends__:[G1,Z1]};function sh(e){!e||typeof e.stopPropagation!="function"||e.stopPropagation()}function Dr(e){return e.originalEvent||e.srcEvent}function iu(e,t){sh(e),sh(Dr(e))}function di(e){return e.pointers&&e.pointers.length&&(e=e.pointers[0]),e.touches&&e.touches.length&&(e=e.touches[0]),e?{x:e.clientX,y:e.clientY}:null}function J1(){return/mac/i.test(navigator.platform)}function $v(e,t){return(Dr(e)||e).button===t}function _i(e){return $v(e,0)}function e2(e){return $v(e,1)}function br(e){var t=Dr(e)||e;return _i(e)?J1()?t.metaKey:t.ctrlKey:!1}function jv(e){var t=Dr(e)||e;return _i(e)&&t.shiftKey}function t2(e){return!0}function Ra(e){return _i(e)||e2(e)}var ch=500;function Hv(e,t,n){var i=this;function r(R,D,F){if(!s(R,D)){var j,z,G;F?z=t.getGraphics(F):(j=D.delegateTarget||D.target,j&&(z=j,F=t.get(z))),!(!z||!F)&&(G=e.fire(R,{element:F,gfx:z,originalEvent:D}),G===!1&&(D.stopPropagation(),D.preventDefault()))}}var o={};function a(R){return o[R]}function s(R,D){var F=u[R]||_i;return!F(D)}var c={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},u={"element.contextmenu":t2,"element.mousedown":Ra,"element.mouseup":Ra,"element.click":Ra,"element.dblclick":Ra};function l(R,D,F){var j=c[R];if(!j)throw new Error("unmapped DOM event name <"+R+">");return r(j,D,F)}var p="svg, .djs-element";function f(R,D,F,j){var z=o[F]=function(G){r(F,G)};j&&(u[F]=j),z.$delegate=bt.bind(R,p,D,z)}function h(R,D,F){var j=a(F);!j||bt.unbind(R,D,j.$delegate)}function d(R){I(c,function(D,F){f(R,F,D)})}function g(R){I(c,function(D,F){h(R,F,D)})}e.on("canvas.destroy",function(R){g(R.svg)}),e.on("canvas.init",function(R){d(R.svg)}),e.on(["shape.added","connection.added"],function(R){var D=R.element,F=R.gfx;e.fire("interactionEvents.createHit",{element:D,gfx:F})}),e.on(["shape.changed","connection.changed"],ch,function(R){var D=R.element,F=R.gfx;e.fire("interactionEvents.updateHit",{element:D,gfx:F})}),e.on("interactionEvents.createHit",ch,function(R){var D=R.element,F=R.gfx;i.createDefaultHit(D,F)}),e.on("interactionEvents.updateHit",function(R){var D=R.element,F=R.gfx;i.updateDefaultHit(D,F)});var y=S("djs-hit djs-hit-stroke"),A=S("djs-hit djs-hit-click-stroke"),_=S("djs-hit djs-hit-all"),w=S("djs-hit djs-hit-no-move"),b={all:_,"click-stroke":A,stroke:y,"no-move":w};function S(R,D){return D=O({stroke:"white",strokeWidth:15},D||{}),n.cls(R,["no-fill","no-border"],D)}function M(R,D){var F=b[D];if(!F)throw new Error("invalid hit type <"+D+">");return W(R,F),R}function C(R,D){pe(R,D)}this.removeHits=function(R){var D=zn(".djs-hit",R);I(D,Le)},this.createDefaultHit=function(R,D){var F=R.waypoints,j=R.isFrame,z;return F?this.createWaypointsHit(D,F):(z=j?"stroke":"all",this.createBoxHit(D,z,{width:R.width,height:R.height}))},this.createWaypointsHit=function(R,D){var F=wl(D);return M(F,"stroke"),C(R,F),F},this.createBoxHit=function(R,D,F){F=O({x:0,y:0},F);var j=ae("rect");return M(j,D),W(j,F),C(R,j),j},this.updateDefaultHit=function(R,D){var F=xe(".djs-hit",D);if(!!F)return R.waypoints?P_(F,R.waypoints):W(F,{width:R.width,height:R.height}),F},this.fire=r,this.triggerMouseEvent=l,this.mouseHandler=a,this.registerEvent=f,this.unregisterEvent=h}Hv.$inject=["eventBus","elementRegistry","styles"];var ko={__init__:["interactionEvents"],interactionEvents:["type",Hv]},n2=500;function Ws(e,t,n){this.offset=6;var i=t.cls("djs-outline",["no-fill"]),r=this;function o(a,s){var c=ae("rect");return W(c,O({x:10,y:10,rx:3,width:100,height:100},i)),pe(a,c),c}e.on(["shape.added","shape.changed"],n2,function(a){var s=a.element,c=a.gfx,u=xe(".djs-outline",c);u||(u=o(c)),r.updateShapeOutline(u,s)}),e.on(["connection.added","connection.changed"],function(a){var s=a.element,c=a.gfx,u=xe(".djs-outline",c);u||(u=o(c)),r.updateConnectionOutline(u,s)})}Ws.prototype.updateShapeOutline=function(e,t){W(e,{x:-this.offset,y:-this.offset,width:t.width+this.offset*2,height:t.height+this.offset*2})};Ws.prototype.updateConnectionOutline=function(e,t){var n=Je(t);W(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+this.offset*2,height:n.height+this.offset*2})};Ws.$inject=["eventBus","styles","elementRegistry"];var zv={__init__:["outline"],outline:["type",Ws]};function Mr(e,t){this._eventBus=e,this._canvas=t,this._selectedElements=[];var n=this;e.on(["shape.remove","connection.remove"],function(i){var r=i.element;n.deselect(r)}),e.on(["diagram.clear","root.set"],function(i){n.select(null)})}Mr.$inject=["eventBus","canvas"];Mr.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(n!==-1){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}};Mr.prototype.get=function(){return this._selectedElements};Mr.prototype.isSelected=function(e){return this._selectedElements.indexOf(e)!==-1};Mr.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice();be(e)||(e=e?[e]:[]);var r=this._canvas,o=r.getRootElement();e=e.filter(function(a){var s=r.findRoot(a);return o===s}),t?I(e,function(a){n.indexOf(a)===-1&&n.push(a)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var uh="hover",lh="selected",Pa=6;function kl(e,t,n){this._canvas=e;var i=this;this._multiSelectionBox=null;function r(a,s){e.addMarker(a,s)}function o(a,s){e.removeMarker(a,s)}t.on("element.hover",function(a){r(a.element,uh)}),t.on("element.out",function(a){o(a.element,uh)}),t.on("selection.changed",function(a){function s(p){o(p,lh)}function c(p){r(p,lh)}var u=a.oldSelection,l=a.newSelection;I(u,function(p){l.indexOf(p)===-1&&s(p)}),I(l,function(p){u.indexOf(p)===-1&&c(p)}),i._updateSelectionOutline(l)}),t.on("element.changed",function(a){n.isSelected(a.element)&&i._updateSelectionOutline(n.get())})}kl.$inject=["canvas","eventBus","selection"];kl.prototype._updateSelectionOutline=function(e){var t=this._canvas.getLayer("selectionOutline");Ao(t);var n=e.length>1,i=this._canvas.getContainer();if(Se(i)[n?"add":"remove"]("djs-multi-select"),!!n){var r=i2(Je(e)),o=ae("rect");W(o,O({rx:3},r)),Se(o).add("djs-selection-outline"),pe(t,o)}};function i2(e){return{x:e.x-Pa,y:e.y-Pa,width:e.width+Pa*2,height:e.height+Pa*2}}function Gv(e,t,n,i){e.on("create.end",500,function(r){var o=r.context,a=o.canExecute,s=o.elements,c=o.hints||{},u=c.autoSelect;if(a){if(u===!1)return;be(u)?t.select(u):t.select(s.filter(r2))}}),e.on("connect.end",500,function(r){var o=r.context,a=o.connection;a&&t.select(a)}),e.on("shape.move.end",500,function(r){var o=r.previousSelection||[],a=i.get(r.context.shape.id),s=Me(o,function(c){return a.id===c.id});s||t.select(a)}),e.on("element.click",function(r){if(!!_i(r)){var o=r.element;o===n.getRootElement()&&(o=null);var a=t.isSelected(o),s=t.get().length>1,c=br(r)||jv(r);if(a&&s)return c?t.deselect(o):t.select(o);a?t.deselect(o):t.select(o,c)}})}Gv.$inject=["eventBus","selection","canvas","elementRegistry"];function r2(e){return!e.hidden}var Cn={__init__:["selectionVisuals","selectionBehavior"],__depends__:[ko,zv],selection:["type",Mr],selectionVisuals:["type",kl],selectionBehavior:["type",Gv]};function Nl(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(Math.random()*1e9)+"-"}Nl.prototype.next=function(){return this._prefix+ ++this._counter};var o2=new Nl("ov"),a2=500;function at(e,t,n,i){this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=o2,this._overlayDefaults=O({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=s2(n.getContainer()),this._init()}at.$inject=["config.overlays","eventBus","canvas","elementRegistry"];at.prototype.get=function(e){if(Gt(e)&&(e={id:e}),Gt(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?Ee(t.overlays,on({type:e.type})):t.overlays.slice():[]}else return e.type?Ee(this._overlays,on({type:e.type})):e.id?this._overlays[e.id]:null};at.prototype.add=function(e,t,n){if(ot(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var i=this._ids.next();return n=O({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i};at.prototype.remove=function(e){var t=this.get(e)||[];be(t)||(t=[t]);var n=this;I(t,function(i){var r=n._getOverlayContainer(i.element,!0);if(i&&(wn(i.html),wn(i.htmlContainer),delete i.htmlContainer,delete i.element,delete n._overlays[i.id]),r){var o=r.overlays.indexOf(i);o!==-1&&r.overlays.splice(o,1)}})};at.prototype.show=function(){Us(this._overlayRoot)};at.prototype.hide=function(){Us(this._overlayRoot,!1)};at.prototype.clear=function(){this._overlays={},this._overlayContainers=[],To(this._overlayRoot)};at.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,r=t.y;if(t.waypoints){var o=Je(t);i=o.x,r=o.y}Vv(n,i,r),Ve(e.html,"data-container-id",t.id)};at.prototype._updateOverlay=function(e){var t=e.position,n=e.htmlContainer,i=e.element,r=t.left,o=t.top;if(t.right!==void 0){var a;i.waypoints?a=Je(i).width:a=i.width,r=t.right*-1+a}if(t.bottom!==void 0){var s;i.waypoints?s=Je(i).height:s=i.height,o=t.bottom*-1+s}Vv(n,r||0,o||0),this._updateOverlayVisibilty(e,this._canvas.viewbox())};at.prototype._createOverlayContainer=function(e){var t=ce('<div class="djs-overlays" />');qe(t,{position:"absolute"}),this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n};at.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";Wv(this._overlayRoot,n)};at.prototype._getOverlayContainer=function(e,t){var n=Me(this._overlayContainers,function(i){return i.element===e});return!n&&!t?this._createOverlayContainer(e):n};at.prototype._addOverlay=function(e){var t=e.id,n=e.element,i=e.html,r,o;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),Gt(i)&&(i=ce(i)),o=this._getOverlayContainer(n),r=ce('<div class="djs-overlay" data-overlay-id="'+t+'">'),qe(r,{position:"absolute"}),r.appendChild(i),e.type&&re(r).add("djs-overlay-"+e.type);var a=this._canvas.findRoot(n),s=this._canvas.getRootElement();Us(r,a===s),e.htmlContainer=r,o.overlays.push(e),o.html.appendChild(r),this._overlays[t]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())};at.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=this._canvas.findRoot(e.element),r=n&&n.minZoom,o=n&&n.maxZoom,a=e.htmlContainer,s=this._canvas.getRootElement(),c=!0;(i!==s||n&&(rn(r)&&r>t.scale||rn(o)&&o<t.scale))&&(c=!1),Us(a,c),this._updateOverlayScale(e,t)};at.prototype._updateOverlayScale=function(e,t){var n=e.scale,i,r,o=e.htmlContainer,a,s="";n!==!0&&(n===!1?(i=1,r=1):(i=n.min,r=n.max),rn(i)&&t.scale<i&&(a=(1/t.scale||1)*i),rn(r)&&t.scale>r&&(a=(1/t.scale||1)*r)),rn(a)&&(s="scale("+a+","+a+")"),Wv(o,s)};at.prototype._updateOverlaysVisibilty=function(e){var t=this;I(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})};at.prototype._init=function(){var e=this._eventBus,t=this;function n(i){t._updateRoot(i),t._updateOverlaysVisibilty(i),t.show()}e.on("canvas.viewbox.changing",function(i){t.hide()}),e.on("canvas.viewbox.changed",function(i){n(i.viewbox)}),e.on(["shape.remove","connection.remove"],function(i){var r=i.element,o=t.get({element:r});I(o,function(c){t.remove(c.id)});var a=t._getOverlayContainer(r);if(a){wn(a.html);var s=t._overlayContainers.indexOf(a);s!==-1&&t._overlayContainers.splice(s,1)}}),e.on("element.changed",a2,function(i){var r=i.element,o=t._getOverlayContainer(r,!0);o&&(I(o.overlays,function(a){t._updateOverlay(a)}),t._updateOverlayContainer(o))}),e.on("element.marker.update",function(i){var r=t._getOverlayContainer(i.element,!0);r&&re(r.html)[i.add?"add":"remove"](i.marker)}),e.on("root.set",function(){t._updateOverlaysVisibilty(t._canvas.viewbox())}),e.on("diagram.clear",this.clear,this)};function s2(e){var t=ce('<div class="djs-overlay-container" />');return qe(t,{position:"absolute",width:0,height:0}),e.insertBefore(t,e.firstChild),t}function Vv(e,t,n){qe(e,{left:t+"px",top:n+"px"})}function Us(e,t){e.style.display=t===!1?"none":""}function Wv(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}var Ys={__init__:["overlays"],overlays:["type",at]};function Uv(e,t,n,i){e.on("element.changed",function(r){var o=r.element;(o.parent||o===t.getRootElement())&&(r.gfx=n.getGraphics(o)),r.gfx&&e.fire(Zm(o)+".changed",r)}),e.on("elements.changed",function(r){var o=r.elements;o.forEach(function(a){e.fire("element.changed",{element:a})}),i.updateContainments(o)}),e.on("shape.changed",function(r){i.update("shape",r.element,r.gfx)}),e.on("connection.changed",function(r){i.update("connection",r.element,r.gfx)})}Uv.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var Ll={__init__:["changeSupport"],changeSupport:["type",Uv]},c2=1e3;function K(e){this._eventBus=e}K.$inject=["eventBus"];function u2(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}K.prototype.on=function(e,t,n,i,r,o){if((_t(t)||ge(t))&&(o=r,r=i,i=n,n=t,t=null),_t(n)&&(o=r,r=i,i=n,n=c2),ot(r)&&(o=r,r=!1),!_t(i))throw new Error("handlerFn must be a function");be(e)||(e=[e]);var a=this._eventBus;I(e,function(s){var c=["commandStack",s,t].filter(function(u){return u}).join(".");a.on(c,n,r?u2(i,o):i,o)})};var l2=["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"];I(l2,function(e){K.prototype[e]=function(t,n,i,r,o){(_t(t)||ge(t))&&(o=r,r=i,i=n,n=t,t=null),this.on(t,e,n,i,r,o)}});function $l(e,t){t.invoke(K,this),this.executed(function(n){var i=n.context;i.rootElement?e.setRootElement(i.rootElement):i.rootElement=e.getRootElement()}),this.revert(function(n){var i=n.context;i.rootElement&&e.setRootElement(i.rootElement)})}oe($l,K);$l.$inject=["canvas","injector"];var p2={__init__:["rootElementsBehavior"],rootElementsBehavior:["type",$l]},Yv={exports:{}};/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */(function(e,t){(function(n,i){e.exports=i(n)})(typeof ns!="undefined"?ns:ns,function(n){if(n.CSS&&n.CSS.escape)return n.CSS.escape;var i=function(r){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");for(var o=String(r),a=o.length,s=-1,c,u="",l=o.charCodeAt(0);++s<a;){if(c=o.charCodeAt(s),c==0){u+="\uFFFD";continue}if(c>=1&&c<=31||c==127||s==0&&c>=48&&c<=57||s==1&&c>=48&&c<=57&&l==45){u+="\\"+c.toString(16)+" ";continue}if(s==0&&a==1&&c==45){u+="\\"+o.charAt(s);continue}if(c>=128||c==45||c==95||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122){u+=o.charAt(s);continue}u+="\\"+o.charAt(s)}return u};return n.CSS||(n.CSS={}),n.CSS.escape=i,i})})(Yv);var mi=Yv.exports,f2={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function On(e){return e=""+e,e&&e.replace(/[&<>"']/g,function(t){return f2[t]})}var qv="_plane";function ph(e){var t=e.id;return h2(t)}function kn(e){var t=e.id;return v(e,"bpmn:SubProcess")?Kv(t):t}function Ni(e){return Kv(e)}function ru(e){var t=Ce(e);return v(t,"bpmndi:BPMNPlane")}function Kv(e){return e+qv}function h2(e){return e.replace(new RegExp(qv+"$"),"")}var d2="bjs-breadcrumbs-shown";function Xv(e,t,n,i){var r=ce('<ul class="bjs-breadcrumbs"></ul>'),o=i.getContainer(),a=re(o);o.appendChild(r);var s=[];e.on("element.changed",function(u){var l=u.element,p=X(l),f=Me(s,function(h){return h===p});!f||c()});function c(u){u&&(s=m2(u));var l=s.map(function(f){var h=On(f.name||f.id),d=ce('<li><span class="bjs-crumb"><a title="'+h+'">'+h+"</a></span></li>"),g=i.findRoot(kn(f))||i.findRoot(f.id);if(!g&&v(f,"bpmn:Process")){var y=t.find(function(A){var _=X(A);return _&&_.processRef&&_.processRef===f});g=i.findRoot(y.id)}return d.addEventListener("click",function(){i.setRootElement(g)}),d});r.innerHTML="";var p=l.length>1;a.toggle(d2,p),l.forEach(function(f){r.appendChild(f)})}e.on("root.set",function(u){c(u.element)})}Xv.$inject=["eventBus","elementRegistry","overlays","canvas"];function m2(e){for(var t=X(e),n=[],i=t;i;i=i.$parent)(v(i,"bpmn:SubProcess")||v(i,"bpmn:Process"))&&n.push(i);return n.reverse()}function Zv(e,t){var n=null,i=new v2;e.on("root.set",function(r){var o=r.element,a=t.viewbox(),s=i.get(o);if(i.set(n,{x:a.x,y:a.y,zoom:a.scale}),n=o,!(v(o,"bpmn:Collaboration")&&!s)){s=s||{x:0,y:0,zoom:1};var c=(a.x-s.x)*a.scale,u=(a.y-s.y)*a.scale;(c!==0||u!==0)&&t.scroll({dx:c,dy:u}),s.zoom!==a.scale&&t.zoom(s.zoom,{x:0,y:0})}}),e.on("diagram.clear",function(){i.clear(),n=null})}Zv.$inject=["eventBus","canvas"];function v2(){this._entries=[],this.set=function(e,t){var n=!1;for(var i in this._entries)if(this._entries[i][0]===e){this._entries[i][1]=t,n=!0;break}n||this._entries.push([e,t])},this.get=function(e){for(var t in this._entries)if(this._entries[t][0]===e)return this._entries[t][1];return null},this.clear=function(){this._entries.length=0},this.remove=function(e){var t=-1;for(var n in this._entries)if(this._entries[n][0]===e){t=n;break}t!==-1&&this._entries.splice(t,1)}}var fh={x:180,y:160};function Qi(e,t){this._eventBus=e,this._moddle=t;var n=this;e.on("import.render.start",1500,function(i,r){n.handleImport(r.definitions)})}Qi.prototype.handleImport=function(e){if(!!e.diagrams){var t=this;this._definitions=e,this._processToDiagramMap={},e.diagrams.forEach(function(i){!i.plane||!i.plane.bpmnElement||(t._processToDiagramMap[i.plane.bpmnElement.id]=i)});var n=[];e.diagrams.forEach(function(i){var r=t.createNewDiagrams(i.plane);Array.prototype.push.apply(n,r)}),n.forEach(function(i){t.movePlaneElementsToOrigin(i.plane)})}};Qi.prototype.createNewDiagrams=function(e){var t=this,n=[],i=[];e.get("planeElement").forEach(function(o){var a=o.bpmnElement;if(!!a){var s=a.$parent;v(a,"bpmn:SubProcess")&&!o.isExpanded&&n.push(a),y2(a,e)&&i.push({diElement:o,parent:s})}});var r=[];return n.forEach(function(o){if(!t._processToDiagramMap[o.id]){var a=t.createDiagram(o);t._processToDiagramMap[o.id]=a,r.push(a)}}),i.forEach(function(o){for(var a=o.diElement,s=o.parent;s&&n.indexOf(s)===-1;)s=s.$parent;if(!!s){var c=t._processToDiagramMap[s.id];t.moveToDiPlane(a,c.plane)}}),r};Qi.prototype.movePlaneElementsToOrigin=function(e){var t=e.get("planeElement"),n=g2(e),i={x:n.x-fh.x,y:n.y-fh.y};t.forEach(function(r){r.waypoint?r.waypoint.forEach(function(o){o.x=o.x-i.x,o.y=o.y-i.y}):r.bounds&&(r.bounds.x=r.bounds.x-i.x,r.bounds.y=r.bounds.y-i.y)})};Qi.prototype.moveToDiPlane=function(e,t){var n=Qv(e),i=n.plane.get("planeElement");i.splice(i.indexOf(e),1),t.get("planeElement").push(e)};Qi.prototype.createDiagram=function(e){var t=this._moddle.create("bpmndi:BPMNPlane",{bpmnElement:e}),n=this._moddle.create("bpmndi:BPMNDiagram",{plane:t});return t.$parent=n,t.bpmnElement=e,n.$parent=this._definitions,this._definitions.diagrams.push(n),n};Qi.$inject=["eventBus","moddle"];function Qv(e){return v(e,"bpmndi:BPMNDiagram")?e:Qv(e.$parent)}function g2(e){var t={top:1/0,right:-1/0,bottom:-1/0,left:1/0};return e.planeElement.forEach(function(n){if(!!n.bounds){var i=le(n.bounds);t.top=Math.min(i.top,t.top),t.left=Math.min(i.left,t.left)}}),Is(t)}function y2(e,t){var n=e.$parent;return!(!v(n,"bpmn:SubProcess")||n===t.bpmnElement||De(e,["bpmn:DataInputAssociation","bpmn:DataOutputAssociation"]))}var Da=250,E2='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.81801948,3.50735931 L10.4996894,9.1896894 L10.5,4 L12,4 L12,12 L4,12 L4,10.5 L9.6896894,10.4996894 L3.75735931,4.56801948 C3.46446609,4.27512627 3.46446609,3.80025253 3.75735931,3.50735931 C4.05025253,3.21446609 4.52512627,3.21446609 4.81801948,3.50735931 Z"/></svg>',_2="bjs-drilldown-empty";function bi(e,t,n,i){K.call(this,t),this._canvas=e,this._eventBus=t,this._elementRegistry=n,this._overlays=i;var r=this;this.executed("shape.toggleCollapse",Da,function(o){var a=o.shape;r.canDrillDown(a)?r.addOverlay(a):r.removeOverlay(a)},!0),this.reverted("shape.toggleCollapse",Da,function(o){var a=o.shape;r.canDrillDown(a)?r.addOverlay(a):r.removeOverlay(a)},!0),this.executed(["shape.create","shape.move","shape.delete"],Da,function(o){var a=o.oldParent,s=o.newParent||o.parent,c=o.shape;r.canDrillDown(c)&&r.addOverlay(c),r.updateDrilldownOverlay(a),r.updateDrilldownOverlay(s),r.updateDrilldownOverlay(c)},!0),this.reverted(["shape.create","shape.move","shape.delete"],Da,function(o){var a=o.oldParent,s=o.newParent||o.parent,c=o.shape;r.canDrillDown(c)&&r.addOverlay(c),r.updateDrilldownOverlay(a),r.updateDrilldownOverlay(s),r.updateDrilldownOverlay(c)},!0),t.on("import.render.complete",function(){n.filter(function(o){return r.canDrillDown(o)}).map(function(o){r.addOverlay(o)})})}oe(bi,K);bi.prototype.updateDrilldownOverlay=function(e){var t=this._canvas;if(!!e){var n=t.findRoot(e);n&&this.updateOverlayVisibility(n)}};bi.prototype.canDrillDown=function(e){var t=this._canvas;return v(e,"bpmn:SubProcess")&&t.findRoot(kn(e))};bi.prototype.updateOverlayVisibility=function(e){var t=this._overlays,n=e.businessObject,i=t.get({element:n.id,type:"drilldown"})[0];if(!!i){var r=n&&n.flowElements&&n.flowElements.length;re(i.html).toggle(_2,!r)}};bi.prototype.addOverlay=function(e){var t=this._canvas,n=this._overlays,i=n.get({element:e,type:"drilldown"});i.length&&this.removeOverlay(e);var r=ce('<button class="bjs-drilldown">'+E2+"</button>");r.addEventListener("click",function(){t.setRootElement(t.findRoot(kn(e)))}),n.add(e,"drilldown",{position:{bottom:-7,right:-8},html:r}),this.updateOverlayVisibility(e)};bi.prototype.removeOverlay=function(e){var t=this._overlays;t.remove({element:e,type:"drilldown"})};bi.$inject=["canvas","eventBus","elementRegistry","overlays"];var b2={__depends__:[Ys,Ll,p2],__init__:["drilldownBreadcrumbs","drilldownOverlayBehavior","drilldownCentering","subprocessCompatibility"],drilldownBreadcrumbs:["type",Xv],drilldownCentering:["type",Zv],drilldownOverlayBehavior:["type",bi],subprocessCompatibility:["type",Qi]};function Yn(e){je.call(this,e)}oe(Yn,je);Yn.prototype._modules=[Q1,zs,Cn,Ys,b2];Yn.prototype._moddleExtensions={};var x2=67,w2=86,S2=89,C2=90,T2=["c","C",x2],A2=["v","V",w2],R2=["y","Y",S2],Jv=["z","Z",C2];function P2(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function Ft(e){return e.altKey?!1:e.ctrlKey||e.metaKey}function nn(e,t){return e=be(e)?e:[e],e.indexOf(t.key)!==-1||e.indexOf(t.keyCode)!==-1}function jl(e){return e.shiftKey}function D2(e){return Ft(e)&&nn(T2,e)}function M2(e){return Ft(e)&&nn(A2,e)}function B2(e){return Ft(e)&&!jl(e)&&nn(Jv,e)}function I2(e){return Ft(e)&&(nn(R2,e)||nn(Jv,e)&&jl(e))}var qs="keyboard.keydown",F2="keyboard.keyup",hh="input-handle-modified-keys",O2=1e3;function st(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}st.$inject=["config.keyboard","eventBus"];st.prototype._keydownHandler=function(e){this._keyHandler(e,qs)};st.prototype._keyupHandler=function(e){this._keyHandler(e,F2)};st.prototype._keyHandler=function(e,t){var n;if(!this._isEventIgnored(e)){var i={keyEvent:e};n=this._eventBus.fire(t||qs,i),n&&e.preventDefault()}};st.prototype._isEventIgnored=function(e){return k2(e.target)&&this._isModifiedKeyIgnored(e)};st.prototype._isModifiedKeyIgnored=function(e){if(!Ft(e))return!0;var t=this._getAllowedModifiers(e.target);return t.indexOf(e.key)===-1};st.prototype._getAllowedModifiers=function(e){var t=Ki(e,"["+hh+"]",!0);return!t||this._node&&!this._node.contains(t)?[]:t.getAttribute(hh).split(",")};st.prototype.bind=function(e){this.unbind(),this._node=e,J.bind(e,"keydown",this._keydownHandler,!0),J.bind(e,"keyup",this._keyupHandler,!0),this._fire("bind")};st.prototype.getBinding=function(){return this._node};st.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),J.unbind(e,"keydown",this._keydownHandler,!0),J.unbind(e,"keyup",this._keyupHandler,!0)),this._node=null};st.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})};st.prototype.addListener=function(e,t,n){_t(e)&&(n=t,t=e,e=O2),this._eventBus.on(n||qs,e,t)};st.prototype.removeListener=function(e,t){this._eventBus.off(t||qs,e)};st.prototype.hasModifier=P2;st.prototype.isCmd=Ft;st.prototype.isShift=jl;st.prototype.isKey=nn;function k2(e){return e&&(ms(e,"input, textarea")||e.contentEditable==="true")}var N2=500;function Br(e,t){var n=this;e.on("editorActions.init",N2,function(i){var r=i.editorActions;n.registerBindings(t,r)})}Br.$inject=["eventBus","keyboard"];Br.prototype.registerBindings=function(e,t){function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("undo",function(i){var r=i.keyEvent;if(B2(r))return t.trigger("undo"),!0}),n("redo",function(i){var r=i.keyEvent;if(I2(r))return t.trigger("redo"),!0}),n("copy",function(i){var r=i.keyEvent;if(D2(r))return t.trigger("copy"),!0}),n("paste",function(i){var r=i.keyEvent;if(M2(r))return t.trigger("paste"),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(nn(["+","Add","="],r)&&Ft(r))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(i){var r=i.keyEvent;if(nn(["-","Subtract"],r)&&Ft(r))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(i){var r=i.keyEvent;if(nn("0",r)&&Ft(r))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(i){var r=i.keyEvent;if(nn(["Backspace","Delete","Del"],r))return t.trigger("removeSelection"),!0})};var Hl={__init__:["keyboard","keyboardBindings"],keyboard:["type",st],keyboardBindings:["type",Br]},L2={moveSpeed:50,moveSpeedAccelerated:200};function eg(e,t,n){var i=this;this._config=O({},L2,e||{}),t.addListener(r);function r(o){var a=o.keyEvent,s=i._config;if(!!t.isCmd(a)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],a)){var c=t.isShift(a)?s.moveSpeedAccelerated:s.moveSpeed,u;switch(a.key){case"ArrowLeft":case"Left":u="left";break;case"ArrowUp":case"Up":u="up";break;case"ArrowRight":case"Right":u="right";break;case"ArrowDown":case"Down":u="down";break}return i.moveCanvas({speed:c,direction:u}),!0}}this.moveCanvas=function(o){var a=0,s=0,c=o.speed,u=c/Math.min(Math.sqrt(n.viewbox().scale),1);switch(o.direction){case"left":a=u;break;case"up":s=u;break;case"right":a=-u;break;case"down":s=-u;break}n.scroll({dx:a,dy:s})}}eg.$inject=["config.keyboardMove","keyboard","canvas"];var tg={__depends__:[Hl],__init__:["keyboardMove"],keyboardMove:["type",eg]},$2=/^djs-cursor-.*$/;function Ks(e){var t=re(document.body);t.removeMatching($2),e&&t.add("djs-cursor-"+e)}function ng(){Ks(null)}var j2=5e3;function ig(e,t){t=t||"element.click";function n(){return!1}return e.once(t,j2,n),function(){e.off(t,n)}}function po(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function an(e,t){return{x:e.x-t.x,y:e.y-t.y}}var H2=15;function rg(e,t){var n;e.on("element.mousedown",500,function(a){return o(a.originalEvent)});function i(a){var s=n.start,c=n.button,u=di(a),l=an(u,s);if(!n.dragging&&z2(l)>H2&&(n.dragging=!0,c===0&&ig(e),Ks("grab")),n.dragging){var p=n.last||n.start;l=an(u,p),t.scroll({dx:l.x,dy:l.y}),n.last=u}a.preventDefault()}function r(a){J.unbind(document,"mousemove",i),J.unbind(document,"mouseup",r),n=null,ng()}function o(a){if(!Ki(a.target,".djs-draggable")){var s=a.button;if(!(s>=2||a.ctrlKey||a.shiftKey||a.altKey))return n={button:s,start:di(a)},J.bind(document,"mousemove",i),J.bind(document,"mouseup",r),!0}}this.isActive=function(){return!!n}}rg.$inject=["eventBus","canvas"];function z2(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}var zl={__init__:["moveCanvas"],moveCanvas:["type",rg]};function Hu(e){return Math.log(e)/Math.log(10)}function og(e,t){var n=Hu(e.min),i=Hu(e.max),r=Math.abs(n)+Math.abs(i);return r/t}function G2(e,t){return Math.max(e.min,Math.min(e.max,t))}var V2=Math.sign||function(e){return e>=0?1:-1},Gl={min:.2,max:4},ag=10,W2=.1,U2=.75;function Tn(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=wt(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||U2;var i=this;t.on("canvas.init",function(r){i._init(e.enabled!==!1)})}Tn.$inject=["config.zoomScroll","eventBus","canvas"];Tn.prototype.scroll=function(t){this._canvas.scroll(t)};Tn.prototype.reset=function(){this._canvas.zoom("fit-viewport")};Tn.prototype.zoom=function(t,n){var i=og(Gl,ag*2);this._totalDelta+=t,Math.abs(this._totalDelta)>W2&&(this._zoom(t,n,i),this._totalDelta=0)};Tn.prototype._handleWheel=function(t){if(!Ki(t.target,".djs-scrollable",!0)){var n=this._container;t.preventDefault();var i=t.ctrlKey,r=t.shiftKey,o=-1*this._scale,a;if(i?o*=t.deltaMode===0?.02:.32:o*=t.deltaMode===0?1:16,i){var s=n.getBoundingClientRect(),c={x:t.clientX-s.left,y:t.clientY-s.top};a=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*V2(t.deltaY)*o,this.zoom(a,c)}else r?a={dx:o*t.deltaY,dy:0}:a={dx:o*t.deltaX,dy:o*t.deltaY},this.scroll(a)}};Tn.prototype.stepZoom=function(t,n){var i=og(Gl,ag);this._zoom(t,n,i)};Tn.prototype._zoom=function(e,t,n){var i=this._canvas,r=e>0?1:-1,o=Hu(i.zoom()),a=Math.round(o/n)*n;a+=n*r;var s=Math.pow(10,a);i.zoom(G2(Gl,s),t)};Tn.prototype.toggle=function(t){var n=this._container,i=this._handleWheel,r=this._enabled;return typeof t=="undefined"&&(t=!r),r!==t&&J[t?"bind":"unbind"](n,"wheel",i,!1),this._enabled=t,t};Tn.prototype._init=function(e){this.toggle(e)};var Vl={__init__:["zoomScroll"],zoomScroll:["type",Tn]};function xo(e){Yn.call(this,e)}oe(xo,Yn);xo.prototype._navigationModules=[tg,zl,Vl];xo.prototype._modules=[].concat(Yn.prototype._modules,xo.prototype._navigationModules);var sg={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(t,n,i,r){var o=["","webkit","Moz","MS","ms","o"],a=n.createElement("div"),s="function",c=Math.round,u=Math.abs,l=Date.now;function p(E,x,P){return setTimeout(w(E,P),x)}function f(E,x,P){return Array.isArray(E)?(h(E,P[x],P),!0):!1}function h(E,x,P){var $;if(!!E)if(E.forEach)E.forEach(x,P);else if(E.length!==r)for($=0;$<E.length;)x.call(P,E[$],$,E),$++;else for($ in E)E.hasOwnProperty($)&&x.call(P,E[$],$,E)}function d(E,x,P){var $="DEPRECATED METHOD: "+x+`
`+P+` AT 
`;return function(){var q=new Error("get-stack-trace"),ie=q&&q.stack?q.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Be=t.console&&(t.console.warn||t.console.log);return Be&&Be.call(t.console,$,ie),E.apply(this,arguments)}}var g;typeof Object.assign!="function"?g=function(x){if(x===r||x===null)throw new TypeError("Cannot convert undefined or null to object");for(var P=Object(x),$=1;$<arguments.length;$++){var q=arguments[$];if(q!==r&&q!==null)for(var ie in q)q.hasOwnProperty(ie)&&(P[ie]=q[ie])}return P}:g=Object.assign;var y=d(function(x,P,$){for(var q=Object.keys(P),ie=0;ie<q.length;)(!$||$&&x[q[ie]]===r)&&(x[q[ie]]=P[q[ie]]),ie++;return x},"extend","Use `assign`."),A=d(function(x,P){return y(x,P,!0)},"merge","Use `assign`.");function _(E,x,P){var $=x.prototype,q;q=E.prototype=Object.create($),q.constructor=E,q._super=$,P&&g(q,P)}function w(E,x){return function(){return E.apply(x,arguments)}}function b(E,x){return typeof E==s?E.apply(x&&x[0]||r,x):E}function S(E,x){return E===r?x:E}function M(E,x,P){h(F(x),function($){E.addEventListener($,P,!1)})}function C(E,x,P){h(F(x),function($){E.removeEventListener($,P,!1)})}function R(E,x){for(;E;){if(E==x)return!0;E=E.parentNode}return!1}function D(E,x){return E.indexOf(x)>-1}function F(E){return E.trim().split(/\s+/g)}function j(E,x,P){if(E.indexOf&&!P)return E.indexOf(x);for(var $=0;$<E.length;){if(P&&E[$][P]==x||!P&&E[$]===x)return $;$++}return-1}function z(E){return Array.prototype.slice.call(E,0)}function G(E,x,P){for(var $=[],q=[],ie=0;ie<E.length;){var Be=x?E[ie][x]:E[ie];j(q,Be)<0&&$.push(E[ie]),q[ie]=Be,ie++}return P&&(x?$=$.sort(function(ct,yt){return ct[x]>yt[x]}):$=$.sort()),$}function he(E,x){for(var P,$,q=x[0].toUpperCase()+x.slice(1),ie=0;ie<o.length;){if(P=o[ie],$=P?P+q:x,$ in E)return $;ie++}return r}var Ne=1;function _e(){return Ne++}function ue(E){var x=E.ownerDocument||E;return x.defaultView||x.parentWindow||t}var T=/mobile|tablet|ip(ad|hone|od)|android/i,m="ontouchstart"in t,B=he(t,"PointerEvent")!==r,k=m&&T.test(navigator.userAgent),V="touch",te="pen",L="mouse",H="kinect",ee=25,N=1,Y=2,U=4,Q=8,ne=1,se=2,de=4,Te=8,Ye=16,tt=se|de,nt=Te|Ye,we=tt|nt,Mt=["x","y"],Ie=["clientX","clientY"];function et(E,x){var P=this;this.manager=E,this.callback=x,this.element=E.element,this.target=E.options.inputTarget,this.domHandler=function($){b(E.options.enable,[E])&&P.handler($)},this.init()}et.prototype={handler:function(){},init:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(ue(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(ue(this.element),this.evWin,this.domHandler)}};function va(E){var x,P=E.options.inputClass;return P?x=P:B?x=Vc:k?x=Ea:m?x=Wc:x=ya,new x(E,Bt)}function Bt(E,x,P){var $=P.pointers.length,q=P.changedPointers.length,ie=x&N&&$-q===0,Be=x&(U|Q)&&$-q===0;P.isFirst=!!ie,P.isFinal=!!Be,ie&&(E.session={}),P.eventType=x,fe(E,P),E.emit("hammer.input",P),E.recognize(P),E.session.prevInput=P}function fe(E,x){var P=E.session,$=x.pointers,q=$.length;P.firstInput||(P.firstInput=mf(x)),q>1&&!P.firstMultiple?P.firstMultiple=mf(x):q===1&&(P.firstMultiple=!1);var ie=P.firstInput,Be=P.firstMultiple,it=Be?Be.center:ie.center,ct=x.center=vf($);x.timeStamp=l(),x.deltaTime=x.timeStamp-ie.timeStamp,x.angle=Gc(it,ct),x.distance=ga(it,ct),Fe(P,x),x.offsetDirection=yf(x.deltaX,x.deltaY);var yt=gf(x.deltaTime,x.deltaX,x.deltaY);x.overallVelocityX=yt.x,x.overallVelocityY=yt.y,x.overallVelocity=u(yt.x)>u(yt.y)?yt.x:yt.y,x.scale=Be?r0(Be.pointers,$):1,x.rotation=Be?i0(Be.pointers,$):0,x.maxPointers=P.prevInput?x.pointers.length>P.prevInput.maxPointers?x.pointers.length:P.prevInput.maxPointers:x.pointers.length,n0(P,x);var mn=E.element;R(x.srcEvent.target,mn)&&(mn=x.srcEvent.target),x.target=mn}function Fe(E,x){var P=x.center,$=E.offsetDelta||{},q=E.prevDelta||{},ie=E.prevInput||{};(x.eventType===N||ie.eventType===U)&&(q=E.prevDelta={x:ie.deltaX||0,y:ie.deltaY||0},$=E.offsetDelta={x:P.x,y:P.y}),x.deltaX=q.x+(P.x-$.x),x.deltaY=q.y+(P.y-$.y)}function n0(E,x){var P=E.lastInterval||x,$=x.timeStamp-P.timeStamp,q,ie,Be,it;if(x.eventType!=Q&&($>ee||P.velocity===r)){var ct=x.deltaX-P.deltaX,yt=x.deltaY-P.deltaY,mn=gf($,ct,yt);ie=mn.x,Be=mn.y,q=u(mn.x)>u(mn.y)?mn.x:mn.y,it=yf(ct,yt),E.lastInterval=x}else q=P.velocity,ie=P.velocityX,Be=P.velocityY,it=P.direction;x.velocity=q,x.velocityX=ie,x.velocityY=Be,x.direction=it}function mf(E){for(var x=[],P=0;P<E.pointers.length;)x[P]={clientX:c(E.pointers[P].clientX),clientY:c(E.pointers[P].clientY)},P++;return{timeStamp:l(),pointers:x,center:vf(x),deltaX:E.deltaX,deltaY:E.deltaY}}function vf(E){var x=E.length;if(x===1)return{x:c(E[0].clientX),y:c(E[0].clientY)};for(var P=0,$=0,q=0;q<x;)P+=E[q].clientX,$+=E[q].clientY,q++;return{x:c(P/x),y:c($/x)}}function gf(E,x,P){return{x:x/E||0,y:P/E||0}}function yf(E,x){return E===x?ne:u(E)>=u(x)?E<0?se:de:x<0?Te:Ye}function ga(E,x,P){P||(P=Mt);var $=x[P[0]]-E[P[0]],q=x[P[1]]-E[P[1]];return Math.sqrt($*$+q*q)}function Gc(E,x,P){P||(P=Mt);var $=x[P[0]]-E[P[0]],q=x[P[1]]-E[P[1]];return Math.atan2(q,$)*180/Math.PI}function i0(E,x){return Gc(x[1],x[0],Ie)+Gc(E[1],E[0],Ie)}function r0(E,x){return ga(x[0],x[1],Ie)/ga(E[0],E[1],Ie)}var o0={mousedown:N,mousemove:Y,mouseup:U},a0="mousedown",s0="mousemove mouseup";function ya(){this.evEl=a0,this.evWin=s0,this.pressed=!1,et.apply(this,arguments)}_(ya,et,{handler:function(x){var P=o0[x.type];P&N&&x.button===0&&(this.pressed=!0),P&Y&&x.which!==1&&(P=U),this.pressed&&(P&U&&(this.pressed=!1),this.callback(this.manager,P,{pointers:[x],changedPointers:[x],pointerType:L,srcEvent:x}))}});var c0={pointerdown:N,pointermove:Y,pointerup:U,pointercancel:Q,pointerout:Q},u0={2:V,3:te,4:L,5:H},Ef="pointerdown",_f="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Ef="MSPointerDown",_f="MSPointerMove MSPointerUp MSPointerCancel");function Vc(){this.evEl=Ef,this.evWin=_f,et.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}_(Vc,et,{handler:function(x){var P=this.store,$=!1,q=x.type.toLowerCase().replace("ms",""),ie=c0[q],Be=u0[x.pointerType]||x.pointerType,it=Be==V,ct=j(P,x.pointerId,"pointerId");ie&N&&(x.button===0||it)?ct<0&&(P.push(x),ct=P.length-1):ie&(U|Q)&&($=!0),!(ct<0)&&(P[ct]=x,this.callback(this.manager,ie,{pointers:P,changedPointers:[x],pointerType:Be,srcEvent:x}),$&&P.splice(ct,1))}});var l0={touchstart:N,touchmove:Y,touchend:U,touchcancel:Q},p0="touchstart",f0="touchstart touchmove touchend touchcancel";function bf(){this.evTarget=p0,this.evWin=f0,this.started=!1,et.apply(this,arguments)}_(bf,et,{handler:function(x){var P=l0[x.type];if(P===N&&(this.started=!0),!!this.started){var $=h0.call(this,x,P);P&(U|Q)&&$[0].length-$[1].length===0&&(this.started=!1),this.callback(this.manager,P,{pointers:$[0],changedPointers:$[1],pointerType:V,srcEvent:x})}}});function h0(E,x){var P=z(E.touches),$=z(E.changedTouches);return x&(U|Q)&&(P=G(P.concat($),"identifier",!0)),[P,$]}var d0={touchstart:N,touchmove:Y,touchend:U,touchcancel:Q},m0="touchstart touchmove touchend touchcancel";function Ea(){this.evTarget=m0,this.targetIds={},et.apply(this,arguments)}_(Ea,et,{handler:function(x){var P=d0[x.type],$=v0.call(this,x,P);!$||this.callback(this.manager,P,{pointers:$[0],changedPointers:$[1],pointerType:V,srcEvent:x})}});function v0(E,x){var P=z(E.touches),$=this.targetIds;if(x&(N|Y)&&P.length===1)return $[P[0].identifier]=!0,[P,P];var q,ie,Be=z(E.changedTouches),it=[],ct=this.target;if(ie=P.filter(function(yt){return R(yt.target,ct)}),x===N)for(q=0;q<ie.length;)$[ie[q].identifier]=!0,q++;for(q=0;q<Be.length;)$[Be[q].identifier]&&it.push(Be[q]),x&(U|Q)&&delete $[Be[q].identifier],q++;if(!!it.length)return[G(ie.concat(it),"identifier",!0),it]}var g0=2500,xf=25;function Wc(){et.apply(this,arguments);var E=w(this.handler,this);this.touch=new Ea(this.manager,E),this.mouse=new ya(this.manager,E),this.primaryTouch=null,this.lastTouches=[]}_(Wc,et,{handler:function(x,P,$){var q=$.pointerType==V,ie=$.pointerType==L;if(!(ie&&$.sourceCapabilities&&$.sourceCapabilities.firesTouchEvents)){if(q)y0.call(this,P,$);else if(ie&&E0.call(this,$))return;this.callback(x,P,$)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function y0(E,x){E&N?(this.primaryTouch=x.changedPointers[0].identifier,wf.call(this,x)):E&(U|Q)&&wf.call(this,x)}function wf(E){var x=E.changedPointers[0];if(x.identifier===this.primaryTouch){var P={x:x.clientX,y:x.clientY};this.lastTouches.push(P);var $=this.lastTouches,q=function(){var ie=$.indexOf(P);ie>-1&&$.splice(ie,1)};setTimeout(q,g0)}}function E0(E){for(var x=E.srcEvent.clientX,P=E.srcEvent.clientY,$=0;$<this.lastTouches.length;$++){var q=this.lastTouches[$],ie=Math.abs(x-q.x),Be=Math.abs(P-q.y);if(ie<=xf&&Be<=xf)return!0}return!1}var Sf=he(a.style,"touchAction"),Cf=Sf!==r,Tf="compute",Af="auto",Uc="manipulation",Oi="none",Yr="pan-x",qr="pan-y",_a=b0();function Yc(E,x){this.manager=E,this.set(x)}Yc.prototype={set:function(E){E==Tf&&(E=this.compute()),Cf&&this.manager.element.style&&_a[E]&&(this.manager.element.style[Sf]=E),this.actions=E.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var E=[];return h(this.manager.recognizers,function(x){b(x.options.enable,[x])&&(E=E.concat(x.getTouchAction()))}),_0(E.join(" "))},preventDefaults:function(E){var x=E.srcEvent,P=E.offsetDirection;if(this.manager.session.prevented){x.preventDefault();return}var $=this.actions,q=D($,Oi)&&!_a[Oi],ie=D($,qr)&&!_a[qr],Be=D($,Yr)&&!_a[Yr];if(q){var it=E.pointers.length===1,ct=E.distance<2,yt=E.deltaTime<250;if(it&&ct&&yt)return}if(!(Be&&ie)&&(q||ie&&P&tt||Be&&P&nt))return this.preventSrc(x)},preventSrc:function(E){this.manager.session.prevented=!0,E.preventDefault()}};function _0(E){if(D(E,Oi))return Oi;var x=D(E,Yr),P=D(E,qr);return x&&P?Oi:x||P?x?Yr:qr:D(E,Uc)?Uc:Af}function b0(){if(!Cf)return!1;var E={},x=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(P){E[P]=x?t.CSS.supports("touch-action",P):!0}),E}var ba=1,jt=2,lr=4,ii=8,Pn=ii,Kr=16,dn=32;function Dn(E){this.options=g({},this.defaults,E||{}),this.id=_e(),this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=ba,this.simultaneous={},this.requireFail=[]}Dn.prototype={defaults:{},set:function(E){return g(this.options,E),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(E){if(f(E,"recognizeWith",this))return this;var x=this.simultaneous;return E=xa(E,this),x[E.id]||(x[E.id]=E,E.recognizeWith(this)),this},dropRecognizeWith:function(E){return f(E,"dropRecognizeWith",this)?this:(E=xa(E,this),delete this.simultaneous[E.id],this)},requireFailure:function(E){if(f(E,"requireFailure",this))return this;var x=this.requireFail;return E=xa(E,this),j(x,E)===-1&&(x.push(E),E.requireFailure(this)),this},dropRequireFailure:function(E){if(f(E,"dropRequireFailure",this))return this;E=xa(E,this);var x=j(this.requireFail,E);return x>-1&&this.requireFail.splice(x,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(E){return!!this.simultaneous[E.id]},emit:function(E){var x=this,P=this.state;function $(q){x.manager.emit(q,E)}P<ii&&$(x.options.event+Rf(P)),$(x.options.event),E.additionalEvent&&$(E.additionalEvent),P>=ii&&$(x.options.event+Rf(P))},tryEmit:function(E){if(this.canEmit())return this.emit(E);this.state=dn},canEmit:function(){for(var E=0;E<this.requireFail.length;){if(!(this.requireFail[E].state&(dn|ba)))return!1;E++}return!0},recognize:function(E){var x=g({},E);if(!b(this.options.enable,[this,x])){this.reset(),this.state=dn;return}this.state&(Pn|Kr|dn)&&(this.state=ba),this.state=this.process(x),this.state&(jt|lr|ii|Kr)&&this.tryEmit(x)},process:function(E){},getTouchAction:function(){},reset:function(){}};function Rf(E){return E&Kr?"cancel":E&ii?"end":E&lr?"move":E&jt?"start":""}function Pf(E){return E==Ye?"down":E==Te?"up":E==se?"left":E==de?"right":""}function xa(E,x){var P=x.manager;return P?P.get(E):E}function en(){Dn.apply(this,arguments)}_(en,Dn,{defaults:{pointers:1},attrTest:function(E){var x=this.options.pointers;return x===0||E.pointers.length===x},process:function(E){var x=this.state,P=E.eventType,$=x&(jt|lr),q=this.attrTest(E);return $&&(P&Q||!q)?x|Kr:$||q?P&U?x|ii:x&jt?x|lr:jt:dn}});function wa(){en.apply(this,arguments),this.pX=null,this.pY=null}_(wa,en,{defaults:{event:"pan",threshold:10,pointers:1,direction:we},getTouchAction:function(){var E=this.options.direction,x=[];return E&tt&&x.push(qr),E&nt&&x.push(Yr),x},directionTest:function(E){var x=this.options,P=!0,$=E.distance,q=E.direction,ie=E.deltaX,Be=E.deltaY;return q&x.direction||(x.direction&tt?(q=ie===0?ne:ie<0?se:de,P=ie!=this.pX,$=Math.abs(E.deltaX)):(q=Be===0?ne:Be<0?Te:Ye,P=Be!=this.pY,$=Math.abs(E.deltaY))),E.direction=q,P&&$>x.threshold&&q&x.direction},attrTest:function(E){return en.prototype.attrTest.call(this,E)&&(this.state&jt||!(this.state&jt)&&this.directionTest(E))},emit:function(E){this.pX=E.deltaX,this.pY=E.deltaY;var x=Pf(E.direction);x&&(E.additionalEvent=this.options.event+x),this._super.emit.call(this,E)}});function qc(){en.apply(this,arguments)}_(qc,en,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Oi]},attrTest:function(E){return this._super.attrTest.call(this,E)&&(Math.abs(E.scale-1)>this.options.threshold||this.state&jt)},emit:function(E){if(E.scale!==1){var x=E.scale<1?"in":"out";E.additionalEvent=this.options.event+x}this._super.emit.call(this,E)}});function Kc(){Dn.apply(this,arguments),this._timer=null,this._input=null}_(Kc,Dn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Af]},process:function(E){var x=this.options,P=E.pointers.length===x.pointers,$=E.distance<x.threshold,q=E.deltaTime>x.time;if(this._input=E,!$||!P||E.eventType&(U|Q)&&!q)this.reset();else if(E.eventType&N)this.reset(),this._timer=p(function(){this.state=Pn,this.tryEmit()},x.time,this);else if(E.eventType&U)return Pn;return dn},reset:function(){clearTimeout(this._timer)},emit:function(E){this.state===Pn&&(E&&E.eventType&U?this.manager.emit(this.options.event+"up",E):(this._input.timeStamp=l(),this.manager.emit(this.options.event,this._input)))}});function Xc(){en.apply(this,arguments)}_(Xc,en,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Oi]},attrTest:function(E){return this._super.attrTest.call(this,E)&&(Math.abs(E.rotation)>this.options.threshold||this.state&jt)}});function Zc(){en.apply(this,arguments)}_(Zc,en,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:tt|nt,pointers:1},getTouchAction:function(){return wa.prototype.getTouchAction.call(this)},attrTest:function(E){var x=this.options.direction,P;return x&(tt|nt)?P=E.overallVelocity:x&tt?P=E.overallVelocityX:x&nt&&(P=E.overallVelocityY),this._super.attrTest.call(this,E)&&x&E.offsetDirection&&E.distance>this.options.threshold&&E.maxPointers==this.options.pointers&&u(P)>this.options.velocity&&E.eventType&U},emit:function(E){var x=Pf(E.offsetDirection);x&&this.manager.emit(this.options.event+x,E),this.manager.emit(this.options.event,E)}});function Sa(){Dn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}_(Sa,Dn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Uc]},process:function(E){var x=this.options,P=E.pointers.length===x.pointers,$=E.distance<x.threshold,q=E.deltaTime<x.time;if(this.reset(),E.eventType&N&&this.count===0)return this.failTimeout();if($&&q&&P){if(E.eventType!=U)return this.failTimeout();var ie=this.pTime?E.timeStamp-this.pTime<x.interval:!0,Be=!this.pCenter||ga(this.pCenter,E.center)<x.posThreshold;this.pTime=E.timeStamp,this.pCenter=E.center,!Be||!ie?this.count=1:this.count+=1,this._input=E;var it=this.count%x.taps;if(it===0)return this.hasRequireFailures()?(this._timer=p(function(){this.state=Pn,this.tryEmit()},x.interval,this),jt):Pn}return dn},failTimeout:function(){return this._timer=p(function(){this.state=dn},this.options.interval,this),dn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Pn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Mn(E,x){return x=x||{},x.recognizers=S(x.recognizers,Mn.defaults.preset),new Qc(E,x)}Mn.VERSION="2.0.7",Mn.defaults={domEvents:!1,touchAction:Tf,enable:!0,inputTarget:null,inputClass:null,preset:[[Xc,{enable:!1}],[qc,{enable:!1},["rotate"]],[Zc,{direction:tt}],[wa,{direction:tt},["swipe"]],[Sa],[Sa,{event:"doubletap",taps:2},["tap"]],[Kc]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var x0=1,Df=2;function Qc(E,x){this.options=g({},Mn.defaults,x||{}),this.options.inputTarget=this.options.inputTarget||E,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=E,this.input=va(this),this.touchAction=new Yc(this,this.options.touchAction),Mf(this,!0),h(this.options.recognizers,function(P){var $=this.add(new P[0](P[1]));P[2]&&$.recognizeWith(P[2]),P[3]&&$.requireFailure(P[3])},this)}Qc.prototype={set:function(E){return g(this.options,E),E.touchAction&&this.touchAction.update(),E.inputTarget&&(this.input.destroy(),this.input.target=E.inputTarget,this.input.init()),this},stop:function(E){this.session.stopped=E?Df:x0},recognize:function(E){var x=this.session;if(!x.stopped){this.touchAction.preventDefaults(E);var P,$=this.recognizers,q=x.curRecognizer;(!q||q&&q.state&Pn)&&(q=x.curRecognizer=null);for(var ie=0;ie<$.length;)P=$[ie],x.stopped!==Df&&(!q||P==q||P.canRecognizeWith(q))?P.recognize(E):P.reset(),!q&&P.state&(jt|lr|ii)&&(q=x.curRecognizer=P),ie++}},get:function(E){if(E instanceof Dn)return E;for(var x=this.recognizers,P=0;P<x.length;P++)if(x[P].options.event==E)return x[P];return null},add:function(E){if(f(E,"add",this))return this;var x=this.get(E.options.event);return x&&this.remove(x),this.recognizers.push(E),E.manager=this,this.touchAction.update(),E},remove:function(E){if(f(E,"remove",this))return this;if(E=this.get(E),E){var x=this.recognizers,P=j(x,E);P!==-1&&(x.splice(P,1),this.touchAction.update())}return this},on:function(E,x){if(E!==r&&x!==r){var P=this.handlers;return h(F(E),function($){P[$]=P[$]||[],P[$].push(x)}),this}},off:function(E,x){if(E!==r){var P=this.handlers;return h(F(E),function($){x?P[$]&&P[$].splice(j(P[$],x),1):delete P[$]}),this}},emit:function(E,x){this.options.domEvents&&w0(E,x);var P=this.handlers[E]&&this.handlers[E].slice();if(!(!P||!P.length)){x.type=E,x.preventDefault=function(){x.srcEvent.preventDefault()};for(var $=0;$<P.length;)P[$](x),$++}},destroy:function(){this.element&&Mf(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Mf(E,x){var P=E.element;if(!!P.style){var $;h(E.options.cssProps,function(q,ie){$=he(P.style,ie),x?(E.oldCssProps[$]=P.style[$],P.style[$]=q):P.style[$]=E.oldCssProps[$]||""}),x||(E.oldCssProps={})}}function w0(E,x){var P=n.createEvent("Event");P.initEvent(E,!0,!0),P.gesture=x,x.target.dispatchEvent(P)}g(Mn,{INPUT_START:N,INPUT_MOVE:Y,INPUT_END:U,INPUT_CANCEL:Q,STATE_POSSIBLE:ba,STATE_BEGAN:jt,STATE_CHANGED:lr,STATE_ENDED:ii,STATE_RECOGNIZED:Pn,STATE_CANCELLED:Kr,STATE_FAILED:dn,DIRECTION_NONE:ne,DIRECTION_LEFT:se,DIRECTION_RIGHT:de,DIRECTION_UP:Te,DIRECTION_DOWN:Ye,DIRECTION_HORIZONTAL:tt,DIRECTION_VERTICAL:nt,DIRECTION_ALL:we,Manager:Qc,Input:et,TouchAction:Yc,TouchInput:Ea,MouseInput:ya,PointerEventInput:Vc,TouchMouseInput:Wc,SingleTouchInput:bf,Recognizer:Dn,AttrRecognizer:en,Tap:Sa,Pan:wa,Swipe:Zc,Pinch:qc,Rotate:Xc,Press:Kc,on:M,off:C,each:h,merge:A,extend:y,assign:g,inherit:_,bindFn:w,prefixed:he});var S0=typeof t!="undefined"?t:typeof self!="undefined"?self:{};S0.Hammer=Mn,typeof r=="function"&&r.amd?r(function(){return Mn}):e.exports?e.exports=Mn:t[i]=Mn})(window,document,"Hammer")})(sg);var Li=sg.exports,Y2=.2,q2=4,dh=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function Ma(e,t){return t.get(e,!1)}function zu(e){e.preventDefault(),typeof e.stopPropagation=="function"?e.stopPropagation():e.srcEvent&&typeof e.srcEvent.stopPropagation=="function"&&e.srcEvent.stopPropagation(),typeof e.stopImmediatePropagation=="function"&&e.stopImmediatePropagation()}function ou(e){function t(u){I(dh,function(l){J.bind(e,l,zu,!0)})}function n(u){setTimeout(function(){I(dh,function(l){J.unbind(e,l,zu,!0)})},500)}J.bind(e,"touchstart",t,!0),J.bind(e,"touchend",n,!0),J.bind(e,"touchcancel",n,!0);var i=new Li.Manager(e,{inputClass:Li.TouchInput,recognizers:[],domEvents:!0}),r=new Li.Tap,o=new Li.Pan({threshold:10}),a=new Li.Press,s=new Li.Pinch,c=new Li.Tap({event:"doubletap",taps:2});return s.requireFailure(o),s.requireFailure(a),i.add([o,a,s,c,r]),i.reset=function(u){var l=this.recognizers,p=this.session;p.stopped||(i.stop(u),setTimeout(function(){var f,h;for(f=0;h=l[f];f++)h.reset(),h.state=8;p.curRecognizer=null},0))},i.on("hammer.input",function(u){u.srcEvent.defaultPrevented&&i.reset(!0)}),i}function cg(e,t,n,i,r){var o=Ma("dragging",e),a=Ma("move",e),s=Ma("contextPad",e),c=Ma("palette",e),u;function l(h,d){return function(g){var y=p(g.target),A=y&&i.get(y);return d&&(g.srcEvent.button=d),r.fire(h,g,A)}}function p(h){var d=Ki(h,"svg, .djs-element",!0);return d}function f(h){u=ou(h);function d(A){var _=0,w=0;function b(M){var C=M.deltaX-_,R=M.deltaY-w;t.scroll({dx:C,dy:R}),_=M.deltaX,w=M.deltaY}function S(M){u.off("panmove",b),u.off("panend",S),u.off("pancancel",S)}u.on("panmove",b),u.on("panend",S),u.on("pancancel",S)}function g(A){var _=p(A.target),w=_&&i.get(_);if(a&&t.getRootElement()!==w)return a.start(A,w,!0);d()}function y(A){var _=t.zoom(),w=A.center;function b(M){var C=1-(1-M.scale)/1.5,R=Math.max(Y2,Math.min(q2,C*_));t.zoom(R,w),zu(M)}function S(M){u.off("pinchmove",b),u.off("pinchend",S),u.off("pinchcancel",S),u.reset(!0)}u.on("pinchmove",b),u.on("pinchend",S),u.on("pinchcancel",S)}u.on("tap",l("element.click")),u.on("doubletap",l("element.dblclick",1)),u.on("panstart",g),u.on("press",g),u.on("pinchstart",y)}o&&n.on("drag.move",function(h){var d=h.originalEvent;if(!(!d||d instanceof MouseEvent)){var g=di(d),y=document.elementFromPoint(g.x,g.y),A=p(y),_=A&&i.get(A);_!==h.hover&&(h.hover&&o.out(h),_&&(o.hover({element:_,gfx:A}),h.hover=_,h.hoverGfx=A))}}),s&&n.on("contextPad.create",function(h){var d=h.pad.html,g=ou(d);g.on("panstart",function(y){s.trigger("dragstart",y,!0)}),g.on("press",function(y){s.trigger("dragstart",y,!0)}),g.on("tap",function(y){s.trigger("click",y)})}),c&&n.on("palette.create",function(h){var d=h.container,g=ou(d);g.on("panstart",function(y){c.trigger("dragstart",y,!0)}),g.on("press",function(y){c.trigger("dragstart",y,!0)}),g.on("tap",function(y){c.trigger("click",y)})}),n.on("canvas.init",function(h){f(h.svg)})}cg.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"];function Wl(e,t){var n=this;t.on("canvas.init",function(i){n.addBBoxMarker(i.svg)})}Wl.$inject=["canvas","eventBus"];Wl.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},n=ae("rect");W(n,{x:-1e4,y:1e4,width:10,height:10}),W(n,t),pe(e,n);var i=ae("rect");W(i,{x:1e4,y:1e4,width:10,height:10}),W(i,t),pe(e,i)};var K2={__depends__:[ko],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",cg],touchFix:["type",Wl]},X2={__depends__:[K2]};function au(e){return e&&e[e.length-1]}function mh(e){return e.y}function vh(e){return e.x}var Z2={left:vh,center:vh,right:function(e){return e.x+e.width},top:mh,middle:mh,bottom:function(e){return e.y+e.height}};function Ir(e,t){this._modeling=e,this._rules=t}Ir.$inject=["modeling","rules"];Ir.prototype._getOrientationDetails=function(e){var t=["top","bottom","middle"],n="x",i="width";return t.indexOf(e)!==-1&&(n="y",i="height"),{axis:n,dimension:i}};Ir.prototype._isType=function(e,t){return t.indexOf(e)!==-1};Ir.prototype._alignmentPosition=function(e,t){var n=this._getOrientationDetails(e),i=n.axis,r=n.dimension,o={},a={},s=!1,c,u,l;function p(f,h){return Math.round((f[i]+h[i]+h[r])/2)}if(this._isType(e,["left","top"]))o[e]=t[0][i];else if(this._isType(e,["right","bottom"]))l=au(t),o[e]=l[i]+l[r];else if(this._isType(e,["center","middle"])){if(I(t,function(f){var h=f[i]+Math.round(f[r]/2);a[h]?a[h].elements.push(f):a[h]={elements:[f],center:h}}),c=sn(a,function(f){return f.elements.length>1&&(s=!0),f.elements.length}),s)return o[e]=au(c).center,o;u=t[0],t=sn(t,function(f){return f[i]+f[r]}),l=au(t),o[e]=p(u,l)}return o};Ir.prototype.trigger=function(e,t){var n=this._modeling,i,r=Ee(e,function(c){return!(c.waypoints||c.host||c.labelTarget)});if(i=this._rules.allowed("elements.align",{elements:r}),be(i)&&(r=i),!(r.length<2||!i)){var o=Z2[t],a=sn(r,o),s=this._alignmentPosition(t,a);n.alignElements(a,s)}};var Q2={__init__:["alignElements"],alignElements:["type",Ir]},gh=".entry",J2=1e3,yh=12;function Nt(e,t,n,i){this._canvas=e,this._eventBus=n,this._overlays=i;var r=rn(t&&t.scale)?t.scale:{min:1,max:1.5};this._overlaysConfig={scale:r},this._current=null,this._init()}Nt.$inject=["canvas","config.contextPad","eventBus","overlays"];Nt.prototype._init=function(){var e=this;this._eventBus.on("selection.changed",function(t){var n=t.newSelection,i=n.length?n.length===1?n[0]:n:null;i?e.open(i,!0):e.close()}),this._eventBus.on("elements.changed",function(t){var n=t.elements,i=e._current;if(!!i){var r=i.target,o=Sn(be(r)?r:[r],function(a){return ug(n,a)});o&&e.open(r,!0)}})};Nt.prototype.registerProvider=function(e,t){t||(t=e,e=J2),this._eventBus.on("contextPad.getProviders",e,function(n){n.providers.push(t)})};Nt.prototype.getEntries=function(e){var t=this._getProviders(),n=be(e)?"getMultiElementContextPadEntries":"getContextPadEntries",i={};return I(t,function(r){if(!!_t(r[n])){var o=r[n](e);_t(o)?i=o(i):I(o,function(a,s){i[s]=a})}}),i};Nt.prototype.trigger=function(e,t,n){var i=this._current.target,r=this._current.entries,o,a,s,c=t.delegateTarget||t.target;if(!c)return t.preventDefault();if(o=r[Ve(c,"data-action")],a=o.action,s=t.originalEvent||t,_t(a)){if(e==="click")return a(s,i,n)}else if(a[e])return a[e](s,i,n);t.preventDefault()};Nt.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))};Nt.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers};Nt.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html,r;I(t,function(o,a){var s=o.group||"default",c=ce(o.html||'<div class="entry" draggable="true"></div>'),u;Ve(c,"data-action",a),u=xe("[data-group="+mi(s)+"]",i),u||(u=ce('<div class="group"></div>'),Ve(u,"data-group",s),i.appendChild(u)),u.appendChild(c),o.className&&ew(c,o.className),o.title&&Ve(c,"title",o.title),o.imageUrl&&(r=ce("<img>"),Ve(r,"src",o.imageUrl),r.style.width="100%",r.style.height="100%",c.appendChild(r))}),re(i).add("open"),this._current={target:e,entries:t,pad:n},this._eventBus.fire("contextPad.open",{current:this._current})};Nt.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=ce('<div class="djs-context-pad"></div>'),r=this._getPosition(e),o=O({html:i},this._overlaysConfig,r);bt.bind(i,gh,"click",function(c){t.trigger("click",c)}),bt.bind(i,gh,"dragstart",function(c){t.trigger("dragstart",c)}),J.bind(i,"mousedown",function(c){c.stopPropagation()});var a=this._canvas.getRootElement();this._overlayId=n.add(a,"context-pad",o);var s=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{target:e,pad:s}),s};Nt.prototype.close=function(){!this.isOpen()||(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)};Nt.prototype.isOpen=function(e){var t=this._current;if(!t)return!1;if(!e)return!0;var n=t.target;return be(e)!==be(n)?!1:be(e)?e.length===n.length&&gi(e,function(i){return ug(n,i)}):n===e};Nt.prototype._getPosition=function(e){var t=be(e)?e:[e],n=Je(t);return{position:{left:n.x+n.width+yh,top:n.y-yh/2}}};function ew(e,t){var n=re(e);t=be(t)?t:t.split(/\s+/g),t.forEach(function(i){n.add(i)})}function ug(e,t){return e.indexOf(t)!==-1}var lg={__depends__:[ko,Ys],contextPad:["type",Nt]},pg="data-id",fg=["contextPad.close","canvas.viewbox.changing","commandStack.changed"],tw=1e3;function Ze(e,t,n){var i=rn(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},this._eventBus=t,this._canvas=n,this._providers={},this._current={}}Ze.$inject=["config.popupMenu","eventBus","canvas"];Ze.prototype.registerProvider=function(e,t,n){n||(n=t,t=tw),this._eventBus.on("popupMenu.getProviders."+e,t,function(i){i.providers.push(n)})};Ze.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");if(!t)throw new Error("providerId parameter is missing");var n=this._getProviders(t);if(!n)return!0;var i=this._getEntries(e,n),r=this._getHeaderEntries(e,n),o=yo(i)>0,a=r&&yo(r)>0;return!o&&!a};Ze.prototype.open=function(e,t,n){var i=this._getProviders(t);if(!e)throw new Error("Element is missing");if(!i||!i.length)throw new Error("No registered providers for: "+t);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var r=this._current={className:t,element:e,position:n},o=this._getEntries(e,i),a=this._getHeaderEntries(e,i);r.entries=O({},o,a),r.container=this._createContainer(t),yo(a)&&r.container.appendChild(this._createEntries(a,"djs-popup-header")),yo(o)&&r.container.appendChild(this._createEntries(o,"djs-popup-body"));var s=this._canvas,c=s.getContainer();this._attachContainer(r.container,c,n.cursor),this._bindAutoClose()};Ze.prototype.close=function(){!this.isOpen()||(this._emit("close"),this._unbindAutoClose(),wn(this._current.container),this._current.container=null)};Ze.prototype.isOpen=function(){return!!this._current.container};Ze.prototype.trigger=function(e){e.preventDefault();var t=e.delegateTarget||e.target,n=Ve(t,pg),i=this._getEntry(n);if(i.action)return i.action.call(null,e,i)};Ze.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers};Ze.prototype._getEntries=function(e,t){var n={};return I(t,function(i){if(!i.getPopupMenuEntries){I(i.getEntries(e),function(o){var a=o.id;if(!a)throw new Error("every entry must have the id property set");n[a]=Gn(o,["id"])});return}var r=i.getPopupMenuEntries(e);_t(r)?n=r(n):I(r,function(o,a){n[a]=o})}),n};Ze.prototype._getHeaderEntries=function(e,t){var n={};return I(t,function(i){if(!i.getPopupMenuHeaderEntries){if(!i.getHeaderEntries)return;I(i.getHeaderEntries(e),function(o){var a=o.id;if(!a)throw new Error("every entry must have the id property set");n[a]=Gn(o,["id"])});return}var r=i.getPopupMenuHeaderEntries(e);_t(r)?n=r(n):I(r,function(o,a){n[a]=o})}),n};Ze.prototype._getEntry=function(e){var t=this._current.entries[e];if(!t)throw new Error("entry not found");return t};Ze.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)};Ze.prototype._createContainer=function(e){var t=ce('<div class="djs-popup">'),n=this._current.position,i=this._current.className;return qe(t,{position:"absolute",left:n.x+"px",top:n.y+"px",visibility:"hidden"}),re(t).add(i),Ve(t,"data-popup",e),t};Ze.prototype._attachContainer=function(e,t,n){var i=this;bt.bind(e,".entry","click",function(r){i.trigger(r)}),this._updateScale(e),t.appendChild(e),n&&this._assureIsInbounds(e,n),qe(e,{visibility:"visible"})};Ze.prototype._updateScale=function(e){var t=this._canvas.zoom(),n=this._config.scale,i,r,o=t;n!==!0&&(n===!1?(i=1,r=1):(i=n.min,r=n.max),rn(i)&&t<i&&(o=i),rn(r)&&t>r&&(o=r)),nw(e,"scale("+o+")")};Ze.prototype._assureIsInbounds=function(e,t){var n=this._canvas,i=n._container.getBoundingClientRect(),r=e.offsetLeft,o=e.offsetTop,a=e.scrollWidth,s=e.scrollHeight,c={},u,l,p={x:t.x-i.left,y:t.y-i.top};r+a>i.width&&(c.x=!0),o+s>i.height&&(c.y=!0),c.x&&c.y?(u=p.x-a+"px",l=p.y-s+"px"):c.x?(u=p.x-a+"px",l=p.y+"px"):c.y&&p.y<s?(u=p.x+"px",l=10+"px"):c.y&&(u=p.x+"px",l=p.y-s+"px"),qe(e,{left:u,top:l},{zIndex:1e3})};Ze.prototype._createEntries=function(e,t){var n=ce("<div>"),i=this;return re(n).add(t),I(e,function(r,o){var a=i._createEntry(r,o),s=r.group||"default",c=xe("[data-group="+mi(s)+"]",n);c||(c=ce('<div class="group"></div>'),Ve(c,"data-group",s),n.appendChild(c)),c.appendChild(a)}),n};Ze.prototype._createEntry=function(e,t){var n=ce("<div>"),i=re(n);if(i.add("entry"),e.className&&e.className.split(" ").forEach(function(a){i.add(a)}),Ve(n,pg,t),e.label){var r=ce("<span>");r.textContent=e.label,n.appendChild(r)}if(e.imageUrl){var o=ce("<img>");Ve(o,"src",e.imageUrl),n.appendChild(o)}return e.active===!0&&i.add("active"),e.disabled===!0&&i.add("disabled"),e.title&&(n.title=e.title),n};Ze.prototype._bindAutoClose=function(){this._eventBus.once(fg,this.close,this)};Ze.prototype._unbindAutoClose=function(){this._eventBus.off(fg,this.close,this)};function nw(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}var Ul={__init__:["popupMenu"],popupMenu:["type",Ze]},iw={align:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%202000%202000%22%3E%3Cpath%20style%3D%22stroke%3AcurrentColor%3Bstroke-width%3A100%3Bstroke-linecap%3Around%22%20d%3D%22M200%20150v1700%22%2F%3E%3Crect%20x%3D%22500%22%20y%3D%22150%22%20width%3D%221300%22%20height%3D%22700%22%20rx%3D%221%22%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%22%2F%3E%3Crect%20x%3D%22500%22%20y%3D%221150%22%20width%3D%22700%22%20height%3D%22700%22%20rx%3D%221%22%20style%3D%22fill%3AcurrentColor%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bopacity%3A.5%22%2F%3E%3C%2Fsvg%3E",bottom:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201800%201800%22%3E%3Cpath%20style%3D%22stroke%3AcurrentColor%3Bstroke-width%3A100%3Bstroke-linecap%3Around%22%20d%3D%22M150%201650h1500%22%2F%3E%3Crect%20x%3D%22150%22%20y%3D%22350%22%20width%3D%22600%22%20height%3D%221300%22%20rx%3D%221%22%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%22%2F%3E%3Crect%20x%3D%221050%22%20y%3D%22850%22%20width%3D%22600%22%20height%3D%22800%22%20rx%3D%221%22%20style%3D%22fill%3AcurrentColor%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bopacity%3A.5%22%2F%3E%3C%2Fsvg%3E",center:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201800%201800%22%3E%3Cpath%20style%3D%22stroke%3AcurrentColor%3Bstroke-width%3A100%3Bstroke-linecap%3Around%22%20d%3D%22M900%20150v1500%22%2F%3E%3Crect%20x%3D%22250%22%20y%3D%22150%22%20width%3D%221300%22%20height%3D%22600%22%20rx%3D%221%22%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%22%2F%3E%3Crect%20x%3D%22500%22%20y%3D%221050%22%20width%3D%22800%22%20height%3D%22600%22%20rx%3D%221%22%20style%3D%22fill%3AcurrentColor%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bopacity%3A.5%22%2F%3E%3C%2Fsvg%3E",left:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201800%201800%22%3E%3Cpath%20style%3D%22stroke%3AcurrentColor%3Bstroke-width%3A100%3Bstroke-linecap%3Around%22%20d%3D%22M100%20150v1500%22%2F%3E%3Crect%20x%3D%22100%22%20y%3D%22150%22%20width%3D%221300%22%20height%3D%22600%22%20rx%3D%221%22%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%22%2F%3E%3Crect%20x%3D%22100%22%20y%3D%221050%22%20width%3D%22800%22%20height%3D%22600%22%20rx%3D%221%22%20style%3D%22fill%3AcurrentColor%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bopacity%3A.5%22%2F%3E%3C%2Fsvg%3E",right:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201800%201800%22%3E%3Cpath%20style%3D%22stroke%3AcurrentColor%3Bstroke-width%3A100%3Bstroke-linecap%3Around%22%20d%3D%22M1650%20150v1500%22%2F%3E%3Crect%20x%3D%22350%22%20y%3D%22150%22%20width%3D%221300%22%20height%3D%22600%22%20rx%3D%221%22%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%22%2F%3E%3Crect%20x%3D%22850%22%20y%3D%221050%22%20width%3D%22800%22%20height%3D%22600%22%20rx%3D%221%22%20style%3D%22fill%3AcurrentColor%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bopacity%3A.5%22%2F%3E%3C%2Fsvg%3E",top:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201800%201800%22%3E%3Cpath%20style%3D%22stroke%3AcurrentColor%3Bstroke-width%3A100%3Bstroke-linecap%3Around%22%20d%3D%22M150%20150h1500%22%2F%3E%3Crect%20x%3D%22150%22%20y%3D%22150%22%20width%3D%22600%22%20height%3D%221300%22%20rx%3D%221%22%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%22%2F%3E%3Crect%20x%3D%221050%22%20y%3D%22150%22%20width%3D%22600%22%20height%3D%22800%22%20rx%3D%221%22%20style%3D%22fill%3AcurrentColor%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bopacity%3A.5%22%2F%3E%3C%2Fsvg%3E",middle:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201800%201800%22%3E%3Cpath%20style%3D%22stroke%3AcurrentColor%3Bstroke-width%3A100%3Bstroke-linecap%3Around%22%20d%3D%22M150%20900h1500%22%2F%3E%3Crect%20x%3D%22150%22%20y%3D%22250%22%20width%3D%22600%22%20height%3D%221300%22%20rx%3D%221%22%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%22%2F%3E%3Crect%20x%3D%221050%22%20y%3D%22500%22%20width%3D%22600%22%20height%3D%22800%22%20rx%3D%221%22%20style%3D%22fill%3AcurrentColor%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bopacity%3A.5%22%2F%3E%3C%2Fsvg%3E"},hg=iw,rw=900;function Fr(e,t,n,i){e.registerProvider(rw,this),this._contextPad=e,this._popupMenu=t,this._translate=n,this._canvas=i}Fr.$inject=["contextPad","popupMenu","translate","canvas"];Fr.prototype.getMultiElementContextPadEntries=function(e){var t={};return this._isAllowed(e)&&O(t,this._getEntries(e)),t};Fr.prototype._isAllowed=function(e){return!this._popupMenu.isEmpty(e,"align-elements")};Fr.prototype._getEntries=function(e){var t=this;return{"align-elements":{group:"align-elements",title:t._translate("Align elements"),imageUrl:hg.align,action:{click:function(n,i){var r=t._getMenuPosition(i);O(r,{cursor:{x:n.x,y:n.y}}),t._popupMenu.open(i,"align-elements",r)}}}}};Fr.prototype._getMenuPosition=function(e){var t=5,n=this._canvas.getContainer(),i=this._contextPad.getPad(e).html,r=n.getBoundingClientRect(),o=i.getBoundingClientRect(),a=o.top-r.top,s=o.left-r.left,c={x:s,y:a+o.height+t};return c};var ow=["left","center","right","top","middle","bottom"];function No(e,t,n,i){this._alignElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",this)}No.$inject=["popupMenu","alignElements","translate","rules"];No.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&O(t,this._getEntries(e)),t};No.prototype._isAllowed=function(e){return this._rules.allowed("elements.align",{elements:e})};No.prototype._getEntries=function(e){var t=this._alignElements,n=this._translate,i=this._popupMenu,r={};return I(ow,function(o){r["align-elements-"+o]={group:"align",title:n("Align elements "+o),className:"bjs-align-elements-menu-entry",imageUrl:hg[o],action:function(a,s){t.trigger(e,o),i.close()}}}),r};function Ut(e){K.call(this,e),this.init()}Ut.$inject=["eventBus"];oe(Ut,K);Ut.prototype.addRule=function(e,t,n){var i=this;typeof e=="string"&&(e=[e]),e.forEach(function(r){i.canExecute(r,t,function(o,a,s){return n(o)},!0)})};Ut.prototype.init=function(){};function Xs(e){Ut.call(this,e)}Xs.$inject=["eventBus"];oe(Xs,Ut);Xs.prototype.init=function(){this.addRule("elements.align",function(e){var t=e.elements,n=Ee(t,function(i){return!(i.waypoints||i.host||i.labelTarget)});return n=Bs(n),n.length<2?!1:n})};var aw={__depends__:[Q2,lg,Ul],__init__:["alignElementsContextPadProvider","alignElementsMenuProvider","bpmnAlignElements"],alignElementsContextPadProvider:["type",Fr],alignElementsMenuProvider:["type",No],bpmnAlignElements:["type",Xs]},sw=10,dg=50,cw=250;function Yl(e,t,n,i){for(var r;r=uw(e,n,t);)n=i(t,n,r);return n}function ql(e){return function(t,n,i){var r={x:n.x,y:n.y};return["x","y"].forEach(function(o){var a=e[o];if(!!a){var s=o==="x"?"width":"height",c=a.margin,u=a.minDistance;c<0?r[o]=Math.min(i[o]+c-t[s]/2,n[o]-u+c):r[o]=Math.max(i[o]+i[s]+c+t[s]/2,n[o]+u+c)}}),r}}function uw(e,t,n){var i={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height},r=pw(e);return Me(r,function(o){if(o===n)return!1;var a=pt(o,i,sw);return a==="intersect"})}function lw(e,t){t||(t={});function n(d){return d.source===e?1:-1}var i=t.defaultDistance||dg,r=t.direction||"e",o=t.filter,a=t.getWeight||n,s=t.maxDistance||cw,c=t.reference||"start";o||(o=dw);function u(d,g){return r==="n"?c==="start"?le(d).top-le(g).bottom:c==="center"?le(d).top-ye(g).y:le(d).top-le(g).top:r==="w"?c==="start"?le(d).left-le(g).right:c==="center"?le(d).left-ye(g).x:le(d).left-le(g).left:r==="s"?c==="start"?le(g).top-le(d).bottom:c==="center"?ye(g).y-le(d).bottom:le(g).bottom-le(d).bottom:c==="start"?le(g).left-le(d).right:c==="center"?ye(g).x-le(d).right:le(g).right-le(d).right}var l=e.incoming.filter(o).map(function(d){var g=a(d),y=g<0?u(d.source,e):u(e,d.source);return{id:d.source.id,distance:y,weight:g}}),p=e.outgoing.filter(o).map(function(d){var g=a(d),y=g>0?u(e,d.target):u(d.target,e);return{id:d.target.id,distance:y,weight:g}}),f=l.concat(p).reduce(function(d,g){return d[g.id+"__weight_"+g.weight]=g,d},{}),h=Rt(f,function(d,g){var y=g.distance,A=g.weight;return y<0||y>s||(d[String(y)]||(d[String(y)]=0),d[String(y)]+=1*A,(!d.distance||d[d.distance]<d[String(y)])&&(d.distance=y)),d},{});return h.distance||i}function pw(e){var t=su(e);return e.host&&(t=t.concat(su(e.host))),e.attachers&&(t=t.concat(e.attachers.reduce(function(n,i){return n.concat(su(i))},[]))),t}function su(e){return hw(e).concat(fw(e))}function fw(e){return e.incoming.map(function(t){return t.source})}function hw(e){return e.outgoing.map(function(t){return t.target})}function dw(){return!0}var mw=100;function mg(e,t,n){e.on("autoPlace",mw,function(i){var r=i.shape,o=i.source;return vw(o,r)}),e.on("autoPlace.end",function(i){n.scrollToElement(i.shape)}),this.append=function(i,r,o){e.fire("autoPlace.start",{source:i,shape:r});var a=e.fire("autoPlace",{source:i,shape:r}),s=t.appendShape(i,r,a,i.parent,o);return e.fire("autoPlace.end",{source:i,shape:s}),s}}mg.$inject=["eventBus","modeling","canvas"];function vw(e,t,n){n||(n={});var i=n.defaultDistance||dg,r=ye(e),o=le(e);return{x:o.right+i+t.width/2,y:r.y}}function vg(e,t){e.on("autoPlace.end",500,function(n){t.select(n.shape)})}vg.$inject=["eventBus","selection"];var gw={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",mg],autoPlaceSelectionBehavior:["type",vg]};function _s(e,t){for(typeof t=="string"&&(t=[t]);e=e.parent;)if(De(e,t))return e;return null}function gg(e,t){if(v(t,"bpmn:TextAnnotation"))return _w(e,t);if(De(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"]))return bw(e,t);if(v(t,"bpmn:FlowNode"))return yw(e,t)}function yw(e,t){var n=le(e),i=ye(e),r=lw(e,{filter:function(l){return v(l,"bpmn:SequenceFlow")}}),o=30,a=80,s="left";v(e,"bpmn:BoundaryEvent")&&(s=pt(e,e.host,-25),s.indexOf("top")!==-1&&(o*=-1));var c={x:n.right+r+t.width/2,y:i.y+Ew(s,a)},u={y:{margin:o,minDistance:a}};return Yl(e,t,c,ql(u))}function Ew(e,t){return e.indexOf("top")!=-1?-1*t:e.indexOf("bottom")!=-1?t:0}function _w(e,t){var n=le(e),i={x:n.right+t.width/2,y:n.top-50-t.height/2};xw(e)&&(i=ye(e),i.x+=100,i.y-=50);var r={y:{margin:-30,minDistance:20}};return Yl(e,t,i,ql(r))}function bw(e,t){var n=le(e),i={x:n.right-10+t.width/2,y:n.bottom+40+t.width/2},r={x:{margin:30,minDistance:30}};return Yl(e,t,i,ql(r))}function xw(e){return!!e.waypoints}function yg(e){e.on("autoPlace",function(t){var n=t.shape,i=t.source;return gg(i,n)})}yg.$inject=["eventBus"];var ww={__depends__:[gw],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",yg]};function qn(e,t,n,i){K.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var r=this;this.postExecuted(["shape.create"],function(o){var a=o.context,s=a.hints||{},c=a.shape,u=a.parent||a.newParent;s.autoResize!==!1&&r._expand([c],u)}),this.postExecuted(["elements.move"],function(o){var a=o.context,s=hs(ml(a.closure.topLevel)),c=a.hints,u=c?c.autoResize:!0;if(u!==!1){var l=qi(s,function(p){return p.parent.id});I(l,function(p,f){be(u)&&(p=p.filter(function(h){return Me(u,on({id:h.id}))})),r._expand(p,f)})}}),this.postExecuted(["shape.toggleCollapse"],function(o){var a=o.context,s=a.hints,c=a.shape;s&&s.autoResize===!1||c.collapsed||r._expand(c.children||[],c)}),this.postExecuted(["shape.resize"],function(o){var a=o.context,s=a.hints,c=a.shape,u=c.parent;s&&s.autoResize===!1||u&&r._expand([c],u)})}qn.$inject=["eventBus","elementRegistry","modeling","rules"];oe(qn,K);qn.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),r=le(Je(e)),o=le(t),a={};return r.top-o.top<i.top&&(a.top=r.top-n.top),r.left-o.left<i.left&&(a.left=r.left-n.left),o.right-r.right<i.right&&(a.right=r.right+n.right),o.bottom-r.bottom<i.bottom&&(a.bottom=r.bottom+n.bottom),Is(O({},o,a))};qn.prototype._expand=function(e,t){typeof t=="string"&&(t=this._elementRegistry.get(t));var n=this._rules.allowed("element.autoResize",{elements:e,target:t});if(!!n){var i=this._getOptimalBounds(e,t);if(!!Sw(i,t)){var r=Cw(cn(t,["x","y","width","height"]),i);this.resize(t,i,{autoResize:r});var o=t.parent;o&&this._expand([t],o)}}};qn.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}};qn.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}};qn.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)};function Sw(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function Cw(e,t){var n="";return e=le(e),t=le(t),e.top>t.top&&(n=n.concat("n")),e.right<t.right&&(n=n.concat("w")),e.bottom<t.bottom&&(n=n.concat("s")),e.left>t.left&&(n=n.concat("e")),n}function Zs(e){e.invoke(qn,this)}Zs.$inject=["injector"];oe(Zs,qn);Zs.prototype.resize=function(e,t,n){v(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)};function Lo(e){Ut.call(this,e);var t=this;this.addRule("element.autoResize",function(n){return t.canResize(n.elements,n.target)})}Lo.$inject=["eventBus"];oe(Lo,Ut);Lo.prototype.canResize=function(e,t){return!1};function Qs(e,t){Lo.call(this,e),this._modeling=t}oe(Qs,Lo);Qs.$inject=["eventBus","modeling"];Qs.prototype.canResize=function(e,t){if(v(t.di,"bpmndi:BPMNPlane")||!v(t,"bpmn:Participant")&&!v(t,"bpmn:Lane")&&!v(t,"bpmn:SubProcess"))return!1;var n=!0;return I(e,function(i){if(v(i,"bpmn:Lane")||i.labelTarget){n=!1;return}}),n};var Tw={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",Zs],bpmnAutoResizeProvider:["type",Qs]},Eh=1500;function Eg(e,t,n){var i=this,r=n.get("dragging",!1);function o(a){if(!a.hover){var s=a.originalEvent,c=i._findTargetGfx(s),u=c&&e.get(c);c&&u&&(a.stopPropagation(),r.hover({element:u,gfx:c}),r.move(s))}}r&&t.on("drag.start",function(a){t.once("drag.move",Eh,function(s){o(s)})}),function(){var a,s;t.on("element.hover",function(c){a=c.gfx,s=c.element}),t.on("element.hover",Eh,function(c){s&&t.fire("element.out",{element:s,gfx:a})}),t.on("element.out",function(){a=null,s=null})}(),this._findTargetGfx=function(a){var s,c;if(a instanceof MouseEvent)return s=di(a),c=document.elementFromPoint(s.x,s.y),Aw(c)}}Eg.$inject=["elementRegistry","eventBus","injector"];function Aw(e){return Ki(e,"svg, .djs-element",!0)}var Rw={__init__:["hoverFix"],hoverFix:["type",Eg]},dr=Math.round,_h="djs-drag-active";function $i(e){e.preventDefault()}function Pw(e){return typeof TouchEvent!="undefined"&&e instanceof TouchEvent}function Dw(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function _g(e,t,n,i){var r={threshold:5,trapClick:!0},o;function a(w){var b=t.viewbox(),S=t._container.getBoundingClientRect();return{x:b.x+(w.x-S.left)/b.scale,y:b.y+(w.y-S.top)/b.scale}}function s(w,b){b=b||o;var S=e.createEvent(O({},b.payload,b.data,{isTouch:b.isTouch}));return e.fire("drag."+w,S)===!1?!1:e.fire(b.prefix+"."+w,S)}function c(w){var b=w.filter(function(S){return i.get(S.id)});b.length&&n.select(b)}function u(w,b){var S=o.payload,M=o.displacement,C=o.globalStart,R=di(w),D=an(R,C),F=o.localStart,j=a(R),z=an(j,F);if(!o.active&&(b||Dw(D)>o.threshold)){if(O(S,{x:dr(F.x+M.x),y:dr(F.y+M.y),dx:0,dy:0},{originalEvent:w}),s("start")===!1)return y();o.active=!0,o.keepSelection||(S.previousSelection=n.get(),n.select(null)),o.cursor&&Ks(o.cursor),t.addMarker(t.getRootElement(),_h)}iu(w),o.active&&(O(S,{x:dr(j.x+M.x),y:dr(j.y+M.y),dx:dr(z.x),dy:dr(z.y)},{originalEvent:w}),s("move"))}function l(w){var b,S=!0;o.active&&(w&&(o.payload.originalEvent=w,iu(w)),S=s("end")),S===!1&&s("rejected"),b=A(S!==!0),s("ended",b)}function p(w){w.which===27&&($i(w),y())}function f(w){var b;o.active&&(b=ig(e),setTimeout(b,400),$i(w)),l(w)}function h(w){u(w)}function d(w){var b=o.payload;b.hoverGfx=w.gfx,b.hover=w.element,s("hover")}function g(w){s("out");var b=o.payload;b.hoverGfx=null,b.hover=null}function y(w){var b;if(!!o){var S=o.active;S&&s("cancel"),b=A(w),S&&s("canceled",b)}}function A(w){var b,S;s("cleanup"),ng(),o.trapClick?S=f:S=l,J.unbind(document,"mousemove",u),J.unbind(document,"dragstart",$i),J.unbind(document,"selectstart",$i),J.unbind(document,"mousedown",S,!0),J.unbind(document,"mouseup",S,!0),J.unbind(document,"keyup",p),J.unbind(document,"touchstart",h,!0),J.unbind(document,"touchcancel",y,!0),J.unbind(document,"touchmove",u,!0),J.unbind(document,"touchend",l,!0),e.off("element.hover",d),e.off("element.out",g),t.removeMarker(t.getRootElement(),_h);var M=o.payload.previousSelection;return w!==!1&&M&&!n.get().length&&c(M),b=o,o=null,b}function _(w,b,S,M){o&&y(!1),typeof b=="string"&&(M=S,S=b,b=null),M=O({},r,M||{});var C=M.data||{},R,D,F,j,z;M.trapClick?j=f:j=l,w?(R=Dr(w)||w,D=di(w),iu(w),R.type==="dragstart"&&$i(R)):(R=null,D={x:0,y:0}),F=a(D),b||(b=F),z=Pw(R),o=O({prefix:S,data:C,payload:{},globalStart:D,displacement:an(b,F),localStart:F,isTouch:z},M),M.manual||(z?(J.bind(document,"touchstart",h,!0),J.bind(document,"touchcancel",y,!0),J.bind(document,"touchmove",u,!0),J.bind(document,"touchend",l,!0)):(J.bind(document,"mousemove",u),J.bind(document,"dragstart",$i),J.bind(document,"selectstart",$i),J.bind(document,"mousedown",j,!0),J.bind(document,"mouseup",j,!0)),J.bind(document,"keyup",p),e.on("element.hover",d),e.on("element.out",g)),s("init"),M.autoActivate&&u(w,!0)}e.on("diagram.destroy",y),this.init=_,this.move=u,this.hover=d,this.out=g,this.end=l,this.cancel=y,this.context=function(){return o},this.setOptions=function(w){O(r,w)}}_g.$inject=["eventBus","canvas","selection","elementRegistry"];var Kn={__depends__:[Rw,Cn],dragging:["type",_g]};function Or(e,t,n){this._canvas=n,this._opts=O({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(r){var o=i._toBorderPoint(r);i.startScroll(o)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}Or.$inject=["config.autoScroll","eventBus","canvas"];Or.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,r=t.getContainer().getBoundingClientRect(),o=[e.x,e.y,r.width-e.x,r.height-e.y];this.stopScroll();for(var a=0,s=0,c=0;c<4;c++)Mw(o[c],n.scrollThresholdOut[c],n.scrollThresholdIn[c])&&(c===0?a=n.scrollStep:c==1?s=n.scrollStep:c==2?a=-n.scrollStep:c==3&&(s=-n.scrollStep));(a!==0||s!==0)&&(t.scroll({dx:a,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))};function Mw(e,t,n){return t<e&&e<n}Or.prototype.stopScroll=function(){clearTimeout(this._scrolling)};Or.prototype.setOptions=function(e){this._opts=O({},this._opts,e)};Or.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=di(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};var Bw={__depends__:[Kn],__init__:["autoScroll"],autoScroll:["type",Or]};function Kl(e){this._commandStack=e.get("commandStack",!1)}Kl.$inject=["injector"];Kl.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),n===void 0?!0:n};var An={__init__:["rules"],rules:["type",Kl]},Ba=Math.round,Iw=Math.max;function Fw(e,t){var n=e.x,i=e.y;return[["M",n,i],["m",0,-t],["a",t,t,0,1,1,0,2*t],["a",t,t,0,1,1,0,-2*t],["z"]]}function Ow(e){var t=[];return e.forEach(function(n,i){t.push([i===0?"M":"L",n.x,n.y])}),t}var bg=10;function kw(e,t){var n,i;for(n=0;i=e[n];n++)if(Po(i,t)<=bg)return{point:e[n],bendpoint:!0,index:n};return null}function Nw(e,t){var n=nv(Fw(t,bg),Ow(e)),i=n[0],r=n[n.length-1],o;return i?i!==r?i.segment2!==r.segment2?(o=Iw(i.segment2,r.segment2)-1,{point:e[o],bendpoint:!0,index:o}):{point:{x:Ba(i.x+r.x)/2,y:Ba(i.y+r.y)/2},index:i.segment2}:{point:{x:Ba(i.x),y:Ba(i.y)},index:i.segment2}:null}function Gu(e,t){return kw(e,t)||Nw(e,t)}function xg(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function bh(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function Lw(e,t){return t?{x:Math.cos(t)*e.x-Math.sin(t)*e.y,y:Math.sin(t)*e.x+Math.cos(t)*e.y}:e}function $w(e,t,n){var i=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}],r=i[0].n*t[0]+i[1].n*t[1],o=i[0].lambda*t[0]+i[1].lambda*t[1];return-r/o}function Xl(e,t){var n=t[0],i=t[1],r={x:i.x-n.x,y:i.y-n.y},o=$w([n.x,n.y],[r.x,r.y],[e.x,e.y]);return{x:n.x+o*r.x,y:n.y+o*r.y}}function wg(e,t){var n=Xl(e,t),i={x:n.x-e.x,y:n.y-e.y};return xg(i)}function bs(e,t){return xg({x:e.x-t.x,y:e.y-t.y})}var Sg="djs-bendpoint",Cg="djs-segment-dragger";function jw(e,t){var n=di(t),i=e._container.getBoundingClientRect(),r;r={x:i.left,y:i.top};var o=e.viewbox();return{x:o.x+(n.x-r.x)/o.scale,y:o.y+(n.y-r.y)/o.scale}}function Vu(e,t,n){var i=jw(e,n),r=Gu(t,i);return r}function Wu(e,t){var n=ae("g");Se(n).add(Sg),pe(e,n);var i=ae("circle");W(i,{cx:0,cy:0,r:4}),Se(i).add("djs-visual"),pe(n,i);var r=ae("circle");return W(r,{cx:0,cy:0,r:10}),Se(r).add("djs-hit"),pe(n,r),t&&Se(n).add(t),n}function Hw(e,t,n,i){var r=ae("g");pe(e,r);var o=18,a=6,s=11,c=Gw(t,n,i),u=a+s,l=ae("rect");W(l,{x:-o/2,y:-a/2,width:o,height:a}),Se(l).add("djs-visual"),pe(r,l);var p=ae("rect");return W(p,{x:-c/2,y:-u/2,width:c,height:u}),Se(p).add("djs-hit"),pe(r,p),vv(r,i==="v"?90:0),r}function Tg(e,t,n){var i=ae("g"),r=Ou(t,n),o=Ln(t,n);return pe(e,i),Hw(i,t,n,o),Se(i).add(Cg),Se(i).add(o==="h"?"horizontal":"vertical"),At(i,r.x,r.y),i}function Uu(e){return Math.abs(Math.round(e*2/3))}function zw(e,t){var n=Vw(e,t);return Xl(e,n)}function Gw(e,t,n){var i=t.x-e.x,r=t.y-e.y;return Uu(n==="h"?i:r)}function Vw(e,t){for(var n=t.waypoints,i=1/0,r,o=0;o<n.length-1;o++){var a=n[o],s=n[o+1],c=wg(e,[a,s]);c<i&&(i=c,r=o)}return[n[r],n[r+1]]}function Ag(e,t,n,i,r){function o(w,b,S){var M=w.index,C=w.point,R,D,F,j,z,G;return M<=0||w.bendpoint?!1:(R=b[M-1],D=b[M],F=Ou(R,D),j=Ln(R,D),z=Math.abs(C.x-F.x),G=Math.abs(C.y-F.y),j&&z<=S&&G<=S)}function a(w,b){var S=w.waypoints,M,C,R,D;return b.index<=0||b.bendpoint||(M={start:S[b.index-1],end:S[b.index]},C=Ln(M.start,M.end),!C)?null:(C==="h"?R=M.end.x-M.start.x:R=M.end.y-M.start.y,D=Uu(R)/2,D)}function s(w,b){var S=b.waypoints,M=Vu(t,S,w),C;if(!!M)return C=a(b,M),o(M,S,C)?r.start(w,b,M.index):i.start(w,b,M.index,!M.bendpoint),!0}function c(w,b,S){J.bind(w,b,function(M){n.triggerMouseEvent(b,M,S),M.stopPropagation()})}function u(w,b){var S=t.getLayer("overlays"),M=xe('.djs-bendpoints[data-element-id="'+mi(w.id)+'"]',S);return!M&&b&&(M=ae("g"),W(M,{"data-element-id":w.id}),Se(M).add("djs-bendpoints"),pe(S,M),c(M,"mousedown",w),c(M,"click",w),c(M,"dblclick",w)),M}function l(w,b){return xe('.djs-segment-dragger[data-segment-idx="'+w+'"]',b)}function p(w,b){b.waypoints.forEach(function(S,M){var C=Wu(w);pe(w,C),At(C,S.x,S.y)}),Wu(w,"floating")}function f(w,b){for(var S=b.waypoints,M,C,R,D=1;D<S.length;D++)M=S[D-1],C=S[D],Ln(M,C)&&(R=Tg(w,M,C),W(R,{"data-segment-idx":D}),c(R,"mousemove",b))}function h(w){I(zn("."+Sg,w),function(b){Le(b)})}function d(w){I(zn("."+Cg,w),function(b){Le(b)})}function g(w){var b=u(w);return b||(b=u(w,!0),p(b,w),f(b,w)),b}function y(w){var b=u(w);b&&(d(b),h(b),f(b,w),p(b,w))}function A(w,b){var S=xe(".floating",w),M=b.point;!S||At(S,M.x,M.y)}function _(w,b,S){var M=l(b.index,w),C=S[b.index-1],R=S[b.index],D=b.point,F=Ou(C,R),j=Ln(C,R),z,G;!M||(z=Ww(M),G={x:D.x-F.x,y:D.y-F.y},j==="v"&&(G={x:G.y,y:G.x}),At(z,G.x,G.y))}e.on("connection.changed",function(w){y(w.element)}),e.on("connection.remove",function(w){var b=u(w.element);b&&Le(b)}),e.on("element.marker.update",function(w){var b=w.element,S;!b.waypoints||(S=g(b),w.add?Se(S).add(w.marker):Se(S).remove(w.marker))}),e.on("element.mousemove",function(w){var b=w.element,S=b.waypoints,M,C;if(S){if(M=u(b,!0),C=Vu(t,S,w.originalEvent),!C)return;A(M,C),C.bendpoint||_(M,C,S)}}),e.on("element.mousedown",function(w){if(!!_i(w)){var b=w.originalEvent,S=w.element;if(!!S.waypoints)return s(b,S)}}),e.on("selection.changed",function(w){var b=w.newSelection,S=b[0];S&&S.waypoints&&g(S)}),e.on("element.hover",function(w){var b=w.element;b.waypoints&&(g(b),n.registerEvent(w.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(w){n.unregisterEvent(w.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(w){var b=w.element,S=w.newId;if(b.waypoints){var M=u(b);M&&W(M,{"data-element-id":S})}}),this.addHandles=g,this.updateHandles=y,this.getBendpointsContainer=u,this.getSegmentDragger=l}Ag.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];function Ww(e){return xe(".djs-visual",e)}var xh=Math.round,zi="reconnectStart",Gi="reconnectEnd",Qr="updateWaypoints";function Zl(e,t,n,i,r,o){this._injector=e,this.start=function(a,s,c,u){var l=n.getGraphics(s),p=s.source,f=s.target,h=s.waypoints,d;!u&&c===0?d=zi:!u&&c===h.length-1?d=Gi:d=Qr;var g=d===Qr?"connection.updateWaypoints":"connection.reconnect",y=r.allowed(g,{connection:s,source:p,target:f});y===!1&&(y=r.allowed(g,{connection:s,source:f,target:p})),y!==!1&&i.init(a,"bendpoint.move",{data:{connection:s,connectionGfx:l,context:{allowed:y,bendpointIndex:c,connection:s,source:p,target:f,insert:u,type:d}}})},t.on("bendpoint.move.hover",function(a){var s=a.context,c=s.connection,u=c.source,l=c.target,p=a.hover,f=s.type;s.hover=p;var h;if(!!p){var d=f===Qr?"connection.updateWaypoints":"connection.reconnect";if(h=s.allowed=r.allowed(d,{connection:c,source:f===zi?p:u,target:f===Gi?p:l}),h){s.source=f===zi?p:u,s.target=f===Gi?p:l;return}h===!1&&(h=s.allowed=r.allowed(d,{connection:c,source:f===Gi?p:l,target:f===zi?p:u})),h&&(s.source=f===Gi?p:l,s.target=f===zi?p:u)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(a){var s=a.context,c=s.type;s.hover=null,s.source=null,s.target=null,c!==Qr&&(s.allowed=!1)}),t.on("bendpoint.move.end",function(a){var s=a.context,c=s.allowed,u=s.bendpointIndex,l=s.connection,p=s.insert,f=l.waypoints.slice(),h=s.source,d=s.target,g=s.type,y=s.hints||{},A={x:xh(a.x),y:xh(a.y)};if(!c)return!1;g===Qr?(p?f.splice(u,0,A):f[u]=A,y.bendpointMove={insert:p,bendpointIndex:u},f=this.cropWaypoints(l,f),o.updateWaypoints(l,eb(f),y)):(g===zi?(y.docking="source",xs(s)&&(y.docking="target",y.newWaypoints=f.reverse())):g===Gi&&(y.docking="target",xs(s)&&(y.docking="source",y.newWaypoints=f.reverse())),o.reconnect(l,h,d,A,y))},this)}Zl.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];Zl.prototype.cropWaypoints=function(e,t){var n=this._injector.get("connectionDocking",!1);if(!n)return t;var i=e.waypoints;return e.waypoints=t,e.waypoints=n.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=i,t};function xs(e){var t=e.hover,n=e.source,i=e.target,r=e.type;if(r===zi)return t&&i&&t===i&&n!==i;if(r===Gi)return t&&n&&t===n&&n!==i}var Uw="reconnectStart",Yw="reconnectEnd",wh="updateWaypoints",Jr="connect-ok",Ia="connect-not-ok",Sh="connect-hover",Ch="djs-updating",Th="djs-element-hidden",Ah=1100;function Rg(e,t,n,i){this._injector=t;var r=t.get("connectionPreview",!1);n.on("bendpoint.move.start",function(o){var a=o.context,s=a.bendpointIndex,c=a.connection,u=a.insert,l=c.waypoints,p=l.slice();a.waypoints=l,u&&p.splice(s,0,{x:o.x,y:o.y}),c.waypoints=p;var f=a.draggerGfx=Wu(i.getLayer("overlays"));Se(f).add("djs-dragging"),i.addMarker(c,Th),i.addMarker(c,Ch)}),n.on("bendpoint.move.hover",function(o){var a=o.context,s=a.allowed,c=a.hover,u=a.type;if(c){if(i.addMarker(c,Sh),u===wh)return;s?(i.removeMarker(c,Ia),i.addMarker(c,Jr)):s===!1&&(i.removeMarker(c,Jr),i.addMarker(c,Ia))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],Ah,function(o){var a=o.context,s=a.hover,c=a.target;s&&(i.removeMarker(s,Sh),i.removeMarker(s,c?Jr:Ia))}),n.on("bendpoint.move.move",function(o){var a=o.context,s=a.allowed,c=a.bendpointIndex,u=a.draggerGfx,l=a.hover,p=a.type,f=a.connection,h=f.source,d=f.target,g=f.waypoints.slice(),y={x:o.x,y:o.y},A=a.hints||{},_={};r&&(A.connectionStart&&(_.connectionStart=A.connectionStart),A.connectionEnd&&(_.connectionEnd=A.connectionEnd),p===Uw?xs(a)?(_.connectionEnd=_.connectionEnd||y,_.source=d,_.target=l||h,g=g.reverse()):(_.connectionStart=_.connectionStart||y,_.source=l||h,_.target=d):p===Yw?xs(a)?(_.connectionStart=_.connectionStart||y,_.source=l||d,_.target=h,g=g.reverse()):(_.connectionEnd=_.connectionEnd||y,_.source=h,_.target=l||d):(_.noCropping=!0,_.noLayout=!0,g[c]=y),p===wh&&(g=e.cropWaypoints(f,g)),_.waypoints=g,r.drawPreview(a,s,_)),At(u,o.x,o.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],Ah,function(o){var a=o.context,s=a.connection,c=a.draggerGfx,u=a.hover,l=a.target,p=a.waypoints;s.waypoints=p,Le(c),i.removeMarker(s,Ch),i.removeMarker(s,Th),u&&(i.removeMarker(u,Jr),i.removeMarker(u,l?Jr:Ia)),r&&r.cleanUp(a)})}Rg.$inject=["bendpointMove","injector","eventBus","canvas"];var Rh="connect-hover",Ph="djs-updating";function Dh(e,t,n){return Ql(e,t,e[t]+n)}function Ql(e,t,n){return{x:t==="x"?n:e.x,y:t==="y"?n:e.y}}function qw(e,t,n,i){var r=Math.max(t[i],n[i]),o=Math.min(t[i],n[i]),a=20,s=Math.min(Math.max(o+a,e[i]),r-a);return Ql(t,i,s)}function Pg(e){return e==="x"?"y":"x"}function Mh(e,t,n){var i,r;return e.original?e.original:(i=ye(t),r=Pg(n),Ql(e,r,i[r]))}function Dg(e,t,n,i,r,o){var a=e.get("connectionDocking",!1);this.start=function(p,f,h){var d,g=n.getGraphics(f),y=h-1,A=h,_=f.waypoints,w=_[y],b=_[A],S=Vu(n,_,p),M,C,R;M=Ln(w,b),M&&(C=M==="v"?"x":"y",y===0&&(w=Mh(w,f.source,C)),A===_.length-1&&(b=Mh(b,f.target,C)),S?R=S.point:R={x:(w.x+b.x)/2,y:(w.y+b.y)/2},d={connection:f,segmentStartIndex:y,segmentEndIndex:A,segmentStart:w,segmentEnd:b,axis:C,dragPosition:R},i.init(p,R,"connectionSegment.move",{cursor:C==="x"?"resize-ew":"resize-ns",data:{connection:f,connectionGfx:g,context:d}}))};function s(p,f){if(!a)return f;var h=p.waypoints,d;return p.waypoints=f,d=a.getCroppedWaypoints(p),p.waypoints=h,d}function c(p){r.update("connection",p.connection,p.connectionGfx)}function u(p,f,h){var d=p.newWaypoints,g=p.segmentStartIndex+f,y=d[g],A=p.segmentEndIndex+f,_=d[A],w=Pg(p.axis),b=qw(h,y,_,w);At(p.draggerGfx,b.x,b.y)}function l(p,f){var h=0,d=p.filter(function(g,y){return Cl(p[y-1],p[y+1],g)?(h=y<=f?h-1:h,!1):!0});return{waypoints:d,segmentOffset:h}}t.on("connectionSegment.move.start",function(p){var f=p.context,h=p.connection,d=n.getLayer("overlays");f.originalWaypoints=h.waypoints.slice(),f.draggerGfx=Tg(d,f.segmentStart,f.segmentEnd),Se(f.draggerGfx).add("djs-dragging"),n.addMarker(h,Ph)}),t.on("connectionSegment.move.move",function(p){var f=p.context,h=f.connection,d=f.segmentStartIndex,g=f.segmentEndIndex,y=f.segmentStart,A=f.segmentEnd,_=f.axis,w=f.originalWaypoints.slice(),b=Dh(y,_,p["d"+_]),S=Dh(A,_,p["d"+_]),M=w.length,C=0;w[d]=b,w[g]=S;var R,D;d<2&&(R=pt(h.source,b),d===1?R==="intersect"&&(w.shift(),w[0]=b,C--):R!=="intersect"&&(w.unshift(y),C++)),g>M-3&&(D=pt(h.target,S),g===M-2?D==="intersect"&&(w.pop(),w[w.length-1]=S):D!=="intersect"&&w.push(A)),f.newWaypoints=h.waypoints=s(h,w),u(f,C,p),f.newSegmentStartIndex=d+C,c(p)}),t.on("connectionSegment.move.hover",function(p){p.context.hover=p.hover,n.addMarker(p.hover,Rh)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(p){var f=p.context.hover;f&&n.removeMarker(f,Rh)}),t.on("connectionSegment.move.cleanup",function(p){var f=p.context,h=f.connection;f.draggerGfx&&Le(f.draggerGfx),n.removeMarker(h,Ph)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(p){var f=p.context,h=f.connection;h.waypoints=f.originalWaypoints,c(p)}),t.on("connectionSegment.move.end",function(p){var f=p.context,h=f.connection,d=f.newWaypoints,g=f.newSegmentStartIndex;d=d.map(function(S){return{original:S.original,x:Math.round(S.x),y:Math.round(S.y)}});var y=l(d,g),A=y.waypoints,_=s(h,A),w=y.segmentOffset,b={segmentMove:{segmentStartIndex:f.segmentStartIndex,newSegmentStartIndex:g+w}};o.updateWaypoints(h,_,b)})}Dg.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var Kw=Math.abs,Bh=Math.round;function Xw(e,t,n){n=n===void 0?10:n;var i,r;for(i=0;i<t.length;i++)if(r=t[i],Kw(r-e)<=n)return r}function Mg(e){return{x:e.x,y:e.y}}function Bg(e){return{x:e.x+e.width,y:e.y+e.height}}function zt(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:Bh(e.x+e.width/2),y:Bh(e.y+e.height/2)}}function xr(e,t){var n=e.snapped;return n?typeof t=="string"?n[t]:n.x&&n.y:!1}function Ge(e,t,n){if(typeof t!="string")throw new Error("axis must be in [x, y]");if(typeof n!="number"&&n!==!1)throw new Error("value must be Number or false");var i,r=e[t],o=e.snapped=e.snapped||{};return n===!1?o[t]=!1:(o[t]=!0,i=n-r,e[t]+=i,e["d"+t]+=i),r}function Ig(e){return e.children||[]}var Zw=Math.abs,Ih=Math.round,cu=10;function Fg(e){function t(o,a){if(be(o)){for(var s=o.length;s--;)if(Zw(o[s]-a)<=cu)return o[s]}else{o=+o;var c=a%o;if(c<cu)return a-c;if(c>o-cu)return a-c+o}return a}function n(o,a){if(o.waypoints)return zw(a,o);if(o.width)return{x:Ih(o.width/2+o.x),y:Ih(o.height/2+o.y)}}function i(o){var a=o.context,s=a.snapPoints,c=a.connection,u=c.waypoints,l=a.segmentStart,p=a.segmentStartIndex,f=a.segmentEnd,h=a.segmentEndIndex,d=a.axis;if(s)return s;var g=[u[p-1],l,f,u[h+1]];return p<2&&g.unshift(n(c.source,o)),h>u.length-3&&g.unshift(n(c.target,o)),a.snapPoints=s={horizontal:[],vertical:[]},I(g,function(y){y&&(y=y.original||y,d==="y"&&s.horizontal.push(y.y),d==="x"&&s.vertical.push(y.x))}),s}e.on("connectionSegment.move.move",1500,function(o){var a=i(o),s=o.x,c=o.y,u,l;if(!!a){u=t(a.vertical,s),l=t(a.horizontal,c);var p=s-u,f=c-l;O(o,{dx:o.dx-p,dy:o.dy-f,x:u,y:l}),(p||a.vertical.indexOf(s)!==-1)&&Ge(o,"x",u),(f||a.horizontal.indexOf(c)!==-1)&&Ge(o,"y",l)}});function r(o){var a=o.snapPoints,s=o.connection.waypoints,c=o.bendpointIndex;if(a)return a;var u=[s[c-1],s[c+1]];return o.snapPoints=a={horizontal:[],vertical:[]},I(u,function(l){l&&(l=l.original||l,a.horizontal.push(l.y),a.vertical.push(l.x))}),a}e.on(["connect.hover","connect.move","connect.end"],1500,function(o){var a=o.context,s=a.hover,c=s&&n(s,o);!Qw(s)||!c||!c.x||!c.y||(Ge(o,"x",c.x),Ge(o,"y",c.y))}),e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(o){var a=o.context,s=r(a),c=a.hover,u=c&&n(c,o),l=o.x,p=o.y,f,h;if(!!s){f=t(u?s.vertical.concat([u.x]):s.vertical,l),h=t(u?s.horizontal.concat([u.y]):s.horizontal,p);var d=l-f,g=p-h;O(o,{dx:o.dx-d,dy:o.dy-g,x:o.x-d,y:o.y-g}),(d||s.vertical.indexOf(l)!==-1)&&Ge(o,"x",f),(g||s.horizontal.indexOf(p)!==-1)&&Ge(o,"y",h)}})}Fg.$inject=["eventBus"];function Qw(e){return e&&!!e.waypoints}var Jw={__depends__:[Kn,An],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",Ag],bendpointMove:["type",Zl],bendpointMovePreview:["type",Rg],connectionSegmentMove:["type",Dg],bendpointSnapping:["type",Fg]};function Og(e,t,n,i){function r(a,s){return i.allowed("connection.create",{source:a,target:s})}function o(a,s){return r(s,a)}e.on("connect.hover",function(a){var s=a.context,c=s.start,u=a.hover,l;if(s.hover=u,l=s.canExecute=r(c,u),!Bf(l)){if(l!==!1){s.source=c,s.target=u;return}l=s.canExecute=o(c,u),!Bf(l)&&l!==!1&&(s.source=u,s.target=c)}}),e.on(["connect.out","connect.cleanup"],function(a){var s=a.context;s.hover=null,s.source=null,s.target=null,s.canExecute=!1}),e.on("connect.end",function(a){var s=a.context,c=s.canExecute,u=s.connectionStart,l={x:a.x,y:a.y},p=s.source,f=s.target;if(!c)return!1;var h=null,d={connectionStart:Yu(s)?l:u,connectionEnd:Yu(s)?u:l};ot(c)&&(h=c),s.connection=n.connect(p,f,h,d)}),this.start=function(a,s,c,u){ot(c)||(u=c,c=ye(s)),t.init(a,"connect",{autoActivate:u,data:{shape:s,context:{start:s,connectionStart:c}}})}}Og.$inject=["eventBus","dragging","modeling","rules"];function Yu(e){var t=e.hover,n=e.source,i=e.target;return t&&n&&t===n&&n!==i}var eS=1100,tS=900,Fh="connect-ok",Oh="connect-not-ok";function kg(e,t,n){var i=e.get("connectionPreview",!1);i&&t.on("connect.move",function(r){var o=r.context,a=o.canExecute,s=o.hover,c=o.source,u=o.start,l=o.startPosition,p=o.target,f=o.connectionStart||l,h=o.connectionEnd||{x:r.x,y:r.y},d=f,g=h;Yu(o)&&(d=h,g=f),i.drawPreview(o,a,{source:c||u,target:p||s,connectionStart:d,connectionEnd:g})}),t.on("connect.hover",tS,function(r){var o=r.context,a=r.hover,s=o.canExecute;s!==null&&n.addMarker(a,s?Fh:Oh)}),t.on(["connect.out","connect.cleanup"],eS,function(r){var o=r.hover;o&&(n.removeMarker(o,Fh),n.removeMarker(o,Oh))}),i&&t.on("connect.cleanup",function(r){i.cleanUp(r.context)})}kg.$inject=["injector","eventBus","canvas"];var Jl={__depends__:[Cn,An,Kn],__init__:["connectPreview"],connect:["type",Og],connectPreview:["type",kg]},nS="djs-connection-preview";function Xn(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}Xn.$inject=["injector","canvas","graphicsFactory","elementFactory"];Xn.prototype.drawPreview=function(e,t,n){n=n||{};var i=e.connectionPreviewGfx,r=e.getConnection,o=n.source,a=n.target,s=n.waypoints,c=n.connectionStart,u=n.connectionEnd,l=n.noLayout,p=n.noCropping,f=n.noNoop,h,d=this;if(i||(i=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),Ao(i),r||(r=e.getConnection=iS(function(g,y,A){return d.getConnection(g,y,A)})),t&&(h=r(t,o,a)),!h){!f&&this.drawNoopPreview(i,n);return}h.waypoints=s||[],this._layouter&&!l&&(h.waypoints=this._layouter.layoutConnection(h,{source:o,target:a,connectionStart:c,connectionEnd:u,waypoints:n.waypoints||h.waypoints})),(!h.waypoints||!h.waypoints.length)&&(h.waypoints=[o?ye(o):c,a?ye(a):u]),this._connectionDocking&&(o||a)&&!p&&(h.waypoints=this._connectionDocking.getCroppedWaypoints(h,o,a)),this._graphicsFactory.drawConnection(i,h)};Xn.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,r=t.connectionStart||ye(n),o=t.connectionEnd||ye(i),a=this.cropWaypoints(r,o,n,i),s=this.createNoopConnection(a[0],a[1]);pe(e,s)};Xn.prototype.cropWaypoints=function(e,t,n,i){var r=this._graphicsFactory,o=n&&r.getShapePath(n),a=i&&r.getShapePath(i),s=r.getConnectionPath({waypoints:[e,t]});return e=n&&Nu(o,s,!0)||e,t=i&&Nu(a,s,!1)||t,[e,t]};Xn.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&Le(e.connectionPreviewGfx)};Xn.prototype.getConnection=function(e){var t=rS(e);return this._elementFactory.createConnection(t)};Xn.prototype.createConnectionPreviewGfx=function(){var e=ae("g");return W(e,{pointerEvents:"none"}),Se(e).add(nS),pe(this._canvas.getActiveLayer(),e),e};Xn.prototype.createNoopConnection=function(e,t){var n=ae("polyline");return W(n,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),W(n,{points:[e.x,e.y,t.x,t.y]}),n};function iS(e){var t={};return function(n){var i=JSON.stringify(n),r=t[i];return r||(r=t[i]=e.apply(null,arguments)),r}}function rS(e){return ot(e)?e:{}}var oS={__init__:["connectionPreview"],connectionPreview:["type",Xn]},kh=Math.min,Nh=Math.max;function uu(e){e.preventDefault()}function fo(e){e.stopPropagation()}function aS(e){return e.nodeType===Node.TEXT_NODE}function sS(e){return[].slice.call(e)}function pn(e){this.container=e.container,this.parent=ce('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=xe("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=wt(this.autoResize,this),this.handlePaste=wt(this.handlePaste,this)}pn.prototype.create=function(e,t,n,i){var r=this,o=this.parent,a=this.content,s=this.container;i=this.options=i||{},t=this.style=t||{};var c=cn(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);O(o.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},c);var u=cn(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return O(a.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},u),i.centerVertically&&O(a.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},u),a.innerText=n,J.bind(a,"keydown",this.keyHandler),J.bind(a,"mousedown",fo),J.bind(a,"paste",r.handlePaste),i.autoResize&&J.bind(a,"input",this.autoResize),i.resizable&&this.resizable(t),s.appendChild(o),this.setSelection(a.lastChild,a.lastChild&&a.lastChild.length),o};pn.prototype.handlePaste=function(e){var t=this.options,n=this.style;e.preventDefault();var i;if(e.clipboardData?i=e.clipboardData.getData("text/plain"):i=window.clipboardData.getData("Text"),this.insertText(i),t.autoResize){var r=this.autoResize(n);r&&this.resizeHandler(r)}};pn.prototype.insertText=function(e){e=cS(e);var t=document.execCommand("insertText",!1,e);t||this._insertTextIE(e)};pn.prototype._insertTextIE=function(e){var t=this.getSelection(),n=t.startContainer,i=t.endContainer,r=t.startOffset,o=t.endOffset,a=t.commonAncestorContainer,s=sS(a.childNodes),c,u;if(aS(a)){var l=n.textContent;n.textContent=l.substring(0,r)+e+l.substring(o),c=n,u=r+e.length}else if(n===this.content&&i===this.content){var p=document.createTextNode(e);this.content.insertBefore(p,s[r]),c=p,u=p.textContent.length}else{var f=s.indexOf(n),h=s.indexOf(i);s.forEach(function(d,g){g===f?d.textContent=n.textContent.substring(0,r)+e+i.textContent.substring(o):g>f&&g<=h&&wn(d)}),c=n,u=r+e.length}c&&u!==void 0&&setTimeout(function(){self.setSelection(c,u)})};pn.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),r=t.scrollHeight;e.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}};pn.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,r=parseInt(this.style.minHeight)||0,o=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){n=this.resizeHandle=ce('<div class="djs-direct-editing-resize-handle"></div>');var s,c,u,l,p=function(d){uu(d),fo(d),s=d.clientX,c=d.clientY;var g=t.getBoundingClientRect();u=g.width,l=g.height,J.bind(document,"mousemove",f),J.bind(document,"mouseup",h)},f=function(d){uu(d),fo(d);var g=kh(Nh(u+d.clientX-s,i),o),y=kh(Nh(l+d.clientY-c,r),a);t.style.width=g+"px",t.style.height=y+"px",e.resizeHandler({width:u,height:l,dx:d.clientX-s,dy:d.clientY-c})},h=function(d){uu(d),fo(d),J.unbind(document,"mousemove",f,!1),J.unbind(document,"mouseup",h,!1)};J.bind(n,"mousedown",p)}O(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)};pn.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),J.unbind(t,"keydown",this.keyHandler),J.unbind(t,"mousedown",fo),J.unbind(t,"input",this.autoResize),J.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),wn(n)),wn(e)};pn.prototype.getValue=function(){return this.content.innerText.trim()};pn.prototype.getSelection=function(){var e=window.getSelection(),t=e.getRangeAt(0);return t};pn.prototype.setSelection=function(e,t){var n=document.createRange();e===null?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};function cS(e){return e.replace(/\r\n|\r|\n/g,`
`)}function Yt(e,t){this._eventBus=e,this._providers=[],this._textbox=new pn({container:t.getContainer(),keyHandler:wt(this._handleKey,this),resizeHandler:wt(this._handleResize,this)})}Yt.$inject=["eventBus","canvas"];Yt.prototype.registerProvider=function(e){this._providers.push(e)};Yt.prototype.isActive=function(e){return!!(this._active&&(!e||this._active.element===e))};Yt.prototype.cancel=function(){!this._active||(this._fire("cancel"),this.close())};Yt.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})};Yt.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0};Yt.prototype.complete=function(){var e=this._active;if(!!e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),r=this.getValue(),o=e.context.text;(r!==o||i.height!==n.height||i.width!==n.width)&&(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,r,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}};Yt.prototype.getValue=function(){return this._textbox.getValue()};Yt.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;if(t===27)return e.preventDefault(),this.cancel();if(t===13&&!e.shiftKey)return e.preventDefault(),this.complete()};Yt.prototype._handleResize=function(e){this._fire("resize",e)};Yt.prototype.activate=function(e){this.isActive()&&this.cancel();var t,n=Me(this._providers,function(i){return(t=i.activate(e))?i:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};var Ng={__depends__:[ko],__init__:["directEditing"],directEditing:["type",Yt]},uS=["marker-start","marker-mid","marker-end"],lS=["circle","ellipse","line","path","polygon","polyline","rect"];function Ji(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var r=this;t.on("drag.cleanup",function(){I(r._clonedMarkers,function(o){Le(o)}),r._clonedMarkers={}})}Ji.$inject=["elementRegistry","eventBus","canvas","styles"];Ji.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)};Ji.prototype.addDragger=function(e,t,n){n=n||this.getGfx(e);var i=_l(n),r=n.getBoundingClientRect();return this._cloneMarkers(_o(i)),W(i,this._styles.cls("djs-dragger",[],{x:r.top,y:r.left})),pe(t,i),i};Ji.prototype.addFrame=function(e,t){var n=ae("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return pe(t,n),n};Ji.prototype._cloneMarkers=function(e){var t=this;if(e.childNodes)for(var n=0;n<e.childNodes.length;n++)t._cloneMarkers(e.childNodes[n]);!dS(e)||uS.forEach(function(i){if(W(e,i)){var r=pS(e,i,t._canvas.getContainer());t._cloneMarker(e,r,i)}})};Ji.prototype._cloneMarker=function(e,t,n){var i=t.id,r=this._clonedMarkers[i];if(!r){r=_l(t);var o=i+"-clone";r.id=o,Se(r).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[i]=r;var a=xe("defs",this._canvas._svg);a||(a=ae("defs"),pe(this._canvas._svg,a)),pe(a,r)}var s=hS(this._clonedMarkers[i].id);W(e,n,s)};function pS(e,t,n){var i=fS(W(e,t));return xe("marker#"+i,n||document)}function fS(e){return e.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]}function hS(e){return"url(#"+e+")"}function dS(e){return lS.indexOf(e.nodeName)!==-1}var $o={__init__:["previewSupport"],previewSupport:["type",Ji]},mS="drop-ok",Lh="drop-not-ok",$h="attach-ok",jh="new-parent",Hh="create",vS=2e3;function Lg(e,t,n,i,r){function o(c,u,l,p,f){if(!u)return!1;c=Ee(c,function(_){var w=_.labelTarget;return!_.parent&&!(gS(_)&&c.indexOf(w)!==-1)});var h=Me(c,function(_){return!oo(_)}),d=!1,g=!1,y=!1;Gh(c)&&(d=r.allowed("shape.attach",{position:l,shape:h,target:u})),d||(Gh(c)?y=r.allowed("shape.create",{position:l,shape:h,source:p,target:u}):y=r.allowed("elements.create",{elements:c,position:l,target:u}));var A=f.connectionTarget;return y||d?(h&&p&&(g=r.allowed("connection.create",{source:A===p?h:p,target:A===p?p:h,hints:{targetParent:u,targetAttach:d}})),{attach:d,connect:g}):y===null||d===null?null:!1}function a(c,u){[$h,mS,Lh,jh].forEach(function(l){l===u?e.addMarker(c,l):e.removeMarker(c,l)})}n.on(["create.move","create.hover"],function(c){var u=c.context,l=u.elements,p=c.hover,f=u.source,h=u.hints||{};if(!p){u.canExecute=!1,u.target=null;return}zh(c);var d={x:c.x,y:c.y},g=u.canExecute=p&&o(l,p,d,f,h);p&&g!==null&&(u.target=p,g&&g.attach?a(p,$h):a(p,g?jh:Lh))}),n.on(["create.end","create.out","create.cleanup"],function(c){var u=c.hover;u&&a(u,null)}),n.on("create.end",function(c){var u=c.context,l=u.source,p=u.shape,f=u.elements,h=u.target,d=u.canExecute,g=d&&d.attach,y=d&&d.connect,A=u.hints||{};if(d===!1||!h)return!1;zh(c);var _={x:c.x,y:c.y};y?p=i.appendShape(l,p,_,h,{attach:g,connection:y===!0?{}:y,connectionTarget:A.connectionTarget}):(f=i.createElements(f,_,h,O({},A,{attach:g})),p=Me(f,function(w){return!oo(w)})),O(u,{elements:f,shape:p}),O(c,{elements:f,shape:p})});function s(){var c=t.context();c&&c.prefix===Hh&&t.cancel()}n.on("create.init",function(){n.on("elements.changed",s),n.once(["create.cancel","create.end"],vS,function(){n.off("elements.changed",s)})}),this.start=function(c,u,l){be(u)||(u=[u]);var p=Me(u,function(d){return!oo(d)});if(!!p){l=O({elements:u,hints:{},shape:p},l||{}),I(u,function(d){ge(d.x)||(d.x=0),ge(d.y)||(d.y=0)});var f=Ee(u,function(d){return!d.hidden}),h=Je(f);I(u,function(d){oo(d)&&(d.waypoints=lt(d.waypoints,function(g){return{x:g.x-h.x-h.width/2,y:g.y-h.y-h.height/2}})),O(d,{x:d.x-h.x-h.width/2,y:d.y-h.y-h.height/2})}),t.init(c,Hh,{cursor:"grabbing",autoActivate:!0,data:{shape:p,elements:u,context:l}})}}}Lg.$inject=["canvas","dragging","eventBus","modeling","rules"];function zh(e){var t=e.context,n=t.createConstraints;!n||(n.left&&(e.x=Math.max(e.x,n.left)),n.right&&(e.x=Math.min(e.x,n.right)),n.top&&(e.y=Math.max(e.y,n.top)),n.bottom&&(e.y=Math.min(e.y,n.bottom)))}function oo(e){return!!e.waypoints}function Gh(e){return e&&e.length===1&&!oo(e[0])}function gS(e){return!!e.labelTarget}var yS=750;function $g(e,t,n,i,r){function o(a){var s=ae("g");W(s,r.cls("djs-drag-group",["no-events"]));var c=ae("g");return a.forEach(function(u){var l;u.hidden||(u.waypoints?(l=n._createContainer("connection",c),n.drawConnection(_o(l),u)):(l=n._createContainer("shape",c),n.drawShape(_o(l),u),At(l,u.x,u.y)),i.addDragger(u,s,l))}),s}t.on("create.move",yS,function(a){var s=a.hover,c=a.context,u=c.elements,l=c.dragGroup;l||(l=c.dragGroup=o(u));var p;s?(l.parentNode||(p=e.getActiveLayer(),pe(p,l)),At(l,a.x,a.y)):Le(l)}),t.on("create.cleanup",function(a){var s=a.context,c=s.dragGroup;c&&Le(c)})}$g.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];var Js={__depends__:[Kn,$o,An,Cn],__init__:["create","createPreview"],create:["type",Lg],createPreview:["type",$g]};function jo(){}jo.prototype.get=function(){return this._data};jo.prototype.set=function(e){this._data=e};jo.prototype.clear=function(){var e=this._data;return delete this._data,e};jo.prototype.isEmpty=function(){return!this._data};var ES={clipboard:["type",jo]};function ep(e){var t=this;this._lastMoveEvent=null;function n(i){t._lastMoveEvent=i}e.on("canvas.init",function(i){var r=t._svg=i.svg;r.addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}ep.$inject=["eventBus"];ep.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||_S(0,0)};function _S(e,t){var n=document.createEvent("MouseEvent"),i=e,r=t,o=e,a=t;return n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,r,o,a,!1,!1,!1,!1,0,null),n}var Ho={__init__:["mouse"],mouse:["type",ep]};function fn(e,t,n,i,r,o,a,s){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=r,this._modeling=o,this._mouse=a,this._rules=s,r.on("copyPaste.copyElement",function(c){var u=c.descriptor,l=c.element,p=c.elements;u.priority=1,u.id=l.id;var f=Me(p,function(h){return h===l.parent});f&&(u.parent=l.parent.id),bS(l)&&(u.priority=2,u.host=l.host.id),ec(l)&&(u.priority=3,u.source=l.source.id,u.target=l.target.id,u.waypoints=xS(l)),tc(l)&&(u.priority=4,u.labelTarget=l.labelTarget.id),I(["x","y","width","height"],function(h){ge(l[h])&&(u[h]=l[h])}),u.hidden=l.hidden,u.collapsed=l.collapsed}),r.on("copyPaste.pasteElements",function(c){var u=c.hints;O(u,{createElementsBehavior:!1})})}fn.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"];fn.prototype.copy=function(e){var t,n;return be(e)||(e=e?[e]:[]),t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}),t===!1?n={}:n=this.createTree(be(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n};fn.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}};fn.prototype._paste=function(e,t,n,i){I(e,function(o){ge(o.x)||(o.x=0),ge(o.y)||(o.y=0)});var r=Je(e);return I(e,function(o){ec(o)&&(o.waypoints=lt(o.waypoints,function(a){return{x:a.x-r.x-r.width/2,y:a.y-r.y-r.height/2}})),O(o,{x:o.x-r.x-r.width/2,y:o.y-r.y-r.height/2})}),this._modeling.createElements(e,n,t,O({},i))};fn.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},r=[];return I(e,function(o,a){o=sn(o,"priority"),I(o,function(s){var c=O({},Gn(s,["priority"]));i[s.parent]?c.parent=i[s.parent]:delete c.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:c});var u;if(ec(c)){c.source=i[s.source],c.target=i[s.target],u=i[s.id]=t.createConnection(c),r.push(u);return}if(tc(c)){c.labelTarget=i[c.labelTarget],u=i[s.id]=t.createLabel(c),r.push(u);return}c.host&&(c.host=i[c.host]),u=i[s.id]=t.createShape(c),r.push(u)})}),r};fn.prototype.createConnection=function(e){var t=this._elementFactory.createConnection(Gn(e,["id"]));return t};fn.prototype.createLabel=function(e){var t=this._elementFactory.createLabel(Gn(e,["id"]));return t};fn.prototype.createShape=function(e){var t=this._elementFactory.createShape(Gn(e,["id"]));return t};fn.prototype.hasRelations=function(e,t){var n,i,r;return!(ec(e)&&(i=Me(t,on({id:e.source.id})),r=Me(t,on({id:e.target.id})),!i||!r)||tc(e)&&(n=Me(t,on({id:e.labelTarget.id})),!n))};fn.prototype.createTree=function(e){var t=this._rules,n=this,i={},r=[],o=Bs(e);function a(u,l){return t.allowed("element.copy",{element:u,elements:l})}function s(u,l){var p=Me(r,function(f){return u===f.element});if(!p){r.push({element:u,depth:l});return}p.depth<l&&(r=c(p,r),r.push({element:p.element,depth:l}))}function c(u,l){var p=l.indexOf(u);return p!==-1&&l.splice(p,1),l}return Xi(o,function(u,l,p){if(tc(u))return;I(u.labels,function(d){s(d,p)});function f(d){d&&d.length&&I(d,function(g){I(g.labels,function(y){s(y,p)}),s(g,p)})}I([u.attachers,u.incoming,u.outgoing],f),s(u,p);var h=[];return u.children&&(h=u.children.slice()),n._eventBus.fire("copyPaste.createTree",{element:u,children:h}),h}),e=lt(r,function(u){return u.element}),r=lt(r,function(u){return u.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:u.descriptor,element:u.element,elements:e}),u}),r=sn(r,function(u){return u.descriptor.priority}),e=lt(r,function(u){return u.element}),I(r,function(u){var l=u.depth;if(!n.hasRelations(u.element,e)){Wh(u.element,e);return}if(!a(u.element,e)){Wh(u.element,e);return}i[l]||(i[l]=[]),i[l].push(u.descriptor)}),i};function bS(e){return!!e.host}function ec(e){return!!e.waypoints}function tc(e){return!!e.labelTarget}function xS(e){return lt(e.waypoints,function(t){return t=Vh(t),t.original&&(t.original=Vh(t.original)),t})}function Vh(e){return O({},e)}function Wh(e,t){var n=t.indexOf(e);return n===-1?t:t.splice(n,1)}var wS={__depends__:[ES,Js,Ho,An],__init__:["copyPaste"],copyPaste:["type",fn]};function lu(e,t,n){be(n)||(n=[n]),I(n,function(i){Ds(e[i])||(t[i]=e[i])})}var pu=750;function jg(e,t,n){function i(c,u){var l=e.create(c.$type);return n.copyElement(c,l,null,u)}t.on("copyPaste.copyElement",pu,function(c){var u=c.descriptor,l=c.element,p=X(l);if(Uh(l))return u;var f=u.businessObject=i(p,!0),h=u.di=i(Ce(l),!0);h.bpmnElement=f,lu(f,u,"name"),lu(h,u,"isExpanded"),p.default&&(u.default=p.default.id)});var r="-bpmn-js-refs";function o(c){return c[r]=c[r]||{}}function a(c,u){c[r]=u}function s(c,u,l){var p=X(c);return c.default&&(l[c.default]={element:p,property:"default"}),c.host&&(X(c).attachedToRef=X(u[c.host])),Gn(l,Rt(l,function(f,h,d){var g=h.element,y=h.property;return d===c.id&&(g[y]=p,f.push(c.id)),f},[]))}t.on("copyPaste.pasteElement",function(c){var u=c.cache,l=c.descriptor,p=l.businessObject,f=l.di;if(Uh(l)){l.businessObject=X(u[l.labelTarget]),l.di=Ce(u[l.labelTarget]);return}p=l.businessObject=i(p),f=l.di=i(f),f.bpmnElement=p,lu(l,p,["isExpanded","name"]),l.type=p.$type}),t.on("copyPaste.copyElement",pu,function(c){var u=c.descriptor,l=c.element;if(!!v(l,"bpmn:Participant")){var p=X(l);p.processRef&&(u.processRef=i(p.processRef,!0))}}),t.on("copyPaste.pasteElement",function(c){var u=c.descriptor,l=u.processRef;l&&(u.processRef=i(l))}),t.on("copyPaste.pasteElement",pu,function(c){var u=c.cache,l=c.descriptor;a(u,s(l,u,o(u)))})}jg.$inject=["bpmnFactory","eventBus","moddleCopy"];function Uh(e){return!!e.labelTarget}var SS=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing","categoryValue"];function zo(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",function(i){var r=i.propertyNames;if(!(!r||!r.length))return sn(r,function(o){return o==="extensionElements"})}),e.on("moddleCopy.canCopyProperty",function(i){var r=i.parent,o=ot(r)&&r.$descriptor,a=i.propertyName;if(a&&SS.indexOf(a)!==-1||a&&o&&!Me(o.properties,on({name:a})))return!1}),e.on("moddleCopy.canSetCopiedProperty",function(i){var r=i.property;if(CS(r,"bpmn:ExtensionElements")&&(!r.values||!r.values.length))return!1})}zo.$inject=["eventBus","bpmnFactory","moddle"];zo.prototype.copyElement=function(e,t,n,i){var r=this;n&&!be(n)&&(n=[n]),n=n||qu(e.$descriptor);var o=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t,clone:i});return o===!1||(be(o)&&(n=o),I(n,function(a){var s;Nn(e,a)&&(s=e.get(a));var c=r.copyProperty(s,t,a,i);if(!!rn(c)){var u=r._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:c,propertyName:a});u!==!1&&t.set(a,c)}})),t};zo.prototype.copyProperty=function(e,t,n,i){var r=this,o=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n,clone:i});if(o!==!1){if(o)return ot(o)&&o.$type&&!o.$parent&&(o.$parent=t),o;var a=this._moddle.getPropertyDescriptor(t,n);if(!a.isReference)return a.isId?e&&this._copyId(e,t,i):be(e)?Rt(e,function(s,c){return o=r.copyProperty(c,t,n,i),o?s.concat(o):s},[]):ot(e)&&e.$type?this._moddle.getElementDescriptor(e).isGeneric?void 0:(o=r._bpmnFactory.create(e.$type),o.$parent=t,o=r.copyElement(e,o,null,i),o):e}};zo.prototype._copyId=function(e,t,n){if(n)return e;if(!this._moddle.ids.assigned(e))return this._moddle.ids.claim(e,t),e};function qu(e,t){return Rt(e.properties,function(n,i){return t&&i.default?n:n.concat(i.name)},[])}function CS(e,t){return e&&typeof e.$instanceOf=="function"&&e.$instanceOf(t)}var Hg={__depends__:[wS],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",jg],moddleCopy:["type",zo]},Yh=Math.round;function tp(e){this._modeling=e}tp.$inject=["modeling"];tp.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,r=t.width||e.width,o=t.height||e.height,a=t.x||e.x,s=t.y||e.y,c=Yh(a+r/2),u=Yh(s+o/2);return i.replaceShape(e,O({},t,{x:c,y:u,width:r,height:o}),n)};var TS={__init__:["replace"],replace:["type",tp]};function AS(e,t,n){be(n)||(n=[n]),I(n,function(i){Ds(e[i])||(t[i]=e[i])})}var RS=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function PS(e,t){var n=e&&Nn(e,"collapsed")?e.collapsed:!Re(e),i;return t&&(Nn(t,"collapsed")||Nn(t,"isExpanded"))?i=Nn(t,"collapsed")?t.collapsed:!t.isExpanded:i=n,n!==i}function zg(e,t,n,i,r,o,a){function s(c,u,l){l=l||{};var p=u.type,f=c.businessObject;if(Fa(f)&&p==="bpmn:SubProcess"&&PS(c,u))return i.toggleCollapse(c),c;var h=e.create(p),d={type:p,businessObject:h};d.di={},AS(c.di,d.di,["fill","stroke","background-color","border-color","color"]);var g=qu(f.$descriptor),y=qu(h.$descriptor,!0),A=DS(g,y);O(h,cn(u,RS));var _=Ee(A,function(b){return b==="eventDefinitions"?qh(c,u.eventDefinitionType):b==="loopCharacteristics"?!It(h):!(Nn(h,b)||b==="processRef"&&u.isExpanded===!1||b==="triggeredByEvent")});if(h=n.copyElement(f,h,_),u.eventDefinitionType&&(qh(h,u.eventDefinitionType)||(d.eventDefinitionType=u.eventDefinitionType,d.eventDefinitionAttrs=u.eventDefinitionAttrs)),v(f,"bpmn:Activity")){if(Fa(f))d.isExpanded=Re(c);else if(u&&Nn(u,"isExpanded")){d.isExpanded=u.isExpanded;var w=t.getDefaultSize(h,{isExpanded:d.isExpanded});d.width=w.width,d.height=w.height,d.x=c.x-(d.width-c.width)/2,d.y=c.y-(d.height-c.height)/2}Re(c)&&!v(f,"bpmn:Task")&&d.isExpanded&&(d.width=c.width,d.height=c.height)}return Fa(f)&&!Fa(h)&&(l.moveChildren=!1),v(f,"bpmn:Participant")&&(u.isExpanded===!0?h.processRef=e.create("bpmn:Process"):l.moveChildren=!1,d.width=c.width,d.height=t.getDefaultSize(d).height),o.allowed("shape.resize",{shape:h})||(d.height=t.getDefaultSize(d).height,d.width=t.getDefaultSize(d).width),h.name=f.name,De(f,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&De(h,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(h.default=f.default),u.host&&!v(f,"bpmn:BoundaryEvent")&&v(h,"bpmn:BoundaryEvent")&&(d.host=u.host),(d.type==="bpmn:DataStoreReference"||d.type==="bpmn:DataObjectReference")&&(d.x=c.x+(c.width-d.width)/2),d=r.replaceElement(c,d,l),l.select!==!1&&a.select(d),d}this.replaceElement=s}zg.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules","selection"];function Fa(e){return v(e,"bpmn:SubProcess")}function qh(e,t){var n=X(e);return t&&n.get("eventDefinitions").some(function(i){return v(i,t)})}function DS(e,t){return e.filter(function(n){return t.indexOf(n)!==-1})}var Gg={__depends__:[Hg,TS,Cn],bpmnReplace:["type",zg]};function Kh(e){return function(t){var n=t.target,i=X(e),r=i.eventDefinitions&&i.eventDefinitions[0],o=i.$type===n.type,a=(r&&r.$type)===n.eventDefinitionType,s=i.triggeredByEvent===n.triggeredByEvent,c=n.isExpanded===void 0||n.isExpanded===Re(e);return!o||!a||!s||!c}}var MS=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],BS=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],IS=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Intermediate Catch Event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message Intermediate Throw Event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Intermediate Catch Event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Intermediate Throw Event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Intermediate Catch Event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link Intermediate Catch Event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link Intermediate Throw Event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation Intermediate Throw Event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal Intermediate Catch Event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal Intermediate Throw Event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],FS=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message End Event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation End Event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error End Event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel End Event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation End Event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal End Event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate End Event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],OS=[{label:"Exclusive Gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel Gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive Gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex Gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event based Gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],kS=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],NS=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],LS=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}}],Xh=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"Send Task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive Task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"User Task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Manual Task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business Rule Task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Service Task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Script Task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call Activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub Process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],$S=[{label:"Data Store Reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],jS=[{label:"Data Object Reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],HS=[{label:"Message Boundary Event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Boundary Event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Boundary Event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Boundary Event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error Boundary Event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel Boundary Event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal Boundary Event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation Boundary Event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],zS=[{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Error Start Event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Escalation Start Event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Compensation Start Event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],GS=[{label:"Sequence Flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default Flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional Flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],VS=[{label:"Expanded Pool",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty Pool";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];function qt(e,t,n,i,r,o,a){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=r,this._rules=o,this._translate=a,this.register()}qt.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate"];qt.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)};qt.prototype.getEntries=function(e){var t=e.businessObject,n=this._rules,i;if(!n.allowed("shape.replace",{element:e}))return[];var r=Kh(e);return v(t,"bpmn:DataObjectReference")?this._createEntries(e,$S):v(t,"bpmn:DataStoreReference")&&!v(e.parent,"bpmn:Collaboration")?this._createEntries(e,jS):v(t,"bpmn:StartEvent")&&!v(t.$parent,"bpmn:SubProcess")?(i=Ee(MS,r),this._createEntries(e,i)):v(t,"bpmn:Participant")?(i=Ee(VS,function(o){return Re(e)!==o.target.isExpanded}),this._createEntries(e,i)):v(t,"bpmn:StartEvent")&&It(t.$parent)?(i=Ee(zS,function(o){var a=o.target,s=a.isInterrupting!==!1,c=X(e).isInterrupting===s;return r(o)||!r(o)&&!c}),this._createEntries(e,i)):v(t,"bpmn:StartEvent")&&!It(t.$parent)&&v(t.$parent,"bpmn:SubProcess")?(i=Ee(BS,r),this._createEntries(e,i)):v(t,"bpmn:EndEvent")?(i=Ee(FS,function(o){var a=o.target;return a.eventDefinitionType=="bpmn:CancelEventDefinition"&&!v(t.$parent,"bpmn:Transaction")?!1:r(o)}),this._createEntries(e,i)):v(t,"bpmn:BoundaryEvent")?(i=Ee(HS,function(o){var a=o.target;if(a.eventDefinitionType=="bpmn:CancelEventDefinition"&&!v(t.attachedToRef,"bpmn:Transaction"))return!1;var s=a.cancelActivity!==!1,c=t.cancelActivity==s;return r(o)||!r(o)&&!c}),this._createEntries(e,i)):v(t,"bpmn:IntermediateCatchEvent")||v(t,"bpmn:IntermediateThrowEvent")?(i=Ee(IS,r),this._createEntries(e,i)):v(t,"bpmn:Gateway")?(i=Ee(OS,r),this._createEntries(e,i)):v(t,"bpmn:Transaction")?(i=Ee(NS,r),this._createEntries(e,i)):It(t)&&Re(e)?(i=Ee(LS,r),this._createEntries(e,i)):v(t,"bpmn:SubProcess")&&Re(e)?(i=Ee(kS,r),this._createEntries(e,i)):v(t,"bpmn:AdHocSubProcess")&&!Re(e)?(i=Ee(Xh,function(o){var a=o.target,s=a.type==="bpmn:SubProcess",c=a.isExpanded===!0;return Kh(e)&&(!s||c)}),this._createEntries(e,i)):v(t,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,GS):v(t,"bpmn:FlowNode")?(i=Ee(Xh,r),v(t,"bpmn:SubProcess")&&!Re(e)&&(i=Ee(i,function(o){return o.label!=="Sub Process (collapsed)"})),this._createEntries(e,i)):[]};qt.prototype.getHeaderEntries=function(e){var t=[];return v(e,"bpmn:Activity")&&!It(e)&&(t=t.concat(this._getLoopEntries(e))),v(e,"bpmn:DataObjectReference")&&(t=t.concat(this._getDataObjectIsCollection(e))),v(e,"bpmn:Participant")&&(t=t.concat(this._getParticipantMultiplicity(e))),v(e,"bpmn:SubProcess")&&!v(e,"bpmn:Transaction")&&!It(e)&&t.push(this._getAdHocEntry(e)),t};qt.prototype._createEntries=function(e,t){var n=[],i=this;return I(t,function(r){var o=i._createMenuEntry(r,e);n.push(o)}),n};qt.prototype._createSequenceFlowEntries=function(e,t){var n=X(e),i=[],r=this._modeling,o=this._moddle,a=this;return I(t,function(s){switch(s.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(v(n.sourceRef,"bpmn:ExclusiveGateway")||v(n.sourceRef,"bpmn:InclusiveGateway")||v(n.sourceRef,"bpmn:ComplexGateway")||v(n.sourceRef,"bpmn:Activity"))&&i.push(a._createMenuEntry(s,e,function(){r.updateProperties(e.source,{default:n})}));break;case"replace-with-conditional-flow":!n.conditionExpression&&v(n.sourceRef,"bpmn:Activity")&&i.push(a._createMenuEntry(s,e,function(){var c=o.create("bpmn:FormalExpression",{body:""});r.updateProperties(e,{conditionExpression:c})}));break;default:if(v(n.sourceRef,"bpmn:Activity")&&n.conditionExpression)return i.push(a._createMenuEntry(s,e,function(){r.updateProperties(e,{conditionExpression:void 0})}));if((v(n.sourceRef,"bpmn:ExclusiveGateway")||v(n.sourceRef,"bpmn:InclusiveGateway")||v(n.sourceRef,"bpmn:ComplexGateway")||v(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n)return i.push(a._createMenuEntry(s,e,function(){r.updateProperties(e.source,{default:void 0})}))}}),i};qt.prototype._createMenuEntry=function(e,t,n){var i=this._translate,r=this._bpmnReplace.replaceElement,o=function(){return r(t,e.target)},a=e.label;a&&typeof a=="function"&&(a=a(t)),n=n||o;var s={label:i(a),className:e.className,id:e.actionName,action:n};return s};qt.prototype._getLoopEntries=function(e){var t=this,n=this._translate;function i(l,p){var f=X(e).loopCharacteristics;p.active?f=void 0:((Ds(p.options.isSequential)||!f||!v(f,p.options.loopCharacteristics))&&(f=t._moddle.create(p.options.loopCharacteristics)),f.isSequential=p.options.isSequential),t._modeling.updateProperties(e,{loopCharacteristics:f})}var r=X(e),o=r.loopCharacteristics,a,s,c;o&&(a=o.isSequential,s=o.isSequential===void 0,c=o.isSequential!==void 0&&!o.isSequential);var u=[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:n("Parallel Multi Instance"),active:c,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:n("Sequential Multi Instance"),active:a,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:n("Loop"),active:s,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}];return u};qt.prototype._getDataObjectIsCollection=function(e){var t=this,n=this._translate;function i(s,c){t._modeling.updateModdleProperties(e,r,{isCollection:!c.active})}var r=e.businessObject.dataObjectRef,o=r.isCollection,a=[{id:"toggle-is-collection",className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:o,action:i}];return a};qt.prototype._getParticipantMultiplicity=function(e){var t=this,n=this._bpmnFactory,i=this._translate;function r(s,c){var u=c.active,l;u||(l=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:l})}var o=e.businessObject.participantMultiplicity,a=[{id:"toggle-participant-multiplicity",className:"bpmn-icon-parallel-mi-marker",title:i("Participant Multiplicity"),active:!!o,action:r}];return a};qt.prototype._getAdHocEntry=function(e){var t=this._translate,n=X(e),i=v(n,"bpmn:AdHocSubProcess"),r=this._bpmnReplace.replaceElement,o={id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:i,action:function(a,s){return i?r(e,{type:"bpmn:SubProcess"},{autoResize:!1,layoutConnection:!1}):r(e,{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}};return o};var WS={__depends__:[Ul,Gg],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",qt]},ws=Math.max,Ss=Math.min,US=20;function Vg(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function YS(e,t,n){var i=n.x,r=n.y,o={x:e.x,y:e.y,width:e.width,height:e.height};return t.indexOf("n")!==-1?(o.y=e.y+r,o.height=e.height-r):t.indexOf("s")!==-1&&(o.height=e.height+r),t.indexOf("e")!==-1?o.width=e.width+i:t.indexOf("w")!==-1&&(o.x=e.x+i,o.width=e.width-i),o}function qS(e,t){return{x:e.x+(t.left||0),y:e.y+(t.top||0),width:e.width-(t.left||0)+(t.right||0),height:e.height-(t.top||0)+(t.bottom||0)}}function Oa(e,t,n){var i=t[e],r=n.min&&n.min[e],o=n.max&&n.max[e];return ge(r)&&(i=(/top|left/.test(e)?Ss:ws)(i,r)),ge(o)&&(i=(/top|left/.test(e)?ws:Ss)(i,o)),i}function KS(e,t){if(!t)return e;var n=le(e);return Is({top:Oa("top",n,t),right:Oa("right",n,t),bottom:Oa("bottom",n,t),left:Oa("left",n,t)})}function XS(e,t,n,i){var r=le(t),o={top:/n/.test(e)?r.bottom-n.height:r.top,left:/w/.test(e)?r.right-n.width:r.left,bottom:/s/.test(e)?r.top+n.height:r.bottom,right:/e/.test(e)?r.left+n.width:r.right},a=i?le(i):o,s={top:Ss(o.top,a.top),left:Ss(o.left,a.left),bottom:ws(o.bottom,a.bottom),right:ws(o.right,a.right)};return Is(s)}function eo(e,t){return typeof e!="undefined"?e:US}function ZS(e,t){var n,i,r,o;return typeof t=="object"?(n=eo(t.left),i=eo(t.right),r=eo(t.top),o=eo(t.bottom)):n=i=r=o=eo(t),{x:e.x-n,y:e.y-r,width:e.width+n+i,height:e.height+r+o}}function QS(e){return!(e.waypoints||e.type==="label")}function Wg(e,t){var n;if(e.length===void 0?n=Ee(e.children,QS):n=e,n.length)return ZS(Je(n),t)}var ka=Math.abs;function JS(e,t){return Vg(le(t),le(e))}var eC=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],gr=30;function nc(e,t){return t=t||[],e.children.filter(function(n){v(n,"bpmn:Lane")&&(nc(n,t),t.push(n))}),t}function er(e){return e.children.filter(function(t){return v(t,"bpmn:Lane")})}function tn(e){return _s(e,eC)||e}function tC(e,t){var n=tn(e),i=v(n,"bpmn:Process")?[]:[n],r=nc(n,i),o=le(e),a=le(t),s=JS(e,t),c=[];return r.forEach(function(u){if(u!==e){var l=0,p=s.right,f=0,h=s.left,d=le(u);s.top&&(ka(d.bottom-o.top)<10&&(f=a.top-d.bottom),ka(d.top-o.top)<5&&(l=a.top-d.top)),s.bottom&&(ka(d.top-o.bottom)<10&&(l=a.bottom-d.top),ka(d.bottom-o.bottom)<5&&(f=a.bottom-d.bottom)),(l||p||f||h)&&c.push({shape:u,newBounds:qS(u,{top:l,right:p,bottom:f,left:h})})}}),c}function Go(e,t,n,i,r,o,a,s,c,u,l,p){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=r,this._elementFactory=o,this._connect=a,this._create=s,this._popupMenu=c,this._canvas=u,this._rules=l,this._translate=p,e.autoPlace!==!1&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(f){var h=f.context,d=h.shape;if(!(!br(f)||!i.isOpen(d))){var g=i.getEntries(d);g.replace&&g.replace.action.click(f,d)}})}Go.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"];Go.prototype.getMultiElementContextPadEntries=function(e){var t=this._modeling,n={};return this._isDeleteAllowed(e)&&O(n,{delete:{group:"edit",className:"bpmn-icon-trash",title:this._translate("Remove"),action:{click:function(i,r){t.removeElements(r.slice())}}}}),n};Go.prototype._isDeleteAllowed=function(e){var t=this._rules.allowed("elements.delete",{elements:e});return be(t)?gi(t,function(n){return nC(t,n)}):t};Go.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,r=this._connect,o=this._create,a=this._popupMenu,s=this._canvas,c=this._rules,u=this._autoPlace,l=this._translate,p={};if(e.type==="label")return p;var f=e.businessObject;function h(b,S){r.start(b,S)}function d(b,S){n.removeElements([S])}function g(b){var S=5,M=s.getContainer(),C=t.getPad(b).html,R=M.getBoundingClientRect(),D=C.getBoundingClientRect(),F=D.top-R.top,j=D.left-R.left,z={x:j,y:F+D.height+S};return z}function y(b,S,M,C){typeof M!="string"&&(C=M,M=l("Append {type}",{type:b.replace(/^bpmn:/,"")}));function R(F,j){var z=i.createShape(O({type:b},C));o.start(F,z,{source:j})}var D=u?function(F,j){var z=i.createShape(O({type:b},C));u.append(j,z)}:R;return{group:"model",className:S,title:M,action:{dragstart:R,click:D}}}function A(b){return function(S,M){n.splitLane(M,b),t.open(M,!0)}}if(De(f,["bpmn:Lane","bpmn:Participant"])&&Re(e)){var _=er(e);O(p,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:l("Add Lane above"),action:{click:function(b,S){n.addLane(S,"top")}}}}),_.length<2&&(e.height>=120&&O(p,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:l("Divide into two Lanes"),action:{click:A(2)}}}),e.height>=180&&O(p,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:l("Divide into three Lanes"),action:{click:A(3)}}})),O(p,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:l("Add Lane below"),action:{click:function(b,S){n.addLane(S,"bottom")}}}})}v(f,"bpmn:FlowNode")&&(v(f,"bpmn:EventBasedGateway")?O(p,{"append.receive-task":y("bpmn:ReceiveTask","bpmn-icon-receive-task",l("Append ReceiveTask")),"append.message-intermediate-event":y("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",l("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":y("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",l("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":y("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",l("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":y("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",l("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):Zh(f,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?O(p,{"append.compensation-activity":y("bpmn:Task","bpmn-icon-task",l("Append compensation activity"),{isForCompensation:!0})}):!v(f,"bpmn:EndEvent")&&!f.isForCompensation&&!Zh(f,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")&&!It(f)&&O(p,{"append.end-event":y("bpmn:EndEvent","bpmn-icon-end-event-none",l("Append EndEvent")),"append.gateway":y("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",l("Append Gateway")),"append.append-task":y("bpmn:Task","bpmn-icon-task",l("Append Task")),"append.intermediate-event":y("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",l("Append Intermediate/Boundary Event"))})),a.isEmpty(e,"bpmn-replace")||O(p,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:l("Change type"),action:{click:function(b,S){var M=O(g(S),{cursor:{x:b.x,y:b.y}});a.open(S,"bpmn-replace",M)}}}}),v(f,"bpmn:SequenceFlow")&&O(p,{"append.text-annotation":y("bpmn:TextAnnotation","bpmn-icon-text-annotation")}),De(f,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&O(p,{"append.text-annotation":y("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using "+(f.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:h,dragstart:h}}}),v(f,"bpmn:TextAnnotation")&&O(p,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using Association"),action:{click:h,dragstart:h}}}),De(f,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&O(p,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:l("Connect using DataInputAssociation"),action:{click:h,dragstart:h}}}),v(f,"bpmn:Group")&&O(p,{"append.text-annotation":y("bpmn:TextAnnotation","bpmn-icon-text-annotation")});var w=c.allowed("elements.delete",{elements:[e]});return be(w)&&(w=w[0]===e),w&&O(p,{delete:{group:"edit",className:"bpmn-icon-trash",title:l("Remove"),action:{click:d}}}),p};function Zh(e,t,n){var i=e.$instanceOf(t),r=!1,o=e.eventDefinitions||[];return I(o,function(a){a.$type===n&&(r=!0)}),i&&r}function nC(e,t){return e.indexOf(t)!==-1}var iC={__depends__:[Ng,lg,Cn,Jl,Js,WS],__init__:["contextPadProvider"],contextPadProvider:["type",Go]},rC={horizontal:["x","width"],vertical:["y","height"]},Qh=5;function Zn(e,t){this._modeling=e,this._filters=[],this.registerFilter(function(n){var i=t.allowed("elements.distribute",{elements:n});return be(i)?i:i?n:[]})}Zn.$inject=["modeling","rules"];Zn.prototype.registerFilter=function(e){if(typeof e!="function")throw new Error("the filter has to be a function");this._filters.push(e)};Zn.prototype.trigger=function(e,t){var n=this._modeling,i,r;if(!(e.length<3)&&(this._setOrientation(t),r=this._filterElements(e),i=this._createGroups(r),!(i.length<=2)))return n.distributeElements(i,this._axis,this._dimension),i};Zn.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,r=[].concat(e);return t.length?(I(t,function(o){r=o(r,n,i)}),r):e};Zn.prototype._createGroups=function(e){var t=[],n=this,i=this._axis,r=this._dimension;if(!i)throw new Error('must have a defined "axis" and "dimension"');var o=sn(e,i);return I(o,function(a,s){var c=n._findRange(a,i,r),u,l=t[t.length-1];l&&n._hasIntersection(l.range,c)?t[t.length-1].elements.push(a):(u={range:c,elements:[a]},t.push(u))}),t};Zn.prototype._setOrientation=function(e){var t=rC[e];this._axis=t[0],this._dimension=t[1]};Zn.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)};Zn.prototype._findRange=function(e){var t=e[this._axis],n=e[this._dimension];return{min:t+Qh,max:t+n-Qh}};var oC={__init__:["distributeElements"],distributeElements:["type",Zn]};function ic(e,t,n){Ut.call(this,t)}ic.$inject=["distributeElements","eventBus","rules"];oe(ic,Ut);ic.prototype.init=function(){this.addRule("elements.distribute",function(e){var t=e.elements;return t=Ee(t,function(n){var i=De(n,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(n.labelTarget||i)}),t=Bs(t),t.length<3?!1:t})};var aC={horizontal:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201800%201800%22%3E%3Cpath%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bstroke-linejoin%3Around%22%20d%3D%22M450%20400V150h900v250%22%2F%3E%3Crect%20x%3D%22150%22%20y%3D%22450%22%20width%3D%22600%22%20height%3D%221200%22%20rx%3D%221%22%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%22%2F%3E%3Crect%20x%3D%221050%22%20y%3D%22450%22%20width%3D%22600%22%20height%3D%22800%22%20rx%3D%221%22%20style%3D%22fill%3AcurrentColor%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bopacity%3A.5%22%2F%3E%3C%2Fsvg%3E",vertical:"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%201800%201800%22%3E%3Cpath%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bstroke-linejoin%3Around%22%20d%3D%22M400%201350H150V450h250%22%2F%3E%3Crect%20x%3D%22450%22%20y%3D%22150%22%20width%3D%221200%22%20height%3D%22600%22%20rx%3D%221%22%20style%3D%22fill%3Anone%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%22%2F%3E%3Crect%20x%3D%22450%22%20y%3D%221050%22%20width%3D%22800%22%20height%3D%22600%22%20rx%3D%221%22%20style%3D%22fill%3AcurrentColor%3Bstroke%3AcurrentColor%3Bstroke-width%3A100%3Bopacity%3A.5%22%2F%3E%3C%2Fsvg%3E"},Jh=aC,sC=900;function Vo(e,t,n,i){this._distributeElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",sC,this)}Vo.$inject=["popupMenu","distributeElements","translate","rules"];Vo.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&O(t,this._getEntries(e)),t};Vo.prototype._isAllowed=function(e){return this._rules.allowed("elements.distribute",{elements:e})};Vo.prototype._getEntries=function(e){var t=this._distributeElements,n=this._translate,i=this._popupMenu,r={"distribute-elements-horizontal":{group:"distribute",title:n("Distribute elements horizontally"),className:"bjs-align-elements-menu-entry",imageUrl:Jh.horizontal,action:function(o,a){t.trigger(e,"horizontal"),i.close()}},"distribute-elements-vertical":{group:"distribute",title:n("Distribute elements vertically"),imageUrl:Jh.vertical,action:function(o,a){t.trigger(e,"vertical"),i.close()}}};return r};var cC={__depends__:[Ul,oC],__init__:["bpmnDistributeElements","distributeElementsMenuProvider"],bpmnDistributeElements:["type",ic],distributeElementsMenuProvider:["type",Vo]},Ug="is not a registered action",uC="is already registered";function Kt(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}Kt.$inject=["eventBus","injector"];Kt.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),r=e.get("zoomScroll",!1),o=e.get("copyPaste",!1),a=e.get("canvas",!1),s=e.get("rules",!1),c=e.get("keyboardMove",!1),u=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),o&&i&&this.register("copy",function(){var l=i.get();if(l.length)return o.copy(l)}),o&&this.register("paste",function(){o.paste()}),r&&this.register("stepZoom",function(l){r.stepZoom(l.value)}),a&&this.register("zoom",function(l){a.zoom(l.value)}),n&&i&&s&&this.register("removeSelection",function(){var l=i.get();if(!!l.length){var p=s.allowed("elements.delete",{elements:l}),f;p!==!1&&(be(p)?f=p:f=l,f.length&&n.removeElements(f.slice()))}}),c&&this.register("moveCanvas",function(l){c.moveCanvas(l)}),u&&this.register("moveSelection",function(l){u.moveSelection(l.direction,l.accelerated)})};Kt.prototype.trigger=function(e,t){if(!this._actions[e])throw np(e,Ug);return this._actions[e](t)};Kt.prototype.register=function(e,t){var n=this;if(typeof e=="string")return this._registerAction(e,t);I(e,function(i,r){n._registerAction(r,i)})};Kt.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw np(e,uC);this._actions[e]=t};Kt.prototype.unregister=function(e){if(!this.isRegistered(e))throw np(e,Ug);this._actions[e]=void 0};Kt.prototype.getActions=function(){return Object.keys(this._actions)};Kt.prototype.isRegistered=function(e){return!!this._actions[e]};function np(e,t){return new Error(e+" "+t)}var lC={__init__:["editorActions"],editorActions:["type",Kt]};function rc(e){e.invoke(Kt,this)}oe(rc,Kt);rc.$inject=["injector"];rc.prototype._registerDefaultActions=function(e){Kt.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),r=e.get("spaceTool",!1),o=e.get("lassoTool",!1),a=e.get("handTool",!1),s=e.get("globalConnect",!1),c=e.get("distributeElements",!1),u=e.get("alignElements",!1),l=e.get("directEditing",!1),p=e.get("searchPad",!1),f=e.get("modeling",!1);t&&n&&i&&this._registerAction("selectElements",function(){var h=t.getRootElement(),d=n.filter(function(g){return g!==h});return i.select(d),d}),r&&this._registerAction("spaceTool",function(){r.toggle()}),o&&this._registerAction("lassoTool",function(){o.toggle()}),a&&this._registerAction("handTool",function(){a.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&c&&this._registerAction("distributeElements",function(h){var d=i.get(),g=h.type;d.length&&c.trigger(d,g)}),i&&u&&this._registerAction("alignElements",function(h){var d=i.get(),g=[],y=h.type;d.length&&(g=Ee(d,function(A){return!v(A,"bpmn:Lane")}),u.trigger(g,y))}),i&&f&&this._registerAction("setColor",function(h){var d=i.get();d.length&&f.setColor(d,h)}),i&&l&&this._registerAction("directEditing",function(){var h=i.get();h.length&&l.activate(h[0])}),p&&this._registerAction("find",function(){p.toggle()}),t&&f&&this._registerAction("moveToOrigin",function(){var h=t.getRootElement(),d,g;v(h,"bpmn:Collaboration")?g=n.filter(function(y){return v(y.parent,"bpmn:Collaboration")}):g=n.filter(function(y){return y!==h&&!v(y.parent,"bpmn:SubProcess")}),d=Je(g),f.moveElements(g,{x:-d.x,y:-d.y},h)})};var pC={__depends__:[lC],editorActions:["type",rc]};function Yg(e){e.on(["create.init","shape.move.init"],function(t){var n=t.context,i=t.shape;De(i,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(n.gridSnappingContext||(n.gridSnappingContext={}),n.gridSnappingContext.snapLocation="top-left")})}Yg.$inject=["eventBus"];var cs=10;function fu(e,t,n){return n||(n="round"),Math[n](e/t)*t}var fC=1200,hC=800;function xi(e,t,n){var i=!n||n.active!==!1;this._eventBus=t;var r=this;t.on("diagram.init",hC,function(){r.setActive(i)}),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],fC,function(o){var a=o.originalEvent;if(!(!r.active||a&&Ft(a))){var s=o.context,c=s.gridSnappingContext;c||(c=s.gridSnappingContext={}),["x","y"].forEach(function(u){var l={},p=mC(o,u,e);p&&(l.offset=p);var f=dC(o,u);f&&O(l,f),xr(o,u)||r.snapEvent(o,u,l)})}})}xi.prototype.snapEvent=function(e,t,n){var i=this.snapValue(e[t],n);Ge(e,t,i)};xi.prototype.getGridSpacing=function(){return cs};xi.prototype.snapValue=function(e,t){var n=0;t&&t.offset&&(n=t.offset),e+=n,e=fu(e,cs);var i,r;return t&&t.min&&(i=t.min,ge(i)&&(i=fu(i+n,cs,"ceil"),e=Math.max(e,i))),t&&t.max&&(r=t.max,ge(r)&&(r=fu(r+n,cs,"floor"),e=Math.min(e,r))),e-=n,e};xi.prototype.isActive=function(){return this.active};xi.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})};xi.prototype.toggleActive=function(){this.setActive(!this.active)};xi.$inject=["elementRegistry","eventBus","config.gridSnapping"];function dC(e,t){var n=e.context,i=n.createConstraints,r=n.resizeConstraints||{},o=n.gridSnappingContext,a=o.snapConstraints;if(a&&a[t])return a[t];a||(a=o.snapConstraints={}),a[t]||(a[t]={});var s=n.direction;i&&(us(t)?(a.x.min=i.left,a.x.max=i.right):(a.y.min=i.top,a.y.max=i.bottom));var c=r.min,u=r.max;return c&&(us(t)?td(s)?a.x.max=c.left:a.x.min=c.right:ed(s)?a.y.max=c.top:a.y.min=c.bottom),u&&(us(t)?td(s)?a.x.min=u.left:a.x.max=u.right:ed(s)?a.y.min=u.top:a.y.max=u.bottom),a[t]}function mC(e,t,n){var i=e.context,r=e.shape,o=i.gridSnappingContext,a=o.snapLocation,s=o.snapOffset;return s&&ge(s[t])||(s||(s=o.snapOffset={}),ge(s[t])||(s[t]=0),!r)||(n.get(r.id)||(us(t)?s[t]+=r[t]+r.width/2:s[t]+=r[t]+r.height/2),!a)||(t==="x"?/left/.test(a)?s[t]-=r.width/2:/right/.test(a)&&(s[t]+=r.width/2):/top/.test(a)?s[t]-=r.height/2:/bottom/.test(a)&&(s[t]+=r.height/2)),s[t]}function us(e){return e==="x"}function ed(e){return e.indexOf("n")!==-1}function td(e){return e.indexOf("w")!==-1}function tr(e,t){K.call(this,e),this._gridSnapping=t;var n=this;this.preExecute("shape.resize",function(i){var r=i.context,o=r.hints||{},a=o.autoResize;if(!!a){var s=r.shape,c=r.newBounds;Gt(a)?r.newBounds=n.snapComplex(c,a):r.newBounds=n.snapSimple(s,c)}})}tr.$inject=["eventBus","gridSnapping","modeling"];oe(tr,K);tr.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t};tr.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e};tr.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),r=/e/.test(t),o={};return o.width=n.snapValue(e.width,{min:e.width}),r&&(i?(o.x=n.snapValue(e.x,{max:e.x}),o.width+=n.snapValue(e.x-o.x,{min:e.x-o.x})):e.x=e.x+e.width-o.width),O(e,o),e};tr.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),r=/s/.test(t),o={};return o.height=n.snapValue(e.height,{min:e.height}),i&&(r?(o.y=n.snapValue(e.y,{max:e.y}),o.height+=n.snapValue(e.y-o.y,{min:e.y-o.y})):e.y=e.y+e.height-o.height),O(e,o),e};var vC=2e3;function qg(e,t){e.on(["spaceTool.move","spaceTool.end"],vC,function(n){var i=n.context;if(!!i.initialized){var r=i.axis,o;r==="x"?(o=t.snapValue(n.dx),n.x=n.x+o-n.dx,n.dx=o):(o=t.snapValue(n.dy),n.y=n.y+o-n.dy,n.dy=o)}})}qg.$inject=["eventBus","gridSnapping"];var gC={__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",tr],gridSnappingSpaceToolBehavior:["type",qg]},yC={__depends__:[gC],__init__:["gridSnapping"],gridSnapping:["type",xi]},EC=2e3;function Kg(e,t){e.on("autoPlace",EC,function(n){var i=n.source,r=ye(i),o=n.shape,a=gg(i,o);return["x","y"].forEach(function(s){var c={};a[s]!==r[s]&&(a[s]>r[s]?c.min=a[s]:c.max=a[s],v(o,"bpmn:TextAnnotation")&&(_C(s)?c.offset=-o.width/2:c.offset=-o.height/2),a[s]=t.snapValue(a[s],c))}),a})}Kg.$inject=["eventBus","gridSnapping"];function _C(e){return e==="x"}var bC=1750;function Xg(e,t,n){t.on(["create.start","shape.move.start"],bC,function(i){var r=i.context,o=r.shape,a=e.getRootElement();if(!(!v(o,"bpmn:Participant")||!v(a,"bpmn:Process")||!a.children.length)){var s=r.createConstraints;!s||(o.width=n.snapValue(o.width,{min:o.width}),o.height=n.snapValue(o.height,{min:o.height}))}})}Xg.$inject=["canvas","eventBus","gridSnapping"];var xC=3e3;function oc(e,t,n){K.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],xC,function(r){var o=r.context,a=o.connection,s=o.hints||{},c=a.waypoints;s.connectionStart||s.connectionEnd||s.createElementsBehavior===!1||!wC(c)||n.updateWaypoints(a,i.snapMiddleSegments(c))})}oc.$inject=["eventBus","gridSnapping","modeling"];oe(oc,K);oc.prototype.snapMiddleSegments=function(e){var t=this._gridSnapping,n;e=e.slice();for(var i=1;i<e.length-2;i++)n=TC(t,e[i],e[i+1]),e[i]=n[0],e[i+1]=n[1];return e};function wC(e){return e.length>3}function SC(e){return e==="h"}function CC(e){return e==="v"}function TC(e,t,n){var i=Ln(t,n),r={};return SC(i)&&(r.y=e.snapValue(t.y)),CC(i)&&(r.x=e.snapValue(t.x)),("x"in r||"y"in r)&&(t=O({},t,r),n=O({},n,r)),[t,n]}var AC={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",Kg],gridSnappingParticipantBehavior:["type",Xg],gridSnappingLayoutConnectionBehavior:["type",oc]},RC={__depends__:[yC,AC],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",Yg]},PC=30,DC=30;function Wo(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(i){var r=i.element,o=i.gfx;if(v(r,"bpmn:Lane"))return n.createParticipantHit(r,o);if(v(r,"bpmn:Participant"))return Re(r)?n.createParticipantHit(r,o):n.createDefaultHit(r,o);if(v(r,"bpmn:SubProcess"))return Re(r)?n.createSubProcessHit(r,o):n.createDefaultHit(r,o)})}Wo.$inject=["eventBus","interactionEvents"];Wo.prototype.createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0};Wo.prototype.createParticipantHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:PC,height:e.height}),!0};Wo.prototype.createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:DC}),!0};var MC={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",Wo]};function ac(e){e.invoke(Br,this)}oe(ac,Br);ac.$inject=["injector"];ac.prototype.registerBindings=function(e,t){Br.prototype.registerBindings.call(this,e,t);function n(i,r){t.isRegistered(i)&&e.addListener(r)}n("selectElements",function(i){var r=i.keyEvent;if(e.isKey(["a","A"],r)&&e.isCmd(r))return t.trigger("selectElements"),!0}),n("find",function(i){var r=i.keyEvent;if(e.isKey(["f","F"],r)&&e.isCmd(r))return t.trigger("find"),!0}),n("spaceTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["s","S"],r))return t.trigger("spaceTool"),!0}),n("lassoTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["l","L"],r))return t.trigger("lassoTool"),!0}),n("handTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["h","H"],r))return t.trigger("handTool"),!0}),n("globalConnectTool",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["c","C"],r))return t.trigger("globalConnectTool"),!0}),n("directEditing",function(i){var r=i.keyEvent;if(!e.hasModifier(r)&&e.isKey(["e","E"],r))return t.trigger("directEditing"),!0})};var BC={__depends__:[Hl],__init__:["keyboardBindings"],keyboardBindings:["type",ac]},IC={moveSpeed:1,moveSpeedAccelerated:10},FC=1500,nd="left",id="up",rd="right",od="down",OC={ArrowLeft:nd,Left:nd,ArrowUp:id,Up:id,ArrowRight:rd,Right:rd,ArrowDown:od,Down:od},kC={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function Zg(e,t,n,i,r){var o=this;this._config=O({},IC,e||{}),t.addListener(FC,function(a){var s=a.keyEvent,c=OC[s.key];if(!!c&&!t.isCmd(s)){var u=t.isShift(s);return o.moveSelection(c,u),!0}}),this.moveSelection=function(a,s){var c=r.get();if(!!c.length){var u=this._config[s?"moveSpeedAccelerated":"moveSpeed"],l=kC[a](u),p=i.allowed("elements.move",{shapes:c});p&&n.moveElements(c,l)}}}Zg.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];var NC={__depends__:[Hl,Cn],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",Zg]},ad=10;function Uo(e,t,n,i){this._dragging=i,this._rules=t;var r=this;function o(c,u){var l=c.shape,p=c.direction,f=c.resizeConstraints,h;c.delta=u,h=YS(l,p,u),c.newBounds=KS(h,f),c.canExecute=r.canResize(c)}function a(c){var u=c.resizeConstraints,l=c.minBounds;u===void 0&&(l===void 0&&(l=r.computeMinResizeBox(c)),c.resizeConstraints={min:le(l)})}function s(c){var u=c.shape,l=c.canExecute,p=c.newBounds;if(l){if(p=iv(p),!LC(u,p))return;n.resizeShape(u,p)}}e.on("resize.start",function(c){a(c.context)}),e.on("resize.move",function(c){var u={x:c.dx,y:c.dy};o(c.context,u)}),e.on("resize.end",function(c){s(c.context)})}Uo.prototype.canResize=function(e){var t=this._rules,n=cn(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)};Uo.prototype.activate=function(e,t,n){var i=this._dragging,r,o;if(typeof n=="string"&&(n={direction:n}),r=O({shape:t},n),o=r.direction,!o)throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");i.init(e,Qg(t,o),"resize",{autoActivate:!0,cursor:$C(o),data:{shape:t,context:r}})};Uo.prototype.computeMinResizeBox=function(e){var t=e.shape,n=e.direction,i,r;return i=e.minDimensions||{width:ad,height:ad},r=Wg(t,e.childrenBoxPadding),XS(n,t,i,r)};Uo.$inject=["eventBus","rules","modeling","dragging"];function LC(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function Qg(e,t){var n=ye(e),i=le(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function $C(e){var t="resize-";return e==="n"||e==="s"?t+"ns":e==="e"||e==="w"?t+"ew":e==="nw"||e==="se"?t+"nwse":t+"nesw"}var sd="djs-resizing",cd="resize-not-ok",jC=500;function Jg(e,t,n){function i(o){var a=o.shape,s=o.newBounds,c=o.frame;c||(c=o.frame=n.addFrame(a,t.getActiveLayer()),t.addMarker(a,sd)),s.width>5&&W(c,{x:s.x,width:s.width}),s.height>5&&W(c,{y:s.y,height:s.height}),o.canExecute?Se(c).remove(cd):Se(c).add(cd)}function r(o){var a=o.shape,s=o.frame;s&&Le(o.frame),t.removeMarker(a,sd)}e.on("resize.move",jC,function(o){i(o.context)}),e.on("resize.cleanup",function(o){r(o.context)})}Jg.$inject=["eventBus","canvas","previewSupport"];var Na=-6,La=8,$a=20,to="djs-resizer",HC=["n","w","s","e","nw","ne","se","sw"];function wi(e,t,n,i){this._resize=i,this._canvas=t;var r=this;e.on("selection.changed",function(o){var a=o.newSelection;r.removeResizers(),a.length===1&&I(a,wt(r.addResizer,r))}),e.on("shape.changed",function(o){var a=o.element;n.isSelected(a)&&(r.removeResizers(),r.addResizer(a))})}wi.prototype.makeDraggable=function(e,t,n){var i=this._resize;function r(o){_i(o)&&i.activate(o,e,n)}J.bind(t,"mousedown",r),J.bind(t,"touchstart",r)};wi.prototype._createResizer=function(e,t,n,i){var r=this._getResizersParent(),o=zC(i),a=ae("g");Se(a).add(to),Se(a).add(to+"-"+e.id),Se(a).add(to+"-"+i),pe(r,a);var s=ae("rect");W(s,{x:-La/2+o.x,y:-La/2+o.y,width:La,height:La}),Se(s).add(to+"-visual"),pe(a,s);var c=ae("rect");return W(c,{x:-$a/2+o.x,y:-$a/2+o.y,width:$a,height:$a}),Se(c).add(to+"-hit"),pe(a,c),Lu(a,t,n),a};wi.prototype.createResizer=function(e,t){var n=Qg(e,t),i=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,i,t)};wi.prototype.addResizer=function(e){var t=this;GC(e)||!this._resize.canResize({shape:e})||I(HC,function(n){t.createResizer(e,n)})};wi.prototype.removeResizers=function(){var e=this._getResizersParent();Ao(e)};wi.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")};wi.$inject=["eventBus","canvas","selection","resize"];function zC(e){var t={x:0,y:0};return e.indexOf("e")!==-1?t.x=-Na:e.indexOf("w")!==-1&&(t.x=Na),e.indexOf("s")!==-1?t.y=-Na:e.indexOf("n")!==-1&&(t.y=Na),t}function GC(e){return!!e.waypoints}var ey={__depends__:[An,Kn,$o],__init__:["resize","resizePreview","resizeHandles"],resize:["type",Uo],resizePreview:["type",Jg],resizeHandles:["type",wi]},VC=2e3;function Yo(e,t,n,i,r,o,a){this._bpmnFactory=t,this._canvas=n,this._modeling=r,this._textRenderer=a,i.registerProvider(this),e.on("element.dblclick",function(c){s(c.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open","root.set","selection.changed"],function(c){i.isActive()&&i.complete()}),e.on(["shape.remove","connection.remove"],VC,function(c){i.isActive(c.element)&&i.cancel()}),e.on(["commandStack.changed"],function(c){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(c){o.removeResizers()}),e.on("create.end",500,function(c){var u=c.context,l=u.shape,p=c.context.canExecute,f=c.isTouch;f||!p||u.hints&&u.hints.createElementsBehavior===!1||s(l)}),e.on("autoPlace.end",500,function(c){s(c.shape)});function s(c,u){(u||De(c,["bpmn:Task","bpmn:TextAnnotation"])||ip(c))&&i.activate(c)}}Yo.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"];Yo.prototype.activate=function(e){var t=ln(e);if(t!==void 0){var n={text:t},i=this.getEditingBBox(e);O(n,i);var r={};return(De(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||ip(e))&&O(r,{centerVertically:!0}),Yi(e)&&O(r,{autoResize:!0}),v(e,"bpmn:TextAnnotation")&&O(r,{resizable:!0,autoResize:!0}),O(n,{options:r}),n}};Yo.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),r={x:i.x+i.width/2,y:i.y+i.height/2},o={x:i.x,y:i.y},a=t.zoom(),s=this._textRenderer.getDefaultStyle(),c=this._textRenderer.getExternalStyle(),u=c.fontSize*a,l=c.lineHeight,p=s.fontSize*a,f=s.lineHeight,h={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};(v(e,"bpmn:Lane")||YC(e))&&(O(o,{width:i.height,height:30*a,x:i.x-i.height/2+15*a,y:r.y-30*a/2}),O(h,{fontSize:p+"px",lineHeight:f,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px",transform:"rotate(-90deg)"})),(De(e,["bpmn:Task","bpmn:CallActivity"])||UC(e)||ip(e))&&(O(o,{width:i.width,height:i.height}),O(h,{fontSize:p+"px",lineHeight:f,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px"})),WC(e)&&(O(o,{width:i.width,x:i.x}),O(h,{fontSize:p+"px",lineHeight:f,paddingTop:7*a+"px",paddingBottom:7*a+"px",paddingLeft:5*a+"px",paddingRight:5*a+"px"}));var d=90*a,g=7*a,y=4*a;if(n.labelTarget&&(O(o,{width:d,height:i.height+g+y,x:r.x-d/2,y:i.y-g}),O(h,{fontSize:u+"px",lineHeight:l,paddingTop:g+"px",paddingBottom:y+"px"})),Yi(n)&&!Gs(n)&&!rt(n)){var A=Vs(e),_=t.getAbsoluteBBox({x:A.x,y:A.y,width:0,height:0}),w=u+g+y;O(o,{width:d,height:w,x:_.x-d/2,y:_.y-w/2}),O(h,{fontSize:u+"px",lineHeight:l,paddingTop:g+"px",paddingBottom:y+"px"})}return v(e,"bpmn:TextAnnotation")&&(O(o,{width:i.width,height:i.height,minWidth:30*a,minHeight:10*a}),O(h,{textAlign:"left",paddingTop:5*a+"px",paddingBottom:7*a+"px",paddingLeft:7*a+"px",paddingRight:5*a+"px",fontSize:p+"px",lineHeight:f})),{bounds:o,style:h}};Yo.prototype.update=function(e,t,n,i){var r,o;v(e,"bpmn:TextAnnotation")&&(o=this._canvas.getAbsoluteBBox(e),r={x:e.x,y:e.y,width:e.width/o.width*i.width,height:e.height/o.height*i.height}),qC(t)&&(t=null),this._modeling.updateLabel(e,t,r)};function ip(e){return v(e,"bpmn:SubProcess")&&!Re(e)}function WC(e){return v(e,"bpmn:SubProcess")&&Re(e)}function UC(e){return v(e,"bpmn:Participant")&&!Re(e)}function YC(e){return v(e,"bpmn:Participant")&&Re(e)}function qC(e){return!e||!e.trim()}var ud="djs-element-hidden",ld="djs-label-hidden";function ty(e,t,n,i){var r=this,o=t.getDefaultLayer(),a,s,c;e.on("directEditing.activate",function(u){var l=u.active;if(a=l.element.label||l.element,v(a,"bpmn:TextAnnotation")){s=t.getAbsoluteBBox(a),c=ae("g");var p=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:a.width,containerHeight:a.height,position:{mx:0,my:0}}),f=r.path=ae("path");W(f,{d:p,strokeWidth:2,stroke:KC(a)}),pe(c,f),pe(o,c),At(c,a.x,a.y)}v(a,"bpmn:TextAnnotation")||a.labelTarget?t.addMarker(a,ud):(v(a,"bpmn:Task")||v(a,"bpmn:CallActivity")||v(a,"bpmn:SubProcess")||v(a,"bpmn:Participant"))&&t.addMarker(a,ld)}),e.on("directEditing.resize",function(u){if(v(a,"bpmn:TextAnnotation")){var l=u.height,p=u.dy,f=Math.max(a.height/s.height*(l+p),0),h=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:a.width,containerHeight:f,position:{mx:0,my:0}});W(r.path,{d:h})}}),e.on(["directEditing.complete","directEditing.cancel"],function(u){var l=u.active;l&&(t.removeMarker(l.element.label||l.element,ud),t.removeMarker(a,ld)),a=void 0,s=void 0,c&&(Le(c),c=void 0)})}ty.$inject=["eventBus","canvas","elementRegistry","pathMap"];function KC(e,t){var n=Ce(e);return n.get("stroke")||t||"black"}var XC={__depends__:[Ll,ey,Ng],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",Yo],labelEditingPreview:["type",ty]},rp=["top","bottom","left","right"],ja=10;function op(e,t){K.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(r){var o=r.context,a=o.connection,s=a.source,c=a.target,u=o.hints||{};u.createElementsBehavior!==!1&&(n(s),n(c))}),this.postExecuted(["label.create"],function(r){var o=r.context,a=o.shape,s=o.hints||{};s.createElementsBehavior!==!1&&n(a.labelTarget)}),this.postExecuted(["elements.create"],function(r){var o=r.context,a=o.elements,s=o.hints||{};s.createElementsBehavior!==!1&&a.forEach(function(c){n(c)})});function n(r){if(!!Gs(r)){var o=JC(r);!o||i(r,o)}}function i(r,o){var a=ye(r),s=r.label,c=ye(s);if(!!s.parent){var u=le(r),l;switch(o){case"top":l={x:a.x,y:u.top-ja-s.height/2};break;case"left":l={x:u.left-ja-s.width/2,y:a.y};break;case"bottom":l={x:a.x,y:u.bottom+ja+s.height/2};break;case"right":l={x:u.right+ja+s.width/2,y:a.y};break}var p=an(l,c);t.moveShape(s,p)}}}oe(op,K);op.$inject=["eventBus","modeling"];function ZC(e){var t=e.host,n=ye(e),i=pt(n,t),r;i.indexOf("-")>=0?r=i.split("-"):r=[i];var o=rp.filter(function(a){return r.indexOf(a)===-1});return o}function QC(e){var t=ye(e),n=[].concat(e.incoming.map(function(i){return i.waypoints[i.waypoints.length-2]}),e.outgoing.map(function(i){return i.waypoints[1]})).map(function(i){return ny(t,i)});return n}function JC(e){var t=ye(e.label),n=ye(e),i=ny(n,t);if(!!eT(i)){var r=QC(e);if(e.host){var o=ZC(e);r=r.concat(o)}var a=rp.filter(function(s){return r.indexOf(s)===-1});if(a.indexOf(i)===-1)return a[0]}}function ny(e,t){return pt(t,e,5)}function eT(e){return rp.indexOf(e)!==-1}function ap(e,t,n){K.call(this,e),this.preExecute("shape.append",function(i){var r=i.source,o=i.shape;i.position||(v(o,"bpmn:TextAnnotation")?i.position={x:r.x+r.width/2+75,y:r.y-50-o.height/2}:i.position={x:r.x+r.width+80+o.width/2,y:r.y+r.height/2})},!0)}oe(ap,K);ap.$inject=["eventBus","elementFactory","bpmnRules"];function sp(e,t){e.invoke(K,this),this.postExecute("shape.move",function(n){var i=n.newParent,r=n.shape,o=Ee(r.incoming.concat(r.outgoing),function(a){return v(a,"bpmn:Association")});I(o,function(a){t.moveConnection(a,{x:0,y:0},i)})},!0)}oe(sp,K);sp.$inject=["injector","modeling"];var pd=500;function sc(e,t){t.invoke(K,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",pd,function(i){var r=i.elements;r=r.filter(function(o){var a=o.host;return fd(o,a)}),r.length===1&&r.map(function(o){return r.indexOf(o)}).forEach(function(o){var a=r[o];i.elements[o]=n.replaceShape(r[o],a)})},!0),this.preExecute("elements.move",pd,function(i){var r=i.shapes,o=i.newHost;if(r.length===1){var a=r[0];fd(a,o)&&(i.shapes=[n.replaceShape(a,o)])}},!0)}sc.$inject=["bpmnReplace","injector"];oe(sc,K);sc.prototype.replaceShape=function(e,t){var n=tT(e),i={type:"bpmn:BoundaryEvent",host:t};return n&&(i.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,i,{layoutConnection:!1})};function tT(e){var t=X(e),n=t.eventDefinitions;return n&&n[0]}function fd(e,t){return!rt(e)&&De(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}function cp(e,t){K.call(this,e);function n(i){return Ee(i.attachers,function(r){return v(r,"bpmn:BoundaryEvent")})}this.postExecute("connection.create",function(i){var r=i.context.source,o=i.context.target,a=n(o);v(r,"bpmn:EventBasedGateway")&&v(o,"bpmn:ReceiveTask")&&a.length>0&&t.removeElements(a)}),this.postExecute("connection.reconnect",function(i){var r=i.context.oldSource,o=i.context.newSource;v(r,"bpmn:Gateway")&&v(o,"bpmn:EventBasedGateway")&&I(o.outgoing,function(a){var s=a.target,c=n(s);v(s,"bpmn:ReceiveTask")&&c.length>0&&t.removeElements(c)})})}cp.$inject=["eventBus","modeling"];oe(cp,K);function up(e){e.invoke(K,this),this.preExecute("shape.create",1500,function(t){var n=t.context,i=n.parent,r=n.shape;v(i,"bpmn:Lane")&&!v(r,"bpmn:Lane")&&(n.parent=_s(i,"bpmn:Participant"))})}up.$inject=["injector"];oe(up,K);function lp(e,t,n){K.call(this,e),this.preExecute("shape.create",function(i){var r=i.context,o=r.shape;if(v(o,"bpmn:DataObjectReference")&&o.type!=="label"){var a=t.create("bpmn:DataObject");o.businessObject.dataObjectRef=a}})}lp.$inject=["eventBus","bpmnFactory","moddle"];oe(lp,K);var Ku=20,Xu=20,iy=30,Ha=2e3;function pp(e,t,n){K.call(this,t),t.on(["create.start","shape.move.start"],Ha,function(r){var o=r.context,a=o.shape,s=e.getRootElement();if(!(!v(a,"bpmn:Participant")||!v(s,"bpmn:Process")||!s.children.length)){var c=s.children.filter(function(p){return!v(p,"bpmn:Group")&&!rt(p)&&!rT(p)});if(!!c.length){var u=Je(c),l=nT(a,u);O(a,l),o.createConstraints=iT(a,u)}}}),t.on("create.start",Ha,function(r){var o=r.context,a=o.shape,s=e.getRootElement(),c=e.getGraphics(s);function u(l){l.element=s,l.gfx=c}v(a,"bpmn:Participant")&&v(s,"bpmn:Process")&&(t.on("element.hover",Ha,u),t.once("create.cleanup",function(){t.off("element.hover",u)}))});function i(){var r=e.getRootElement();return v(r,"bpmn:Collaboration")?r:n.makeCollaboration()}this.preExecute("elements.create",Ha,function(r){var o=r.elements,a=r.parent,s=oT(o),c;s&&v(a,"bpmn:Process")&&(r.parent=i(),c=r.hints=r.hints||{},c.participant=s,c.process=a,c.processRef=X(s).get("processRef"))},!0),this.preExecute("shape.create",function(r){var o=r.parent,a=r.shape;v(a,"bpmn:Participant")&&v(o,"bpmn:Process")&&(r.parent=i(),r.process=o,r.processRef=X(a).get("processRef"))},!0),this.execute("shape.create",function(r){var o=r.hints||{},a=r.process||o.process,s=r.shape,c=o.participant;a&&(!c||s===c)&&X(s).set("processRef",X(a))},!0),this.revert("shape.create",function(r){var o=r.hints||{},a=r.process||o.process,s=r.processRef||o.processRef,c=r.shape,u=o.participant;a&&(!u||c===u)&&X(c).set("processRef",s)},!0),this.postExecute("shape.create",function(r){var o=r.hints||{},a=r.process||r.hints.process,s=r.shape,c=o.participant;if(a){var u=a.children.slice();c?s===c&&n.moveElements(u,{x:0,y:0},c):n.moveElements(u,{x:0,y:0},s)}},!0)}pp.$inject=["canvas","eventBus","modeling"];oe(pp,K);function nT(e,t){t={width:t.width+Ku*2+iy,height:t.height+Xu*2};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}function iT(e,t){return t=le(t),{bottom:t.top+e.height/2-Xu,left:t.right-e.width/2+Ku,top:t.bottom-e.height/2+Xu,right:t.left+e.width/2-Ku-iy}}function rT(e){return!!e.waypoints}function oT(e){return Me(e,function(t){return v(t,"bpmn:Participant")})}var hd="__targetRef_placeholder";function fp(e,t){K.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],dd(o)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],dd(o));function n(a,s,c){var u=a.get("dataInputAssociations");return Me(u,function(l){return l!==c&&l.targetRef===s})}function i(a,s){var c=a.get("properties"),u=Me(c,function(l){return l.name===hd});return!u&&s&&(u=t.create("bpmn:Property",{name:hd}),Ke(c,u)),u}function r(a,s){var c=i(a);!c||n(a,c,s)||We(a.get("properties"),c)}function o(a){var s=a.context,c=s.connection,u=c.businessObject,l=c.target,p=l&&l.businessObject,f=s.newTarget,h=f&&f.businessObject,d=s.oldTarget||s.target,g=d&&d.businessObject,y=c.businessObject,A;g&&g!==p&&r(g,u),h&&h!==p&&r(h,u),p?(A=i(p,!0),y.targetRef=A):y.targetRef=null}}fp.$inject=["eventBus","bpmnFactory"];oe(fp,K);function dd(e){return function(t){var n=t.context,i=n.connection;if(v(i,"bpmn:DataInputAssociation"))return e(t)}}function cc(e){this._bpmnUpdater=e}cc.$inject=["bpmnUpdater"];cc.prototype.execute=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.newSemanticParent,r=e.newDiParent;e.oldSemanticParent=t.$parent,e.oldDiParent=n.$parent,this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,r)};cc.prototype.revert=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.oldSemanticParent,r=e.oldDiParent;this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,r)};function hp(e,t,n,i){K.call(this,i),t.registerHandler("dataStore.updateContainment",cc);function r(){return n.filter(function(s){return v(s,"bpmn:Participant")&&X(s).processRef})[0]}function o(s){return s.children.filter(function(c){return v(c,"bpmn:DataStoreReference")&&!c.labelTarget})}function a(s,c){var u=s.businessObject||s;if(c=c||r(),c){var l=c.businessObject||c;t.execute("dataStore.updateContainment",{dataStoreBo:u,dataStoreDi:Ce(s),newSemanticParent:l.processRef||l,newDiParent:Ce(c)})}}this.preExecute("shape.create",function(s){var c=s.context,u=c.shape;v(u,"bpmn:DataStoreReference")&&u.type!=="label"&&(c.hints||(c.hints={}),c.hints.autoResize=!1)}),this.preExecute("elements.move",function(s){var c=s.context,u=c.shapes,l=u.filter(function(p){return v(p,"bpmn:DataStoreReference")});l.length&&(c.hints||(c.hints={}),c.hints.autoResize=u.filter(function(p){return!v(p,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(s){var c=s.context,u=c.shape,l=u.parent;v(u,"bpmn:DataStoreReference")&&u.type!=="label"&&v(l,"bpmn:Collaboration")&&a(u)}),this.postExecute("shape.move",function(s){var c=s.context,u=c.shape,l=c.oldParent,p=u.parent;if(!v(l,"bpmn:Collaboration")&&v(u,"bpmn:DataStoreReference")&&u.type!=="label"&&v(p,"bpmn:Collaboration")){var f=v(l,"bpmn:Participant")?l:sT(l,"bpmn:Participant");a(u,f)}}),this.postExecute("shape.delete",function(s){var c=s.context,u=c.shape,l=e.getRootElement();De(u,["bpmn:Participant","bpmn:SubProcess"])&&v(l,"bpmn:Collaboration")&&o(l).filter(function(p){return aT(p,u)}).forEach(function(p){a(p)})}),this.postExecute("canvas.updateRoot",function(s){var c=s.context,u=c.oldRoot,l=c.newRoot,p=o(u);p.forEach(function(f){v(l,"bpmn:Process")&&a(f,l)})})}hp.$inject=["canvas","commandStack","elementRegistry","eventBus"];oe(hp,K);function aT(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}function sT(e,t){for(;e.parent;){if(v(e.parent,t))return e.parent;e=e.parent}}var cT=500;function dp(e,t,n){K.call(this,e);function i(r,o){var a=er(o),s=[],c=[];if(Xi(a,function(f){return f.y>r.y?c.push(f):s.push(f),f.children}),!!a.length){var u;c.length&&s.length?u=r.height/2:u=r.height;var l,p;s.length&&(l=n.calculateAdjustments(s,"y",u,r.y-10),n.makeSpace(l.movingShapes,l.resizingShapes,{x:0,y:u},"s")),c.length&&(p=n.calculateAdjustments(c,"y",-u,r.y+r.height+10),n.makeSpace(p.movingShapes,p.resizingShapes,{x:0,y:-u},"n"))}}this.postExecuted("shape.delete",cT,function(r){var o=r.context,a=o.hints,s=o.shape,c=o.oldParent;!v(s,"bpmn:Lane")||a&&a.nested||i(s,c)})}dp.$inject=["eventBus","modeling","spaceTool"];oe(dp,K);var md=500;function uc(e,t){t.invoke(K,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",md,function(i){var r=i.elements;r.filter(function(o){var a=o.host;return vd(o,a)}).map(function(o){return r.indexOf(o)}).forEach(function(o){i.elements[o]=n.replaceShape(r[o])})},!0),this.preExecute("elements.move",md,function(i){var r=i.shapes,o=i.newHost;r.forEach(function(a,s){var c=a.host;vd(a,lT(r,c)?c:o)&&(r[s]=n.replaceShape(a))})},!0)}uc.$inject=["bpmnReplace","injector"];oe(uc,K);uc.prototype.replaceShape=function(e){var t=uT(e),n;return t?n={type:"bpmn:IntermediateCatchEvent",eventDefinitionType:t.$type}:n={type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,n,{layoutConnection:!1})};function uT(e){var t=X(e),n=t.eventDefinitions;return n&&n[0]}function vd(e,t){return!rt(e)&&v(e,"bpmn:BoundaryEvent")&&!t}function lT(e,t){return e.indexOf(t)!==-1}function mp(e,t,n){K.call(this,e);function i(r,o,a){var s=o.waypoints,c,u,l,p,f,h,d,g=r.outgoing.slice(),y=r.incoming.slice(),A;ge(a.width)?A=ye(a):A=a;var _=Gu(s,A);if(_){if(c=s.slice(0,_.index),u=s.slice(_.index+(_.bendpoint?1:0)),!c.length||!u.length)return;l=_.bendpoint?s[_.index]:A,(c.length===1||!gd(r,c[c.length-1]))&&c.push(yd(l)),(u.length===1||!gd(r,u[0]))&&u.unshift(yd(l))}p=o.source,f=o.target,t.canConnect(p,r,o)&&(n.reconnectEnd(o,r,c||A),h=o),t.canConnect(r,f,o)&&(h?d=n.connect(r,f,{type:o.type,waypoints:u}):(n.reconnectStart(o,r,u||A),d=o));var w=[].concat(h&&Ee(y,function(b){return b.source===h.source})||[],d&&Ee(g,function(b){return b.target===d.target})||[]);w.length&&n.removeElements(w)}this.preExecute("elements.move",function(r){var o=r.newParent,a=r.shapes,s=r.delta,c=a[0];if(!(!c||!o)){o&&o.waypoints&&(r.newParent=o=o.parent);var u=ye(c),l={x:u.x+s.x,y:u.y+s.y},p=Me(o.children,function(f){var h=t.canInsert(a,f);return h&&Gu(f.waypoints,l)});p&&(r.targetFlow=p,r.position=l)}},!0),this.postExecuted("elements.move",function(r){var o=r.shapes,a=r.targetFlow,s=r.position;a&&i(o[0],a,s)},!0),this.preExecute("shape.create",function(r){var o=r.parent,a=r.shape;t.canInsert(a,o)&&(r.targetFlow=o,r.parent=o.parent)},!0),this.postExecuted("shape.create",function(r){var o=r.shape,a=r.targetFlow,s=r.position;a&&i(o,a,s)},!0)}oe(mp,K);mp.$inject=["eventBus","bpmnRules","modeling"];function gd(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function yd(e){return O({},e)}function vp(e,t){K.call(this,e),this.preExecuted("connection.create",function(n){var i=n.context,r=i.source,o=i.target,a=o.incoming.slice();i.hints&&i.hints.createElementsBehavior===!1||v(r,"bpmn:EventBasedGateway")&&o.incoming.length&&a.filter(hu).forEach(function(s){t.removeConnection(s)})}),this.preExecuted("shape.replace",function(n){var i=n.context.newShape,r,o;!v(i,"bpmn:EventBasedGateway")||(r=i.outgoing.filter(hu).map(function(a){return a.target}),o=r.reduce(function(a,s){var c=s.incoming.filter(hu);return a.concat(c)},[]),o.forEach(function(a){a.source!==i&&t.removeConnection(a)}))})}vp.$inject=["eventBus","modeling"];oe(vp,K);function hu(e){return v(e,"bpmn:SequenceFlow")}var za=1500,pT=2e3;function ry(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],za,function(i){var r=i.context,o=r.shape||i.shape,a=i.hover;v(a,"bpmn:Lane")&&!De(o,["bpmn:Lane","bpmn:Participant"])&&(i.hover=tn(a),i.hoverGfx=e.getGraphics(i.hover));var s=n.getRootElement();a!==s&&(o.labelTarget||v(o,"bpmn:Group"))&&(i.hover=s,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],za,function(i){var r=i.hover;v(r,"bpmn:Lane")&&(i.hover=tn(r)||r,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["bendpoint.move.hover"],za,function(i){var r=i.context,o=i.hover,a=r.type;v(o,"bpmn:Lane")&&/reconnect/.test(a)&&(i.hover=tn(o)||o,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.start"],za,function(i){var r=i.context,o=r.start;v(o,"bpmn:Lane")&&(r.start=tn(o)||o)}),t.on("shape.move.start",pT,function(i){var r=i.shape;v(r,"bpmn:Lane")&&(i.shape=tn(r)||r)})}ry.$inject=["elementRegistry","eventBus","canvas"];function fT(e){return e.create("bpmn:Category")}function hT(e){return e.create("bpmn:CategoryValue")}function dT(e,t,n){return Ke(t.get("categoryValue"),e),e.$parent=t,Ke(n.get("rootElements"),t),t.$parent=n,e}function mT(e){var t=e.$parent;return t&&(We(t.get("categoryValue"),e),e.$parent=null),e}function vT(e){var t=e.$parent;return t&&(We(t.get("rootElements"),e),e.$parent=null),e}var Ed=770;function gp(e,t,n,i,r,o){r.invoke(K,this);function a(){return n.filter(function(d){return v(d,"bpmn:Group")})}function s(d,g){return d.some(function(y){var A=X(y),_=A.categoryValueRef&&A.categoryValueRef.$parent;return _===g})}function c(d,g){return d.some(function(y){var A=X(y);return A.categoryValueRef===g})}function u(d,g,y){var A=a().filter(function(_){return _.businessObject!==y});g&&!s(A,g)&&vT(g),d&&!c(A,d)&&mT(d)}function l(d,g){return dT(d,g,t.getDefinitions())}function p(d,g){var y=X(d),A=y.categoryValueRef;A||(A=y.categoryValueRef=g.categoryValue=g.categoryValue||hT(e));var _=A.$parent;_||(_=A.$parent=g.category=g.category||fT(e)),l(A,_,t.getDefinitions())}function f(d,g){var y=g.category,A=g.categoryValue,_=X(d);A?(_.categoryValueRef=null,u(A,y,_)):u(null,_.categoryValueRef.$parent,_)}this.execute("label.create",function(d){var g=d.context,y=g.labelTarget;!v(y,"bpmn:Group")||p(y,g)}),this.revert("label.create",function(d){var g=d.context,y=g.labelTarget;!v(y,"bpmn:Group")||f(y,g)}),this.execute("shape.delete",function(d){var g=d.context,y=g.shape,A=X(y);if(!(!v(y,"bpmn:Group")||y.labelTarget)){var _=g.categoryValue=A.categoryValueRef,w;_&&(w=g.category=_.$parent,u(_,w,A),A.categoryValueRef=null)}}),this.reverted("shape.delete",function(d){var g=d.context,y=g.shape;if(!(!v(y,"bpmn:Group")||y.labelTarget)){var A=g.category,_=g.categoryValue,w=X(y);_&&(w.categoryValueRef=_,l(_,A))}}),this.execute("shape.create",function(d){var g=d.context,y=g.shape;!v(y,"bpmn:Group")||y.labelTarget||X(y).categoryValueRef&&p(y,g)}),this.reverted("shape.create",function(d){var g=d.context,y=g.shape;!v(y,"bpmn:Group")||y.labelTarget||X(y).categoryValueRef&&f(y,g)});function h(d,g){var y=e.create(d.$type);return o.copyElement(d,y,null,g)}i.on("copyPaste.copyElement",Ed,function(d){var g=d.descriptor,y=d.element;if(!(!v(y,"bpmn:Group")||y.labelTarget)){var A=X(y);if(A.categoryValueRef){var _=A.categoryValueRef;g.categoryValue=h(_,!0),_.$parent&&(g.category=h(_.$parent,!0))}}}),i.on("copyPaste.pasteElement",Ed,function(d){var g=d.descriptor,y=g.businessObject,A=g.categoryValue,_=g.category;A&&(A=y.categoryValueRef=h(A)),_&&(A.$parent=h(_)),delete g.category,delete g.categoryValue})}gp.$inject=["bpmnFactory","bpmnjs","elementRegistry","eventBus","injector","moddleCopy"];oe(gp,K);function Zu(e,t,n,i){var r,o,a,s,c;return r=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y),r==0?null:(o=e.y-n.y,a=e.x-n.x,c=(i.x-n.x)*o-(i.y-n.y)*a,s=c/r,{x:Math.round(e.x+s*(t.x-e.x)),y:Math.round(e.y+s*(t.y-e.y))})}function oy(e){function t(i,r,o){var a={x:o.x,y:o.y-50},s={x:o.x-50,y:o.y},c=Zu(i,r,o,a),u=Zu(i,r,o,s),l;c&&u?_d(c,o)>_d(u,o)?l=u:l=c:l=c||u,i.original=l}function n(i){var r=i.waypoints;t(r[0],r[1],ye(i.source)),t(r[r.length-1],r[r.length-2],ye(i.target))}e.on("bpmnElement.added",function(i){var r=i.element;r.waypoints&&n(r)})}oy.$inject=["eventBus"];function _d(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function yp(e){K.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(n){var i=n.context.shape,r=X(i),o=Ce(i);De(r,t)&&!o.get("isHorizontal")&&o.set("isHorizontal",!0)})}yp.$inject=["eventBus"];oe(yp,K);var ay=Math.sqrt,sy=Math.min,gT=Math.max,bd=Math.abs;function xd(e){return Math.pow(e,2)}function no(e,t){return ay(xd(e.x-t.x)+xd(e.y-t.y))}function yT(e,t){var n=0,i,r,o,a,s,c,u,l,p,f,h;for(n=0;n<t.length-1;n++){if(i=t[n],r=t[n+1],Sd(i,r)?u=[i]:(o=no(e,i),a=no(e,r),c=sy(o,a),u=ET(i,r,e,c)),u.length<1)throw new Error("expected between [1, 2] circle -> line intersections");u.length===1&&(l={type:"bendpoint",position:u[0],segmentIndex:n,bendpointIndex:Sd(i,u[0])?n:n+1}),u.length===2&&(s=bT(u[0],u[1]),l={type:"segment",position:s,segmentIndex:n,relativeLocation:no(i,s)/no(i,r)}),p=no(l.position,e),(!h||f>p)&&(h=l,f=p)}return h}function ET(e,t,n,i){var r=t.x-e.x,o=t.y-e.y,a=n.x-e.x,s=n.y-e.y,c=r*r+o*o,u=r*a+o*s,l=a*a+s*s-i*i,p=u/c,f=l/c,h=p*p-f;if(h<0&&h>-1e-6&&(h=0),h<0)return[];var d=ay(h),g=-p+d,y=-p-d,A={x:e.x-r*g,y:e.y-o*g};if(h===0)return[A];var _={x:e.x-r*y,y:e.y-o*y};return[A,_].filter(function(w){return _T(w,e,t)})}function _T(e,t,n){return wd(e.x,t.x,n.x)&&wd(e.y,t.y,n.y)}function wd(e,t,n){return e>=sy(t,n)-Cs&&e<=gT(t,n)+Cs}function bT(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var Cs=.1;function Sd(e,t){return bd(e.x-t.x)<=Cs&&bd(e.y-t.y)<=Cs}function xT(e,t,n,i){var r=n.segmentIndex,o=t.length-e.length;if(i.segmentMove){var a=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return r===a?s:r>=s?r+o<s?s:r+o:r}if(i.bendpointMove){var c=i.bendpointMove.insert,u=i.bendpointMove.bendpointIndex,l;if(o===0)return r;if(r>=u&&(l=c?r+1:r-1),r<u&&(l=r,c&&n.type!=="bendpoint"&&u-1===r)){var p=uy(t,u);p<n.relativeLocation&&l++}return l}return o===0?r:i.connectionStart&&r===0?0:i.connectionEnd&&r===e.length-2?t.length-2:Math.floor((t.length-2)/2)}function cy(e,t,n,i){var r=0,o=0,a={point:e,delta:{x:0,y:0}},s=yT(e,n),c=s.segmentIndex,u=xT(n,t,s,i);if(u<0||u>t.length-2||u===null)return a;var l=Cd(n,c),p=Cd(t,u),f=s.position,h=ST(l,f),d=wT(l,p);if(s.type==="bendpoint"){var g=t.length-n.length,y=s.bendpointIndex,A=n[y];if(t.indexOf(A)!==-1)return a;if(g===0){var _=t[y];return r=_.x-s.position.x,o=_.y-s.position.y,{delta:{x:r,y:o},point:{x:e.x+r,y:e.y+o}}}g<0&&y!==0&&y<n.length-1&&(h=uy(n,y))}var w={x:(p[1].x-p[0].x)*h+p[0].x,y:(p[1].y-p[0].y)*h+p[0].y},b=Lw({x:e.x-f.x,y:e.y-f.y},d);return r=w.x+b.x-e.x,o=w.y+b.y-e.y,{point:$n(w),delta:$n({x:r,y:o})}}function uy(e,t){var n=bs(e[t-1],e[t]),i=bs(e[t],e[t+1]),r=n/(n+i);return r}function wT(e,t){var n=bh(e),i=bh(t);return i-n}function Cd(e,t){return[e[t],e[t+1]]}function ST(e,t){var n=bs(e[0],e[1]),i=bs(e[0],t);return n===0?0:i/n}function CT(e,t,n,i){var r=TT(e);return cy(r,t,n,i).delta}function TT(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function qo(e,t,n){var i=po(t),r=po(n),o=an(e,i),a={x:o.x*(n.width/t.width),y:o.y*(n.height/t.height)};return $n({x:r.x+a.x,y:r.y+a.y})}function Td(e,t,n){var i=po(e),r=po(t),o=po(n),a=an(e,i),s=an(i,r),c=AT(i,t,n);if(c)return c;var u={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},l={x:o.x+u.x,y:o.y+u.y};return $n({x:l.x+a.x-e.x,y:l.y+a.y-e.y})}function AT(e,t,n){var i=le(t),r=le(n);if(RT(i,r))return null;var o=pt(t,e),a,s,c;if(o==="top")a={x:0,y:r.bottom-i.bottom};else if(o==="bottom")a={x:0,y:r.top-i.top};else if(o==="right")a={x:r.left-i.left,y:0};else if(o==="left")a={x:r.right-i.right,y:0};else return null;return s={x:e.x+a.x,y:e.y+a.y},c=pt(n,s),c!==o?null:a}function RT(e,t){return PT(e,t)||DT(e,t)}function PT(e,t){return e.right!==t.right&&e.left!==t.left}function DT(e,t){return e.top!==t.top&&e.bottom!==t.bottom}var MT={width:90,height:20},Ad="name",Rd="text";function Ep(e,t,n,i){K.call(this,e),this.postExecute("element.updateProperties",function(o){var a=o.context,s=a.element,c=a.properties;if(Ad in c&&t.updateLabel(s,c[Ad]),Rd in c&&v(s,"bpmn:TextAnnotation")){var u=i.getTextAnnotationBounds({x:s.x,y:s.y,width:s.width,height:s.height},c[Rd]||"");t.updateLabel(s,c.text,u)}}),this.postExecute(["shape.create","connection.create"],function(o){var a=o.context,s=a.hints||{};if(s.createElementsBehavior!==!1){var c=a.shape||a.connection,u=c.businessObject;if(!(rt(c)||!Yi(c))&&!!ln(c)){var l=Vs(c),p=i.getExternalLabelBounds(MT,ln(c));t.createLabel(c,l,{id:u.id+"_label",businessObject:u,width:p.width,height:p.height})}}}),this.postExecute("shape.delete",function(o){var a=o.context,s=a.labelTarget,c=a.hints||{};s&&c.unsetLabel!==!1&&t.updateLabel(s,null,null,{removeShape:!1})}),this.postExecute(["label.create"],function(o){var a=o.context,s=a.shape,c=a.labelTarget,u;!c||!v(c,"bpmn:BaseElement")||(u=Ce(c),u.label||(u.label=n.create("bpmndi:BPMNLabel",{bounds:n.create("dc:Bounds")}),s.di=u),O(u.label.bounds,{x:s.x,y:s.y,width:s.width,height:s.height}))});function r(o){var a=o.context,s=a.connection,c=s.label,u=O({},a.hints),l=a.newWaypoints||s.waypoints,p=a.oldWaypoints;return typeof u.startChanged=="undefined"&&(u.startChanged=!!u.connectionStart),typeof u.endChanged=="undefined"&&(u.endChanged=!!u.connectionEnd),CT(c,l,p,u)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(o){var a=o.context,s=a.hints||{};if(s.labelBehavior!==!1){var c=a.connection,u=c.label,l;!u||!u.parent||(l=r(o),t.moveShape(u,l))}}),this.postExecute(["shape.replace"],function(o){var a=o.context,s=a.newShape,c=a.oldShape,u=X(s);u&&Yi(u)&&c.label&&s.label&&(s.label.x=c.label.x,s.label.y=c.label.y)}),this.postExecute("shape.resize",function(o){var a=o.context,s=a.shape,c=a.newBounds,u=a.oldBounds;if(Gs(s)){var l=s.label,p=ye(l),f=FT(u),h=IT(p,f),d=BT(h,u,c);t.moveShape(l,d)}})}oe(Ep,K);Ep.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];function BT(e,t,n){var i=qo(e,t,n);return $n(an(i,e))}function IT(e,t){if(!!t.length){var n=OT(e,t);return Xl(e,n)}}function FT(e){return[[{x:e.x,y:e.y},{x:e.x+(e.width||0),y:e.y}],[{x:e.x+(e.width||0),y:e.y},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y+(e.height||0)},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y},{x:e.x,y:e.y+(e.height||0)}]]}function OT(e,t){var n=t.map(function(r){return{line:r,distance:wg(e,r)}}),i=sn(n,"distance");return i[0].line}function kT(e,t,n,i){return cy(e,t,n,i).point}function _p(e,t){K.call(this,e);function n(i,r){var o=i.context,a=o.connection,s=O({},o.hints),c=o.newWaypoints||a.waypoints,u=o.oldWaypoints;return typeof s.startChanged=="undefined"&&(s.startChanged=!!s.connectionStart),typeof s.endChanged=="undefined"&&(s.endChanged=!!s.connectionEnd),kT(r,c,u,s)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(i){var r=i.context,o=r.connection,a=o.outgoing,s=o.incoming;s.forEach(function(c){var u=c.waypoints[c.waypoints.length-1],l=n(i,u),p=[].concat(c.waypoints.slice(0,-1),[l]);t.updateWaypoints(c,p)}),a.forEach(function(c){var u=c.waypoints[0],l=n(i,u),p=[].concat([l],c.waypoints.slice(1));t.updateWaypoints(c,p)})}),this.postExecute(["connection.move"],function(i){var r=i.context,o=r.connection,a=o.outgoing,s=o.incoming,c=r.delta;s.forEach(function(u){var l=u.waypoints[u.waypoints.length-1],p={x:l.x+c.x,y:l.y+c.y},f=[].concat(u.waypoints.slice(0,-1),[p]);t.updateWaypoints(u,f)}),a.forEach(function(u){var l=u.waypoints[0],p={x:l.x+c.x,y:l.y+c.y},f=[].concat([p],u.waypoints.slice(1));t.updateWaypoints(u,f)})})}oe(_p,K);_p.$inject=["eventBus","modeling"];function lc(e,t,n){var i=fc(e),r=py(i,t),o=i[0];return r.length?r[r.length-1]:qo(o.original||o,n,t)}function pc(e,t,n){var i=fc(e),r=py(i,t),o=i[i.length-1];return r.length?r[0]:qo(o.original||o,n,t)}function bp(e,t,n){var i=fc(e),r=ly(t,n),o=i[0];return qo(o.original||o,r,t)}function xp(e,t,n){var i=fc(e),r=ly(t,n),o=i[i.length-1];return qo(o.original||o,r,t)}function ly(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function fc(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function py(e,t){var n=lt(e,LT);return Ee(n,function(i){return NT(i,t)})}function NT(e,t){return pt(t,e,1)==="intersect"}function LT(e){return e.original||e}function wp(e,t){K.call(this,e),this.postExecute("shape.replace",function(n){var i=n.oldShape,r=n.newShape;if(!!$T(i,r)){var o=jT(i);o.incoming.forEach(function(a){var s=pc(a,r,i);t.reconnectEnd(a,r,s)}),o.outgoing.forEach(function(a){var s=lc(a,r,i);t.reconnectStart(a,r,s)})}},!0)}wp.$inject=["eventBus","modeling"];oe(wp,K);function $T(e,t){return v(e,"bpmn:Participant")&&Re(e)&&v(t,"bpmn:Participant")&&!Re(t)}function jT(e){var t=Ro([e],!1),n=[],i=[];return t.forEach(function(r){r!==e&&(r.incoming.forEach(function(o){v(o,"bpmn:MessageFlow")&&n.push(o)}),r.outgoing.forEach(function(o){v(o,"bpmn:MessageFlow")&&i.push(o)}))},[]),{incoming:n,outgoing:i}}var HT="flow elements must be children of pools/participants";function fy(e,t,n){function i(r,o,a){t.add({position:{x:r.x+5,y:r.y+5},type:"error",timeout:a||2e3,html:"<div>"+o+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(r){var o=r.context,a=o.shape,s=o.target;v(s,"bpmn:Collaboration")&&v(a,"bpmn:FlowNode")&&i(r,n(HT))})}fy.$inject=["eventBus","tooltips","translate"];function Sp(e,t){K.call(this,e),this.preExecute("shape.resize",function(n){var i=n.shape,r=Ce(i),o=r&&r.get("label"),a=o&&o.get("bounds");a&&t.updateModdleProperties(i,o,{bounds:void 0})},!0)}oe(Sp,K);Sp.$inject=["eventBus","modeling"];function Cp(e,t,n){K.call(this,e),this.preExecute("shape.delete",function(i){var r=i.context.shape;if(!(r.incoming.length!==1||r.outgoing.length!==1)){var o=r.incoming[0],a=r.outgoing[0];if(!(!v(o,"bpmn:SequenceFlow")||!v(a,"bpmn:SequenceFlow"))&&t.canConnect(o.source,a.target,o)){var s=zT(o.waypoints,a.waypoints);n.reconnectEnd(o,a.target,s)}}})}oe(Cp,K);Cp.$inject=["eventBus","bpmnRules","modeling"];function mr(e){return e.original||e}function zT(e,t){var n=Zu(mr(e[e.length-2]),mr(e[e.length-1]),mr(t[1]),mr(t[0]));return n?[].concat(e.slice(0,e.length-1),[n],t.slice(1)):[mr(e[0]),mr(t[t.length-1])]}function Tp(e,t){K.call(this,e),this.preExecute("shape.delete",function(n){var i=n.shape,r=i.parent;v(i,"bpmn:Participant")&&(n.collaborationRoot=r)},!0),this.postExecute("shape.delete",function(n){var i=n.collaborationRoot;i&&!i.businessObject.participants.length&&t.makeProcess()},!0)}Tp.$inject=["eventBus","modeling"];oe(Tp,K);function Ap(e,t,n,i){K.call(this,e);var r=i.get("dragging",!1);function o(c){var u=c.source,l=c.target,p=c.parent;if(!!p){var f,h;v(c,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(u,l)||(h=!0),n.canConnectMessageFlow(u,l)&&(f="bpmn:MessageFlow")),v(c,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(u,l)||(h=!0),n.canConnectSequenceFlow(u,l)&&(f="bpmn:SequenceFlow")),v(c,"bpmn:Association")&&!n.canConnectAssociation(u,l)&&(h=!0),h&&t.removeConnection(c),f&&t.connect(u,l,{type:f,waypoints:c.waypoints.slice()})}}function a(c){var u=c.context,l=u.connection,p=u.newSource||l.source,f=u.newTarget||l.target,h,d;h=n.canConnect(p,f),!(!h||h.type===l.type)&&(d=t.connect(p,f,{type:h.type,waypoints:l.waypoints.slice()}),t.removeConnection(l),u.connection=d,r&&s(l,d))}function s(c,u){var l=r.context(),p=l&&l.payload.previousSelection,f;!p||!p.length||(f=p.indexOf(c),f!==-1&&p.splice(f,1,u))}this.postExecuted("elements.move",function(c){var u=c.closure,l=u.allConnections;I(l,o)},!0),this.preExecute("connection.reconnect",a),this.postExecuted("element.updateProperties",function(c){var u=c.context,l=u.properties,p=u.element,f=p.businessObject,h;l.default&&(h=Me(p.outgoing,on({id:p.businessObject.default.id})),h&&t.updateProperties(h,{conditionExpression:void 0})),l.conditionExpression&&f.sourceRef.default===f&&t.updateProperties(p.source,{default:void 0})})}oe(Ap,K);Ap.$inject=["eventBus","modeling","bpmnRules","injector"];function hc(e,t,n,i,r,o){i.invoke(K,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=o,this.postExecuted(["elements.create"],500,function(a){var s=a.context,c=s.parent,u=s.elements,l=Rt(u,function(p,f){var h=t.canReplace([f],f.host||f.parent||c);return h?p.concat(h.replacements):p},[]);l.length&&this.replaceElements(u,l)},this),this.postExecuted(["elements.move"],500,function(a){var s=a.context,c=s.newParent,u=s.newHost,l=[];I(s.closure.topLevel,function(f){It(f)?l=l.concat(f.children):l=l.concat(f)}),l.length===1&&u&&(c=u);var p=t.canReplace(l,c);p&&this.replaceElements(l,p.replacements,u)},this),this.postExecute(["shape.replace"],1500,function(a){var s=a.context,c=s.oldShape,u=s.newShape,l=c.attachers,p;l&&l.length&&(p=t.canReplace(l,u),this.replaceElements(l,p.replacements))},this),this.postExecuted(["shape.replace"],1500,function(a){var s=a.context,c=s.oldShape,u=s.newShape;r.unclaimId(c.businessObject.id,c.businessObject),r.updateProperties(u,{id:c.id})})}oe(hc,K);hc.prototype.replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,r=this._selection;I(t,function(o){var a={type:o.newElementType},s=n.get(o.oldElementId),c=e.indexOf(s);e[c]=i.replaceElement(s,a,{select:!1})}),t&&r.select(e)};hc.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var GT=1500,VT={width:140,height:120},Vi={width:300,height:60},wo={width:300,height:150},hy={width:140,height:120},dy={width:50,height:30};function my(e){e.on("resize.start",GT,function(t){var n=t.context,i=n.shape,r=n.direction,o=n.balanced;(v(i,"bpmn:Lane")||v(i,"bpmn:Participant"))&&(n.resizeConstraints=ZT(i,r,o)),v(i,"bpmn:Participant")&&(n.minDimensions=wo),v(i,"bpmn:SubProcess")&&Re(i)&&(n.minDimensions=hy),v(i,"bpmn:TextAnnotation")&&(n.minDimensions=dy)})}my.$inject=["eventBus"];var Ga=Math.abs,WT=Math.min,UT=Math.max;function vy(e,t,n,i){var r=e[t];e[t]=r===void 0?n:i(n,r)}function Va(e,t,n){return vy(e,t,n,WT)}function Wa(e,t,n){return vy(e,t,n,UT)}var YT=20,qT=50,KT=20,XT=20;function ZT(e,t,n){var i=tn(e),r=!0,o=!0,a=nc(i,[i]),s=le(e),c={},u={};/e/.test(t)?u.right=s.left+Vi.width:/w/.test(t)&&(u.left=s.right-Vi.width),a.forEach(function(p){var f=le(p);/n/.test(t)&&(f.top<s.top-10&&(r=!1),n&&Ga(s.top-f.bottom)<10&&Wa(c,"top",f.top+Vi.height),Ga(s.top-f.top)<5&&Va(u,"top",f.bottom-Vi.height)),/s/.test(t)&&(f.bottom>s.bottom+10&&(o=!1),n&&Ga(s.bottom-f.top)<10&&Va(c,"bottom",f.bottom-Vi.height),Ga(s.bottom-f.bottom)<5&&Wa(u,"bottom",f.top+Vi.height))});var l=i.children.filter(function(p){return!p.hidden&&!p.waypoints&&(v(p,"bpmn:FlowElement")||v(p,"bpmn:Artifact"))});return l.forEach(function(p){var f=le(p);r&&/n/.test(t)&&Va(u,"top",f.top-KT),/e/.test(t)&&Wa(u,"right",f.right+YT),o&&/s/.test(t)&&Wa(u,"bottom",f.bottom+XT),/w/.test(t)&&Va(u,"left",f.left-qT)}),{min:u,max:c}}var Pd=1001;function gy(e,t){e.on("resize.start",Pd+500,function(n){var i=n.context,r=i.shape;(v(r,"bpmn:Lane")||v(r,"bpmn:Participant"))&&(i.balanced=!br(n))}),e.on("resize.end",Pd,function(n){var i=n.context,r=i.shape,o=i.canExecute,a=i.newBounds;if(v(r,"bpmn:Lane")||v(r,"bpmn:Participant"))return o&&(a=iv(a),t.resizeLane(r,a,i.balanced)),!1})}gy.$inject=["eventBus","modeling"];var QT=500;function Rp(e,t,n,i,r){n.invoke(K,this);function o(l){return De(l,["bpmn:ReceiveTask","bpmn:SendTask"])||JT(l,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function a(l){var p=e.getDefinitions(),f=p.get("rootElements");return!!Me(f,on({id:l.id}))}function s(l){if(v(l,"bpmn:ErrorEventDefinition"))return"errorRef";if(v(l,"bpmn:EscalationEventDefinition"))return"escalationRef";if(v(l,"bpmn:MessageEventDefinition"))return"messageRef";if(v(l,"bpmn:SignalEventDefinition"))return"signalRef"}function c(l){if(De(l,["bpmn:ReceiveTask","bpmn:SendTask"]))return l.get("messageRef");var p=l.get("eventDefinitions"),f=p[0];return f.get(s(f))}function u(l,p){if(De(l,["bpmn:ReceiveTask","bpmn:SendTask"]))return l.set("messageRef",p);var f=l.get("eventDefinitions"),h=f[0];return h.set(s(h),p)}this.executed("shape.create",function(l){var p=l.shape;if(!!o(p)){var f=X(p),h=c(f),d;h&&!a(h)&&(d=e.getDefinitions().get("rootElements"),Ke(d,h),l.addedRootElement=h)}},!0),this.reverted("shape.create",function(l){var p=l.addedRootElement;if(!!p){var f=e.getDefinitions().get("rootElements");We(f,p)}},!0),t.on("copyPaste.copyElement",function(l){var p=l.descriptor,f=l.element;if(!(f.labelTarget||!o(f))){var h=X(f),d=c(h);d&&(p.referencedRootElement=d)}}),t.on("copyPaste.pasteElement",QT,function(l){var p=l.descriptor,f=p.businessObject,h=p.referencedRootElement;!h||(a(h)||(h=i.copyElement(h,r.create(h.$type))),u(f,h),delete p.referencedRootElement)})}Rp.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"];oe(Rp,K);function JT(e,t){return be(t)||(t=[t]),Sn(t,function(n){return js(e,n)})}var eA=Math.max;function yy(e){e.on("spaceTool.getMinDimensions",function(t){var n=t.shapes,i=t.axis,r=t.start,o={};return I(n,function(a){var s=a.id;v(a,"bpmn:Participant")&&(tA(i)?o[s]=wo:o[s]={width:wo.width,height:nA(a,r)}),v(a,"bpmn:SubProcess")&&Re(a)&&(o[s]=hy),v(a,"bpmn:TextAnnotation")&&(o[s]=dy),v(a,"bpmn:Group")&&(o[s]=VT)}),o})}yy.$inject=["eventBus"];function tA(e){return e==="x"}function nA(e,t){var n;return iA(e)?(n=rA(e,t),eA(wo.height,n)):wo.height}function iA(e){return!!er(e).length}function rA(e,t){var n=er(e),i;return i=Ey(n,t),e.height-i.height+Vi.height}function Ey(e,t){var n,i,r;for(n=0;n<e.length;n++)if(i=e[n],t>=i.y&&t<=i.y+i.height)return r=er(i),r.length?Ey(r,t):i}var Dd=400,oA=600,Md={x:180,y:160};function Si(e,t,n,i,r,o,a){K.call(this,t),this._canvas=e,this._eventBus=t,this._modeling=n,this._elementFactory=i,this._bpmnFactory=r,this._bpmnjs=o,this._elementRegistry=a;var s=this;function c(p){return v(p,"bpmn:SubProcess")&&!Re(p)}function u(p){var f=p.shape,h=p.newRootElement,d=X(f);h=s._addDiagram(h||d),p.newRootElement=e.addRootElement(h)}function l(p){var f=p.shape,h=X(f);s._removeDiagram(h);var d=p.newRootElement=a.get(kn(h));e.removeRootElement(d)}this.executed("shape.create",function(p){var f=p.shape;!c(f)||u(p)},!0),this.postExecuted("shape.create",function(p){var f=p.shape,h=p.newRootElement;!h||!f.children||(s._showRecursively(f.children),s._moveChildrenToShape(f,h))},!0),this.reverted("shape.create",function(p){var f=p.shape;!c(f)||l(p)},!0),this.preExecuted("shape.delete",function(p){var f=p.shape;if(!!c(f)){var h=a.get(kn(f));!h||n.removeElements(h.children.slice())}},!0),this.executed("shape.delete",function(p){var f=p.shape;!c(f)||l(p)},!0),this.reverted("shape.delete",function(p){var f=p.shape;!c(f)||u(p)},!0),this.preExecuted("shape.replace",function(p){var f=p.oldShape,h=p.newShape;!c(f)||!c(h)||(p.oldRoot=e.removeRootElement(kn(f)))},!0),this.postExecuted("shape.replace",function(p){var f=p.newShape,h=p.oldRoot,d=e.findRoot(kn(f));if(!(!h||!d)){var g=h.children;n.moveElements(g,{x:0,y:0},d)}},!0),this.executed("element.updateProperties",function(p){var f=p.element;if(!!v(f,"bpmn:SubProcess")){var h=p.properties,d=p.oldProperties,g=d.id,y=h.id;if(g!==y){if(ru(f)){a.updateId(f,Ni(y)),a.updateId(g,y);return}var A=a.get(Ni(g));!A||a.updateId(Ni(g),Ni(y))}}},!0),this.reverted("element.updateProperties",function(p){var f=p.element;if(!!v(f,"bpmn:SubProcess")){var h=p.properties,d=p.oldProperties,g=d.id,y=h.id;if(g!==y){if(ru(f)){a.updateId(f,Ni(g)),a.updateId(y,g);return}var A=a.get(Ni(y));!A||a.updateId(A,Ni(g))}}},!0),t.on("element.changed",function(p){var f=p.element;if(!!ru(f)){var h=f,d=a.get(ph(h));!d||d===h||t.fire("element.changed",{element:d})}}),this.executed("shape.toggleCollapse",Dd,function(p){var f=p.shape;!v(f,"bpmn:SubProcess")||(Re(f)?l(p):(u(p),s._showRecursively(f.children)))},!0),this.reverted("shape.toggleCollapse",Dd,function(p){var f=p.shape;!v(f,"bpmn:SubProcess")||(Re(f)?l(p):(u(p),s._showRecursively(f.children)))},!0),this.postExecuted("shape.toggleCollapse",oA,function(p){var f=p.shape;if(!!v(f,"bpmn:SubProcess")){var h=p.newRootElement;!h||(Re(f)?s._moveChildrenToShape(h,f):s._moveChildrenToShape(f,h))}},!0),t.on("copyPaste.createTree",function(p){var f=p.element,h=p.children;if(!!c(f)){var d=kn(f),g=a.get(d);g&&h.push.apply(h,g.children)}}),t.on("copyPaste.copyElement",function(p){var f=p.descriptor,h=p.element,d=p.elements,g=h.parent,y=v(Ce(g),"bpmndi:BPMNPlane");if(!!y){var A=ph(g),_=Me(d,function(w){return w.id===A});!_||(f.parent=_.id)}}),t.on("copyPaste.pasteElement",function(p){var f=p.descriptor;!f.parent||(c(f.parent)||f.parent.hidden)&&(f.hidden=!0)})}oe(Si,K);Si.prototype._moveChildrenToShape=function(e,t){var n=this._modeling,i=e.children,r;if(!!i){i=i.concat(i.reduce(function(u,l){return l.label&&l.label.parent!==e?u.concat(l.label):u},[]));var o=i.filter(function(u){return!u.hidden});if(!o.length){n.moveElements(i,{x:0,y:0},t,{autoResize:!1});return}var a=Je(o);if(!t.x)r={x:Md.x-a.x,y:Md.y-a.y};else{var s=ye(t),c=ye(a);r={x:s.x-c.x,y:s.y-c.y}}n.moveElements(i,r,t,{autoResize:!1})}};Si.prototype._showRecursively=function(e,t){var n=this,i=[];return e.forEach(function(r){r.hidden=!!t,i=i.concat(r),r.children&&(i=i.concat(n._showRecursively(r.children,r.collapsed||t)))}),i};Si.prototype._addDiagram=function(e){var t=this._bpmnjs,n=t.getDefinitions().diagrams;return e.businessObject||(e=this._createNewDiagram(e)),n.push(e.di.$parent),e};Si.prototype._createNewDiagram=function(e){var t=this._bpmnFactory,n=this._elementFactory,i=t.create("bpmndi:BPMNPlane",{bpmnElement:e}),r=t.create("bpmndi:BPMNDiagram",{plane:i});i.$parent=r;var o=n.createRoot({id:kn(e),type:e.$type,di:i,businessObject:e,collapsed:!0});return o};Si.prototype._removeDiagram=function(e){var t=this._bpmnjs,n=t.getDefinitions().diagrams,i=Me(n,function(r){return r.plane.bpmnElement.id===e.id});return n.splice(n.indexOf(i),1),i};Si.$inject=["canvas","eventBus","modeling","elementFactory","bpmnFactory","bpmnjs","elementRegistry"];function Pp(e,t){e.invoke(K,this),this.postExecuted("shape.replace",function(n){var i=n.context.oldShape,r=n.context.newShape;if(!(!v(r,"bpmn:SubProcess")||!(v(i,"bpmn:Task")||v(i,"bpmn:CallActivity"))||!Re(r))){var o=aA(r);t.createShape({type:"bpmn:StartEvent"},o,r)}})}Pp.$inject=["injector","modeling"];oe(Pp,K);function aA(e){return{x:e.x+e.width/6,y:e.y+e.height/2}}function Dp(e,t){K.call(this,e),this.postExecuted("shape.toggleCollapse",1500,function(n){var i=n.shape;if(Re(i))return;var r=Ro(i);r.forEach(function(a){var s=a.incoming.slice(),c=a.outgoing.slice();I(s,function(u){o(u,!0)}),I(c,function(u){o(u,!1)})});function o(a,s){r.indexOf(a.source)!==-1&&r.indexOf(a.target)!==-1||(s?t.reconnectEnd(a,i,ye(i)):t.reconnectStart(a,i,ye(i)))}},!0)}oe(Dp,K);Dp.$inject=["eventBus","modeling"];var du=500;function Mp(e,t,n,i){K.call(this,e);function r(s){s.length&&s.forEach(function(c){c.type==="label"&&!c.businessObject.name&&(c.hidden=!0)})}function o(s,c){var u=s.children,l=c,p,f;return p=sA(u).concat([s]),f=Wg(p),f?(l.width=Math.max(f.width,l.width),l.height=Math.max(f.height,l.height),l.x=f.x+(f.width-l.width)/2,l.y=f.y+(f.height-l.height)/2):(l.x=s.x+(s.width-l.width)/2,l.y=s.y+(s.height-l.height)/2),l}function a(s,c){return{x:s.x+(s.width-c.width)/2,y:s.y+(s.height-c.height)/2,width:c.width,height:c.height}}this.executed(["shape.toggleCollapse"],du,function(s){var c=s.context,u=c.shape;!v(u,"bpmn:SubProcess")||(u.collapsed?Ce(u).isExpanded=!1:(r(u.children),Ce(u).isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],du,function(s){var c=s.context,u=c.shape;u.collapsed?Ce(u).isExpanded=!1:Ce(u).isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],du,function(s){var c=s.context.shape,u=t.getDefaultSize(c),l;c.collapsed?l=a(c,u):l=o(c,u),n.resizeShape(c,l,null,{autoResize:c.collapsed?!1:"nwse"})})}oe(Mp,K);Mp.$inject=["eventBus","elementFactory","modeling"];function sA(e){return e.filter(function(t){return!t.hidden})}function Bp(e,t,n,i){t.invoke(K,this),this.preExecute("shape.delete",function(r){var o=r.context,a=o.shape,s=a.businessObject;rt(a)||(v(a,"bpmn:Participant")&&Re(a)&&n.ids.unclaim(s.processRef.id),i.unclaimId(s.id,s))}),this.preExecute("connection.delete",function(r){var o=r.context,a=o.connection,s=a.businessObject;i.unclaimId(s.id,s)}),this.preExecute("canvas.updateRoot",function(){var r=e.getRootElement(),o=r.businessObject;v(r,"bpmn:Collaboration")&&n.ids.unclaim(o.id)})}oe(Bp,K);Bp.$inject=["canvas","injector","moddle","modeling"];function Ip(e,t){K.call(this,e),this.preExecute("connection.delete",function(n){var i=n.context,r=i.connection,o=r.source;cA(r,o)&&t.updateProperties(o,{default:null})})}oe(Ip,K);Ip.$inject=["eventBus","modeling"];function cA(e,t){if(!v(e,"bpmn:SequenceFlow"))return!1;var n=X(t),i=X(e);return n.get("default")===i}var uA=500,lA=5e3;function Fp(e,t,n){K.call(this,e);var i;function r(){return i=i||new pA,i.enter(),i}function o(){if(!i)throw new Error(n("out of bounds release"));return i}function a(){if(!i)throw new Error(n("out of bounds release"));var c=i.leave();return c&&(t.updateLaneRefs(i.flowNodes,i.lanes),i=null),c}var s=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(s,lA,function(c){r()}),this.postExecuted(s,uA,function(c){a()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(c){var u=c.context,l=u.shape,p=o();l.labelTarget||(v(l,"bpmn:Lane")&&p.addLane(l),v(l,"bpmn:FlowNode")&&p.addFlowNode(l))})}Fp.$inject=["eventBus","modeling","translate"];oe(Fp,K);function pA(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}var fA={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","createBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","fixHoverBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","layoutConnectionBehavior","messageFlowBehavior","modelingFeedback","removeElementBehavior","removeEmbeddedLabelBoundsBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","rootElementReferenceBehavior","spaceToolBehavior","subProcessPlaneBehavior","subProcessStartEventBehavior","toggleCollapseConnectionBehaviour","toggleElementCollapseBehaviour","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior"],adaptiveLabelPositioningBehavior:["type",op],appendBehavior:["type",ap],associationBehavior:["type",sp],attachEventBehavior:["type",sc],boundaryEventBehavior:["type",cp],createBehavior:["type",up],createDataObjectBehavior:["type",lp],createParticipantBehavior:["type",pp],dataInputAssociationBehavior:["type",fp],dataStoreBehavior:["type",hp],deleteLaneBehavior:["type",dp],detachEventBehavior:["type",uc],dropOnFlowBehavior:["type",mp],eventBasedGatewayBehavior:["type",vp],fixHoverBehavior:["type",ry],groupBehavior:["type",gp],importDockingFix:["type",oy],isHorizontalFix:["type",yp],labelBehavior:["type",Ep],layoutConnectionBehavior:["type",_p],messageFlowBehavior:["type",wp],modelingFeedback:["type",fy],removeElementBehavior:["type",Cp],removeEmbeddedLabelBoundsBehavior:["type",Sp],removeParticipantBehavior:["type",Tp],replaceConnectionBehavior:["type",Ap],replaceElementBehaviour:["type",hc],resizeBehavior:["type",my],resizeLaneBehavior:["type",gy],rootElementReferenceBehavior:["type",Rp],spaceToolBehavior:["type",yy],subProcessPlaneBehavior:["type",Si],subProcessStartEventBehavior:["type",Pp],toggleCollapseConnectionBehaviour:["type",Dp],toggleElementCollapseBehaviour:["type",Mp],unclaimIdBehavior:["type",Bp],unsetDefaultFlowBehavior:["type",Ip],updateFlowNodeRefsBehavior:["type",Fp]};function _y(e,t){var n=pt(e,t,-15);return n!=="intersect"?n:null}function ft(e){Ut.call(this,e)}oe(ft,Ut);ft.$inject=["eventBus"];ft.prototype.init=function(){this.addRule("connection.start",function(e){var t=e.source;return hA(t)}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},r=i.targetParent,o=i.targetAttach;if(o)return!1;r&&(n.parent=r);try{return ls(t,n)}finally{r&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection,n=e.source,i=e.target;return ls(n,i,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){var t=e.shape,n=e.newBounds;return Ay(t,n)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return Od(i)&&!Ts(t,i)?!1:gi(t,function(r){return Od(r)?ls(r.source,r.target,r):r.host?ho(r,r.host,null,n):tl(r,i,null)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position;return ho(n,t,null,i)||Cy(n,t,i)||Ty(n,t)||Ts(n,t)}),this.addRule("shape.create",function(e){return tl(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return ho(e.shape,e.target,null,e.position)}),this.addRule("element.copy",function(e){var t=e.element,n=e.elements;return My(n,t)})};ft.prototype.canConnectMessageFlow=Py;ft.prototype.canConnectSequenceFlow=Dy;ft.prototype.canConnectDataAssociation=Np;ft.prototype.canConnectAssociation=Ry;ft.prototype.canMove=Ty;ft.prototype.canAttach=ho;ft.prototype.canReplace=Cy;ft.prototype.canDrop=wr;ft.prototype.canInsert=Ts;ft.prototype.canCreate=tl;ft.prototype.canConnect=ls;ft.prototype.canResize=Ay;ft.prototype.canCopy=My;function hA(e){return Qu(e)?null:De(e,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}function Qu(e){return!e||rt(e)}function dA(e,t){return e===t}function Bd(e){do{if(v(e,"bpmn:Process"))return X(e);if(v(e,"bpmn:Participant"))return X(e).processRef||X(e)}while(e=e.parent)}function Ju(e){return v(e,"bpmn:TextAnnotation")}function Op(e){return v(e,"bpmn:Group")&&!e.labelTarget}function kp(e){return v(e,"bpmn:BoundaryEvent")&&bn(e,"bpmn:CompensateEventDefinition")}function kr(e){return X(e).isForCompensation}function mA(e,t){var n=Bd(e),i=Bd(t);return n===i}function vA(e){return v(e,"bpmn:InteractionNode")&&!v(e,"bpmn:BoundaryEvent")&&(!v(e,"bpmn:Event")||v(e,"bpmn:ThrowEvent")&&by(e,"bpmn:MessageEventDefinition"))}function gA(e){return v(e,"bpmn:InteractionNode")&&!kr(e)&&(!v(e,"bpmn:Event")||v(e,"bpmn:CatchEvent")&&by(e,"bpmn:MessageEventDefinition"))&&!(v(e,"bpmn:BoundaryEvent")&&!bn(e,"bpmn:MessageEventDefinition"))}function Id(e){for(var t=e;t=t.parent;){if(v(t,"bpmn:FlowElementsContainer"))return X(t);if(v(t,"bpmn:Participant"))return X(t).processRef}return null}function yA(e,t){var n=Id(e),i=Id(t);return n===i}function bn(e,t){var n=X(e);return!!Me(n.eventDefinitions||[],function(i){return v(i,t)})}function by(e,t){var n=X(e);return(n.eventDefinitions||[]).every(function(i){return v(i,t)})}function EA(e){return v(e,"bpmn:FlowNode")&&!v(e,"bpmn:EndEvent")&&!It(e)&&!(v(e,"bpmn:IntermediateThrowEvent")&&bn(e,"bpmn:LinkEventDefinition"))&&!kp(e)&&!kr(e)}function _A(e){return v(e,"bpmn:FlowNode")&&!v(e,"bpmn:StartEvent")&&!v(e,"bpmn:BoundaryEvent")&&!It(e)&&!(v(e,"bpmn:IntermediateCatchEvent")&&bn(e,"bpmn:LinkEventDefinition"))&&!kr(e)}function Fd(e){return v(e,"bpmn:ReceiveTask")||v(e,"bpmn:IntermediateCatchEvent")&&(bn(e,"bpmn:MessageEventDefinition")||bn(e,"bpmn:TimerEventDefinition")||bn(e,"bpmn:ConditionalEventDefinition")||bn(e,"bpmn:SignalEventDefinition"))}function Od(e){return e.waypoints}function bA(e){for(var t=[];e;)e=e.parent,e&&t.push(e);return t}function el(e,t){var n=bA(t);return n.indexOf(e)!==-1}function ls(e,t,n){if(Qu(e)||Qu(t))return null;if(!v(n,"bpmn:DataAssociation")){if(Py(e,t))return{type:"bpmn:MessageFlow"};if(Dy(e,t))return{type:"bpmn:SequenceFlow"}}var i=Np(e,t);return i||(kp(e)&&kr(t)?{type:"bpmn:Association",associationDirection:"One"}:Ry(e,t)?{type:"bpmn:Association"}:!1)}function wr(e,t,n){return rt(e)||Op(e)?!0:v(t,"bpmn:Participant")&&!Re(t)?!1:v(e,"bpmn:Participant")?v(t,"bpmn:Process")||v(t,"bpmn:Collaboration"):De(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:v(e,"bpmn:Lane")?v(t,"bpmn:Participant")||v(t,"bpmn:Lane"):v(e,"bpmn:BoundaryEvent")&&!xA(e)?!1:v(e,"bpmn:FlowElement")&&!v(e,"bpmn:DataStoreReference")?v(t,"bpmn:FlowElementsContainer")?Re(t):De(t,["bpmn:Participant","bpmn:Lane"]):v(e,"bpmn:DataStoreReference")&&v(t,"bpmn:Collaboration")?Sn(X(t).get("participants"),function(i){return!!i.get("processRef")}):De(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?De(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):v(e,"bpmn:MessageFlow")?v(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t:!1}function xA(e){return X(e).cancelActivity&&(xy(e)||wy(e))}function wA(e){return!rt(e)&&v(e,"bpmn:BoundaryEvent")}function SA(e){return v(e,"bpmn:Lane")}function CA(e){return wA(e)||v(e,"bpmn:IntermediateThrowEvent")&&xy(e)?!0:v(e,"bpmn:IntermediateCatchEvent")&&wy(e)}function xy(e){var t=X(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function wy(e){return Sy(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function Sy(e,t){return t.some(function(n){return bn(e,n)})}function TA(e){return v(e,"bpmn:ReceiveTask")&&Me(e.incoming,function(t){return v(t.source,"bpmn:EventBasedGateway")})}function ho(e,t,n,i){if(Array.isArray(e)||(e=[e]),e.length!==1)return!1;var r=e[0];return rt(r)||!CA(r)||It(t)||!v(t,"bpmn:Activity")||kr(t)||i&&!_y(i,t)||TA(t)?!1:"attach"}function Cy(e,t,n){if(!t)return!1;var i={replacements:[]};return I(e,function(r){It(t)||v(r,"bpmn:StartEvent")&&r.type!=="label"&&wr(r,t)&&(u1(r)||i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),(l1(r)||p1(r)||f1(r))&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"}),Sy(r,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&v(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:StartEvent"})),v(t,"bpmn:Transaction")||bn(r,"bpmn:CancelEventDefinition")&&r.type!=="label"&&(v(r,"bpmn:EndEvent")&&wr(r,t)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:EndEvent"}),v(r,"bpmn:BoundaryEvent")&&ho(r,t,null,n)&&i.replacements.push({oldElementId:r.id,newElementType:"bpmn:BoundaryEvent"}))}),i.replacements.length?i:!1}function Ty(e,t){return Sn(e,SA)?!1:t?e.every(function(n){return wr(n,t)}):!0}function tl(e,t,n,i){return t?rt(e)||Op(e)?!0:dA(n,t)||n&&el(n,t)?!1:wr(e,t)||Ts(e,t):!1}function Ay(e,t){return v(e,"bpmn:SubProcess")?Re(e)&&(!t||t.width>=100&&t.height>=80):v(e,"bpmn:Lane")?!t||t.width>=130&&t.height>=60:v(e,"bpmn:Participant")?!t||t.width>=250&&t.height>=50:!!(Ju(e)||Op(e))}function AA(e,t){var n=Ju(e),i=Ju(t);return(n||i)&&n!==i}function Ry(e,t){return kp(e)&&kr(t)?!0:el(t,e)||el(e,t)?!1:AA(e,t)?!0:!!Np(e,t)}function Py(e,t){return kd(e)&&!kd(t)?!1:vA(e)&&gA(t)&&!mA(e,t)}function Dy(e,t){return Fd(t)&&t.incoming.length>0&&DA(t.incoming)&&!v(e,"bpmn:EventBasedGateway")?!1:EA(e)&&_A(t)&&yA(e,t)&&!(v(e,"bpmn:EventBasedGateway")&&!Fd(t))}function Np(e,t){return De(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&De(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:De(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&De(e,["bpmn:Activity","bpmn:CatchEvent"])?{type:"bpmn:DataOutputAssociation"}:!1}function Ts(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(e.length!==1)return!1;e=e[0]}return t.source===e||t.target===e?!1:De(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!rt(t)&&v(e,"bpmn:FlowNode")&&!v(e,"bpmn:BoundaryEvent")&&wr(e,t.parent)}function RA(e,t){return e&&t&&e.indexOf(t)!==-1}function My(e,t){return rt(t)?!0:!(v(t,"bpmn:Lane")&&!RA(e,t.parent))}function PA(e){if(e&&e.source)return v(e.source,"bpmn:EventBasedGateway")}function DA(e){return e=e||[],e.some(PA)}function kd(e){return _s(e,"bpmn:Process")||_s(e,"bpmn:Collaboration")}var MA={__depends__:[An],__init__:["bpmnRules"],bpmnRules:["type",ft]},BA=2e3;function By(e,t){e.on("saveXML.start",BA,n);function n(){var i=t.getRootElements();I(i,function(r){var o=Ce(r),a,s;a=Ro([r],!1),a=Ee(a,function(c){return c!==r&&!c.labelTarget}),s=lt(a,Ce),o.set("planeElement",s)})}}By.$inject=["eventBus","canvas"];var IA={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",By]};function dc(e){K.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(n){var i=n.context,r=i.shape||i.connection,o=i.parent,a=t.getOrdering(r,o);a&&(a.parent!==void 0&&(i.parent=a.parent),i.parentIndex=a.index)}),this.preExecute(["shape.move","connection.move"],function(n){var i=n.context,r=i.shape||i.connection,o=i.newParent||r.parent,a=t.getOrdering(r,o);a&&(a.parent!==void 0&&(i.newParent=a.parent),i.newParentIndex=a.index)})}dc.prototype.getOrdering=function(e,t){return null};oe(dc,K);function Lp(e,t,n){dc.call(this,e);var i=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:9,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function r(s){if(s.labelTarget)return{level:10};var c=Me(i,function(u){return De(s,[u.type])});return c&&c.order||{level:1}}function o(s){var c=s.order;if(c||(s.order=c=r(s)),!c)throw new Error("no order for <"+s.id+">");return c}function a(s,c,u){for(var l=c;l&&!De(l,u);)l=l.parent;if(!l)throw new Error("no parent for <"+s.id+"> in <"+(c&&c.id)+">");return l}this.getOrdering=function(s,c){if(s.labelTarget)return{parent:t.findRoot(c)||t.getRootElement(),index:-1};var u=o(s);u.containers&&(c=a(s,c,u.containers));var l=c.children.indexOf(s),p=km(c.children,function(f){return!s.labelTarget&&f.labelTarget?!1:u.level<o(f).level});return p!==-1&&l!==-1&&l<p&&(p-=1),{index:p,parent:c}}}Lp.$inject=["eventBus","canvas","translate"];oe(Lp,dc);var FA={__depends__:[zs],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",Lp]};function He(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}He.$inject=["eventBus","injector"];He.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)};He.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),r=this._fire(e,"canExecute",n);if(r===void 0){if(!i)return!1;i.canExecute&&(r=i.canExecute(t))}return r};He.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,e!==!1&&this._fire("changed",{trigger:"clear"})};He.prototype.undo=function(){var e=this._getUndoAction(),t;if(e){for(this._currentExecution.trigger="undo",this._pushAction(e);e&&(this._internalUndo(e),t=this._getUndoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};He.prototype.redo=function(){var e=this._getRedoAction(),t;if(e){for(this._currentExecution.trigger="redo",this._pushAction(e);e&&(this._internalExecute(e,!0),t=this._getRedoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};He.prototype.register=function(e,t){this._setHandler(e,t)};He.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)};He.prototype.canUndo=function(){return!!this._getUndoAction()};He.prototype.canRedo=function(){return!!this._getRedoAction()};He.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]};He.prototype._getUndoAction=function(){return this._stack[this._stackIdx]};He.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,r=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),r.revert&&t._markDirty(r.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)})};He.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var i=t?[e+"."+t,t]:[e],r,o,a;for(n=this._eventBus.createEvent(n),r=0;(o=i[r])&&(a=this._eventBus.fire("commandStack."+o,n),!n.cancelBubble);r++);return a};He.prototype._createId=function(){return this._uid++};He.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}};He.prototype._internalExecute=function(e,t){var n=this,i=e.command,r=e.context,o=this._getHandler(i);if(!o)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),o.preExecute&&o.preExecute(r),this._fire(i,"preExecuted",e)),this._atomicDo(function(){n._fire(i,"execute",e),o.execute&&n._markDirty(o.execute(r)),n._executedAction(e,t),n._fire(i,"executed",e)}),t||(this._fire(i,"postExecute",e),o.postExecute&&o.postExecute(r),this._fire(i,"postExecuted",e)),this._popAction(e)};He.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)};He.prototype._popAction=function(){var e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:T0("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)};He.prototype._markDirty=function(e){var t=this._currentExecution;!e||(e=be(e)?e:[e],t.dirty=t.dirty.concat(e))};He.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)};He.prototype._revertedAction=function(e){this._stackIdx--};He.prototype._getHandler=function(e){return this._handlerMap[e]};He.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};var OA={commandStack:["type",He]},kA=new Nl("tt");function NA(e){var t=ce('<div class="djs-tooltip-container" />');return qe(t,{position:"absolute",width:"0",height:"0"}),e.insertBefore(t,e.firstChild),t}function LA(e,t,n){qe(e,{left:t+"px",top:n+"px"})}function $p(e,t){e.style.display=t===!1?"none":""}var Iy="djs-tooltip",mu="."+Iy;function St(e,t){this._eventBus=e,this._canvas=t,this._ids=kA,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=NA(t.getContainer());var n=this;bt.bind(this._tooltipRoot,mu,"mousedown",function(i){i.stopPropagation()}),bt.bind(this._tooltipRoot,mu,"mouseover",function(i){n.trigger("mouseover",i)}),bt.bind(this._tooltipRoot,mu,"mouseout",function(i){n.trigger("mouseout",i)}),this._init()}St.$inject=["eventBus","canvas"];St.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=O({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t};St.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get(Ve(n,"data-tooltip-id"));!i||(e==="mouseover"&&i.timeout&&this.clearTimeout(i),e==="mouseout"&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))};St.prototype.get=function(e){return typeof e!="string"&&(e=e.id),this._tooltips[e]};St.prototype.clearTimeout=function(e){if(e=this.get(e),!!e){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}};St.prototype.setTimeout=function(e){if(e=this.get(e),!!e){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}};St.prototype.remove=function(e){var t=this.get(e);t&&(wn(t.html),wn(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])};St.prototype.show=function(){$p(this._tooltipRoot)};St.prototype.hide=function(){$p(this._tooltipRoot,!1)};St.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i};St.prototype._addTooltip=function(e){var t=e.id,n=e.html,i,r=this._tooltipRoot;n.get&&n.constructor.prototype.jquery&&(n=n.get(0)),Gt(n)&&(n=ce(n)),i=ce('<div data-tooltip-id="'+t+'" class="'+Iy+'">'),qe(i,{position:"absolute"}),i.appendChild(n),e.type&&re(i).add("djs-tooltip-"+e.type),e.className&&re(i).add(e.className),e.htmlContainer=i,r.appendChild(i),this._tooltips[t]=e,this._updateTooltip(e)};St.prototype._updateTooltip=function(e){var t=e.position,n=e.htmlContainer;LA(n,t.x,t.y)};St.prototype._updateTooltipVisibilty=function(e){I(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,r=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(r=!1),$p(i,r))})};St.prototype._init=function(){var e=this;function t(n){e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()}this._eventBus.on("canvas.viewbox.changing",function(n){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(n){t(n.viewbox)})};var Fy={__init__:["tooltips"],tooltips:["type",St]};function ui(e,t){if(typeof t!="function")throw new Error("removeFn iterator must be a function");if(!!e){for(var n;n=e[0];)t(n);return e}}var $A=250,Nd=1400;function jp(e,t,n){K.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",Nd,function(r){var o=r.context,a=o.shapes,s=o.validatedShapes;o.shapes=Ld(a),o.validatedShapes=Ld(s)}),i&&t.on("shape.move.start",$A,function(r){var o=r.context,a=o.shapes,s=[];I(a,function(c){I(c.labels,function(u){!u.hidden&&o.shapes.indexOf(u)===-1&&s.push(u),c.labelTarget&&s.push(c)})}),I(s,function(c){i.makeDraggable(o,c,!0)})}),this.preExecuted("elements.move",Nd,function(r){var o=r.context,a=o.closure,s=a.enclosedElements,c=[];I(s,function(u){I(u.labels,function(l){s[l.id]||c.push(l)})}),a.addAll(c)}),this.preExecute(["connection.delete","shape.delete"],function(r){var o=r.context,a=o.connection||o.shape;ui(a.labels,function(s){n.removeShape(s,{nested:!0})})}),this.execute("shape.delete",function(r){var o=r.context,a=o.shape,s=a.labelTarget;s&&(o.labelTargetIndex=Sl(s.labels,a),o.labelTarget=s,a.labelTarget=null)}),this.revert("shape.delete",function(r){var o=r.context,a=o.shape,s=o.labelTarget,c=o.labelTargetIndex;s&&(Ke(s.labels,a,c),a.labelTarget=s)})}oe(jp,K);jp.$inject=["injector","eventBus","modeling"];function Ld(e){return Ee(e,function(t){return e.indexOf(t.labelTarget)===-1})}var jA={__init__:["labelSupport"],labelSupport:["type",jp]},HA=251,$d=1401,jd="attach-ok";function Hp(e,t,n,i,r){K.call(this,t);var o=e.get("movePreview",!1);t.on("shape.move.start",$d,function(a){var s=a.context,c=s.shapes,u=s.validatedShapes;s.shapes=zA(c),s.validatedShapes=GA(u)}),o&&t.on("shape.move.start",HA,function(a){var s=a.context,c=s.shapes,u=nl(c);I(u,function(l){o.makeDraggable(s,l,!0),I(l.labels,function(p){o.makeDraggable(s,p,!0)})})}),o&&t.on("shape.move.start",function(a){var s=a.context,c=s.shapes;if(c.length===1){var u=c[0],l=u.host;l&&(n.addMarker(l,jd),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(l,jd)}))}}),this.preExecuted("elements.move",$d,function(a){var s=a.context,c=s.closure,u=s.shapes,l=nl(u);I(l,function(p){c.add(p,c.topLevel[p.host.id])})}),this.postExecuted("elements.move",function(a){var s=a.context,c=s.shapes,u=s.newHost,l;u&&c.length!==1||(u?l=c:l=Ee(c,function(p){var f=p.host;return VA(p)&&!WA(c,f)}),I(l,function(p){r.updateAttachment(p,u)}))}),this.postExecuted("elements.move",function(a){var s=a.context.shapes;I(s,function(c){I(c.attachers,function(u){I(u.outgoing.slice(),function(l){var p=i.allowed("connection.reconnect",{connection:l,source:l.source,target:l.target});p||r.removeConnection(l)}),I(u.incoming.slice(),function(l){var p=i.allowed("connection.reconnect",{connection:l,source:l.source,target:l.target});p||r.removeConnection(l)})})})}),this.postExecute("shape.create",function(a){var s=a.context,c=s.shape,u=s.host;u&&r.updateAttachment(c,u)}),this.postExecute("shape.replace",function(a){var s=a.context,c=s.oldShape,u=s.newShape;ui(c.attachers,function(l){var p=i.allowed("elements.move",{target:u,shapes:[l]});p==="attach"?r.updateAttachment(l,u):r.removeShape(l)}),u.attachers.length&&I(u.attachers,function(l){var p=Td(l,c,u);r.moveShape(l,p,l.parent)})}),this.postExecute("shape.resize",function(a){var s=a.context,c=s.shape,u=s.oldBounds,l=s.newBounds,p=c.attachers,f=s.hints||{};f.attachSupport!==!1&&I(p,function(h){var d=Td(h,u,l);r.moveShape(h,d,h.parent),I(h.labels,function(g){r.moveShape(g,d,g.parent)})})}),this.preExecute("shape.delete",function(a){var s=a.context.shape;ui(s.attachers,function(c){r.removeShape(c)}),s.host&&r.updateAttachment(s,null)})}oe(Hp,K);Hp.$inject=["injector","eventBus","canvas","rules","modeling"];function nl(e){return hs(lt(e,function(t){return t.attachers||[]}))}function zA(e){var t=nl(e);return A0("id",e,t)}function GA(e){var t=qi(e,"id");return Ee(e,function(n){for(;n;){if(n.host&&t[n.host.id])return!1;n=n.parent}return!0})}function VA(e){return!!e.host}function WA(e,t){return e.indexOf(t)!==-1}var UA={__depends__:[An],__init__:["attachSupport"],attachSupport:["type",Hp]},YA=250;function nr(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}nr.$inject=["eventBus","dragging"];nr.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error(`A tool has to be registered with it's "events"`);n.push(e),this.bindEvents(e,t)};nr.prototype.isActive=function(e){return e&&this._active===e};nr.prototype.length=function(e){return this._tools.length};nr.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))};nr.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,r=[];n.on(t.tool+".init",function(o){var a=o.context;if(!a.reactivate&&this.isActive(e)){this.setActive(null),i.cancel();return}this.setActive(e)},this),I(t,function(o){r.push(o+".ended"),r.push(o+".canceled")}),n.on(r,YA,function(o){!this._active||qA(o)||this.setActive(null)},this)};function qA(e){var t=e.originalEvent&&e.originalEvent.target;return t&&Ki(t,'.group[data-group="tools"]')}var mc={__depends__:[Kn],__init__:["toolManager"],toolManager:["type",nr]};function KA(e,t){if(e==="x"){if(t>0)return"e";if(t<0)return"w"}if(e==="y"){if(t>0)return"s";if(t<0)return"n"}return null}function XA(e,t){var n=[];return I(e.concat(t),function(i){var r=i.incoming,o=i.outgoing;I(r.concat(o),function(a){var s=a.source,c=a.target;(io(e,s)||io(e,c)||io(t,s)||io(t,c))&&(io(n,a)||n.push(a))})}),n}function io(e,t){return e.indexOf(t)!==-1}function ZA(e,t,n){var i=e.x,r=e.y,o=e.width,a=e.height,s=n.x,c=n.y;switch(t){case"n":return{x:i,y:r+c,width:o,height:a-c};case"s":return{x:i,y:r,width:o,height:a+c};case"w":return{x:i+s,y:r,width:o-s,height:a};case"e":return{x:i,y:r,width:o+s,height:a};default:throw new Error("unknown direction: "+t)}}var vu=Math.abs,QA=Math.round,In={x:"width",y:"height"},Oy="crosshair",Ua={n:"top",w:"left",s:"bottom",e:"right"},JA=1500,Hd={n:"s",w:"e",s:"n",e:"w"},Ya=20;function Qn(e,t,n,i,r,o,a){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=r,this._toolManager=o,this._mouse=a;var s=this;o.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(c){n.once("spaceTool.selection.ended",function(){s.activateMakeSpace(c.originalEvent)})}),n.on("spaceTool.move",JA,function(c){var u=c.context,l=u.initialized;l||(l=u.initialized=s.init(c,u)),l&&Gd(c)}),n.on("spaceTool.end",function(c){var u=c.context,l=u.axis,p=u.direction,f=u.movingShapes,h=u.resizingShapes,d=u.start;if(!!u.initialized){Gd(c);var g={x:0,y:0};g[l]=QA(c["d"+l]),s.makeSpace(f,h,g,p,d),n.once("spaceTool.ended",function(y){s.activateSelection(y.originalEvent,!0,!0)})}})}Qn.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"];Qn.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:Oy,data:{context:{reactivate:n}},trapClick:!1})};Qn.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:Oy,data:{context:{}}})};Qn.prototype.makeSpace=function(e,t,n,i,r){return this._modeling.createSpace(e,t,n,i,r)};Qn.prototype.init=function(e,t){var n=vu(e.dx)>vu(e.dy)?"x":"y",i=e["d"+n],r=e[n]-i;if(vu(i)<5)return!1;i<0&&(i*=-1),br(e)&&(i*=-1);var o=KA(n,i),a=this._canvas.getRootElement(),s=Ro(a,!0),c=this.calculateAdjustments(s,n,i,r),u=this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:o,shapes:c.resizingShapes,start:r}),l=eR(c,n,o,r,u);return O(t,c,{axis:n,direction:o,spaceToolConstraints:l,start:r}),Ks("resize-"+(n==="x"?"ew":"ns")),!0};Qn.prototype.calculateAdjustments=function(e,t,n,i){var r=this._rules,o=[],a=[];return I(e,function(s){if(!(!s.parent||il(s))){var c=s[t],u=c+s[In[t]];if(n>0&&c>i||n<0&&u<i)return o.push(s);if(c<i&&u>i&&r.allowed("shape.resize",{shape:s}))return a.push(s)}}),{movingShapes:o,resizingShapes:a}};Qn.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};Qn.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};function zd(e){return{top:e.top-Ya,right:e.right+Ya,bottom:e.bottom+Ya,left:e.left-Ya}}function Gd(e){var t=e.context,n=t.spaceToolConstraints;if(!!n){var i,r;ge(n.left)&&(i=Math.max(e.x,n.left),e.dx=e.dx+i-e.x,e.x=i),ge(n.right)&&(i=Math.min(e.x,n.right),e.dx=e.dx+i-e.x,e.x=i),ge(n.top)&&(r=Math.max(e.y,n.top),e.dy=e.dy+r-e.y,e.y=r),ge(n.bottom)&&(r=Math.min(e.y,n.bottom),e.dy=e.dy+r-e.y,e.y=r)}}function eR(e,t,n,i,r){var o=e.movingShapes,a=e.resizingShapes;if(!!a.length){var s={},c,u;return I(a,function(l){var p=le(l),f=Ee(l.children,function(_){return!il(_)&&!Vd(_)&&!gu(o,_)&&!gu(a,_)}),h=Ee(l.children,function(_){return!il(_)&&!Vd(_)&&gu(o,_)}),d,g,y;f.length&&(g=zd(le(Je(f))),d=i-p[Ua[n]]+g[Ua[n]],n==="n"?s.bottom=u=ge(u)?Math.min(u,d):d:n==="w"?s.right=u=ge(u)?Math.min(u,d):d:n==="s"?s.top=c=ge(c)?Math.max(c,d):d:n==="e"&&(s.left=c=ge(c)?Math.max(c,d):d)),h.length&&(y=zd(le(Je(h))),d=i-y[Ua[Hd[n]]]+p[Ua[Hd[n]]],n==="n"?s.bottom=u=ge(u)?Math.min(u,d):d:n==="w"?s.right=u=ge(u)?Math.min(u,d):d:n==="s"?s.top=c=ge(c)?Math.max(c,d):d:n==="e"&&(s.left=c=ge(c)?Math.max(c,d):d));var A=r&&r[l.id];A&&(n==="n"?(d=i+l[In[t]]-A[In[t]],s.bottom=u=ge(u)?Math.min(u,d):d):n==="w"?(d=i+l[In[t]]-A[In[t]],s.right=u=ge(u)?Math.min(u,d):d):n==="s"?(d=i-l[In[t]]+A[In[t]],s.top=c=ge(c)?Math.max(c,d):d):n==="e"&&(d=i-l[In[t]]+A[In[t]],s.left=c=ge(c)?Math.max(c,d):d))}),s}}function gu(e,t){return e.indexOf(t)!==-1}function il(e){return!!e.waypoints}function Vd(e){return!!e.labelTarget}var yu="djs-dragging",Wd="djs-resizing",tR=250,qa=Math.max;function ky(e,t,n,i,r){function o(a,s){I(a,function(c){r.addDragger(c,s),n.addMarker(c,yu)})}e.on("spaceTool.selection.start",function(a){var s=n.getLayer("space"),c=a.context,u={x:"M 0,-10000 L 0,10000",y:"M -10000,0 L 10000,0"},l=ae("g");W(l,i.cls("djs-crosshair-group",["no-events"])),pe(s,l);var p=ae("path");W(p,"d",u.x),Se(p).add("djs-crosshair"),pe(l,p);var f=ae("path");W(f,"d",u.y),Se(f).add("djs-crosshair"),pe(l,f),c.crosshairGroup=l}),e.on("spaceTool.selection.move",function(a){var s=a.context.crosshairGroup;At(s,a.x,a.y)}),e.on("spaceTool.selection.cleanup",function(a){var s=a.context,c=s.crosshairGroup;c&&Le(c)}),e.on("spaceTool.move",tR,function(a){var s=a.context,c=s.line,u=s.axis,l=s.movingShapes,p=s.resizingShapes;if(!!s.initialized){if(!s.dragGroup){var f=n.getLayer("space");c=ae("path"),W(c,"d","M0,0 L0,0"),Se(c).add("djs-crosshair"),pe(f,c),s.line=c;var h=ae("g");W(h,i.cls("djs-drag-group",["no-events"])),pe(n.getActiveLayer(),h),o(l,h);var d=s.movingConnections=t.filter(function(b){var S=!1;I(l,function(D){I(D.outgoing,function(F){b===F&&(S=!0)})});var M=!1;I(l,function(D){I(D.incoming,function(F){b===F&&(M=!0)})});var C=!1;I(p,function(D){I(D.outgoing,function(F){b===F&&(C=!0)})});var R=!1;return I(p,function(D){I(D.incoming,function(F){b===F&&(R=!0)})}),nR(b)&&(S||C)&&(M||R)});o(d,h),s.dragGroup=h}if(!s.frameGroup){var g=ae("g");W(g,i.cls("djs-frame-group",["no-events"])),pe(n.getActiveLayer(),g);var y=[];I(p,function(b){var S=r.addFrame(b,g),M=S.getBBox();y.push({element:S,initialBounds:M}),n.addMarker(b,Wd)}),s.frameGroup=g,s.frames=y}var A={x:"M"+a.x+", -10000 L"+a.x+", 10000",y:"M -10000, "+a.y+" L 10000, "+a.y};W(c,{d:A[u]});var _={x:"y",y:"x"},w={x:a.dx,y:a.dy};w[_[s.axis]]=0,At(s.dragGroup,w.x,w.y),I(s.frames,function(b){var S=b.element,M=b.initialBounds,C,R;s.direction==="e"?W(S,{width:qa(M.width+w.x,5)}):(C=qa(M.width-w.x,5),W(S,{width:C,x:M.x+M.width-C})),s.direction==="s"?W(S,{height:qa(M.height+w.y,5)}):(R=qa(M.height-w.y,5),W(S,{height:R,y:M.y+M.height-R}))})}}),e.on("spaceTool.cleanup",function(a){var s=a.context,c=s.movingShapes,u=s.movingConnections,l=s.resizingShapes,p=s.line,f=s.dragGroup,h=s.frameGroup;I(c,function(d){n.removeMarker(d,yu)}),I(u,function(d){n.removeMarker(d,yu)}),f&&(Le(p),Le(f)),I(l,function(d){n.removeMarker(d,Wd)}),h&&Le(h)})}ky.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];function nR(e){return e.waypoints}var Ny={__init__:["spaceToolPreview"],__depends__:[Kn,An,mc,$o,Ho],spaceTool:["type",Qn],spaceToolPreview:["type",ky]};function Xt(e){this._model=e}Xt.$inject=["moddle"];Xt.prototype._needsId=function(e){return De(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])};Xt.prototype._ensureId=function(e){if(e.id){this._model.ids.claim(e.id,e);return}var t;v(e,"bpmn:Activity")?t="Activity":v(e,"bpmn:Event")?t="Event":v(e,"bpmn:Gateway")?t="Gateway":De(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?t="Flow":t=(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))};Xt.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n};Xt.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})};Xt.prototype.createDiShape=function(e,t){return this.create("bpmndi:BPMNShape",O({bpmnElement:e,bounds:this.createDiBounds()},t))};Xt.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)};Xt.prototype.createDiWaypoints=function(e){var t=this;return lt(e,function(n){return t.createDiWaypoint(n)})};Xt.prototype.createDiWaypoint=function(e){return this.create("dc:Point",cn(e,["x","y"]))};Xt.prototype.createDiEdge=function(e,t){return this.create("bpmndi:BPMNEdge",O({bpmnElement:e,waypoint:this.createDiWaypoints([])},t))};Xt.prototype.createDiPlane=function(e,t){return this.create("bpmndi:BPMNPlane",O({bpmnElement:e},t))};function Dt(e,t,n,i){K.call(this,e),this._bpmnFactory=t,this._translate=i;var r=this;function o(h){var d=h.context,g=d.hints||{},y;!d.cropped&&g.createElementsBehavior!==!1&&(y=d.connection,y.waypoints=n.getCroppedWaypoints(y),d.cropped=!0)}this.executed(["connection.layout","connection.create"],o),this.reverted(["connection.layout"],function(h){delete h.context.cropped});function a(h){var d=h.context;r.updateParent(d.shape||d.connection,d.oldParent)}function s(h){var d=h.context,g=d.shape||d.connection,y=d.parent||d.newParent;r.updateParent(g,y)}this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Ht(a)),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Ht(s));function c(h){var d=h.context,g=d.oldRoot,y=g.children;I(y,function(A){v(A,"bpmn:BaseElement")&&r.updateParent(A)})}this.executed(["canvas.updateRoot"],c),this.reverted(["canvas.updateRoot"],c);function u(h){var d=h.context.shape;!v(d,"bpmn:BaseElement")||r.updateBounds(d)}this.executed(["shape.move","shape.create","shape.resize"],Ht(function(h){h.context.shape.type!=="label"&&u(h)})),this.reverted(["shape.move","shape.create","shape.resize"],Ht(function(h){h.context.shape.type!=="label"&&u(h)})),e.on("shape.changed",function(h){h.element.type==="label"&&u({context:{shape:h.element}})});function l(h){r.updateConnection(h.context)}this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],Ht(l)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],Ht(l));function p(h){r.updateConnectionWaypoints(h.context.connection)}this.executed(["connection.layout","connection.move","connection.updateWaypoints"],Ht(p)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],Ht(p)),this.executed("connection.reconnect",Ht(function(h){var d=h.context,g=d.connection,y=d.oldSource,A=d.newSource,_=X(g),w=X(y),b=X(A);_.conditionExpression&&!De(b,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(d.oldConditionExpression=_.conditionExpression,delete _.conditionExpression),y!==A&&w.default===_&&(d.oldDefault=w.default,delete w.default)})),this.reverted("connection.reconnect",Ht(function(h){var d=h.context,g=d.connection,y=d.oldSource,A=d.newSource,_=X(g),w=X(y),b=X(A);d.oldConditionExpression&&(_.conditionExpression=d.oldConditionExpression),d.oldDefault&&(w.default=d.oldDefault,delete b.default)}));function f(h){r.updateAttachment(h.context)}this.executed(["element.updateAttachment"],Ht(f)),this.reverted(["element.updateAttachment"],Ht(f))}oe(Dt,K);Dt.$inject=["eventBus","bpmnFactory","connectionDocking","translate"];Dt.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject};Dt.prototype.updateParent=function(e,t){if(!(e instanceof Os)&&!(v(e,"bpmn:DataStoreReference")&&e.parent&&v(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,r=Ce(e),o=n&&n.businessObject,a=Ce(n);v(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,o,t&&t.businessObject),v(e,"bpmn:DataOutputAssociation")&&(e.source?o=e.source.businessObject:o=null),v(e,"bpmn:DataInputAssociation")&&(e.target?o=e.target.businessObject:o=null),this.updateSemanticParent(i,o),v(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,o),this.updateDiParent(r,a)}};Dt.prototype.updateBounds=function(e){var t=Ce(e),n=rR(e);if(n){var i=an(n,t.get("bounds"));O(n,{x:e.x+i.x,y:e.y+i.y})}var r=e instanceof Os?this._getLabel(t):t,o=r.bounds;o||(o=this._bpmnFactory.createDiBounds(),r.set("bounds",o)),O(o,{x:e.x,y:e.y,width:e.width,height:e.height})};Dt.prototype.updateFlowNodeRefs=function(e,t,n){if(n!==t){var i,r;v(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),We(i,e)),v(t,"bpmn:Lane")&&(r=t.get("flowNodeRef"),Ke(r,e))}};Dt.prototype.updateDiConnection=function(e,t,n){var i=Ce(e),r=Ce(t),o=Ce(n);i.sourceElement&&i.sourceElement.bpmnElement!==X(t)&&(i.sourceElement=t&&r),i.targetElement&&i.targetElement.bpmnElement!==X(n)&&(i.targetElement=n&&o)};Dt.prototype.updateDiParent=function(e,t){if(t&&!v(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):(We(n,e),e.$parent=null)}};function iR(e){for(;e&&!v(e,"bpmn:Definitions");)e=e.$parent;return e}Dt.prototype.getLaneSet=function(e){var t,n;return v(e,"bpmn:Lane")?(t=e.childLaneSet,t||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):(v(e,"bpmn:Participant")&&(e=e.processRef),n=e.get("laneSets"),t=n[0],t||(t=this._bpmnFactory.create("bpmn:LaneSet"),t.$parent=e,n.push(t)),t)};Dt.prototype.updateSemanticParent=function(e,t,n){var i,r=this._translate;if(e.$parent!==t&&!((v(e,"bpmn:DataInput")||v(e,"bpmn:DataOutput"))&&(v(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),"ioSpecification"in t&&t.ioSpecification===e.$parent))){if(v(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if(v(e,"bpmn:FlowElement")){if(t){if(v(t,"bpmn:Participant"))t=t.processRef;else if(v(t,"bpmn:Lane"))do t=t.$parent.$parent;while(v(t,"bpmn:Lane"))}i="flowElements"}else if(v(e,"bpmn:Artifact")){for(;t&&!v(t,"bpmn:Process")&&!v(t,"bpmn:SubProcess")&&!v(t,"bpmn:Collaboration");)if(v(t,"bpmn:Participant")){t=t.processRef;break}else t=t.$parent;i="artifacts"}else if(v(e,"bpmn:MessageFlow"))i="messageFlows";else if(v(e,"bpmn:Participant")){i="participants";var o=e.processRef,a;o&&(a=iR(e.$parent||t),e.$parent&&(We(a.get("rootElements"),o),o.$parent=null),t&&(Ke(a.get("rootElements"),o),o.$parent=a))}else v(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":v(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(r("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var s;if(e.$parent&&(s=e.$parent.get(i),We(s,e)),t?(s=t.get(i),s.push(e),e.$parent=t):e.$parent=null,n){var c=n.get(i);We(s,e),t&&(c||(c=[],t.set(i,c)),c.push(e))}}};Dt.prototype.updateConnectionWaypoints=function(e){var t=Ce(e);t.set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))};Dt.prototype.updateConnection=function(e){var t=e.connection,n=X(t),i=t.source,r=X(i),o=t.target,a=X(t.target),s;if(v(n,"bpmn:DataAssociation"))v(n,"bpmn:DataInputAssociation")?(n.get("sourceRef")[0]=r,s=e.parent||e.newParent||a,this.updateSemanticParent(n,a,s)):v(n,"bpmn:DataOutputAssociation")&&(s=e.parent||e.newParent||r,this.updateSemanticParent(n,r,s),n.targetRef=a);else{var c=v(n,"bpmn:SequenceFlow");n.sourceRef!==r&&(c&&(We(n.sourceRef&&n.sourceRef.get("outgoing"),n),r&&r.get("outgoing")&&r.get("outgoing").push(n)),n.sourceRef=r),n.targetRef!==a&&(c&&(We(n.targetRef&&n.targetRef.get("incoming"),n),a&&a.get("incoming")&&a.get("incoming").push(n)),n.targetRef=a)}this.updateConnectionWaypoints(t),this.updateDiConnection(t,i,o)};Dt.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};function Ht(e){return function(t){var n=t.context,i=n.shape||n.connection;v(i,"bpmn:BaseElement")&&e(t)}}function rR(e){if(!!v(e,"bpmn:Activity")){var t=Ce(e);if(!!t){var n=t.get("label");if(!!n)return n.get("bounds")}}}function Ci(e,t,n){Wn.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=n}oe(Ci,Wn);Ci.$inject=["bpmnFactory","moddle","translate"];Ci.prototype.baseCreate=Wn.prototype.create;Ci.prototype.create=function(e,t){if(e==="label"){var n=t.di||this._bpmnFactory.createDiLabel();return this.baseCreate(e,O({type:"label",di:n},bo,t))}return this.createBpmnElement(e,t)};Ci.prototype.createBpmnElement=function(e,t){var n,i=this._translate;t=O({},t||{});var r=t.businessObject,o=t.di;if(!r){if(!t.type)throw new Error(i("no shape type specified"));r=this._bpmnFactory.create(t.type),Mv(r)}if(!aR(o)){var a=O({},o||{},{id:r.id+"_di"});e==="root"?o=this._bpmnFactory.createDiPlane(r,a):e==="connection"?o=this._bpmnFactory.createDiEdge(r,a):o=this._bpmnFactory.createDiShape(r,a)}v(r,"bpmn:Group")&&(t=O({isFrame:!0},t)),t=oR(r,t,["processRef","isInterrupting","associationDirection","isForCompensation"]),t.isExpanded&&(t=Ly(o,t,"isExpanded")),v(r,"bpmn:SubProcess")&&(t.collapsed=!Re(r,o)),v(r,"bpmn:ExclusiveGateway")&&(o.isMarkerVisible=!0);var s,c;return t.eventDefinitionType&&(s=r.get("eventDefinitions")||[],c=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),t.eventDefinitionType==="bpmn:ConditionalEventDefinition"&&(c.condition=this._bpmnFactory.create("bpmn:FormalExpression")),s.push(c),c.$parent=r,r.eventDefinitions=s,delete t.eventDefinitionType),n=this.getDefaultSize(r,o),t=O({id:r.id},n,t,{businessObject:r,di:o}),this.baseCreate(e,t)};Ci.prototype.getDefaultSize=function(e,t){var n=X(e);return t=t||Ce(e),v(n,"bpmn:SubProcess")?Re(n,t)?{width:350,height:200}:{width:100,height:80}:v(n,"bpmn:Task")?{width:100,height:80}:v(n,"bpmn:Gateway")?{width:50,height:50}:v(n,"bpmn:Event")?{width:36,height:36}:v(n,"bpmn:Participant")?Re(n,t)?{width:600,height:250}:{width:400,height:60}:v(n,"bpmn:Lane")?{width:400,height:100}:v(n,"bpmn:DataObjectReference")?{width:36,height:50}:v(n,"bpmn:DataStoreReference")?{width:50,height:50}:v(n,"bpmn:TextAnnotation")?{width:100,height:30}:v(n,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}};Ci.prototype.createParticipantShape=function(e){return ot(e)||(e={isExpanded:e}),e=O({type:"bpmn:Participant"},e||{}),e.isExpanded!==!1&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)};function oR(e,t,n){return I(n,function(i){t=Ly(e,t,i)}),t}function Ly(e,t,n){return t[n]===void 0?t:(e[n]=t[n],Gn(t,[n]))}function aR(e){return De(e,["bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane"])}function vc(e,t){this._modeling=e,this._canvas=t}vc.$inject=["modeling","canvas"];vc.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;I(n,function(r){var o={x:0,y:0};i.left?o.x=i.left-r.x:i.right?o.x=i.right-r.width-r.x:i.center?o.x=i.center-Math.round(r.width/2)-r.x:i.top?o.y=i.top-r.y:i.bottom?o.y=i.bottom-r.height-r.y:i.middle&&(o.y=i.middle-Math.round(r.height/2)-r.y),t.moveElements([r],o,r.parent)})};vc.prototype.postExecute=function(e){};function gc(e){this._modeling=e}gc.$inject=["modeling"];gc.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape,r=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:r.attach}),e.shape=i};gc.prototype.postExecute=function(e){var t=e.hints||{};sR(e.source,e.shape)||(t.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))};function sR(e,t){return Sn(e.outgoing,function(n){return n.target===t})}function yc(e,t){this._canvas=e,this._layouter=t}yc.$inject=["canvas","layouter"];yc.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,r=e.parent,o=e.parentIndex,a=e.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,r,o),t};yc.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var Ka=Math.round;function zp(e){this._modeling=e}zp.$inject=["modeling"];zp.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,r=e.position,o=e.hints,a=this._modeling;I(t,function(p){ge(p.x)||(p.x=0),ge(p.y)||(p.y=0)});var s=Ee(t,function(p){return!p.hidden}),c=Je(s);I(t,function(p){Ud(p)&&(p.waypoints=lt(p.waypoints,function(f){return{x:Ka(f.x-c.x-c.width/2+r.x),y:Ka(f.y-c.y-c.height/2+r.y)}})),O(p,{x:Ka(p.x-c.x-c.width/2+r.x),y:Ka(p.y-c.y-c.height/2+r.y)})});var u=Bs(t),l={};I(t,function(p){if(Ud(p)){l[p.id]=ge(i)?a.createConnection(l[p.source.id],l[p.target.id],i,p,p.parent||n,o):a.createConnection(l[p.source.id],l[p.target.id],p,p.parent||n,o);return}var f=O({},o);u.indexOf(p)===-1&&(f.autoResize=!1),l[p.id]=ge(i)?a.createShape(p,cn(p,["x","y","width","height"]),p.parent||n,i,f):a.createShape(p,cn(p,["x","y","width","height"]),p.parent||n,f)}),e.elements=ml(l)};function Ud(e){return!!e.waypoints}var Yd=Math.round;function Ti(e){this._canvas=e}Ti.$inject=["canvas"];Ti.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,r=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return n.width!==void 0?O(t,n):O(t,{x:n.x-Yd(t.width/2),y:n.y-Yd(t.height/2)}),this._canvas.addShape(t,i,r),t};Ti.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t};function Ko(e){Ti.call(this,e)}oe(Ko,Ti);Ko.$inject=["canvas"];var cR=Ti.prototype.execute;Ko.prototype.execute=function(e){var t=e.shape;return lR(t),t.labelTarget=e.labelTarget,cR.call(this,e)};var uR=Ti.prototype.revert;Ko.prototype.revert=function(e){return e.shape.labelTarget=null,uR.call(this,e)};function lR(e){["width","height"].forEach(function(t){typeof e[t]=="undefined"&&(e[t]=0)})}function Xo(e,t){this._canvas=e,this._modeling=t}Xo.$inject=["canvas","modeling"];Xo.prototype.preExecute=function(e){var t=this._modeling,n=e.connection;ui(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),ui(n.outgoing,function(i){t.removeConnection(i,{nested:!0})})};Xo.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=Sl(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t};Xo.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,Ke(n.children,t,i),this._canvas.addConnection(t,n),t};function Gp(e,t){this._modeling=e,this._elementRegistry=t}Gp.$inject=["modeling","elementRegistry"];Gp.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;I(i,function(r){!n.get(r.id)||(r.waypoints?t.removeConnection(r):t.removeShape(r))})};function Zo(e,t){this._canvas=e,this._modeling=t}Zo.$inject=["canvas","modeling"];Zo.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;ui(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),ui(n.outgoing,function(i){t.removeConnection(i,{nested:!0})}),ui(n.children,function(i){pR(i)?t.removeConnection(i,{nested:!0}):t.removeShape(i,{nested:!0})})};Zo.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=Sl(i.children,n),t.removeShape(n),n};Zo.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,r=e.oldParentIndex;return Ke(i.children,n,r),t.addShape(n,i),n};function pR(e){return e.waypoints}function Ec(e){this._modeling=e}Ec.$inject=["modeling"];var qd={x:"y",y:"x"};Ec.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,r=e.dimension;function o(y,A){y.range.min=Math.min(A[i],y.range.min),y.range.max=Math.max(A[i]+A[r],y.range.max)}function a(y){return y[i]+y[r]/2}function s(y){return y.length-1}function c(y){return y.max-y.min}function u(y,A){var _={y:0};_[i]=y-a(A),_[i]&&(_[qd[i]]=0,t.moveElements([A],_,A.parent))}var l=n[0],p=s(n),f=n[p],h,d,g=0;I(n,function(y,A){var _,w,b;if(y.elements.length<2){A&&A!==n.length-1&&(o(y,y.elements[0]),g+=c(y.range));return}_=sn(y.elements,i),w=_[0],A===p&&(w=_[s(_)]),b=a(w),y.range=null,I(_,function(S){if(u(b,S),y.range===null){y.range={min:S[i],max:S[i]+S[r]};return}o(y,S)}),A&&A!==n.length-1&&(g+=c(y.range))}),d=Math.abs(f.range.min-l.range.max),h=Math.round((d-g)/(n.length-1)),!(h<n.length-1)&&I(n,function(y,A){var _={},w;y===l||y===f||(w=n[A-1],y.range.max=0,I(y.elements,function(b,S){_[qd[i]]=0,_[i]=w.range.max-b[i]+h,y.range.min!==b[i]&&(_[i]+=b[i]-y.range.min),_[i]&&t.moveElements([b],_,b.parent),y.range.max=Math.max(b[i]+b[r],S?y.range.max:0)}))})};Ec.prototype.postExecute=function(e){};function _c(e,t){this._layouter=e,this._canvas=t}_c.$inject=["layouter","canvas"];_c.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return O(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t};_c.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};function Vp(){}Vp.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldParent=o,e.oldParentIndex=We(o.children,t),Ke(i.children,t,r),t.parent=i,I(t.waypoints,function(a){a.x+=n.x,a.y+=n.y,a.original&&(a.original.x+=n.x,a.original.y+=n.y)}),t};Vp.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,r=e.oldParentIndex,o=e.delta;return We(n.children,t),Ke(i.children,t,r),t.parent=i,I(t.waypoints,function(a){a.x-=o.x,a.y-=o.y,a.original&&(a.original.x-=o.x,a.original.y-=o.y)}),t};function Wp(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Wp.prototype.add=function(e,t){return this.addAll([e],t)};Wp.prototype.addAll=function(e,t){var n=M_(e,!!t,this);return O(this,n),this};function Qo(e){this._modeling=e}Qo.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]};Qo.prototype.moveClosure=function(e,t,n,i,r){var o=this._modeling,a=e.allShapes,s=e.allConnections,c=e.enclosedConnections,u=e.topLevel,l=!1;r&&r.parent===n&&(l=!0),I(a,function(p){o.moveShape(p,t,u[p.id]&&!l&&n,{recurse:!1,layout:!1})}),I(s,function(p){var f=!!a[p.source.id],h=!!a[p.target.id];c[p.id]&&f&&h?o.moveConnection(p,t,u[p.id]&&!l&&n):o.layoutConnection(p,{connectionStart:f&&bp(p,p.source,t),connectionEnd:h&&xp(p,p.target,t)})})};Qo.prototype.getClosure=function(e){return new Wp().addAll(e,!0)};function bc(e){this._helper=new Qo(e)}bc.$inject=["modeling"];bc.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)};bc.prototype.postExecute=function(e){var t=e.hints,n;t&&t.primaryShape&&(n=t.primaryShape,t.oldParent=n.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,n)};function ir(e){this._modeling=e,this._helper=new Qo(e)}ir.$inject=["modeling"];ir.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldBounds=cn(t,["x","y","width","height"]),e.oldParent=o,e.oldParentIndex=We(o.children,t),Ke(i.children,t,r),O(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t};ir.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,r=this._modeling;i.layout!==!1&&(I(t.incoming,function(o){r.layoutConnection(o,{connectionEnd:xp(o,t,n)})}),I(t.outgoing,function(o){r.layoutConnection(o,{connectionStart:bp(o,t,n)})})),i.recurse!==!1&&this.moveChildren(e)};ir.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,r=e.delta;return Ke(n.children,t,i),O(t,{parent:n,x:t.x-r.x,y:t.y-r.y}),t};ir.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)};ir.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};function Jo(e){this._modeling=e}Jo.$inject=["modeling"];Jo.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget required");return be(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i};Jo.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,r=e.dockingOrPoints,o=e.hints||{},a={};o.connectionStart&&(a.connectionStart=o.connectionStart),o.connectionEnd&&(a.connectionEnd=o.connectionEnd),o.layoutConnection!==!1&&(n&&(!i||o.docking==="source")&&(a.connectionStart=a.connectionStart||Kd(be(r)?r[0]:r)),i&&(!n||o.docking==="target")&&(a.connectionEnd=a.connectionEnd||Kd(be(r)?r[r.length-1]:r)),o.newWaypoints&&(a.waypoints=o.newWaypoints),this._modeling.layoutConnection(t,a))};Jo.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,r=e.connection;return t&&(r.source=t),n&&(r.target=n),i&&(r.waypoints=i),r};function Kd(e){return e.original||e}function Jn(e,t){this._modeling=e,this._rules=t}Jn.$inject=["modeling","rules"];Jn.prototype.preExecute=function(e){var t=this,n=this._modeling,i=this._rules,r=e.oldShape,o=e.newData,a=e.hints||{},s;function c(d,g,y){return i.allowed("connection.reconnect",{connection:y,source:d,target:g})}var u={x:o.x,y:o.y},l={x:r.x,y:r.y,width:r.width,height:r.height};s=e.newShape=e.newShape||t.createShape(o,u,r.parent,a),r.host&&n.updateAttachment(s,r.host);var p;a.moveChildren!==!1&&(p=r.children.slice(),n.moveElements(p,{x:0,y:0},s,a));var f=r.incoming.slice(),h=r.outgoing.slice();I(f,function(d){var g=d.source,y=c(g,s,d);y&&t.reconnectEnd(d,s,pc(d,s,l),a)}),I(h,function(d){var g=d.target,y=c(s,g,d);y&&t.reconnectStart(d,s,lc(d,s,l),a)})};Jn.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)};Jn.prototype.execute=function(e){};Jn.prototype.revert=function(e){};Jn.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)};Jn.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)};Jn.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)};function ea(e){this._modeling=e}ea.$inject=["modeling"];ea.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},O(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};ea.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds,r=e.hints||{};r.layout!==!1&&(I(n.incoming,function(o){t.layoutConnection(o,{connectionEnd:pc(o,n,i)})}),I(n.outgoing,function(o){t.layoutConnection(o,{connectionStart:lc(o,n,i)})}))};ea.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return O(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};function Ai(e){this._modeling=e}Ai.$inject=["modeling"];Ai.prototype.preExecute=function(e){var t=e.delta,n=e.direction,i=e.movingShapes,r=e.resizingShapes,o=e.start,a={};this.moveShapes(i,t),I(r,function(s){a[s.id]=hR(s)}),this.resizeShapes(r,t,n),this.updateConnectionWaypoints(XA(i,r),t,n,o,i,r,a)};Ai.prototype.execute=function(){};Ai.prototype.revert=function(){};Ai.prototype.moveShapes=function(e,t){var n=this;I(e,function(i){n._modeling.moveShape(i,t,null,{autoResize:!1,layout:!1,recurse:!1})})};Ai.prototype.resizeShapes=function(e,t,n){var i=this;I(e,function(r){var o=ZA(r,n,t);i._modeling.resizeShape(r,o,null,{attachSupport:!1,autoResize:!1,layout:!1})})};Ai.prototype.updateConnectionWaypoints=function(e,t,n,i,r,o,a){var s=this,c=r.concat(o);I(e,function(u){var l=u.source,p=u.target,f=fR(u),h=$y(n),d={labelBehavior:!1};ai(c,l)&&ai(c,p)?(f=lt(f,function(g){return Zd(g,i,n)&&(g[h]=g[h]+t[h]),g.original&&Zd(g.original,i,n)&&(g.original[h]=g.original[h]+t[h]),g}),s._modeling.updateWaypoints(u,f,{labelBehavior:!1})):(ai(c,l)||ai(c,p))&&(ai(r,l)?d.connectionStart=bp(u,l,t):ai(r,p)?d.connectionEnd=xp(u,p,t):ai(o,l)?d.connectionStart=lc(u,l,a[l.id]):ai(o,p)&&(d.connectionEnd=pc(u,p,a[p.id])),s._modeling.layoutConnection(u,d))})};function Xd(e){return O({},e)}function fR(e){return lt(e.waypoints,function(t){return t=Xd(t),t.original&&(t.original=Xd(t.original)),t})}function $y(e){switch(e){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function Zd(e,t,n){var i=$y(n);if(/e|s/.test(n))return e[i]>t;if(/n|w/.test(n))return e[i]<t}function ai(e,t){return e.indexOf(t)!==-1}function hR(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}function xc(e){this._modeling=e}xc.$inject=["modeling"];xc.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=jy(n),t.collapsed=!t.collapsed;var i=Hy(n,t.collapsed);return[t].concat(i)};xc.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=t.children,r=zy(i,n);return t.collapsed=!t.collapsed,[t].concat(r)};function jy(e){var t={};return I(e,function(n){t[n.id]=n.hidden,n.children&&(t=O({},t,jy(n.children)))}),t}function Hy(e,t){var n=[];return I(e,function(i){i.hidden=t,n=n.concat(i),i.children&&(n=n.concat(Hy(i.children,i.collapsed||t)))}),n}function zy(e,t){var n=[];return I(e,function(i){i.hidden=t[i.id],n=n.concat(i),i.children&&(n=n.concat(zy(i.children,t)))}),n}function wc(e){this._modeling=e}wc.$inject=["modeling"];wc.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=Gy(i,t),Vy(n,t),t.host=n,t};wc.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,r=e.attacherIdx;return t.host=i,Gy(n,t),Vy(i,t,r),t};function Gy(e,t){return We(e&&e.attachers,t)}function Vy(e,t,n){if(!!e){var i=e.attachers;i||(e.attachers=i=[]),Ke(i,t,n)}}function Up(){}Up.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t};Up.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};function Oe(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}Oe.$inject=["eventBus","elementFactory","commandStack"];Oe.prototype.getHandlers=function(){return{"shape.append":gc,"shape.create":Ti,"shape.delete":Zo,"shape.move":ir,"shape.resize":ea,"shape.replace":Jn,"shape.toggleCollapse":xc,spaceTool:Ai,"label.create":Ko,"connection.create":yc,"connection.delete":Xo,"connection.move":Vp,"connection.layout":_c,"connection.updateWaypoints":Up,"connection.reconnect":Jo,"elements.create":zp,"elements.move":bc,"elements.delete":Gp,"elements.distribute":Ec,"elements.align":vc,"element.updateAttachment":wc}};Oe.prototype.registerHandlers=function(e){I(this.getHandlers(),function(t,n){e.registerHandler(n,t)})};Oe.prototype.moveShape=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=null);var o={shape:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",o)};Oe.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)};Oe.prototype.moveElements=function(e,t,n,i){i=i||{};var r=i.attach,o=n,a;r===!0?(a=n,o=n.parent):r===!1&&(a=null);var s={shapes:e,delta:t,newParent:o,newHost:a,hints:i};this._commandStack.execute("elements.move",s)};Oe.prototype.moveConnection=function(e,t,n,i,r){typeof i=="object"&&(r=i,i=void 0);var o={connection:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",o)};Oe.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)};Oe.prototype.createConnection=function(e,t,n,i,r,o){typeof n=="object"&&(o=r,r=i,i=n,n=void 0),i=this._create("connection",i);var a={source:e,target:t,parent:r,parentIndex:n,connection:i,hints:o};return this._commandStack.execute("connection.create",a),a.connection};Oe.prototype.createShape=function(e,t,n,i,r){typeof i!="number"&&(r=i,i=void 0),r=r||{};var o=r.attach,a,s;e=this._create("shape",e),o?(a=n.parent,s=n):a=n;var c={position:t,shape:e,parent:a,parentIndex:i,host:s,hints:r};return this._commandStack.execute("shape.create",c),c.shape};Oe.prototype.createElements=function(e,t,n,i,r){be(e)||(e=[e]),typeof i!="number"&&(r=i,i=void 0),r=r||{};var o={position:t,elements:e,parent:n,parentIndex:i,hints:r};return this._commandStack.execute("elements.create",o),o.elements};Oe.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var r={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape};Oe.prototype.appendShape=function(e,t,n,i,r){r=r||{},t=this._create("shape",t);var o={source:e,position:n,target:i,shape:t,connection:r.connection,connectionParent:r.connectionParent,hints:r};return this._commandStack.execute("shape.append",o),o.shape};Oe.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)};Oe.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)};Oe.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)};Oe.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)};Oe.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape};Oe.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)};Oe.prototype.resizeShape=function(e,t,n,i){var r={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",r)};Oe.prototype.createSpace=function(e,t,n,i,r){var o={delta:n,direction:i,movingShapes:e,resizingShapes:t,start:r};this._commandStack.execute("spaceTool",o)};Oe.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)};Oe.prototype.reconnect=function(e,t,n,i,r){var o={connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:r||{}};this._commandStack.execute("connection.reconnect",o)};Oe.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,O(i,{docking:"source"}))};Oe.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,O(i,{docking:"target"}))};Oe.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)};Oe.prototype._create=function(e,t){return t instanceof Mo?t:this._elementFactory.create(e,t)};Oe.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};function ta(e){this._elementRegistry=e}ta.$inject=["elementRegistry"];ta.prototype.execute=function(e){var t=e.element,n=e.moddleElement,i=e.properties;if(!n)throw new Error("<moddleElement> required");var r=e.changed||this.getVisualReferences(n).concat(t),o=e.oldProperties||dR(n,Pu(i));return Wy(n,i),e.oldProperties=o,e.changed=r,r};ta.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return Wy(n,t),i};ta.prototype.getVisualReferences=function(e){var t=this._elementRegistry;return v(e,"bpmn:DataObject")?mR(e,t):[]};function dR(e,t){return Rt(t,function(n,i){return n[i]=e.get(i),n},{})}function Wy(e,t){I(t,function(n,i){e.set(i,n)})}function mR(e,t){return t.filter(function(n){return v(n,"bpmn:DataObjectReference")&&X(n).dataObjectRef===e})}var ro="default",Hn="id",Uy="di",vR={width:0,height:0};function na(e,t,n,i,r){this._elementRegistry=e,this._moddle=t,this._translate=n,this._modeling=i,this._textRenderer=r}na.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"];na.prototype.execute=function(e){var t=e.element,n=[t],i=this._translate;if(!t)throw new Error(i("element required"));var r=this._elementRegistry,o=this._moddle.ids,a=t.businessObject,s=bR(e.properties),c=e.oldProperties||gR(t,s);return Yy(s,a)&&(o.unclaim(a[Hn]),r.updateId(t,s[Hn]),o.claim(s[Hn],a)),ro in s&&(s[ro]&&n.push(r.get(s[ro].id)),a[ro]&&n.push(r.get(a[ro].id))),qy(t,s),e.oldProperties=c,e.changed=n,n};na.prototype.postExecute=function(e){var t=e.element,n=t.label,i=n&&X(n).name;if(!!i){var r=this._textRenderer.getExternalLabelBounds(n,i);this._modeling.resizeShape(n,r,vR)}};na.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,r=t.businessObject,o=this._elementRegistry,a=this._moddle.ids;return qy(t,i),Yy(n,r)&&(a.unclaim(n[Hn]),o.updateId(t,i[Hn]),a.claim(i[Hn],r)),e.changed};function Yy(e,t){return Hn in e&&e[Hn]!==t[Hn]}function gR(e,t){var n=Pu(t),i=e.businessObject,r=Ce(e);return Rt(n,function(o,a){return a!==Uy?o[a]=i.get(a):o[a]=yR(r,Pu(t.di)),o},{})}function yR(e,t){return Rt(t,function(n,i){return n[i]=e&&e.get(i),n},{})}function qy(e,t){var n=e.businessObject,i=Ce(e);I(t,function(r,o){o!==Uy?n.set(o,r):i&&ER(i,r)})}function ER(e,t){I(t,function(n,i){e.set(i,n)})}var _R=["default"];function bR(e){var t=O({},e);return _R.forEach(function(n){n in e&&(t[n]=X(t[n]))}),t}function Sc(e,t){this._canvas=e,this._modeling=t}Sc.$inject=["canvas","modeling"];Sc.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=t.getRootElement(),o=r.businessObject,a=o.$parent,s=Ce(r);t.setRootElement(n),t.removeRootElement(r),Ke(a.rootElements,i),i.$parent=a,We(a.rootElements,o),o.$parent=null,r.di=null,s.bpmnElement=i,n.di=s,e.oldRoot=r};Sc.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,r=e.oldRoot,o=r.businessObject,a=i.$parent,s=Ce(n);t.setRootElement(r),t.removeRootElement(n),We(a.rootElements,i),i.$parent=null,Ke(a.rootElements,o),o.$parent=a,n.di=null,s.bpmnElement=o,r.di=s};function Yp(e,t){this._modeling=e,this._spaceTool=t}Yp.$inject=["modeling","spaceTool"];Yp.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,r=e.location,o=tn(i),a=o===i,s=a?i:i.parent,c=er(s);c.length||n.createShape({type:"bpmn:Lane"},{x:i.x+gr,y:i.y,width:i.width-gr,height:i.height},s);var u=[];Xi(o,function(g){return u.push(g),g.label&&u.push(g.label),g===i?[]:Ee(g.children,function(y){return y!==i})});var l=r==="top"?-120:120,p=r==="top"?i.y:i.y+i.height,f=p+(r==="top"?10:-10),h=r==="top"?"n":"s",d=t.calculateAdjustments(u,"y",l,f);t.makeSpace(d.movingShapes,d.resizingShapes,{x:0,y:l},h,f),e.newLane=n.createShape({type:"bpmn:Lane"},{x:i.x+(a?gr:0),y:p-(r==="top"?120:0),width:i.width-(a?gr:0),height:120},s)};function qp(e,t){this._modeling=e,this._translate=t}qp.$inject=["modeling","translate"];qp.prototype.preExecute=function(e){var t=this._modeling,n=this._translate,i=e.shape,r=e.count,o=er(i),a=o.length;if(a>r)throw new Error(n("more than {count} child lanes",{count:r}));var s=Math.round(i.height/r),c,u,l,p,f;for(f=0;f<r;f++)c=i.y+f*s,f===r-1?u=i.height-s*f:u=s,l={x:i.x+gr,y:c,width:i.width-gr,height:u},f<a?t.resizeShape(o[f],l):(p={type:"bpmn:Lane"},t.createShape(p,l,i))};function ia(e,t){this._modeling=e,this._spaceTool=t}ia.$inject=["modeling","spaceTool"];ia.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds,i=e.balanced;i!==!1?this.resizeBalanced(t,n):this.resizeSpace(t,n)};ia.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=tC(e,t);n.resizeShape(e,t),i.forEach(function(r){n.resizeShape(r.shape,r.newBounds)})};ia.prototype.resizeSpace=function(e,t){var n=this._spaceTool,i=le(e),r=le(t),o=Vg(r,i),a=tn(e),s=[],c=[];Xi(a,function(d){return s.push(d),(v(d,"bpmn:Lane")||v(d,"bpmn:Participant"))&&c.push(d),d.children});var u,l,p,f,h;(o.bottom||o.top)&&(u=o.bottom||o.top,l=e.y+(o.bottom?e.height:0)+(o.bottom?-10:10),p=o.bottom?"s":"n",f=o.top>0||o.bottom<0?-u:u,h=n.calculateAdjustments(s,"y",f,l),n.makeSpace(h.movingShapes,h.resizingShapes,{x:0,y:u},p)),(o.left||o.right)&&(u=o.right||o.left,l=e.x+(o.right?e.width:0)+(o.right?-10:100),p=o.right?"e":"w",f=o.left>0||o.right<0?-u:u,h=n.calculateAdjustments(c,"x",f,l),n.makeSpace(h.movingShapes,h.resizingShapes,{x:u,y:0},p))};var So="flowNodeRef",Kp="lanes";function ra(e){this._elementRegistry=e}ra.$inject=["elementRegistry"];ra.prototype.computeUpdates=function(e,t){var n=[],i=[],r={},o=[];function a(l,p){var f=le(p),h={x:l.x+l.width/2,y:l.y+l.height/2};return h.x>f.left&&h.x<f.right&&h.y>f.top&&h.y<f.bottom}function s(l){n.indexOf(l)===-1&&(o.push(l),n.push(l))}function c(l){var p=tn(l);return r[p.id]||(r[p.id]=nc(p)),r[p.id]}function u(l){if(!l.parent)return[];var p=c(l);return p.filter(function(f){return a(l,f)}).map(function(f){return f.businessObject})}return t.forEach(function(l){var p=tn(l);if(!(!p||n.indexOf(p)!==-1)){var f=p.children.filter(function(h){return v(h,"bpmn:FlowNode")});f.forEach(s),n.push(p)}}),e.forEach(s),o.forEach(function(l){var p=l.businessObject,f=p.get(Kp),h=f.slice(),d=u(l);i.push({flowNode:p,remove:h,add:d})}),t.forEach(function(l){var p=l.businessObject;l.parent||p.get(So).forEach(function(f){i.push({flowNode:f,remove:[p],add:[]})})}),i};ra.prototype.execute=function(e){var t=e.updates;t||(t=e.updates=this.computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(n){var i=n.flowNode,r=i.get(Kp);n.remove.forEach(function(o){We(r,o),We(o.get(So),i)}),n.add.forEach(function(o){Ke(r,o),Ke(o.get(So),i)})})};ra.prototype.revert=function(e){var t=e.updates;t.forEach(function(n){var i=n.flowNode,r=i.get(Kp);n.add.forEach(function(o){We(r,o),We(o.get(So),i)}),n.remove.forEach(function(o){Ke(r,o),Ke(o.get(So),i)})})};function Cc(e){this._moddle=e}Cc.$inject=["moddle"];Cc.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;r?t.claim(n,i):t.unclaim(n)};Cc.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element,r=e.claiming;r?t.unclaim(n):t.claim(n,i)};var xR={fill:void 0,stroke:void 0};function Xp(e){this._commandStack=e,this._normalizeColor=function(t){if(!!t){if(Gt(t)){var n=wR(t);if(n)return n}throw new Error("invalid color value: "+t)}}}Xp.$inject=["commandStack"];Xp.prototype.postExecute=function(e){var t=e.elements,n=e.colors||xR,i=this,r={};"fill"in n&&O(r,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&O(r,{"border-color":this._normalizeColor(n.stroke)}),I(t,function(o){var a=SR(o)?cn(r,["border-color"]):r;CR(a),rt(o)?i._commandStack.execute("element.updateModdleProperties",{element:o,moddleElement:Ce(o).label,properties:{color:r["border-color"]}}):i._commandStack.execute("element.updateProperties",{element:o,properties:{di:a}})})};function wR(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}function SR(e){return!!e.waypoints}function CR(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}var TR={width:0,height:0};function Ky(e,t,n){function i(u,l){if(!Yi(u)){var p=Ce(u);l&&!p.label&&(p.label=n.create("bpmndi:BPMNLabel")),!l&&p.label&&delete p.label}}function r(u,l){var p=u.label||u,f=u.labelTarget||u;return d1(p,l),i(u,l),[p,f]}function o(u){var l=u.element,p=l.businessObject,f=u.newLabel;if(!rt(l)&&Yi(l)&&!Gs(l)&&!Qd(f)){var h=7,d=Vs(l);d={x:d.x,y:d.y+h},e.createLabel(l,d,{id:p.id+"_label",businessObject:p,di:l.di})}}function a(u){return u.oldLabel=ln(u.element),r(u.element,u.newLabel)}function s(u){return r(u.element,u.oldLabel)}function c(u){var l=u.element,p=l.label||l,f=u.newLabel,h=u.newBounds,d=u.hints||{};if(!(!rt(p)&&!v(p,"bpmn:TextAnnotation"))){if(rt(p)&&Qd(f)){d.removeShape!==!1&&e.removeShape(p,{unsetLabel:!1});return}var g=ln(p);typeof h=="undefined"&&(h=t.getExternalLabelBounds(p,g)),h&&e.resizeShape(p,h,TR)}}this.preExecute=o,this.execute=a,this.revert=s,this.postExecute=c}Ky.$inject=["modeling","textRenderer","bpmnFactory"];function Qd(e){return!e||!e.trim()}function ht(e,t,n,i){Oe.call(this,e,t,n),this._bpmnRules=i}oe(ht,Oe);ht.$inject=["eventBus","elementFactory","commandStack","bpmnRules"];ht.prototype.getHandlers=function(){var e=Oe.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=ta,e["element.updateProperties"]=na,e["canvas.updateRoot"]=Sc,e["lane.add"]=Yp,e["lane.resize"]=ia,e["lane.split"]=qp,e["lane.updateRefs"]=ra,e["id.updateClaim"]=Cc,e["element.setColor"]=Xp,e["element.updateLabel"]=Ky,e};ht.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})};ht.prototype.connect=function(e,t,n,i){var r=this._bpmnRules;if(n||(n=r.canConnect(e,t)),!!n)return this.createConnection(e,t,n,e.parent,i)};ht.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})};ht.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})};ht.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})};ht.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane};ht.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})};ht.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e};ht.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})};ht.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"}),t={newRoot:e};this._commandStack.execute("canvas.updateRoot",t)};ht.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})};ht.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};ht.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})};function Xy(){}Xy.prototype.layoutConnection=function(e,t){return t=t||{},[t.connectionStart||ye(t.source||e.source),t.connectionEnd||ye(t.target||e.target)]};var Xa=20,AR=5,As=Math.round,Jd=20,RR={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function PR(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}function DR(e,t){return{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[e].test(t)}function Zy(e,t,n){var i=pt(t,e,AR),r=n.split(":")[0],o=As((t.x-e.x)/2+e.x),a=As((t.y-e.y)/2+e.y),s,c,u=DR(r,i),l=/h|r|l/.test(r),p=!1,f=!1;return u?(s=l?{x:o,y:e.y}:{x:e.x,y:a},c=l?"h:h":"v:v"):(p=PR(i,r),c=l?"h:v":"v:h",p?l?(f=a===e.y,s={x:e.x+Xa*(/l/.test(r)?-1:1),y:f?a+Xa:a}):(f=o===e.x,s={x:f?o+Xa:o,y:e.y+Xa*(/t/.test(r)?-1:1)}):s={x:o,y:a}),{waypoints:Zp(e,s,c).concat(s),directions:c,turnNextDirections:f}}function MR(e,t,n){return Zy(e,t,n)}function BR(e,t,n){var i=Zy(t,e,em(n));return{waypoints:i.waypoints.slice().reverse(),directions:em(i.directions),turnNextDirections:i.turnNextDirections}}function IR(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n=n=="h"?"v":"h"),t.turnNextDirections&&(i=i=="h"?"v":"h");var r=n+":"+i,o=Zp(e.waypoints[e.waypoints.length-1],t.waypoints[0],r);return{waypoints:o,directions:r}}function em(e){return e.split(":").reverse().join(":")}function FR(e,t,n){var i=As((t.x-e.x)/2+e.x),r=As((t.y-e.y)/2+e.y);if(n==="h:v")return[{x:t.x,y:e.y}];if(n==="v:h")return[{x:e.x,y:t.y}];if(n==="h:h")return[{x:i,y:e.y},{x:i,y:t.y}];if(n==="v:v")return[{x:e.x,y:r},{x:t.x,y:r}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}function Zp(e,t,n){if(n=n||"h:h",!GR(n))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Qy(n)){var i=MR(e,t,n),r=BR(e,t,n),o=IR(i,r);return[].concat(i.waypoints,o.waypoints,r.waypoints)}return FR(e,t,n)}function OR(e,t,n){var i=Zp(e,t,n);return i.unshift(e),i.push(t),Jy(i)}function kR(e,t,n,i,r){var o=r&&r.preferredLayouts||[],a=R0(o,"straight")[0]||"h:h",s=RR[a]||0,c=pt(e,t,s),u=zR(c,a);n=n||ye(e),i=i||ye(t);var l=u.split(":"),p=nm(n,e,l[0],VR(c)),f=nm(i,t,l[1],c);return OR(p,f,u)}function NR(e,t,n,i,r,o){be(n)&&(r=n,o=i,n=ye(e),i=ye(t)),o=O({preferredLayouts:[]},o),r=r||[];var a=o.preferredLayouts,s=a.indexOf("straight")!==-1,c;return c=s&&$R(e,t,n,i,o),c||(c=o.connectionEnd&&HR(t,e,i,r),c)||(c=o.connectionStart&&jR(e,t,n,r),c)?c:!o.connectionStart&&!o.connectionEnd&&r&&r.length?r:kR(e,t,n,i,o)}function LR(e,t,n){return e>=t&&e<=n}function tm(e,t,n){var i={x:"width",y:"height"};return LR(t[e],n[e],n[e]+n[i[e]])}function $R(e,t,n,i,r){var o={},a,s;return s=pt(e,t),/^(top|bottom|left|right)$/.test(s)?(/top|bottom/.test(s)&&(a="x"),/left|right/.test(s)&&(a="y"),r.preserveDocking==="target"?tm(a,i,e)?(o[a]=i[a],[{x:o.x!==void 0?o.x:n.x,y:o.y!==void 0?o.y:n.y,original:{x:o.x!==void 0?o.x:n.x,y:o.y!==void 0?o.y:n.y}},{x:i.x,y:i.y}]):null:tm(a,n,t)?(o[a]=n[a],[{x:n.x,y:n.y},{x:o.x!==void 0?o.x:i.x,y:o.y!==void 0?o.y:i.y,original:{x:o.x!==void 0?o.x:i.x,y:o.y!==void 0?o.y:i.y}}]):null):null}function jR(e,t,n,i){return Qp(e,t,n,i)}function HR(e,t,n,i){var r=i.slice().reverse();return r=Qp(e,t,n,r),r?r.reverse():null}function Qp(e,t,n,i){function r(l){return l.length<3?!0:l.length>4?!1:!!Me(l,function(p,f){var h=l[f-1];return h&&Po(p,h)<3})}function o(l,p,f){var h=Ln(p,l);switch(h){case"v":return{x:f.x,y:l.y};case"h":return{x:l.x,y:f.y}}return{x:l.x,y:l.y}}function a(l,p,f){var h;for(h=l.length-2;h!==0;h--)if(jf(l[h],p,Jd)||jf(l[h],f,Jd))return l.slice(h);return l}if(r(i))return null;var s=i[0],c=i.slice(),u;return c[0]=n,c[1]=o(c[1],s,n),u=a(c,e,t),u!==c&&(c=Qp(e,t,n,u)),c&&Ln(c)?null:c}function zR(e,t){if(Qy(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}function GR(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}function Qy(e){return e&&/t|r|b|l/.test(e)}function VR(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}function nm(e,t,n,i){if(n==="h"&&(n=/left/.test(i)?"l":"r"),n==="v"&&(n=/top/.test(i)?"t":"b"),n==="t")return{original:e,x:e.x,y:t.y};if(n==="r")return{original:e,x:t.x+t.width,y:e.y};if(n==="b")return{original:e,x:e.x,y:t.y+t.height};if(n==="l")return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function Jy(e){return e.reduce(function(t,n,i){var r=t[t.length-1],o=e[i+1];return Cl(r,o,n,0)||t.push(n),t},[])}var WR=-10,UR=40,Jp={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},ps={top:"t",right:"r",bottom:"b",left:"l"};function ef(){}oe(ef,Xy);ef.prototype.layoutConnection=function(e,t){t||(t={});var n=t.source||e.source,i=t.target||e.target,r=t.waypoints||e.waypoints,o=t.connectionStart,a=t.connectionEnd,s,c;return o||(o=im(r&&r[0],n)),a||(a=im(r&&r[r.length-1],i)),(v(e,"bpmn:Association")||v(e,"bpmn:DataAssociation"))&&r&&!rm(n,i)?[].concat([o],r.slice(1,-1),[a]):(v(e,"bpmn:MessageFlow")?s=qR(n,i):(v(e,"bpmn:SequenceFlow")||rm(n,i))&&(n===i?s={preferredLayouts:nP(n,e)}:v(n,"bpmn:BoundaryEvent")?s={preferredLayouts:iP(n,i,a)}:Co(n)||Co(i)?s=XR(n):v(n,"bpmn:Gateway")?s={preferredLayouts:["v:h"]}:v(i,"bpmn:Gateway")?s={preferredLayouts:["h:v"]}:s={preferredLayouts:["h:h"]}),s&&(s=O(s,t),c=Jy(NR(n,i,o,a,r,s))),c||[o,a])};function YR(e){var t=e.host;return pt(ye(e),t,WR)}function qR(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:KR(e,t)}}function KR(e,t){return v(t,"bpmn:Participant")?"source":v(e,"bpmn:Participant")?"target":Co(t)?"source":Co(e)||v(t,"bpmn:Event")?"target":v(e,"bpmn:Event")?"source":null}function XR(e){return{preferredLayouts:["straight","h:h"],preserveDocking:ZR(e)}}function ZR(e){return Co(e)?"target":"source"}function im(e,t){return e?e.original||e:ye(t)}function rm(e,t){return v(t,"bpmn:Activity")&&v(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function Co(e){return v(e,"bpmn:SubProcess")&&Re(e)}function mo(e,t){return e===t}function QR(e,t){return t.indexOf(e)!==-1}function vo(e){var t=/right|left/.exec(e);return t&&t[0]}function Wi(e){var t=/top|bottom/.exec(e);return t&&t[0]}function JR(e,t){return Jp[e]===t}function eP(e,t){var n=vo(e),i=Jp[n];return t.indexOf(i)!==-1}function tP(e,t){var n=Wi(e),i=Jp[n];return t.indexOf(i)!==-1}function rl(e){return e==="right"||e==="left"}function nP(e,t){var n=t.waypoints,i=n&&n.length&&pt(n[0],e);return i==="top"?["t:r"]:i==="right"?["r:b"]:i==="left"?["l:t"]:["b:l"]}function iP(e,t,n){var i=ye(e),r=ye(t),o=YR(e),a,s,c=mo(e.host,t),u=QR(o,["top","right","bottom","left"]),l=pt(r,i,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return c?rP(o,u,e,t,n):(a=oP(o,l,u),s=aP(o,l,u),[a+":"+s])}function rP(e,t,n,i,r){var o=t?e:Wi(e),a=ps[o],s;return t?rl(e)?s=om("y",n,i,r)?"h":"b":s=om("x",n,i,r)?"v":"l":s="v",[a+":"+s]}function om(e,t,n,i){var r=UR;return!(Eu(e,i,n,r)||Eu(e,i,{x:n.x+n.width,y:n.y+n.height},r)||Eu(e,i,ye(t),r))}function Eu(e,t,n,i){return Math.abs(t[e]-n[e])<i}function oP(e,t,n){return n?ps[e]:mo(Wi(e),Wi(t))||JR(vo(e),vo(t))?ps[Wi(e)]:ps[vo(e)]}function aP(e,t,n){return n?rl(e)?eP(e,t)||mo(e,t)?"h":"v":tP(e,t)||mo(e,t)?"v":"h":rl(t)||mo(Wi(e),Wi(t))&&vo(t)?"h":"v"}function am(e){return O({original:e.point.original||e.point},e.actual)}function Ri(e,t){this._elementRegistry=e,this._graphicsFactory=t}Ri.$inject=["elementRegistry","graphicsFactory"];Ri.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),r=this.getDockingPoint(e,n),o=e.waypoints.slice(i.idx+1,r.idx);return o.unshift(am(i)),o.push(am(r)),o};Ri.prototype.getDockingPoint=function(e,t,n){var i=e.waypoints,r,o,a;return r=n?0:i.length-1,o=i[r],a=this._getIntersection(t,e,n),{point:o,actual:a||o,idx:r}};Ri.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),r=this._getConnectionPath(t);return Nu(i,r,n)};Ri.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)};Ri.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)};Ri.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};var eE={__init__:["modeling","bpmnUpdater"],__depends__:[fA,MA,IA,FA,Gg,OA,Fy,jA,UA,Cn,Ll,Ny],bpmnFactory:["type",Xt],bpmnUpdater:["type",Dt],elementFactory:["type",Ci],modeling:["type",ht],layouter:["type",ef],connectionDocking:["type",Ri]},sP=500,cP=1250,uP=1500,Rs=Math.round;function lP(e){return{x:e.x+Rs(e.width/2),y:e.y+Rs(e.height/2)}}function tE(e,t,n,i,r){function o(s,c,u,l){return r.allowed("elements.move",{shapes:s,delta:c,position:u,target:l})}e.on("shape.move.start",uP,function(s){var c=s.context,u=s.shape,l=i.get().slice();l.indexOf(u)===-1&&(l=[u]),l=pP(l),O(c,{shapes:l,validatedShapes:l,shape:u})}),e.on("shape.move.start",cP,function(s){var c=s.context,u=c.validatedShapes,l;if(l=c.canExecute=o(u),!l)return!1}),e.on("shape.move.move",sP,function(s){var c=s.context,u=c.validatedShapes,l=s.hover,p={x:s.dx,y:s.dy},f={x:s.x,y:s.y},h;if(h=o(u,p,f,l),c.delta=p,c.canExecute=h,h===null){c.target=null;return}c.target=l}),e.on("shape.move.end",function(s){var c=s.context,u=c.delta,l=c.canExecute,p=l==="attach",f=c.shapes;if(l===!1)return!1;u.x=Rs(u.x),u.y=Rs(u.y),!(u.x===0&&u.y===0)&&n.moveElements(f,u,c.target,{primaryShape:c.shape,attach:p})}),e.on("element.mousedown",function(s){if(!!_i(s)){var c=Dr(s);if(!c)throw new Error("must supply DOM mousedown event");return a(c,s.element)}});function a(s,c,u,l){if(ot(u)&&(l=u,u=!1),!(c.waypoints||!c.parent)&&!Se(s.target).has("djs-hit-no-move")){var p=lP(c);return t.init(s,p,"shape.move",{cursor:"grabbing",autoActivate:u,data:{shape:c,context:l||{}}}),!0}}this.start=a}tE.$inject=["eventBus","dragging","modeling","selection","rules"];function pP(e){var t=qi(e,"id");return Ee(e,function(n){for(;n=n.parent;)if(t[n.id])return!1;return!0})}var sm=499,_u="djs-dragging",cm="drop-ok",um="drop-not-ok",lm="new-parent",pm="attach-ok";function nE(e,t,n,i){function r(c){var u=o(c),l=fP(u);return l}function o(c){var u=Ro(c,!0),l=lt(u,function(p){return(p.incoming||[]).concat(p.outgoing||[])});return hs(u.concat(l))}function a(c,u){[pm,cm,um,lm].forEach(function(l){l===u?t.addMarker(c,l):t.removeMarker(c,l)})}function s(c,u,l){i.addDragger(u,c.dragGroup),l&&t.addMarker(u,_u),c.allDraggedElements?c.allDraggedElements.push(u):c.allDraggedElements=[u]}e.on("shape.move.start",sm,function(c){var u=c.context,l=u.shapes,p=u.allDraggedElements,f=r(l);if(!u.dragGroup){var h=ae("g");W(h,n.cls("djs-drag-group",["no-events"]));var d=t.getActiveLayer();pe(d,h),u.dragGroup=h}f.forEach(function(g){i.addDragger(g,u.dragGroup)}),p?p=hs([p,o(l)]):p=o(l),I(p,function(g){t.addMarker(g,_u)}),u.allDraggedElements=p,u.differentParents=hP(l)}),e.on("shape.move.move",sm,function(c){var u=c.context,l=u.dragGroup,p=u.target,f=u.shape.parent,h=u.canExecute;p&&(h==="attach"?a(p,pm):u.canExecute&&p&&p.id!==f.id?a(p,lm):a(p,u.canExecute?cm:um)),At(l,c.dx,c.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(c){var u=c.context,l=u.target;l&&a(l,null)}),e.on("shape.move.cleanup",function(c){var u=c.context,l=u.allDraggedElements,p=u.dragGroup;I(l,function(f){t.removeMarker(f,_u)}),p&&Le(p)}),this.makeDraggable=s}nE.$inject=["eventBus","canvas","styles","previewSupport"];function fP(e){var t=Ee(e,function(n){return dP(n)?Me(e,on({id:n.source.id}))&&Me(e,on({id:n.target.id})):!0});return t}function hP(e){return yo(qi(e,function(t){return t.parent&&t.parent.id}))!==1}function dP(e){return e.waypoints}var mP={__depends__:[ko,Cn,zv,An,Kn,$o],__init__:["move","movePreview"],move:["type",tE],movePreview:["type",nE]},iE=".djs-palette-toggle",rE=".entry",vP=iE+", "+rE,ol="djs-palette-",gP="shown",al="open",fm="two-column",yP=1e3;function Xe(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(i){var r=i.tool;n.updateToolHighlight(r)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}Xe.$inject=["eventBus","canvas"];Xe.prototype.registerProvider=function(e,t){t||(t=e,e=yP),this._eventBus.on("palette.getProviders",e,function(n){n.providers.push(t)}),this._rebuild()};Xe.prototype.getEntries=function(){var e=this._getProviders();return e.reduce(_P,{})};Xe.prototype._rebuild=function(){if(!!this._diagramInitialized){var e=this._getProviders();!e.length||(this._container||this._init(),this._update())}};Xe.prototype._init=function(){var e=this,t=this._eventBus,n=this._getParentContainer(),i=this._container=ce(Xe.HTML_MARKUP);n.appendChild(i),re(n).add(ol+gP),bt.bind(i,vP,"click",function(r){var o=r.delegateTarget;if(ms(o,iE))return e.toggle();e.trigger("click",r)}),J.bind(i,"mousedown",function(r){r.stopPropagation()}),bt.bind(i,rE,"dragstart",function(r){e.trigger("dragstart",r)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})};Xe.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers};Xe.prototype._toggleState=function(e){e=e||{};var t=this._getParentContainer(),n=this._container,i=this._eventBus,r,o=re(n),a=re(t);"twoColumn"in e?r=e.twoColumn:r=this._needsCollapse(t.clientHeight,this._entries||{}),o.toggle(fm,r),a.toggle(ol+fm,r),"open"in e&&(o.toggle(al,e.open),a.toggle(ol+al,e.open)),i.fire("palette.changed",{twoColumn:r,open:this.isOpen()})};Xe.prototype._update=function(){var e=xe(".djs-palette-entries",this._container),t=this._entries=this.getEntries();To(e),I(t,function(n,i){var r=n.group||"default",o=xe("[data-group="+mi(r)+"]",e);o||(o=ce('<div class="group"></div>'),Ve(o,"data-group",r),e.appendChild(o));var a=n.html||(n.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),s=ce(a);if(o.appendChild(s),!n.separator&&(Ve(s,"data-action",i),n.title&&Ve(s,"title",n.title),n.className&&EP(s,n.className),n.imageUrl)){var c=ce("<img>");Ve(c,"src",n.imageUrl),s.appendChild(c)}}),this.open()};Xe.prototype.trigger=function(e,t,n){var i=this._entries,r,o,a,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();r=i[Ve(s,"data-action")],r&&(o=r.action,a=t.originalEvent||t,_t(o)?e==="click"&&o(a,n):o[e]&&o[e](a,n),t.preventDefault())};Xe.prototype._layoutChanged=function(){this._toggleState({})};Xe.prototype._needsCollapse=function(e,t){var n=50,i=Object.keys(t).length*46;return e<i+n};Xe.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})};Xe.prototype.open=function(){this._toggleState({open:!0})};Xe.prototype.toggle=function(e){this.isOpen()?this.close():this.open()};Xe.prototype.isActiveTool=function(e){return e&&this._activeTool===e};Xe.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=xe(".djs-palette-entries",this._container),this._toolsContainer=xe("[data-group=tools]",t)),n=this._toolsContainer,I(n.children,function(i){var r=i.getAttribute("data-action");if(!!r){var o=re(i);r=r.replace("-tool",""),o.contains("entry")&&r===e?o.add("highlighted-entry"):o.remove("highlighted-entry")}})};Xe.prototype.isOpen=function(){return re(this._container).has(al)};Xe.prototype._getParentContainer=function(){return this._canvas.getContainer()};Xe.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';function EP(e,t){var n=re(e),i=be(t)?t:t.split(/\s+/g);i.forEach(function(r){n.add(r)})}function _P(e,t){var n=t.getPaletteEntries();return _t(n)?n(e):(I(n,function(i,r){e[r]=i}),e)}var bP={__init__:["palette"],palette:["type",Xe]},oE="crosshair";function rr(e,t,n,i,r,o,a){this._selection=r,this._dragging=n,this._mouse=a;var s=this,c={create:function(u){var l=t.getActiveLayer(),p;p=u.frame=ae("rect"),W(p,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),pe(l,p)},update:function(u){var l=u.frame,p=u.bbox;W(l,{x:p.x,y:p.y,width:p.width,height:p.height})},remove:function(u){u.frame&&Le(u.frame)}};o.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(u){var l=u.originalEvent.target;!u.hover&&!(l instanceof SVGElement)||e.once("lasso.selection.ended",function(){s.activateLasso(u.originalEvent,!0)})}),e.on("lasso.end",function(u){var l=bu(u),p=i.filter(function(f){return f});s.select(p,l)}),e.on("lasso.start",function(u){var l=u.context;l.bbox=bu(u),c.create(l)}),e.on("lasso.move",function(u){var l=u.context;l.bbox=bu(u),c.update(l)}),e.on("lasso.cleanup",function(u){var l=u.context;c.remove(l)}),e.on("element.mousedown",1500,function(u){if(!!jv(u))return s.activateLasso(u.originalEvent),!0})}rr.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"];rr.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:oE,data:{context:{}}})};rr.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:oE,data:{context:{}}})};rr.prototype.select=function(e,t){var n=B_(e,t);this._selection.select(ml(n))};rr.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};rr.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};function bu(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y},i;return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?i={x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?i={x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?i={x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?i={x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:i={x:n.x,y:n.y,width:0,height:0},i}var xP={__depends__:[mc,Ho],__init__:["lassoTool"],lassoTool:["type",rr]},xu=1500,aE="grab";function Nr(e,t,n,i,r,o){this._dragging=n,this._mouse=o;var a=this,s=i.get("keyboard",!1);r.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",xu,function(c){if(!!br(c))return a.activateMove(c.originalEvent,!0),!1}),s&&s.addListener(xu,function(c){if(!(!hm(c.keyEvent)||a.isActive())){var u=a._mouse.getLastMoveEvent();a.activateMove(u,!!u)}},"keyboard.keydown"),s&&s.addListener(xu,function(c){!hm(c.keyEvent)||!a.isActive()||a.toggle()},"keyboard.keyup"),e.on("hand.end",function(c){var u=c.originalEvent.target;if(!c.hover&&!(u instanceof SVGElement))return!1;e.once("hand.ended",function(){a.activateMove(c.originalEvent,{reactivate:!0})})}),e.on("hand.move.move",function(c){var u=t.viewbox().scale;t.scroll({dx:c.dx*u,dy:c.dy*u})}),e.on("hand.move.end",function(c){var u=c.context,l=u.reactivate;return!br(c)&&l&&e.once("hand.move.ended",function(p){a.activateHand(p.originalEvent,!0,!0)}),!1})}Nr.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"];Nr.prototype.activateMove=function(e,t,n){typeof t=="object"&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:aE,data:{context:n||{}}})};Nr.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:aE,data:{context:{reactivate:n}}})};Nr.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)};Nr.prototype.isActive=function(){var e=this._dragging.context();return e?/^(hand|hand\.move)$/.test(e.prefix):!1};function hm(e){return nn(" ",e)}var wP={__depends__:[mc,Ho],__init__:["handTool"],handTool:["type",Nr]},dm="connect-ok",mm="connect-not-ok";function Lr(e,t,n,i,r,o,a){var s=this;this._dragging=t,this._rules=o,this._mouse=a,r.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(c){var u=c.context,l=c.hover,p=u.canStartConnect=s.canStartConnect(l);p!==null&&(u.startTarget=l,i.addMarker(l,p?dm:mm))}),e.on(["global-connect.out","global-connect.cleanup"],function(c){var u=c.context.startTarget,l=c.context.canStartConnect;u&&i.removeMarker(u,l?dm:mm)}),e.on(["global-connect.ended"],function(c){var u=c.context,l=u.startTarget,p={x:c.x,y:c.y},f=s.canStartConnect(l);if(!!f)return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,l,p)}),!1})}Lr.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"];Lr.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})};Lr.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)};Lr.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)};Lr.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};var SP={__depends__:[Jl,An,Kn,mc,Ho],globalConnect:["type",Lr]};function tf(e,t,n,i,r,o,a,s){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=r,this._handTool=o,this._globalConnect=a,this._translate=s,e.registerProvider(this)}tf.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];tf.prototype.getPaletteEntries=function(e){var t={},n=this._create,i=this._elementFactory,r=this._spaceTool,o=this._lassoTool,a=this._handTool,s=this._globalConnect,c=this._translate;function u(f,h,d,g,y){function A(w){var b=i.createShape(O({type:f},y));if(y){var S=Ce(b);S.isExpanded=y.isExpanded}n.start(w,b)}var _=f.replace(/^bpmn:/,"");return{group:h,className:d,title:g||c("Create {type}",{type:_}),action:{dragstart:A,click:A}}}function l(f){var h=i.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),d=i.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:h});n.start(f,[h,d],{hints:{autoSelect:[h]}})}function p(f){n.start(f,i.createParticipantShape())}return O(t,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:c("Activate the hand tool"),action:{click:function(f){a.activateHand(f)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:c("Activate the lasso tool"),action:{click:function(f){o.activateSelection(f)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:c("Activate the create/remove space tool"),action:{click:function(f){r.activateSelection(f)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:c("Activate the global connect tool"),action:{click:function(f){s.start(f)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":u("bpmn:StartEvent","event","bpmn-icon-start-event-none",c("Create StartEvent")),"create.intermediate-event":u("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",c("Create Intermediate/Boundary Event")),"create.end-event":u("bpmn:EndEvent","event","bpmn-icon-end-event-none",c("Create EndEvent")),"create.exclusive-gateway":u("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",c("Create Gateway")),"create.task":u("bpmn:Task","activity","bpmn-icon-task",c("Create Task")),"create.data-object":u("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",c("Create DataObjectReference")),"create.data-store":u("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",c("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:c("Create expanded SubProcess"),action:{dragstart:l,click:l}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:c("Create Pool/Participant"),action:{dragstart:p,click:p}},"create.group":u("bpmn:Group","artifact","bpmn-icon-group",c("Create Group"))}),t};var CP={__depends__:[bP,Js,Ny,xP,wP,SP,zs],__init__:["paletteProvider"],paletteProvider:["type",tf]},TP=250;function nf(e,t,n,i,r){K.call(this,e);function o(s){var c=s.canExecute.replacements;I(c,function(u){var l=u.oldElementId,p={type:u.newElementType};if(!s.visualReplacements[l]){var f=t.get(l);O(p,{x:f.x,y:f.y});var h=n.createShape(p);i.addShape(h,f.parent);var d=xe('[data-element-id="'+mi(f.id)+'"]',s.dragGroup);d&&W(d,{display:"none"});var g=r.addDragger(h,s.dragGroup);s.visualReplacements[l]=g,i.removeShape(h)}})}function a(s){var c=s.visualReplacements;I(c,function(u,l){var p=xe('[data-element-id="'+mi(l)+'"]',s.dragGroup);p&&W(p,{display:"inline"}),u.remove(),c[l]&&delete c[l]})}e.on("shape.move.move",TP,function(s){var c=s.context,u=c.canExecute;c.visualReplacements||(c.visualReplacements={}),u&&u.replacements?o(c):a(c)})}nf.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"];oe(nf,K);var AP={__depends__:[$o],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",nf]},RP=1250,wu=40,PP=20,DP=10,vm=20,sE=["x","y"],MP=Math.abs;function cE(e){e.on(["connect.hover","connect.move","connect.end"],RP,function(t){var n=t.context,i=n.canExecute,r=n.start,o=n.hover,a=n.source,s=n.target;t.originalEvent&&Ft(t.originalEvent)||(n.initialConnectionStart||(n.initialConnectionStart=n.connectionStart),i&&o&&BP(t,o,kP(o)),o&&OP(i,["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"])?(n.connectionStart=zt(r),De(o,["bpmn:Event","bpmn:Gateway"])&&gm(t,zt(o)),De(o,["bpmn:Task","bpmn:SubProcess"])&&IP(t,o),v(a,"bpmn:BoundaryEvent")&&s===a.host&&FP(t)):uE(i,"bpmn:MessageFlow")?(v(r,"bpmn:Event")&&(n.connectionStart=zt(r)),v(o,"bpmn:Event")&&gm(t,zt(o))):n.connectionStart=n.initialConnectionStart)})}cE.$inject=["eventBus"];function BP(e,t,n){sE.forEach(function(i){var r=lE(i,t);e[i]<t[i]+n?Ge(e,i,t[i]+n):e[i]>t[i]+r-n&&Ge(e,i,t[i]+r-n)})}function IP(e,t){var n=zt(t);sE.forEach(function(i){NP(e,t,i)&&Ge(e,i,n[i])})}function FP(e){var t=e.context,n=t.source,i=t.target;if(!LP(t)){var r=zt(n),o=pt(r,i,-10),a=[];/top|bottom/.test(o)&&a.push("x"),/left|right/.test(o)&&a.push("y"),a.forEach(function(s){var c=e[s],u;MP(c-r[s])<wu&&(c>r[s]?u=r[s]+wu:u=r[s]-wu,Ge(e,s,u))})}}function gm(e,t){Ge(e,"x",t.x),Ge(e,"y",t.y)}function uE(e,t){return e&&e.type===t}function OP(e,t){return Sn(t,function(n){return uE(e,n)})}function lE(e,t){return e==="x"?t.width:t.height}function kP(e){return v(e,"bpmn:Task")?DP:PP}function NP(e,t,n){return e[n]>t[n]+vm&&e[n]<t[n]+lE(n,t)-vm}function LP(e){var t=e.hover,n=e.source;return t&&n&&t===n}function Pi(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}Pi.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]};Pi.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,this._snapLocations.indexOf(e)===-1&&this._snapLocations.push(e)};Pi.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)};Pi.prototype.getSnapLocations=function(){return this._snapLocations};Pi.prototype.setSnapLocations=function(e){this._snapLocations=e};Pi.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new Tc,n.initDefaults(this._defaultSnaps)),n};function Tc(e){this._snapValues={}}Tc.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),n.x.indexOf(t.x)===-1&&n.x.push(t.x),n.y.indexOf(t.y)===-1&&n.y.push(t.y)};Tc.prototype.snap=function(e,t,n,i){var r=this._snapValues[t];return r&&Xw(e[n],r[n],i)};Tc.prototype.initDefaults=function(e){var t=this;I(e||{},function(n,i){I(n,function(r){t.add(i,r)})})};var $P=1250;function Rn(e,t,n){var i=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(r){i.initSnap(r)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],$P,function(r){var o=r.context,a=o.shape,s=o.snapContext,c=o.target;if(!(r.originalEvent&&Ft(r.originalEvent))&&!(xr(r)||!c)){var u=s.pointsForTarget(c);u.initialized||(u=i.addSnapTargetPoints(u,a,c),u.initialized=!0),n.snap(r,u)}}),t.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}Rn.$inject=["elementRegistry","eventBus","snapping"];Rn.prototype.initSnap=function(e){var t=this._elementRegistry,n=e.context,i=n.shape,r=n.snapContext;r||(r=n.snapContext=new Pi);var o;t.get(i.id)?o=zt(i,e):o={x:e.x+zt(i).x,y:e.y+zt(i).y};var a={x:o.x-i.width/2,y:o.y-i.height/2},s={x:o.x+i.width/2,y:o.y+i.height/2};return r.setSnapOrigin("mid",{x:o.x-e.x,y:o.y-e.y}),sl(i)||(r.setSnapOrigin("top-left",{x:a.x-e.x,y:a.y-e.y}),r.setSnapOrigin("bottom-right",{x:s.x-e.x,y:s.y-e.y})),r};Rn.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return I(i,function(r){if(sl(r)){sl(t)&&e.add("mid",zt(r));return}if(jP(r)){if(r.waypoints.length<3)return;var o=r.waypoints.slice(1,-1);I(o,function(a){e.add("mid",a)});return}e.add("mid",zt(r))}),!ge(t.x)||!ge(t.y)||this._elementRegistry.get(t.id)&&e.add("mid",zt(t)),e};Rn.prototype.getSnapTargets=function(e,t){return Ig(t).filter(function(n){return!HP(n)})};function jP(e){return!!e.waypoints}function HP(e){return!!e.hidden}function sl(e){return!!e.labelTarget}var ym=1500;function $r(e,t){t.invoke(Rn,this),e.on(["create.move","create.end"],ym,WP),e.on(["create.move","create.end","shape.move.move","shape.move.end"],ym,function(n){var i=n.context,r=i.canExecute,o=i.target,a=r&&(r==="attach"||r.attach);a&&!xr(n)&&zP(n,o)})}oe($r,Rn);$r.$inject=["eventBus","injector"];$r.prototype.initSnap=function(e){var t=Rn.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return I(n.outgoing,function(r){var o=r.waypoints[0];o=o.original||o,t.setSnapOrigin(r.id+"-docking",_m(o,i,e))}),I(n.incoming,function(r){var o=r.waypoints[r.waypoints.length-1];o=o.original||o,t.setSnapOrigin(r.id+"-docking",_m(o,i,e))}),v(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t};$r.prototype.addSnapTargetPoints=function(e,t,n){Rn.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);I(i,function(o){(VP(o)||GP([t,o],"bpmn:TextAnnotation"))&&(e.add("top-left",Mg(o)),e.add("bottom-right",Bg(o)))});var r=this._elementRegistry;return I(t.incoming,function(o){if(r.get(t.id)){Em(i,o.source)||e.add("mid",ye(o.source));var a=o.waypoints[0];e.add(o.id+"-docking",a.original||a)}}),I(t.outgoing,function(o){if(r.get(t.id)){Em(i,o.target)||e.add("mid",ye(o.target));var a=o.waypoints[o.waypoints.length-1];e.add(o.id+"-docking",a.original||a)}}),v(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e};$r.prototype.getSnapTargets=function(e,t){return Rn.prototype.getSnapTargets.call(this,e,t).filter(function(n){return!v(n,"bpmn:Lane")})};function zP(e,t){var n=le(t),i=_y(e,t),r=e.context,o=r.shape,a;o.parent?a={x:0,y:0}:a=ye(o),/top/.test(i)?Ge(e,"y",n.top-a.y):/bottom/.test(i)&&Ge(e,"y",n.bottom-a.y),/left/.test(i)?Ge(e,"x",n.left-a.x):/right/.test(i)&&Ge(e,"x",n.right-a.x)}function GP(e,t){return e.every(function(n){return v(n,t)})}function VP(e){return v(e,"bpmn:SubProcess")&&Re(e)?!0:v(e,"bpmn:Participant")}function WP(e){var t=e.context,n=t.createConstraints;if(!!n){var i=n.top,r=n.right,o=n.bottom,a=n.left;(a&&a>=e.x||r&&r<=e.x)&&Ge(e,"x",e.x),(i&&i>=e.y||o&&o<=e.y)&&Ge(e,"y",e.y)}}function Em(e,t){return e.indexOf(t)!==-1}function _m(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}var UP=1250;function oa(e,t){var n=this;e.on(["resize.start"],function(i){n.initSnap(i)}),e.on(["resize.move","resize.end"],UP,function(i){var r=i.context,o=r.shape,a=o.parent,s=r.direction,c=r.snapContext;if(!(i.originalEvent&&Ft(i.originalEvent))&&!xr(i)){var u=c.pointsForTarget(a);u.initialized||(u=n.addSnapTargetPoints(u,o,a,s),u.initialized=!0),ZP(s)&&Ge(i,"x",i.x),QP(s)&&Ge(i,"y",i.y),t.snap(i,u)}}),e.on(["resize.cleanup"],function(){t.hide()})}oa.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,r=t.snapContext;r||(r=t.snapContext=new Pi);var o=pE(n,i);return r.setSnapOrigin("corner",{x:o.x-e.x,y:o.y-e.y}),r};oa.prototype.addSnapTargetPoints=function(e,t,n,i){var r=this.getSnapTargets(t,n);return I(r,function(o){e.add("corner",Bg(o)),e.add("corner",Mg(o))}),e.add("corner",pE(t,i)),e};oa.$inject=["eventBus","snapping"];oa.prototype.getSnapTargets=function(e,t){return Ig(t).filter(function(n){return!YP(n,e)&&!qP(n)&&!KP(n)&&!XP(n)})};function pE(e,t){var n=ye(e),i=le(e),r={x:n.x,y:n.y};return t.indexOf("n")!==-1?r.y=i.top:t.indexOf("s")!==-1&&(r.y=i.bottom),t.indexOf("e")!==-1?r.x=i.right:t.indexOf("w")!==-1&&(r.x=i.left),r}function YP(e,t){return e.host===t}function qP(e){return!!e.waypoints}function KP(e){return!!e.hidden}function XP(e){return!!e.labelTarget}function ZP(e){return e==="n"||e==="s"}function QP(e){return e==="e"||e==="w"}var JP=7,eD=1e3;function Di(e){this._canvas=e,this._asyncHide=Om(wt(this.hide,this),eD)}Di.$inject=["canvas"];Di.prototype.snap=function(e,t){var n=e.context,i=n.snapContext,r=i.getSnapLocations(),o={x:xr(e,"x"),y:xr(e,"y")};I(r,function(a){var s=i.getSnapOrigin(a),c={x:e.x+s.x,y:e.y+s.y};if(I(["x","y"],function(u){var l;o[u]||(l=t.snap(c,a,u,JP),l!==void 0&&(o[u]={value:l,originValue:l-s[u]}))}),o.x&&o.y)return!1}),this.showSnapLine("vertical",o.x&&o.x.value),this.showSnapLine("horizontal",o.y&&o.y.value),I(["x","y"],function(a){var s=o[a];ot(s)&&Ge(e,a,s.originValue)})};Di.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=ae("path");return W(n,{d:"M0,0 L0,0"}),Se(n).add("djs-snap-line"),pe(t,n),{update:function(i){ge(i)?e==="horizontal"?W(n,{d:"M-100000,"+i+" L+100000,"+i,display:""}):W(n,{d:"M "+i+",-100000 L "+i+", +100000",display:""}):W(n,{display:"none"})}}};Di.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}};Di.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()};Di.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]};Di.prototype.hide=function(){I(this._snapLines,function(e){e.update()})};var tD={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",Rn],resizeSnapping:["type",oa],snapping:["type",Di]},nD={__depends__:[tD],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",cE],createMoveSnapping:["type",$r]};function me(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=ce(me.BOX_HTML),this._searchInput=xe(me.INPUT_SELECTOR,this._container),this._resultsContainer=xe(me.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}me.$inject=["canvas","eventBus","overlays","selection"];me.prototype._bindEvents=function(){var e=this;function t(n,i,r,o){e._eventMaps.push({el:n,type:r,listener:bt.bind(n,i,r,o)})}t(document,"html","click",function(n){e.close()}),t(this._container,me.INPUT_SELECTOR,"click",function(n){n.stopPropagation(),n.delegateTarget.focus()}),t(this._container,me.RESULT_SELECTOR,"mouseover",function(n){n.stopPropagation(),e._scrollToNode(n.delegateTarget),e._preselect(n.delegateTarget)}),t(this._container,me.RESULT_SELECTOR,"click",function(n){n.stopPropagation(),e._select(n.delegateTarget)}),t(this._container,me.INPUT_SELECTOR,"keydown",function(n){n.keyCode===38&&n.preventDefault(),n.keyCode===40&&n.preventDefault()}),t(this._container,me.INPUT_SELECTOR,"keyup",function(n){if(n.keyCode===27)return e.close();if(n.keyCode===13){var i=e._getCurrentResult();return i?e._select(i):e.close()}if(n.keyCode===38)return e._scrollToDirection(!0);if(n.keyCode===40)return e._scrollToDirection();n.keyCode===37||n.keyCode===39||e._search(n.delegateTarget.value)})};me.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){bt.unbind(e.el,e.type,e.listener)})};me.prototype._search=function(e){var t=this;if(this._clearResults(),!(!e||e==="")){var n=this._searchProvider.find(e);if(!!n.length){n.forEach(function(r){var o=r.element.id,a=t._createResultNode(r,o);t._results[o]={element:r.element,node:a}});var i=xe(me.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}};me.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(!!t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}};me.prototype._scrollToNode=function(e){if(!(!e||e===this._getCurrentResult())){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}};me.prototype._clearResults=function(){To(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")};me.prototype._getCurrentResult=function(){return xe(me.RESULT_SELECTED_SELECTOR,this._resultsContainer)};me.prototype._createResultNode=function(e,t){var n=ce(me.RESULT_HTML);return e.primaryTokens.length>0&&bm(n,e.primaryTokens,me.RESULT_PRIMARY_HTML),bm(n,e.secondaryTokens,me.RESULT_SECONDARY_HTML),Ve(n,me.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n};me.prototype.registerProvider=function(e){this._searchProvider=e};me.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,re(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))};me.prototype.close=function(){!this.isOpen()||(this._unbindEvents(),this._open=!1,re(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))};me.prototype.toggle=function(){this.isOpen()?this.close():this.open()};me.prototype.isOpen=function(){return this._open};me.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&re(t).remove(me.RESULT_SELECTED_CLASS);var n=Ve(e,me.RESULT_ID_ATTRIBUTE),i=this._results[n].element;re(e).add(me.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._canvas.scrollToElement(i,{top:400}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}};me.prototype._select=function(e){var t=Ve(e,me.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._canvas.scrollToElement(n,{top:400}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)};me.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=Je(e),n=iD(t);this._overlayId=this._overlays.add(e,n)}};function iD(e){var t=6,n=e.width+t*2,i=e.height+t*2,r={width:n+"px",height:i+"px"},o=ce('<div class="'+me.OVERLAY_CLASS+'"></div>');return qe(o,r),{position:{bottom:i-t,right:n-t},show:!0,html:o}}function bm(e,t,n){var i=rD(t),r=ce(n);r.innerHTML=i,e.appendChild(r)}function rD(e){var t="";return e.forEach(function(n){n.matched?t+='<strong class="'+me.RESULT_HIGHLIGHT_CLASS+'">'+On(n.matched)+"</strong>":t+=On(n.normal)}),t!==""?t:null}me.CONTAINER_SELECTOR=".djs-search-container";me.INPUT_SELECTOR=".djs-search-input input";me.RESULTS_CONTAINER_SELECTOR=".djs-search-results";me.RESULT_SELECTOR=".djs-search-result";me.RESULT_SELECTED_CLASS="djs-search-result-selected";me.RESULT_SELECTED_SELECTOR="."+me.RESULT_SELECTED_CLASS;me.RESULT_ID_ATTRIBUTE="data-result-id";me.RESULT_HIGHLIGHT_CLASS="djs-search-highlight";me.OVERLAY_CLASS="djs-search-overlay";me.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>';me.RESULT_HTML='<div class="djs-search-result"></div>';me.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>';me.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';var oD={__depends__:[Ys,Cn],searchPad:["type",me]};function rf(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}rf.$inject=["elementRegistry","searchPad","canvas"];rf.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(i){return!i.labelTarget});return n=Ee(n,function(i){return i!==t}),n=lt(n,function(i){return{primaryTokens:wm(ln(i),e),secondaryTokens:wm(i.id,e),element:i}}),n=Ee(n,function(i){return xm(i.primaryTokens)||xm(i.secondaryTokens)}),n=sn(n,function(i){return ln(i.element)+i.element.id}),n};function xm(e){var t=Ee(e,function(n){return!!n.matched});return t.length>0}function wm(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var r=e.indexOf(t);return r>-1?(r!==0&&n.push({normal:i.substr(0,r)}),n.push({matched:i.substr(r,t.length)}),t.length+r<e.length&&n.push({normal:i.substr(t.length+r,e.length)})):n.push({normal:i}),n}var aD={__depends__:[oD],__init__:["bpmnSearch"],bpmnSearch:["type",rf]},sD='<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>';function xn(e){Oo.call(this,e)}oe(xn,Oo);xn.Viewer=Yn;xn.NavigatedViewer=xo;xn.prototype.createDiagram=Pr(function(){return this.importXML(sD)});xn.prototype._interactionModules=[tg,zl,X2,Vl];xn.prototype._modelingModules=[aw,ww,Bw,Tw,Jw,Jl,oS,iC,Hg,Js,cC,pC,RC,MC,BC,NC,XC,eE,mP,CP,AP,ey,nD,aD];xn.prototype._modules=[].concat(Yn.prototype._modules,xn.prototype._interactionModules,xn.prototype._modelingModules);const of=1,fE=1<<1,hE=1<<2,dE=1<<3,cD=1<<4,uD=1<<5,lD=1<<6,pD=1<<7,fD=1<<8,hD=1<<9,dD=of|fE|hE,mD=of|dE,Pe=Object.freeze({ACTIVATED:of,RUNNING:fE,ENDING:hE,ENDED:dE,DESTROYED:cD,FAILED:uD,TERMINATED:lD,CANCELED:pD,COMPLETED:fD,COMPENSABLE:hD,ACTIVE:dD,NOT_DEAD:mD}),jr={};function ji(e,t){throw new Error(`illegal transition: ${e.name} -> ${t}`)}function Hi(e,t){return e===jr?t:e}class Lt{constructor(t,n,{start:i,cancel:r,complete:o,destroy:a,fail:s,terminate:c,compensable:u}={}){this.name=t,this.traits=n,this._start=Hi(i,this),this._compensable=Hi(u,this),this._cancel=Hi(r,this),this._complete=Hi(o,this),this._destroy=Hi(a,this),this._fail=Hi(s,this),this._terminate=Hi(c,this)}hasTrait(t){return(this.traits&t)!==0}complete(){return this._complete||ji(this,"complete")}destroy(){return this._destroy||ji(this,"destroy")}cancel(){return this._cancel||ji(this,"cancel")}fail(){return this._fail||ji(this,"fail")}terminate(){return this._terminate||ji(this,"terminate")}compensable(){return this._compensable||ji(this,"compensable")}start(){return this._start||ji(this,"start")}}const Ac=new Lt("failed",Pe.DESTROYED|Pe.FAILED),Rc=new Lt("terminated",Pe.DESTROYED|Pe.TERMINATED),af=new Lt("completed",Pe.DESTROYED|Pe.COMPLETED),Mi=new Lt("terminating",Pe.ENDING|Pe.TERMINATED,{destroy:Rc}),Hr=new Lt("canceling",Pe.ENDING|Pe.FAILED|Pe.CANCELED,{destroy:Ac,complete:jr,terminate:Mi}),sf=new Lt("completing",Pe.ENDING|Pe.COMPLETED,{destroy:af,cancel:Hr,terminate:Mi}),cf=new Lt("failing",Pe.ENDING|Pe.FAILED,{cancel:Hr,complete:sf,destroy:Ac,terminate:Mi}),vD=new Lt("compensable:failing",Pe.ENDING|Pe.FAILED,{complete:jr,terminate:Mi,destroy:Ac}),mE=new Lt("compensable:completed",Pe.ENDED|Pe.COMPLETED,{cancel:Hr,fail:vD,destroy:af,compensable:jr}),gD=new Lt("compensable:completing",Pe.ENDING|Pe.COMPLETED,{destroy:mE,terminate:Mi,compensable:jr}),yD=new Lt("compensable:running",Pe.RUNNING|Pe.COMPENSABLE,{cancel:Hr,complete:gD,compensable:jr,destroy:mE,fail:cf,terminate:Mi}),vE=new Lt("running",Pe.RUNNING,{cancel:Hr,complete:sf,compensable:yD,destroy:Rc,fail:cf,terminate:Mi}),ED=new Lt("activated",Pe.ACTIVATED,{start:vE,destroy:Rc}),_D=Object.freeze({ACTIVATED:ED,RUNNING:vE,CANCELING:Hr,COMPLETING:sf,COMPLETED:af,FAILING:cf,FAILED:Ac,TERMINATING:Mi,TERMINATED:Rc});class bD{constructor(t,n,i=null,r=null){this.id=t,this.element=n,this.parent=i,this.initiator=r,this.subscriptions=new Set,this.children=[],this.state=_D.ACTIVATED}get running(){return this.hasTrait(Pe.RUNNING)}get destroyed(){return this.hasTrait(Pe.DESTROYED)}get completed(){return this.hasTrait(Pe.COMPLETED)}get canceled(){return this.hasTrait(Pe.CANCELED)}get failed(){return this.hasTrait(Pe.FAILED)}hasTrait(t){return this.state.hasTrait(t)}start(){return this.state=this.state.start(),this}compensable(){return this.state=this.state.compensable(),this}fail(t){return this.failed||(this.state=this.state.fail(),this.failInitiator=t),this}cancel(t){return this.canceled||(this.state=this.state.cancel(),this.cancelInitiator=t),this}terminate(t){return this.state=this.state.terminate(),this.terminateInitiator=t,this}complete(){return this.state=this.state.complete(),this}destroy(t){return this.state=this.state.destroy(),this.destroyInitiator=t,this}getTokens(){return this.children.filter(t=>!t.destroyed).length}getTokensByElement(t){return this.children.filter(n=>!n.destroyed&&n.element===t).length}}function ao(e,t){const n=[];for(const i of e)t(i)&&n.push(i);return n}function Sm(e,t){for(const n of e)if(t(n))return n;return null}function cl(e,t){return["type","name","ref","iref"].every(n=>!(n in e)||e[n]===t[n])}function gE(e){return e.filter(t=>v(t,"bpmn:SequenceFlow"))}function ul(e){return v(e,"bpmn:MessageFlow")}function xD(e){return v(e,"bpmn:SequenceFlow")}function wD(e){return uf(e)&&_E(e,"bpmn:LinkEventDefinition")}function Ps(e){return uf(e)&&_E(e,"bpmn:CompensateEventDefinition")}function yE(e){return v(e,"bpmn:Activity")&&e.businessObject.isForCompensation}function uf(e){return v(e,"bpmn:CatchEvent")&&!Pc(e)}function Su(e){return v(e,"bpmn:BoundaryEvent")&&!Pc(e)}function fs(e){return v(e,"bpmn:StartEvent")&&!Pc(e)}function Pc(e){return!!e.labelTarget}function vi(e){return X(e).triggeredByEvent}function EE(e){return v(e,"bpmn:StartEvent")&&X(e).isInterrupting||v(e,"bpmn:BoundaryEvent")&&X(e).cancelActivity}function Dc(e,t){return t.some(n=>v(e,n))}function _E(e,t){return Sn(X(e).eventDefinitions,n=>v(n,t))}function bE(e,t,n){const i=e.get("scopeIds",!1)||new un([32,36]),r={},o={},a=new SD,s=new Set,c=[],u=new Set,l=new Set;T("tick",function(){for(const N of s)ue("elementChanged",{element:N});s.clear()});function p(N,Y){if(c.push([Y,N]),c.length!==1)return;let U;for(;U=c[0];){const[Q,ne]=U;ne.destroyed||Q(),c.shift()}ue("tick")}function f(N){return o[N.type]||a}function h(N){const{element:Y,parentScope:U,initiator:Q=null}=N,ne=N.scope||V({element:Y,parent:U,initiator:Q});return p(ne,function(){ne.running||ne.start(),he("signal",{...N,scope:ne}),f(Y).signal({...N,scope:ne}),ne.parent&&_e(ne.parent)}),ne}function d(N){const{element:Y,scope:U,initiator:Q=U}=N,ne=V({element:Y,parent:U,initiator:Q});return p(ne,function(){ne.running||ne.start(),he("enter",N),f(Y).enter({...N,initiator:Q,scope:ne}),_e(U)}),ne}function g(N){const{element:Y,scope:U,initiator:Q=U}=N;p(U,function(){he("exit",N),f(Y).exit({...N,initiator:Q}),U.running&&U.complete(),G(U,Q),U.parent&&_e(U.parent)})}function y(N){const{event:Y,initiator:U,scope:Q}=N,ne=b(Y),se=Q.subscriptions,de=ao(se,we=>cl(ne,we.event)),Te=de.filter(we=>!we.event.interrupting),Ye=de.filter(we=>we.event.interrupting);if(!Ye.length)return Te.map(we=>we.triggerFn(U)).flat();const tt=Ye.find(we=>!we.event.boundary)||Ye[0],nt=ao(se,we=>we.event.persistent||CD(we.event,tt.event));return se.forEach(we=>{nt.includes(we)||we.remove()}),[tt.triggerFn(U)].flat().filter(we=>we)}function A(N,Y,U){Y=b(Y);const Q=Y.element,ne={scope:N,event:Y,element:Q,triggerFn:U,remove(){_(ne)}};return l.add(ne),N.subscriptions.add(ne),Q&&Ne(Q),ne}function _(N){const{scope:Y,event:U}=N;l.delete(N),Y.subscriptions.delete(N),U.element&&Ne(U.element)}function w(N){return v(N,"bpmn:StartEvent")||v(N,"bpmn:IntermediateCatchEvent")||v(N,"bpmn:ReceiveTask")?X(N).name||N.id:null}function b(N){if(!N.businessObject)return N;const Y=EE(N),U=Su(N),Q=w(N),ne={element:N,interrupting:Y,boundary:U,...Q?{iref:Q}:{}},se=(N.businessObject.eventDefinitions||{})[0];if(!se)return{...ne,type:TD(N)?"message":"none"};if(v(se,"bpmn:LinkEventDefinition"))return{...ne,type:"link",name:se.name};if(v(se,"bpmn:SignalEventDefinition"))return{...ne,type:"signal",ref:se.signalRef};if(v(se,"bpmn:TimerEventDefinition"))return{...ne,type:"timer"};if(v(se,"bpmn:ConditionalEventDefinition"))return{...ne,type:"condition"};if(v(se,"bpmn:EscalationEventDefinition"))return{...ne,type:"escalation",ref:se.escalationRef};if(v(se,"bpmn:CancelEventDefinition"))return{...ne,type:"cancel"};if(v(se,"bpmn:ErrorEventDefinition"))return{...ne,type:"error",ref:se.errorRef};if(v(se,"bpmn:MessageEventDefinition"))return{...ne,type:"message",ref:se.messageRef};if(v(se,"bpmn:CompensateEventDefinition")){let de=se.activityRef&&n.get(se.activityRef.id);return de||(fs(N)&&vi(N.parent)?de=N.parent.parent:Su(N)?de=N.host:de=N.parent),{...ne,type:"compensate",ref:de,persistent:!0}}throw new Error("unknown event definition",se)}function S(N,Y=!0){const{element:U,parent:Q,initiator:ne}=N;Y&&he("createScope",{element:U,scope:Q});const se=new bD(i.next(),U,Q,ne);return Q&&Q.children.push(se),u.add(se),Y&&ue("createScope",{scope:se}),Ne(U),Q&&Ne(Q.element),se}function M(N){if(typeof N=="function")return N;const{event:Y,element:U,scope:Q}=N,ne=N.elements||U&&[U],se=Y&&b(Y);return de=>(!se||cl(se,de.event))&&(!ne||ne.includes(de.element))&&(!Q||Q===de.scope)}function C(N){const Y=N==="function"?N:M(N);return U=>Array.from(U.subscriptions).some(Y)}function R(N){if(typeof N=="function")return N;const{element:Y,waitsOnElement:U,parent:Q,trait:ne=Pe.RUNNING,subscribedTo:se}=N,de=se?C(se):()=>!0;return Te=>(!Y||Te.element===Y)&&(!Q||Te.parent===Q)&&(!U||Te.getTokensByElement(U)>0)&&Te.hasTrait(ne)&&de(Te)}function D(N){return ao(l,M(N))}function F(N){return Sm(l,M(N))}function j(N){return ao(u,R(N))}function z(N){return Sm(u,R(N))}function G(N,Y=null){if(!N.destroyed){N.destroy(Y);for(const U of N.subscriptions){const Q=U.event.traits||Pe.ACTIVE;N.hasTrait(Q)||_(U)}if(N.destroyed){for(const U of N.children)U.destroyed||G(U,Y);he("destroyScope",{element:N.element,scope:N}),u.delete(N),ue("destroyScope",{scope:N})}Ne(N.element),N.parent&&Ne(N.parent.element)}}function he(N,Y){ue("trace",{...Y,action:N})}function Ne(N){s.add(N),c.length||ue("tick")}function _e(N){ue("scopeChanged",{scope:N})}function ue(N,Y={}){return t.fire(`tokenSimulation.simulator.${N}`,Y)}function T(N,Y){t.on("tokenSimulation.simulator."+N,Y)}function m(N,Y){t.off("tokenSimulation.simulator."+N,Y)}function B(N,Y){const U=te(N);r[N.id||N]={...U,...Y},Ne(N)}function k(){const N=[];return n.forEach(Y=>{if(!Dc(Y,["bpmn:Process","bpmn:Participant"]))return;const U=S({element:Y},!1);N.push(U);const Q=Y.children.filter(fs);for(const ne of Q){const se={...b(ne),interrupting:!1};A(U,se,de=>h({element:Y,startEvent:ne,initiator:de}))}}),N}function V(N){const{element:Y}=N,U=S(N),{children:Q=[],attachers:ne=[]}=Y;for(const se of Q)if(vi(se)){const de=se.children.filter(Te=>fs(Te)&&!Ps(Te));for(const Te of de)A(U,Te,Ye=>h({element:se,parentScope:U,startEvent:Te,initiator:Ye}))}for(const se of ne)Su(se)&&!Ps(se)&&A(U,se,de=>h({element:se,parentScope:U.parent,hostScope:U,initiator:de}));return U}function te(N){return r[N.id||N]||{}}function L(N,Y){if(!Y.length)return;const U={type:"all-completed",persistent:!1},Q=new Set(Y),ne=se=>{Q.delete(se.scope),Q.size===0&&(m("destroyScope",ne),y({scope:N,event:U}))};return T("destroyScope",ne),U}function H(N,Y=!0){B(N,{wait:Y})}function ee(){for(const N of u)G(N);for(const N of k())u.add(N);ue("tick"),ue("reset")}this.createScope=S,this.destroyScope=G,this.findScope=z,this.findScopes=j,this.findSubscription=F,this.findSubscriptions=D,this.waitAtElement=H,this.waitForScopes=L,this.setConfig=B,this.getConfig=te,this.signal=h,this.enter=d,this.exit=g,this.subscribe=A,this.trigger=y,this.reset=ee,this.on=T,this.off=m,this.registerBehavior=function(N,Y){o[N]=Y}}bE.$inject=["injector","eventBus","elementRegistry"];function SD(){this.signal=function(e){console.log("ignored #exit",e.element)},this.exit=function(e){console.log("ignored #exit",e.element)},this.enter=function(e){console.log("ignored #enter",e.element)}}function CD(e,t){return e.type===t.type&&e.boundary&&!t.boundary}function TD(e){return v(e,"bpmn:ReceiveTask")||e.incoming.some(t=>v(t,"bpmn:MessageFlow"))}function Mc(e,t){this._simulator=e,this._activityBehavior=t,e.registerBehavior("bpmn:StartEvent",this)}Mc.prototype.signal=function(e){this._simulator.exit(e)};Mc.prototype.exit=function(e){this._activityBehavior.exit(e)};Mc.$inject=["simulator","activityBehavior"];function aa(e,t,n){this._intermediateThrowEventBehavior=n,this._scopeBehavior=t,e.registerBehavior("bpmn:EndEvent",this)}aa.$inject=["simulator","scopeBehavior","intermediateThrowEventBehavior"];aa.prototype.enter=function(e){this._intermediateThrowEventBehavior.enter(e)};aa.prototype.signal=function(e){this._intermediateThrowEventBehavior.signal(e)};aa.prototype.exit=function(e){const{scope:t}=e;this._scopeBehavior.tryExit(t.parent,t)};function Bc(e,t,n){this._simulator=e,this._activityBehavior=t,this._scopeBehavior=n,e.registerBehavior("bpmn:BoundaryEvent",this)}Bc.prototype.signal=function(e){const{element:t,scope:n,hostScope:i=this._simulator.findScope({parent:n.parent,element:t.host})}=e;if(!i)throw new Error("host scope not found");if(X(t).cancelActivity){this._scopeBehavior.interrupt(i,n);const o=this._scopeBehavior.tryExit(i,n);if(o){const a=this._simulator.subscribe(i,o,s=>(a.remove(),this._simulator.exit(e)));return}}this._simulator.exit(e)};Bc.prototype.exit=function(e){this._activityBehavior.exit(e)};Bc.$inject=["simulator","activityBehavior","scopeBehavior"];function sa(e,t){this._activityBehavior=t,this._simulator=e,e.registerBehavior("bpmn:IntermediateCatchEvent",this),e.registerBehavior("bpmn:ReceiveTask",this)}sa.$inject=["simulator","activityBehavior"];sa.prototype.signal=function(e){const{element:t}=e;return v(t,"bpmn:ReceiveTask")?this._activityBehavior.signal(e):this._simulator.exit(e)};sa.prototype.enter=function(e){const{element:t}=e;if(v(t,"bpmn:ReceiveTask")){const n=this._activityBehavior._triggerMessages(e);if(n)return this._activityBehavior.signalOnEvent(e,n)}return this._activityBehavior.signalOnEvent(e,t)};sa.prototype.exit=function(e){this._activityBehavior.exit(e)};function ca(e,t,n){this._simulator=e,this._activityBehavior=t,this._eventBehaviors=n,e.registerBehavior("bpmn:IntermediateThrowEvent",this)}ca.prototype.enter=function(e){const{element:t}=e,n=this._eventBehaviors.get(t);if(n){const i=n(e);if(i)return this._activityBehavior.signalOnEvent(e,i)}this._activityBehavior.enter(e)};ca.prototype.signal=function(e){this._activityBehavior.signal(e)};ca.prototype.exit=function(e){this._activityBehavior.exit(e)};ca.$inject=["simulator","activityBehavior","eventBehaviors"];function Ic(e){this._simulator=e,e.registerBehavior("bpmn:ExclusiveGateway",this)}Ic.prototype.enter=function(e){this._simulator.exit(e)};Ic.prototype.exit=function(e){const{element:t,scope:n}=e,i=gE(t.outgoing);if(i.length===1)return this._simulator.enter({element:i[0],scope:n.parent});const{activeOutgoing:r}=this._simulator.getConfig(t),o=i.find(a=>a===r);if(!o)throw new Error("no outgoing configured");return this._simulator.enter({element:o,scope:n.parent})};Ic.$inject=["simulator"];function Fc(e,t){this._simulator=e,this._activityBehavior=t,e.registerBehavior("bpmn:ParallelGateway",this)}Fc.prototype.enter=function(e){const{scope:t,element:n}=e,i=gE(n.incoming),{parent:r}=t,o=this._simulator.findScopes({parent:r,element:n});if(o.length===i.length){for(const a of o)a!==t&&this._simulator.destroyScope(a.complete(),t);this._simulator.exit(e)}};Fc.prototype.exit=function(e){this._activityBehavior.exit(e)};Fc.$inject=["simulator","activityBehavior"];function lf(e){this._simulator=e,e.registerBehavior("bpmn:EventBasedGateway",this)}lf.$inject=["simulator"];lf.prototype.enter=function(e){const{element:t,scope:n}=e,i=n.parent,o=AD(t).map(a=>this._simulator.subscribe(i,a,s=>(o.forEach(c=>c.remove()),this._simulator.destroyScope(n,s),this._simulator.signal({element:a,parentScope:i,initiator:s}))))};function AD(e){return e.outgoing.map(t=>t.target).filter(t=>Dc(t,["bpmn:IntermediateCatchEvent","bpmn:ReceiveTask"]))}function ei(e,t,n){this._simulator=e,this._scopeBehavior=t,this._transactionBehavior=n;const i=["bpmn:BusinessRuleTask","bpmn:CallActivity","bpmn:ManualTask","bpmn:ScriptTask","bpmn:SendTask","bpmn:ServiceTask","bpmn:Task","bpmn:UserTask"];for(const r of i)e.registerBehavior(r,this)}ei.$inject=["simulator","scopeBehavior","transactionBehavior"];ei.prototype.signal=function(e){const t=this._triggerMessages(e);if(t)return this.signalOnEvent(e,t);this._simulator.exit(e)};ei.prototype.enter=function(e){const{element:t}=e,n=this.waitAtElement(t);if(n)return this.signalOnEvent(e,n);const i=this._triggerMessages(e);if(i)return this.signalOnEvent(e,i);this._simulator.exit(e)};ei.prototype.exit=function(e){const{element:t,scope:n}=e,i=n.parent,r=!n.failed;r&&!vi(t)&&this._transactionBehavior.registerCompensation(n);const o=r?t.outgoing.filter(xD):[];o.forEach(a=>this._simulator.enter({element:a,scope:i})),o.length===0&&this._scopeBehavior.tryExit(i,n)};ei.prototype.signalOnEvent=function(e,t){const{scope:n,element:i}=e,r=this._simulator.subscribe(n,t,o=>(r.remove(),this._simulator.signal({scope:n,element:i,initiator:o})))};ei.prototype.waitAtElement=function(e){return this._simulator.getConfig(e).wait&&{element:e,type:"continue",interrupting:!1,boundary:!1}};ei.prototype._getMessageContexts=function(e,t=null){const n=t?r=>r.referencePoint.x>t.x:()=>!0,i=(r,o)=>r.referencePoint.x-o.referencePoint.x;return[...e.incoming.filter(ul).map(r=>({incoming:r,referencePoint:PD(r.waypoints)})),...e.outgoing.filter(ul).map(r=>({outgoing:r,referencePoint:RD(r.waypoints)}))].sort(i).filter(n)};ei.prototype._triggerMessages=function(e){const{element:t,initiator:n,scope:i}=e;let r=i.messageContexts;r||(r=i.messageContexts=this._getMessageContexts(t));const o=n&&n.element;if(ul(o)&&i.expectedIncoming!==o){console.debug("Simulator :: ActivityBehavior :: ignoring out-of-bounds message");return}for(;r.length;){const{incoming:a,outgoing:s}=r.shift();if(a){if(!n)continue;return i.expectedIncoming=a,{element:t,type:"message",name:a.id,interrupting:!1,boundary:!1}}this._simulator.signal({element:s})}};function RD(e){return e&&e[0]}function PD(e){return e&&e[e.length-1]}function or(e,t,n,i,r){this._simulator=e,this._activityBehavior=t,this._scopeBehavior=n,this._transactionBehavior=i,this._elementRegistry=r,e.registerBehavior("bpmn:SubProcess",this),e.registerBehavior("bpmn:Transaction",this),e.registerBehavior("bpmn:AdHocSubProcess",this)}or.$inject=["simulator","activityBehavior","scopeBehavior","transactionBehavior","elementRegistry"];or.prototype.signal=function(e){this._start(e)};or.prototype.enter=function(e){const{element:t}=e,n=this._activityBehavior.waitAtElement(t);if(n)return this._activityBehavior.signalOnEvent(e,n);this._start(e)};or.prototype.exit=function(e){const{scope:t}=e,n=t.parent;n.failInitiator===t&&n.complete(),this._activityBehavior.exit(e)};or.prototype._start=function(e){const{element:t,startEvent:n,scope:i}=e,r=i.parent;if(vi(t)){if(!n)throw new Error("missing <startEvent>: required for event sub-process")}else if(n)throw new Error("unexpected <startEvent>: not allowed for sub-process");if(r.destroyed)throw new Error(`target scope <${r.id}> destroyed`);DD(t)&&this._transactionBehavior.setup(e),n&&EE(n)&&this._scopeBehavior.interrupt(r,i);const o=n?[n]:this._findStarts(t);for(const a of o)this._simulator.signal({element:a,parentScope:i,initiator:i})};or.prototype._findStarts=function(e){return e=this._elementRegistry.get(e.id+"_plane")||e,e.children.filter(t=>Pc(t)||t.incoming.find(i=>v(i,"bpmn:SequenceFlow"))||yE(t)||vi(t)?!1:Dc(t,["bpmn:Activity","bpmn:StartEvent","bpmn:EndEvent"]))};function DD(e){return v(e,"bpmn:Transaction")}const ll={type:"cancel",interrupting:!0,boundary:!1,persistent:!0};function Bi(e,t){this._simulator=e,this._scopeBehavior=t}Bi.$inject=["simulator","scopeBehavior"];Bi.prototype.setup=function(e){const{scope:t}=e,n=this._simulator.subscribe(t,ll,o=>(n.remove(),this.cancel({scope:t,initiator:o}))),i={type:"compensate",ref:t.element,persistent:!0,traits:Pe.NOT_DEAD},r=this._simulator.subscribe(t,i,o=>t.canceled?(r.remove(),this.compensate({scope:t,element:t.element,initiator:o})):this._simulator.trigger({event:ll,scope:t}))};Bi.prototype.cancel=function(e){const{scope:t,initiator:n}=e;if(!t.destroyed)return t.cancel(n),this._simulator.trigger({event:{type:"compensate",ref:t.element},initiator:n,scope:t}),this._simulator.trigger({scope:t,initiator:n,event:ll})};Bi.prototype.registerCompensation=function(e){const{element:t}=e,n=t.children.filter(vi).map(o=>o.children.find(a=>fs(a)&&Ps(a))).filter(o=>o),i=t.attachers.filter(Ps);if(!n.length&&!i.length)return;const r=this.findTransactionScope(e.parent);v(r.element,"bpmn:Transaction")||this.makeCompensable(r);for(const o of n){const a={element:o,type:"compensate",persistent:!0,interrupting:!0,ref:t,traits:Pe.NOT_DEAD},s=o.parent,c=this._simulator.subscribe(e,a,u=>(c.remove(),this._simulator.signal({initiator:u,element:s,startEvent:o,parentScope:e})))}for(const o of i){const a={element:o,type:"compensate",persistent:!0,ref:t,traits:Pe.NOT_DEAD},s=o.outgoing.map(u=>u.target).find(yE);if(!s)continue;const c=this._simulator.subscribe(r,a,u=>(c.remove(),this._simulator.enter({initiator:u,element:s,scope:r})))}};Bi.prototype.makeCompensable=function(e){if(e.hasTrait(Pe.COMPENSABLE)||!e.parent)return;const t={type:"compensate",ref:e.element,interrupting:!0,persistent:!0,traits:Pe.NOT_DEAD};e.compensable();const n=this._simulator.subscribe(e,t,o=>(n.remove(),e.fail(o),this.compensate({scope:e,element:e.element,initiator:o}),this._scopeBehavior.tryExit(e,o),e)),i=e.parent;if(!i)return;const r=this._simulator.subscribe(i,t,o=>(r.remove(),this._simulator.trigger({scope:e,event:t,initiator:o})));this.makeCompensable(i)};Bi.prototype.findTransactionScope=function(e){let t=e;for(;t;){const n=t.element;if(v(n,"bpmn:SubProcess")&&!vi(n)||Dc(n,["bpmn:Transaction","bpmn:Process","bpmn:Participant"]))return t;t=t.parent}throw MD(e)};Bi.prototype.compensate=function(e){const{scope:t,element:n}=e,i=ao(t.subscriptions,a=>cl({type:"compensate"},a.event)),r=i.filter(a=>a.event.ref===n),o=i.filter(a=>a.event.ref!==n);for(const a of r)this._scopeBehavior.preExit(t,s=>this._simulator.trigger(a));for(const a of o.reverse())this._scopeBehavior.preExit(t,s=>this._simulator.trigger(a))};function MD(e){throw new Error(`no transaction context for <${e.id}>`)}function ar(e,t){this._simulator=e,this._scopeBehavior=t,e.registerBehavior("bpmn:SequenceFlow",this)}ar.prototype.enter=function(e){this._simulator.exit(e)};ar.prototype.exit=function(e){const{element:t,scope:n}=e;this._simulator.enter({element:t.target,scope:n.parent})};ar.$inject=["simulator","scopeBehavior"];function sr(e){this._simulator=e,e.registerBehavior("bpmn:MessageFlow",this)}sr.$inject=["simulator"];sr.prototype.signal=function(e){this._simulator.exit(e)};sr.prototype.exit=function(e){const{element:t,scope:n}=e,i=t.target,r=uf(i)?i:{type:"message",element:t,name:t.id},o=this._simulator.findSubscription({event:r,elements:[i,i.parent]});o&&this._simulator.trigger({event:r,initiator:n,scope:o.scope})};function ke(e,t){return e.type==="label"?!1:(Array.isArray(t)||(t=[t]),t.some(function(n){return v(e,n)}))}function BD(e,t){return Me(X(e).eventDefinitions,n=>ke(n,t))}function xE(e,t){return Sn(X(e).eventDefinitions,n=>ke(n,t))}function pf(e,t,n){this._simulator=e,this._elementRegistry=t,this._scopeBehavior=n}pf.$inject=["simulator","elementRegistry","scopeBehavior"];pf.prototype.get=function(e){const n=Object.entries({"bpmn:LinkEventDefinition":i=>{const{element:r,scope:o}=i,a=Cm(r),s=o.parent,u=s.element.children.filter(l=>wD(l)&&Cm(l).name===a.name);for(const l of u)this._simulator.signal({element:l,parentScope:s,initiator:o})},"bpmn:SignalEventDefinition":i=>{const{element:r,scope:o}=i,a=this._simulator.findSubscriptions({event:r}),s=new Set;for(const c of a){const u=c.scope;s.has(u)||(s.add(u),this._simulator.trigger({event:r,scope:u,initiator:o}))}},"bpmn:EscalationEventDefinition":i=>{const{element:r,scope:o}=i,a=this._simulator.findScopes({subscribedTo:{event:r},trait:Pe.ACTIVE});let s=o;for(;s=s.parent;)if(a.includes(s)){this._simulator.trigger({event:r,scope:s,initiator:o});break}},"bpmn:ErrorEventDefinition":i=>{const{element:r,scope:o}=i;this._simulator.trigger({event:r,initiator:o,scope:Cu(o)})},"bpmn:TerminateEventDefinition":i=>{const{scope:r}=i;this._scopeBehavior.terminate(r.parent,r)},"bpmn:CancelEventDefinition":i=>{const{scope:r,element:o}=i;this._simulator.trigger({event:o,initiator:r,scope:Cu(r)})},"bpmn:CompensateEventDefinition":i=>{const{scope:r,element:o}=i;return this._simulator.waitForScopes(r,this._simulator.trigger({event:o,scope:Cu(r)}))}}).find(i=>xE(e,i[0]));return n&&n[1]};function Cm(e){return BD(e,"bpmn:LinkEventDefinition")}function Cu(e){for(;vi(e.parent.element);)e=e.parent;return e.parent}const wE={type:"pre-exit",persistent:!0,interrupting:!0,boundary:!1},Tu={type:"exit",interrupting:!0,boundary:!1,persistent:!0};function ti(e){this._simulator=e}ti.$inject=["simulator"];ti.prototype.isFinished=function(e,t=null){return t=SE(t),e.children.every(n=>n.destroyed||n.completed||t(n))};ti.prototype.destroyChildren=function(e,t,n=null){n=SE(n),e.children.filter(i=>!i.destroyed&&!n(i)).map(i=>{this._simulator.destroyScope(i,t)})};ti.prototype.terminate=function(e,t){this.destroyChildren(e,t),e.terminate(t),this.tryExit(e,t)};ti.prototype.interrupt=function(e,t){this.destroyChildren(e,t,t),e.fail(t)};ti.prototype.tryExit=function(e,t){if(!e)throw new Error("missing <scope>");if(t||(t=e),!this.isFinished(e,t))return Tu;const n=this._simulator.findSubscriptions({event:wE,scope:e});for(const i of n){const{event:r,scope:o}=i;if(this._simulator.trigger({event:r,scope:o,initiator:t}).length)return Tu}this._simulator.trigger({event:Tu,scope:e,initiator:t}),this.exit({scope:e,initiator:t})};ti.prototype.exit=function(e){const{scope:t,initiator:n}=e;if(!n)throw new Error("missing <initiator>");this._simulator.exit({element:t.element,scope:t,initiator:n})};ti.prototype.preExit=function(e,t){const n=this._simulator.subscribe(e,wE,i=>(n.remove(),t(i)));return n};function SE(e){return typeof e=="function"?e:t=>t===e}function Oc(e,t){this._simulator=e,this._scopeBehavior=t,e.registerBehavior("bpmn:Process",this),e.registerBehavior("bpmn:Participant",this)}Oc.prototype.signal=function(e){const{startEvent:t,scope:n}=e;if(!t)throw new Error("missing <startEvent>");this._simulator.signal({element:t,parentScope:n})};Oc.prototype.exit=function(e){const{scope:t,initiator:n}=e;this._scopeBehavior.destroyChildren(t,n)};Oc.$inject=["simulator","scopeBehavior"];var ID={__init__:["startEventBehavior","endEventBehavior","boundaryEventBehavior","intermediateCatchEventBehavior","intermediateThrowEventBehavior","exclusiveGatewayBehavior","parallelGatewayBehavior","eventBasedGatewayBehavior","subProcessBehavior","sequenceFlowBehavior","messageFlowBehavior","processBehavior"],startEventBehavior:["type",Mc],endEventBehavior:["type",aa],boundaryEventBehavior:["type",Bc],intermediateCatchEventBehavior:["type",sa],intermediateThrowEventBehavior:["type",ca],exclusiveGatewayBehavior:["type",Ic],parallelGatewayBehavior:["type",Fc],eventBasedGatewayBehavior:["type",lf],activityBehavior:["type",ei],subProcessBehavior:["type",or],sequenceFlowBehavior:["type",ar],messageFlowBehavior:["type",sr],eventBehaviors:["type",pf],scopeBehavior:["type",ti],processBehavior:["type",Oc],transactionBehavior:["type",Bi]};const FD=5e3;var CE={__depends__:[ID],__init__:[["eventBus","simulator",function(e,t){e.on(["tokenSimulation.toggleMode","tokenSimulation.resetSimulation"],FD,n=>{t.reset()})}]],simulator:["type",bE]},pl={exports:{}};typeof Object.create=="function"?pl.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:pl.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}};var TE=pl.exports;function kc(e,t){e.invoke(sr,this),this._animation=t}TE(kc,sr);kc.$inject=["injector","animation"];kc.prototype.signal=function(e){const{element:t,scope:n}=e;this._animation.animate(t,n,()=>{sr.prototype.signal.call(this,e)})};function Nc(e,t){e.invoke(ar,this),this._animation=t}TE(Nc,ar);Nc.$inject=["injector","animation"];Nc.prototype.enter=function(e){const{element:t,scope:n}=e;this._animation.animate(t,n,()=>{ar.prototype.enter.call(this,e)})};var OD={sequenceFlowBehavior:["type",Nc],messageFlowBehavior:["type",kc]};const gt="tokenSimulation.toggleMode",AE="tokenSimulation.playSimulation",RE="tokenSimulation.pauseSimulation",ni="tokenSimulation.resetSimulation",kD="tokenSimulation.animationCreated",PE="tokenSimulation.animationSpeedChanged",DE="tokenSimulation.simulator.elementChanged",ua="tokenSimulation.simulator.destroyScope",ND="tokenSimulation.simulator.scopeChanged",cr="tokenSimulation.simulator.createScope",zr="tokenSimulation.scopeFilterChanged",ME="tokenSimulation.simulator.trace",Tm=e=>!0;function la(e,t){this._eventBus=e,this._simulator=t,this._filter=Tm,e.on([gt,ni],()=>{this._filter=Tm}),e.on(ua,n=>{const{scope:i}=n;this._scope===i&&i.parent&&this.toggle(i.parent)}),e.on(cr,n=>{const{scope:i}=n;!i.parent&&this._scope&&!BE(this._scope,i)&&this.toggle(null)})}la.prototype.toggle=function(e){const t=this._scope!==e;this._scope=t?e:null,this._filter=this._scope?n=>BE(this._scope,n):n=>!0,this._eventBus.fire(zr,{filter:this._filter,scope:this._scope})};la.prototype.isShown=function(e){return typeof e=="string"&&(e=this._simulator.findScope(t=>t.id===e)),e&&this._filter(e)};la.prototype.findScope=function(e){return this._simulator.findScopes(e).filter(t=>this.isShown(t))[0]};la.$inject=["eventBus","simulator"];function BE(e,t){do if(e===t)return!0;while(t=t.parent);return!1}var Gr={scopeFilter:["type",la]};const IE=getComputedStyle(document.documentElement),LD=IE.getPropertyValue("--token-simulation-green-base-44"),$D=IE.getPropertyValue("--token-simulation-white");function jD(){}function HD(e,t){return t.length===2?WD:e===1?GD:e===t.length-1?VD:zD}const zD=function(e){return e},GD=function(e){return-Math.cos(e*Math.PI/2)+1},VD=function(e){return Math.sin(e*Math.PI/2)},WD=function(e){return-Math.cos(e*Math.PI)/2+.5},go=20;function $t(e,t,n){this._eventBus=t,this._scopeFilter=n,this._canvas=e,this._animations=new Set,this._speed=1,t.on(ni,()=>{this.clearAnimations()}),t.on(RE,()=>{this.pause()}),t.on(AE,()=>{this.play()}),t.on(zr,i=>{this.each(r=>{this._scopeFilter.isShown(r.scope)?r.show():r.hide()})}),t.on(ua,i=>{const{scope:r}=i;this.clearAnimations(r)})}$t.prototype.animate=function(e,t,n){this.createAnimation(e,t,n)};$t.prototype.pause=function(){this.each(e=>e.pause())};$t.prototype.play=function(){this.each(e=>e.play())};$t.prototype.each=function(e){this._animations.forEach(e)};$t.prototype.createAnimation=function(e,t,n=jD){const i=this._getGroup(t);if(!i)return;const r=this._createTokenGfx(i,t),o=new hn(r,e.waypoints,()=>{this._animations.delete(o),n()});return o.setSpeed(this.getAnimationSpeed()),this._scopeFilter.isShown(t)||o.hide(),o.scope=t,o.element=e,this._animations.add(o),this._eventBus.fire(kD,{animation:o}),o.play(),o};$t.prototype.setAnimationSpeed=function(e){this._speed=e,this.each(t=>t.setSpeed(e)),this._eventBus.fire(PE,{speed:e})};$t.prototype.getAnimationSpeed=function(){return this._speed};$t.prototype.clearAnimations=function(e){this.each(t=>{(!e||t.scope===e)&&t.remove()})};$t.prototype._createTokenGfx=function(e,t){const n=ae(this._getTokenSVG(t).trim());return Ms(n,e)};$t.prototype._getTokenSVG=function(e){const t=e.colors||{primary:LD,auxiliary:$D};return`
    <g class="bts-token">
      <circle
        class="bts-circle"
        r="${go/2}"
        cx="${go/2}"
        cy="${go/2}"
        fill="${t.primary}"
      />
      <text
        class="bts-text"
        transform="translate(10, 14)"
        text-anchor="middle"
        fill="${t.auxiliary}"
      >1</text>
    </g>
  `};$t.prototype._getGroup=function(e){var t=this._canvas,n,i;"findRoot"in t?(i=t.findRoot(e.element),n=t._findPlaneForRoot(i).layer):n=xe(".viewport",t._svg);var r=xe(".bts-animation-tokens",n);return r||(r=ae('<g class="bts-animation-tokens" />'),Ms(r,n)),r};$t.$inject=["canvas","eventBus","scopeFilter"];function hn(e,t,n){this.gfx=e,this.waypoints=t,this.done=n,this._paused=!0,this._t=0,this._parts=[],this.create()}hn.prototype.pause=function(){this._paused=!0};hn.prototype.play=function(){this._paused&&(this._paused=!1,this.tick(0)),this.schedule()};hn.prototype.schedule=function(){if(this._paused||this._scheduled)return;const e=Date.now();this._scheduled=!0,requestAnimationFrame(()=>{this._scheduled=!1,!this._paused&&(this.tick((Date.now()-e)*this._speed),this.schedule())})};hn.prototype.tick=function(e){const t=this._t=this._t+e,n=this._parts.find(s=>s.startTime<=t&&s.endTime>t);if(!n)return this.remove();const i=t-n.startTime,r=n.length*n.easing(i/n.duration),o=n.startLength+r,a=this._path.getPointAtLength(o);this.move(a.x,a.y)};hn.prototype.move=function(e,t){W(this.gfx,"transform",`translate(${e}, ${t})`)};hn.prototype.create=function(){const e=this.waypoints,t=e.reduce((o,a,s)=>{const c=e[s-1];if(c){const u=o[o.length-1],l=u&&u.endLength||0,p=qD(c,a);o.push({startLength:l,endLength:l+p,length:p,easing:HD(s,e)})}return o},[]),n=t.reduce(function(o,a){return o+a.length},0),i=e.reduce((o,a,s)=>{const c=a.x-go/2,u=a.y-go/2;return o.push([s>0?"L":"M",c,u]),o},[]).flat().join(" "),r=UD(n);this._parts=t.reduce((o,a,s)=>{const c=r/n*a.length,u=s>0?o[s-1].endTime:0,l=u+c;return[...o,{...a,startTime:u,endTime:l,duration:c}]},[]),this._path=ae(`<path d="${i}" />`),this._t=0};hn.prototype.show=function(){W(this.gfx,"display","")};hn.prototype.hide=function(){W(this.gfx,"display","none")};hn.prototype.remove=function(){this.pause(),Le(this.gfx),this.done()};hn.prototype.setSpeed=function(e){this._speed=e};function UD(e){return Math.log(e)*YD(250,300)}function YD(e,t){return e+Math.floor(Math.random()*(t-e))}function qD(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}var KD={__depends__:[CE,OD,Gr],animation:["type",$t]},fl={exports:{}};(function(e,t){(function(n,i){{var r=i();e&&e.exports&&(t=e.exports=r),t.randomColor=r}})(ns,function(){var n=null,i={};A();var r=[],o=function(C){if(C=C||{},C.seed!==void 0&&C.seed!==null&&C.seed===parseInt(C.seed,10))n=C.seed;else if(typeof C.seed=="string")n=S(C.seed);else{if(C.seed!==void 0&&C.seed!==null)throw new TypeError("The seed value must be an integer or string");n=null}var R,D,F;if(C.count!==null&&C.count!==void 0){for(var j=C.count,z=[],G=0;G<C.count;G++)r.push(!1);for(C.count=null;j>z.length;){var he=o(C);n!==null&&(C.seed=n),z.push(he)}return C.count=j,z}return R=a(C),D=s(R,C),F=c(R,D,C),u([R,D,F],C)};function a(C){if(r.length>0){var R=M(C.hue),D=d(R),F=(R[1]-R[0])/r.length,j=parseInt((D-R[0])/F);r[j]===!0?j=(j+2)%r.length:r[j]=!0;var z=(R[0]+j*F)%359,G=(R[0]+(j+1)*F)%359;return R=[z,G],D=d(R),D<0&&(D=360+D),D}else{var R=p(C.hue);return D=d(R),D<0&&(D=360+D),D}}function s(C,R){if(R.hue==="monochrome")return 0;if(R.luminosity==="random")return d([0,100]);var D=f(C),F=D[0],j=D[1];switch(R.luminosity){case"bright":F=55;break;case"dark":F=j-10;break;case"light":j=55;break}return d([F,j])}function c(C,R,D){var F=l(C,R),j=100;switch(D.luminosity){case"dark":j=F+20;break;case"light":F=(j+F)/2;break;case"random":F=0,j=100;break}return d([F,j])}function u(C,R){switch(R.format){case"hsvArray":return C;case"hslArray":return b(C);case"hsl":var D=b(C);return"hsl("+D[0]+", "+D[1]+"%, "+D[2]+"%)";case"hsla":var F=b(C),G=R.alpha||Math.random();return"hsla("+F[0]+", "+F[1]+"%, "+F[2]+"%, "+G+")";case"rgbArray":return _(C);case"rgb":var j=_(C);return"rgb("+j.join(", ")+")";case"rgba":var z=_(C),G=R.alpha||Math.random();return"rgba("+z.join(", ")+", "+G+")";default:return g(C)}}function l(C,R){for(var D=h(C).lowerBounds,F=0;F<D.length-1;F++){var j=D[F][0],z=D[F][1],G=D[F+1][0],he=D[F+1][1];if(R>=j&&R<=G){var Ne=(he-z)/(G-j),_e=z-Ne*j;return Ne*R+_e}}return 0}function p(C){if(typeof parseInt(C)=="number"){var R=parseInt(C);if(R<360&&R>0)return[R,R]}if(typeof C=="string"){if(i[C]){var D=i[C];if(D.hueRange)return D.hueRange}else if(C.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var F=w(C)[0];return[F,F]}}return[0,360]}function f(C){return h(C).saturationRange}function h(C){C>=334&&C<=360&&(C-=360);for(var R in i){var D=i[R];if(D.hueRange&&C>=D.hueRange[0]&&C<=D.hueRange[1])return i[R]}return"Color not found"}function d(C){if(n===null){var R=.618033988749895,D=Math.random();return D+=R,D%=1,Math.floor(C[0]+D*(C[1]+1-C[0]))}else{var F=C[1]||1,j=C[0]||0;n=(n*9301+49297)%233280;var z=n/233280;return Math.floor(j+z*(F-j))}}function g(C){var R=_(C);function D(j){var z=j.toString(16);return z.length==1?"0"+z:z}var F="#"+D(R[0])+D(R[1])+D(R[2]);return F}function y(C,R,D){var F=D[0][0],j=D[D.length-1][0],z=D[D.length-1][1],G=D[0][1];i[C]={hueRange:R,lowerBounds:D,saturationRange:[F,j],brightnessRange:[z,G]}}function A(){y("monochrome",null,[[0,0],[100,0]]),y("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),y("orange",[18,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),y("yellow",[46,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),y("green",[62,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),y("blue",[178,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),y("purple",[257,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),y("pink",[282,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}function _(C){var R=C[0];R===0&&(R=1),R===360&&(R=359),R=R/360;var D=C[1]/100,F=C[2]/100,j=Math.floor(R*6),z=R*6-j,G=F*(1-D),he=F*(1-z*D),Ne=F*(1-(1-z)*D),_e=256,ue=256,T=256;switch(j){case 0:_e=F,ue=Ne,T=G;break;case 1:_e=he,ue=F,T=G;break;case 2:_e=G,ue=F,T=Ne;break;case 3:_e=G,ue=he,T=F;break;case 4:_e=Ne,ue=G,T=F;break;case 5:_e=F,ue=G,T=he;break}var m=[Math.floor(_e*255),Math.floor(ue*255),Math.floor(T*255)];return m}function w(C){C=C.replace(/^#/,""),C=C.length===3?C.replace(/(.)/g,"$1$1"):C;var R=parseInt(C.substr(0,2),16)/255,D=parseInt(C.substr(2,2),16)/255,F=parseInt(C.substr(4,2),16)/255,j=Math.max(R,D,F),z=j-Math.min(R,D,F),G=j?z/j:0;switch(j){case R:return[60*((D-F)/z%6)||0,G,j];case D:return[60*((F-R)/z+2)||0,G,j];case F:return[60*((R-D)/z+4)||0,G,j]}}function b(C){var R=C[0],D=C[1]/100,F=C[2]/100,j=(2-D)*F;return[R,Math.round(D*F/(j<1?j:2-j)*1e4)/100,j/2*100]}function S(C){for(var R=0,D=0;D!==C.length&&!(R>=Number.MAX_SAFE_INTEGER);D++)R+=C.charCodeAt(D);return R}function M(C){if(isNaN(C)){if(typeof C=="string"){if(i[C]){var D=i[C];if(D.hueRange)return D.hueRange}else if(C.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var F=w(C)[0];return h(F).hueRange}}}else{var R=parseInt(C);if(R<360&&R>0)return h(C).hueRange}return[0,360]}return o})})(fl,fl.exports);var XD=fl.exports;const ZD=1500;function FE(e){const t=XD({count:60}).filter(o=>n(o.substring(1))<200);function n(o){var a=parseInt(o.substr(0,2),16),s=parseInt(o.substr(2,2),16),c=parseInt(o.substr(4,2),16),u=(a*299+s*587+c*114)/1e3;return u}let i=0;function r(o){const{element:a}=o;if(a&&a.type==="bpmn:MessageFlow")return{primary:"#999",auxiliary:"#FFF"};if(o.parent)return o.parent.colors;const s=t[i++%t.length];return{primary:s,auxiliary:n(s)>=128?"#111":"#fff"}}e.on(cr,ZD,o=>{const{scope:a}=o;a.colors=r(a)})}FE.$inject=["eventBus"];var QD={__init__:["coloredScopes"],coloredScopes:["type",FE]},JD='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M12.83 352h262.34A12.82 12.82 0 0 0 288 339.17v-38.34A12.82 12.82 0 0 0 275.17 288H12.83A12.82 12.82 0 0 0 0 300.83v38.34A12.82 12.82 0 0 0 12.83 352zm0-256h262.34A12.82 12.82 0 0 0 288 83.17V44.83A12.82 12.82 0 0 0 275.17 32H12.83A12.82 12.82 0 0 0 0 44.83v38.34A12.82 12.82 0 0 0 12.83 96zM432 160H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0 256H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"/></svg>',e5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg>',t5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></svg>',n5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z"/></svg>',i5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></svg>',r5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M20 424.229h20V279.771H20c-11.046 0-20-8.954-20-20V212c0-11.046 8.954-20 20-20h112c11.046 0 20 8.954 20 20v212.229h20c11.046 0 20 8.954 20 20V492c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20v-47.771c0-11.046 8.954-20 20-20zM96 0C56.235 0 24 32.235 24 72s32.235 72 72 72 72-32.235 72-72S135.764 0 96 0z"/></svg>',o5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"/></svg>',a5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 580.5 448">
  <path fill="currentColor" d="M112 0C85 0 64 22 64 48v196l192-89V48c0-26-22-48-48-48zm256 0c-27 0-48 22-48 48v77l190-89c-5-21-24-36-46-36Zm144 105-192 89v70l192-89zM256 224 64 314v70l192-90zm256 21-192 89v66c0 27 21 48 48 48h96c26 0 48-21 48-48zM256 364 89 442c7 4 14 6 23 6h96c26 0 48-21 48-48z"/>
  <rect fill="currentColor" width="63.3" height="618.2" x="311.5" y="-469.4" transform="rotate(65)" rx="10"/>
</svg>
`,s5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Adapted from Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"/></svg>',c5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"/></svg>',u5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M288 32C128.94 32 0 160.94 0 320c0 52.8 14.25 102.26 39.06 144.8 5.61 9.62 16.3 15.2 27.44 15.2h443c11.14 0 21.83-5.58 27.44-15.2C561.75 422.26 576 372.8 576 320c0-159.06-128.94-288-288-288zm0 64c14.71 0 26.58 10.13 30.32 23.65-1.11 2.26-2.64 4.23-3.45 6.67l-9.22 27.67c-5.13 3.49-10.97 6.01-17.64 6.01-17.67 0-32-14.33-32-32S270.33 96 288 96zM96 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm48-160c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm246.77-72.41l-61.33 184C343.13 347.33 352 364.54 352 384c0 11.72-3.38 22.55-8.88 32H232.88c-5.5-9.45-8.88-20.28-8.88-32 0-33.94 26.5-61.43 59.9-63.59l61.34-184.01c4.17-12.56 17.73-19.45 30.36-15.17 12.57 4.19 19.35 17.79 15.17 30.36zm14.66 57.2l15.52-46.55c3.47-1.29 7.13-2.23 11.05-2.23 17.67 0 32 14.33 32 32s-14.33 32-32 32c-11.38-.01-20.89-6.28-26.57-15.22zM480 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"/></svg>',l5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>',p5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"/></svg>',f5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M384 64H192C85.961 64 0 149.961 0 256s85.961 192 192 192h192c106.039 0 192-85.961 192-192S490.039 64 384 64zM64 256c0-70.741 57.249-128 128-128 70.741 0 128 57.249 128 128 0 70.741-57.249 128-128 128-70.741 0-128-57.249-128-128zm320 128h-48.905c65.217-72.858 65.236-183.12 0-256H384c70.741 0 128 57.249 128 128 0 70.74-57.249 128-128 128z"/></svg>',h5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path fill="currentColor" d="M384 64H192C86 64 0 150 0 256s86 192 192 192h192c106 0 192-86 192-192S490 64 384 64zm0 320c-70.8 0-128-57.3-128-128 0-70.8 57.3-128 128-128 70.8 0 128 57.3 128 128 0 70.8-57.3 128-128 128z"/></svg>';function Ct(e){return function(n=""){return`<span class="bts-icon ${n}">${e}</span>`}}const Am=Ct(JD),OE=Ct(e5),hl=Ct(t5),d5=Ct(a5),m5=Ct(n5),kE=Ct(i5),NE=Ct(r5),dl=Ct(o5),LE=Ct(s5),v5=Ct(c5),g5=Ct(u5),y5=Ct(l5),E5=Ct(p5),$E=Ct(f5),_5=Ct(h5);function ff(e){this._exclusiveGatewaySettings=e}ff.prototype.createContextPads=function(e){if(e.outgoing.filter(function(r){return ke(r,"bpmn:SequenceFlow")}).length<2)return;const n=`
    <div class="bts-context-pad" title="Set Sequence Flow">
      ${m5()}
    </div>
  `;return[{action:()=>{this._exclusiveGatewaySettings.setSequenceFlow(e)},element:e,html:n}]};ff.$inject=["exclusiveGatewaySettings"];function ur(e){this._simulator=e}ur.prototype.createContextPads=function(e){return ke(e,"bpmn:ReceiveTask")||ke(e,"bpmn:SubProcess")&&X(e).triggeredByEvent?[]:[this.createPauseContextPad(e)]};ur.prototype.createPauseContextPad=function(e){const t=()=>this._findSubscriptions({element:e}),n=this._isPaused(e),i=`
    <div class="bts-context-pad ${n?"":"show-hover"}" title="${n?"Remove":"Add"} pause point">
      ${(n?d5:dl)("show-hover")}
      ${dl("hide-hover")}
    </div>
  `;return{action:()=>{this._togglePaused(e)},element:e,hideContexts:t,html:i}};ur.prototype._isPaused=function(e){const{wait:t}=this._simulator.getConfig(e);return t};ur.prototype._togglePaused=function(e){const t=!this._isPaused(e);this._simulator.waitAtElement(e,t)};ur.prototype._findSubscriptions=function(e){return this._simulator.findSubscriptions(e)};ur.$inject=["simulator"];function ci(e){this._simulator=e}ci.$inject=["simulator"];ci.prototype.createContextPads=function(e){return[this.createTriggerContextPad(e)]};ci.prototype.createTriggerContextPad=function(e){const t=()=>this._findSubscriptions({element:e}),n=`
    <div class="bts-context-pad" title="Trigger Event">
      ${LE()}
    </div>
  `;return{action:r=>{const{event:o,scope:a}=r[0];return this._simulator.trigger({event:o,scope:a})},element:e,html:n,contexts:t}};ci.prototype._findSubscriptions=function(e){return this._simulator.findSubscriptions(e)};const Au=500,b5=-15,x5=-15;function Zt(e,t,n,i,r,o){this._elementRegistry=t,this._overlays=n,this._injector=i,this._canvas=r,this._scopeFilter=o,this._overlayCache=new Map,this._handlerIdx=0,this._handlers=[],this.registerHandler("bpmn:ExclusiveGateway",ff),this.registerHandler("bpmn:Activity",ur),this.registerHandler("bpmn:StartEvent",ci),this.registerHandler("bpmn:IntermediateCatchEvent",ci),this.registerHandler("bpmn:BoundaryEvent",ci),this.registerHandler("bpmn:Activity",ci),e.on(gt,Au,a=>{a.active?this.openContextPads():this.closeContextPads()}),e.on(ni,Au,()=>{this.closeContextPads(),this.openContextPads()}),e.on(zr,a=>{const s=zn(".djs-overlay-ts-context-menu [data-scope-ids]",n._overlayRoot);for(const u of s){const p=u.dataset.scopeIds.split(",").some(f=>o.isShown(f));re(u).toggle("hidden",!p)}const c=zn(".djs-overlay-ts-context-menu [data-hide-scope-ids]",n._overlayRoot);for(const u of c){const p=u.dataset.hideScopeIds.split(",").some(f=>o.isShown(f));re(u).toggle("hidden",p)}}),e.on(DE,Au,a=>{const{element:s}=a;this.updateElementContextPads(s)})}Zt.prototype.registerHandler=function(e,t){const n=this._injector.instantiate(t);n.hash=String(this._handlerIdx++),this._handlers.push({handler:n,type:e})};Zt.prototype.getHandlers=function(e){return this._handlers.filter(({type:t})=>ke(e,t)).map(({handler:t})=>t)};Zt.prototype.openContextPads=function(e){e||(e=this._canvas.getRootElement()),this._elementRegistry.forEach(t=>{w5(e,t)&&this.updateElementContextPads(t)})};Zt.prototype._getOverlays=function(e){return this._overlayCache.get(e)||[]};Zt.prototype._addOverlay=function(e,t){const{handlerHash:n}=t;if(!n)throw new Error("<handlerHash> required");const i=this._overlays.add(e,"ts-context-menu",{...t,position:{top:b5,left:x5},show:{minZoom:.5}}),r=this._overlays.get(i),o=this._overlayCache;o.has(n)||o.set(n,[]),o.get(n).push(r)};Zt.prototype._removeOverlay=function(e){const{id:t,handlerHash:n}=e;this._overlays.remove(t);const i=this._overlayCache.get(n)||[],r=i.indexOf(e);r!==-1&&i.splice(r,1)};Zt.prototype.updateElementContextPads=function(e){for(const t of this.getHandlers(e))this._updateElementContextPads(e,t)};Zt.prototype._updateElementContextPads=function(e,t){const n=(t.createContextPads(e)||[]).filter(a=>a),i=`${e.id}------${t.hash}`,r=this._getOverlays(i),o=[];for(const a of n){const{element:s,contexts:c,hideContexts:u,action:l,html:p}=a,f=`${a.element.id}-------${p}`;let h=r.find(g=>g.hash===f);const d=h&&h.html||ce(p);if(c){const g=c();d.dataset.scopeIds=g.map(A=>A.scope.id).join(",");const y=g.filter(A=>this._scopeFilter.isShown(A.scope));re(d).toggle("hidden",y.length===0)}if(u){const g=u();d.dataset.hideScopeIds=g.map(A=>A.scope.id).join(",");const y=g.filter(A=>this._scopeFilter.isShown(A.scope));re(d).toggle("hidden",y.length>0)}if(h){o.push(h);continue}l&&J.bind(d,"click",g=>{g.preventDefault();const y=c?c().filter(A=>this._scopeFilter.isShown(A.scope)):null;l(y)}),this._addOverlay(s,{hash:f,handlerHash:i,html:d})}for(const a of r)o.includes(a)||this._removeOverlay(a)};Zt.prototype.closeContextPads=function(){for(const e of this._overlayCache.values())for(const t of e)this._closeOverlay(t);this._overlayCache.clear()};Zt.prototype._closeOverlay=function(e){this._overlays.remove(e.id)};Zt.$inject=["eventBus","elementRegistry","overlays","injector","canvas","scopeFilter"];function w5(e,t){do{if(e===t)return!0;t=t.parent}while(t);return!1}var S5={__depends__:[Gr],__init__:["contextPads"],contextPads:["type",Zt]};function jE(e,t,n){e.on(ua,i=>{const{scope:r}=i,{destroyInitiator:o,element:a}=r;!r.completed||!o||!["bpmn:Process","bpmn:Participant"].includes(a.type)||n.addElementNotification(o.element,{type:"success",icon:hl(),text:"Finished",scope:r})})}jE.$inject=["eventBus","simulator","elementNotifications"];const C5=-15,T5=15;function pa(e,t){this._overlays=e,t.on([ni,cr,gt],()=>{this.clear()})}pa.prototype.addElementNotification=function(e,t){const n={top:C5,right:T5},{type:i,icon:r,text:o,scope:a={}}=t,s=a.colors,c=s?`style="color: ${s.auxiliary}; background: ${s.primary}"`:"",u=ce(`
    <div class="bts-element-notification ${i||""}" ${c}>
      ${r||""}
      <span class="bts-text">${o}</span>
    </div>
  `);this._overlays.add(e,"element-notification",{position:n,html:u,show:{minZoom:.5}})};pa.prototype.clear=function(){this._overlays.remove({type:"element-notification"})};pa.prototype.removeElementNotification=function(e){this._overlays.remove({element:e})};pa.$inject=["overlays","eventBus"];var HE={elementNotifications:["type",pa]};const A5=2e3,R5=NE();function fa(e,t,n){this._eventBus=e,this._canvas=t,this._scopeFilter=n,this._init(),e.on([gt,ni],i=>{this.clear()})}fa.prototype._init=function(){this.container=ce('<div class="bts-notifications"></div>'),this._canvas.getContainer().appendChild(this.container)};fa.prototype.showNotification=function(e){const{text:t,type:n="info",icon:i=R5,scope:r,ttl:o=A5}=e;if(r&&!this._scopeFilter.isShown(r))return;const a=i.startsWith("<")?i:`<i class="${i}"></i>`,s=r&&r.colors,c=s?`style="color: ${s.auxiliary}; background: ${s.primary}"`:"",u=ce(`
    <div class="bts-notification ${n}">
      <span class="bts-icon">${a}</span>
      <span class="bts-text">${t}</span>
      ${r?`<span class="bts-scope" ${c}>${r.id}</span>`:""}
    </div>
  `);for(this.container.appendChild(u);this.container.children.length>5;)this.container.children[0].remove();setTimeout(function(){u.remove()},o)};fa.prototype.clear=function(){for(;this.container.children.length;)this.container.children[0].remove()};fa.$inject=["eventBus","canvas","scopeFilter"];var ha={__depends__:[Gr],notifications:["type",fa]},P5={__depends__:[HE,ha],__init__:["simulationState"],simulationState:["type",jE]};const D5="--token-simulation-silver-base-97",M5="--token-simulation-green-base-44";function Qt(e,t,n,i,r){this._eventBus=e,this._canvas=t,this._scopeFilter=n,this._elementColors=i,this._simulationStyles=r,this._highlight=null,this._init(),e.on(gt,o=>{o.active?re(this._container).remove("hidden"):(re(this._container).add("hidden"),To(this._container),this.unhighlightScope())}),e.on(zr,o=>{const a=this.getScopeElements();for(const s of a){const c=s.dataset.scopeId;re(s).toggle("inactive",!this._scopeFilter.isShown(c))}}),e.on(cr,o=>{this.addScope(o.scope)}),e.on(ua,o=>{this.removeScope(o.scope)}),e.on(ND,o=>{this.updateScope(o.scope)}),e.on(ni,()=>{this.removeAllInstances()})}Qt.prototype._init=function(){this._container=ce('<div class="bts-scopes hidden"></div>'),this._canvas.getContainer().appendChild(this._container)};Qt.prototype.addScope=function(e){const t=["bpmn:Process","bpmn:SubProcess","bpmn:Participant"],{element:n}=e;if(!t.includes(n.type))return;const i=e.colors,r=i?`style="color: ${i.auxiliary}; background: ${i.primary}"`:"",o=ce(`
    <div data-scope-id="${e.id}" class="bts-scope"
         title="View Process Instance ${e.id}" ${r}>
      ${e.getTokens()}
    </div>
  `);J.bind(o,"click",()=>{this._scopeFilter.toggle(e)}),J.bind(o,"mouseenter",()=>{this.highlightScope(n)}),J.bind(o,"mouseleave",()=>{this.unhighlightScope()}),this._scopeFilter.isShown(e)||re(o).add("inactive"),this._container.appendChild(o)};Qt.prototype.getScopeElements=function(){return zn("[data-scope-id]",this._container)};Qt.prototype.getScopeElement=function(e){return xe(`[data-scope-id="${e.id}"]`,this._container)};Qt.prototype.updateScope=function(e){const t=this.getScopeElement(e);t&&(t.textContent=e.getTokens())};Qt.prototype.removeScope=function(e){const t=this.getScopeElement(e);t&&t.remove()};Qt.prototype.removeAllInstances=function(){this._container.innerHTML=""};Qt.prototype.highlightScope=function(e){this.unhighlightScope(),this._highlight={element:e,colors:this._elementColors.get(e)},this._elementColors.set(e,this._getHighlightColors()),e.parent||re(this._canvas.getContainer()).add("highlight")};Qt.prototype.unhighlightScope=function(){if(!this._highlight)return;const{element:e,colors:t}=this._highlight;this._elementColors.set(e,t),e.parent||re(this._canvas.getContainer()).remove("highlight"),this._highlight=null};Qt.prototype._getHighlightColors=function(){return{fill:this._simulationStyles.get(D5),stroke:this._simulationStyles.get(M5)}};Qt.$inject=["eventBus","canvas","scopeFilter","elementColors","simulationStyles"];function Lc(){this._cache={}}Lc.$inject=[];Lc.prototype.get=function(e){const t=this._cache[e];return t||(this._computedStyle||(this._computedStyle=this._getComputedStyle()),this._cache[e]=this._computedStyle.getPropertyValue(e).trim())};Lc.prototype._getComputedStyle=function(){const e=typeof getComputedStyle=="function"?getComputedStyle:B5,t=typeof document!="undefined"?document.documentElement:{};return e(t)};function B5(){return{getPropertyValue(){return""}}}var hf={simulationStyles:["type",Lc]},I5={__depends__:[Gr,hf],__init__:["showScopes"],showScopes:["type",Qt]};const F5=NE();function Za(e){const t=e&&e.businessObject.name;return t&&On(t)}function Vr(e,t,n,i,r,o){this._notifications=t,this._tokenSimulationPalette=n,this._canvas=i,this._scopeFilter=r,this._init(),e.on(zr,a=>{const s=zn(".bts-entry[data-scope-id]",this._container);for(const c of s){const u=c.dataset.scopeId;re(c).toggle("inactive",!this._scopeFilter.isShown(u))}}),e.on(ua,a=>{const{scope:s}=a,{element:c}=s,u=s.completed;if(!["bpmn:Process","bpmn:Participant","bpmn:SubProcess"].includes(c.type))return;const f=`${ke(c,"bpmn:SubProcess")?Za(c)||"SubProcess":"Process"} ${u?"finished":"canceled"}`;this.log({text:f,icon:u?hl():y5(),scope:s})}),e.on(cr,a=>{const{scope:s}=a,{element:c}=s;if(!["bpmn:Process","bpmn:Participant","bpmn:SubProcess"].includes(c.type))return;const p=`${ke(c,"bpmn:SubProcess")?Za(c)||"SubProcess":"Process"} started`;this.log({text:p,icon:hl(),scope:s})}),e.on(ME,a=>{const{action:s,scope:c,element:u}=a;if(s!=="exit")return;const l=c.parent,p=Za(u);if(ke(u,"bpmn:BusinessRuleTask")?this.log({text:p||"Business Rule Task",icon:"bpmn-icon-business-rule",scope:l}):ke(u,"bpmn:CallActivity")?this.log({text:p||"Call Activity",icon:"bpmn-icon-call-activity",scope:l}):(ke(u,"bpmn:IntermediateCatchEvent")||ke(u,"bpmn:IntermediateThrowEvent"))&&this.log({text:p||"Intermediate Event",icon:"bpmn-icon-intermediate-event-none",scope:l}),ke(u,"bpmn:BoundaryEvent"))this.log({text:p||"Boundary Event",icon:"bpmn-icon-intermediate-event-none",scope:l});else if(ke(u,"bpmn:ManualTask"))this.log({text:p||"Manual Task",icon:"bpmn-icon-manual",scope:l});else if(ke(u,"bpmn:ScriptTask"))this.log({text:p||"Script Task",icon:"bpmn-icon-script",scope:l});else if(ke(u,"bpmn:ServiceTask"))this.log({text:p||"Service Task",icon:"bpmn-icon-service",scope:l});else if(ke(u,"bpmn:Task"))this.log({text:p||"Task",icon:"bpmn-icon-task",scope:l});else if(ke(u,"bpmn:UserTask"))this.log({text:p||"User Task",icon:"bpmn-icon-user",scope:l});else if(ke(u,"bpmn:ExclusiveGateway")){if(u.outgoing.length<2)return;const f=Za(u.sequenceFlow);let h=p||"Gateway";f&&(h=h.concat(` ${OE()} ${f}`)),this.log({text:h,icon:"bpmn-icon-gateway-xor",scope:l})}else ke(u,"bpmn:EndEvent")?xE(X(u),"bpmn:TerminateEventDefinition")?this.log({text:p||"Terminate End Event",icon:"bpmn-icon-end-event-terminate",scope:l}):this.log({text:p||"End Event",icon:"bpmn-icon-end-event-none",scope:l}):ke(u,"bpmn:StartEvent")&&this.log({text:p||"Start Event",icon:"bpmn-icon-start-event-none",scope:l})}),e.on([gt,ni],a=>{this.clear(),re(this._container).add("hidden")})}Vr.prototype._init=function(){this._container=ce(`
    <div class="bts-log hidden">
      <div class="bts-header">
        ${Am("bts-log-icon")}
        <button class="bts-close">
          ${E5()}
        </button>
      </div>
      <div class="bts-content">
        <p class="bts-entry placeholder">No Entries</p>
      </div>
    </div>
  `),this._placeholder=xe(".bts-placeholder",this._container),this._content=xe(".bts-content",this._container),J.bind(this._content,"wheel",e=>{e.stopPropagation()}),J.bind(this._content,"mousedown",e=>{e.stopPropagation()}),this._close=xe(".bts-close",this._container),J.bind(this._close,"click",()=>{re(this._container).add("hidden")}),this._icon=xe(".bts-log-icon",this._container),J.bind(this._icon,"click",()=>{re(this._container).add("hidden")}),this._canvas.getContainer().appendChild(this._container),this.paletteEntry=ce(`
    <div class="bts-entry" title="Show Simulation Log">
      ${Am()}
    </div>
  `),J.bind(this.paletteEntry,"click",()=>{re(this._container).remove("hidden")}),this._tokenSimulationPalette.addEntry(this.paletteEntry,3)};Vr.prototype.toggle=function(){const e=this._container;re(e).has("hidden")?re(e).remove("hidden"):re(e).add("hidden")};Vr.prototype.log=function(e){const{text:t,type:n="info",icon:i=F5,scope:r}=e;re(this._placeholder).add("hidden");const o=new Date,a=o.toLocaleTimeString()+":"+o.getUTCMilliseconds();this._notifications.showNotification(e);const s=i.startsWith("<")?i:`<i class="${i}"></i>`,c=r&&r.colors,u=c?`style="background: ${c.primary}; color: ${c.auxiliary}"`:"",l=ce(`
    <p class="bts-entry ${n} ${r&&this._scopeFilter.isShown(r)?"":"inactive"}" ${r?`data-scope-id="${r.id}"`:""}>
      <span class="bts-date">${a}</span>
      <span class="bts-icon">${s}</span>
      <span class="bts-text">${t}</span>
      ${r?`<span class="bts-scope" data-scope-id="${r.id}" ${u}>${r.id}</span>`:""}
    </p>
  `);bt.bind(l,".bts-scope[data-scope-id]","click",p=>{this._scopeFilter.toggle(r)}),this._content.appendChild(l),this._content.scrollTop=this._content.scrollHeight};Vr.prototype.clear=function(){for(;this._content.firstChild;)this._content.removeChild(this._content.firstChild);this._placeholder=ce('<p class="bts-entry placeholder">No Entries</p>'),this._content.appendChild(this._placeholder)};Vr.$inject=["eventBus","notifications","tokenSimulationPalette","canvas","scopeFilter","simulator"];var O5={__depends__:[ha,Gr],__init__:["log"],log:["type",Vr]};const k5=["bpmn:InclusiveGateway","bpmn:ComplexGateway"];function N5(e){return e.labelTarget}function Wr(e,t,n,i,r){this._eventBus=e,this._elementRegistry=t,this._elementNotifications=r,this._notifications=i,this._canvasParent=n.getContainer().parentNode,e.on(gt,o=>{o.active?this.enable():this.clear()})}Wr.prototype.getUnsupportedElements=function(){return this._unsupportedElements};Wr.prototype.enable=function(){const e=[];this._elementRegistry.forEach(t=>{N5(t)||!ke(t,k5)||(this.showWarning(t),e.push(t))}),e.length&&this._notifications.showNotification({text:"Found unsupported elements",icon:kE(),type:"warning",ttl:5e3}),this._unsupportedElements=e};Wr.prototype.clear=function(){re(this._canvasParent).remove("warning")};Wr.prototype.showWarning=function(e){this._elementNotifications.addElementNotification(e,{type:"warning",icon:kE(),text:"Not supported"})};Wr.$inject=["eventBus","elementRegistry","canvas","notifications","elementNotifications"];var L5={__depends__:[HE,ha],__init__:["elementSupport"],elementSupport:["type",Wr]};const zE=LE(),$5=dl(),Rm=1500;function Ii(e,t,n,i){this._eventBus=e,this._tokenSimulationPalette=t,this._notifications=n,this.canvasParent=i.getContainer().parentNode,this.isActive=!1,this.isPaused=!0,this._init(),e.on(cr,Rm,r=>{this.activate(),this.unpause()}),e.on([ni,gt],()=>{this.deactivate(),this.pause()}),e.on(ME,Rm,r=>{this.unpause()})}Ii.prototype._init=function(){this.paletteEntry=ce(`
    <div class="bts-entry disabled" title="Play/Pause Simulation">
      ${zE}
    </div>
  `),J.bind(this.paletteEntry,"click",this.toggle.bind(this)),this._tokenSimulationPalette.addEntry(this.paletteEntry,1)};Ii.prototype.toggle=function(){this.isPaused?this.unpause():this.pause()};Ii.prototype.pause=function(){!this.isActive||(re(this.paletteEntry).remove("active"),re(this.canvasParent).add("paused"),this.paletteEntry.innerHTML=zE,this._eventBus.fire(RE),this._notifications.showNotification({text:"Pause Simulation"}),this.isPaused=!0)};Ii.prototype.unpause=function(){!this.isActive||!this.isPaused||(re(this.paletteEntry).add("active"),re(this.canvasParent).remove("paused"),this.paletteEntry.innerHTML=$5,this._eventBus.fire(AE),this._notifications.showNotification({text:"Play Simulation"}),this.isPaused=!1)};Ii.prototype.activate=function(){this.isActive=!0,re(this.paletteEntry).remove("disabled")};Ii.prototype.deactivate=function(){this.isActive=!1,re(this.paletteEntry).remove("active"),re(this.paletteEntry).add("disabled")};Ii.$inject=["eventBus","tokenSimulationPalette","notifications","canvas"];var j5={__depends__:[ha],__init__:["pauseSimulation"],pauseSimulation:["type",Ii]};function $c(e,t,n){this._eventBus=e,this._tokenSimulationPalette=t,this._notifications=n,this._init(),e.on(cr,()=>{re(this._paletteEntry).remove("disabled")}),e.on(gt,i=>{(this._active=i.active)||this.resetSimulation()})}$c.prototype._init=function(){this._paletteEntry=ce(`
    <div class="bts-entry disabled" title="Reset Simulation">
      ${v5()}
    </div>
  `),J.bind(this._paletteEntry,"click",()=>{this.resetSimulation(),this._notifications.showNotification({text:"Reset Simulation",type:"info"})}),this._tokenSimulationPalette.addEntry(this._paletteEntry,2)};$c.prototype.resetSimulation=function(){re(this._paletteEntry).add("disabled"),this._eventBus.fire(ni)};$c.$inject=["eventBus","tokenSimulationPalette","notifications"];var H5={__depends__:[ha],__init__:["resetSimulation"],resetSimulation:["type",$c]};const z5=10,G5=-15,V5=500,W5="--token-simulation-green-base-44",U5="--token-simulation-white";function Fi(e,t,n,i,r){this._overlays=t,this._scopeFilter=i,this._simulator=n,this._simulationStyles=r,this.overlayIds={},e.on(DE,V5,o=>{const{element:a}=o;this.removeTokenCounts(a),this.addTokenCounts(a)}),e.on(zr,o=>{const a=zn(".bts-token-count[data-scope-id]",t._overlayRoot);for(const s of a){const c=s.dataset.scopeId;re(s).toggle("inactive",!this._scopeFilter.isShown(c))}})}Fi.prototype.addTokenCounts=function(e){if(ke(e,"bpmn:MessageFlow")||ke(e,"bpmn:SequenceFlow"))return;const t=this._simulator.findScopes(n=>!n.destroyed&&n.children.some(i=>!i.destroyed&&i.element===e&&!i.children.length));this.addTokenCount(e,t)};Fi.prototype.addTokenCount=function(e,t){if(!t.length)return;const n=t.map(a=>this._getTokenHTML(e,a)).join(""),i=ce(`
    <div class="bts-token-count-parent">
      ${n}
    </div>
  `),r={bottom:z5,left:G5},o=this._overlays.add(e,"token-count",{position:r,html:i,show:{minZoom:.5}});this.overlayIds[e.id]=o};Fi.prototype.removeTokenCounts=function(e){this.removeTokenCount(e)};Fi.prototype.removeTokenCount=function(e){const t=this.overlayIds[e.id];!t||(this._overlays.remove(t),delete this.overlayIds[e.id])};Fi.prototype._getTokenHTML=function(e,t){const n=t.colors||this._getDefaultColors();return`
    <div data-scope-id="${t.id}" class="bts-token-count waiting ${this._scopeFilter.isShown(t)?"":"inactive"}"
         style="color: ${n.auxiliary}; background: ${n.primary}">
      ${t.getTokensByElement(e)}
    </div>
  `};Fi.prototype._getDefaultColors=function(){return{primary:this._simulationStyles.get(W5),auxiliary:this._simuationStyles.get(U5)}};Fi.$inject=["eventBus","overlays","simulator","scopeFilter","simulationStyles"];var Y5={__depends__:[Gr,hf],__init__:["tokenCount"],tokenCount:["type",Fi]};const q5=[["Slow",.5],["Normal",1],["Fast",2]];function da(e,t,n){this._canvas=e,this._animation=t,this._eventBus=n,this._init(t.getAnimationSpeed()),n.on(gt,i=>{i.active?re(this._container).remove("hidden"):re(this._container).add("hidden")}),n.on(PE,i=>{this.setActive(i.speed)})}da.prototype.getToggleSpeed=function(e){return parseFloat(e.dataset.speed)};da.prototype._init=function(e){this._container=ce(`
    <div class="bts-set-animation-speed hidden">
      ${g5()}
      <div class="bts-animation-speed-buttons">
        ${q5.map(([t,n],i)=>`
            <button title="Set animation speed = ${t}" data-speed="${n}" class="bts-animation-speed-button ${n===e?"active":""}">
              ${Array.from({length:i+1}).map(()=>OE()).join("")}
            </button>
          `).join("")}
      </div>
    </div>
  `),bt.bind(this._container,"[data-speed]","click",t=>{const n=t.delegateTarget,i=this.getToggleSpeed(n);this._animation.setAnimationSpeed(i)}),this._canvas.getContainer().appendChild(this._container)};da.prototype.setActive=function(e){zn("[data-speed]",this._container).forEach(t=>{const n=this.getToggleSpeed(t)===e;re(t)[n?"add":"remove"]("active")})};da.$inject=["canvas","animation","eventBus"];var K5={__init__:["setAnimationSpeed"],setAnimationSpeed:["type",da]};const X5="--token-simulation-grey-darken-30",Z5="--token-simulation-grey-lighten-56";function Q5(e,t){var n=e.outgoing.filter(df),i=n.indexOf(t||e.sequenceFlow);return n[i+1]?n[i+1]:n[0]}function df(e){return ke(e,"bpmn:SequenceFlow")}function Ur(e,t,n,i,r){this._elementRegistry=t,this._elementColors=n,this._simulator=i,this._simulationStyles=r,e.on(gt,o=>{o.active?this.setSequenceFlowsDefault():this.resetSequenceFlows()})}Ur.prototype.setSequenceFlowsDefault=function(){const e=this._elementRegistry.filter(t=>ke(t,"bpmn:ExclusiveGateway"));for(const t of e)this.setSequenceFlow(t)};Ur.prototype.resetSequenceFlows=function(){this._elementRegistry.filter(t=>ke(t,"bpmn:ExclusiveGateway")).forEach(t=>{t.outgoing.filter(df).length&&this.resetSequenceFlow(t)})};Ur.prototype.resetSequenceFlow=function(e){this._simulator.setConfig(e,{activeOutgoing:void 0})};Ur.prototype.setSequenceFlow=function(e){const t=e.outgoing.filter(df);if(t.length<2)return;const{activeOutgoing:n}=this._simulator.getConfig(e);let i;n?i=Q5(e,n):i=t[0],this._simulator.setConfig(e,{activeOutgoing:i}),e.outgoing.forEach(r=>{const o=r===i?X5:Z5,a=this._simulationStyles.get(o);this._elementColors.set(r,{stroke:a})})};Ur.$inject=["eventBus","elementRegistry","elementColors","simulator","simulationStyles"];function ma(e,t){this._elementRegistry=e,this._graphicsFactory=t}ma.$inject=["elementRegistry","graphicsFactory"];ma.prototype.get=function(e){const t=Ce(e);if(!!t)return GE(e)?{stroke:t.label&&t.label.get("color")}:{fill:t.get("background-color"),stroke:t.get("border-color")}};ma.prototype.set=function(e,t){const{fill:n,stroke:i}=t,r=Ce(e);!r||(GE(e)?r.label&&r.label.set("color",i):(r.set("background-color",n),r.set("border-color",i)),this._forceRedraw(e))};ma.prototype._forceRedraw=function(e){const t=this._elementRegistry.getGraphics(e),n=e.waypoints?"connection":"shape";this._graphicsFactory.update(n,e,t)};function GE(e){return"labelTarget"in e}var VE={elementColors:["type",ma]},J5={__depends__:[VE,hf],exclusiveGatewaySettings:["type",Ur]};const e3=5e4;function jc(e,t,n){this._elementRegistry=t,this._elementColors=n,this._colorCache={},e.on(gt,e3,i=>{i.active?this.preserveColors():this.resetColors()})}jc.prototype.preserveColors=function(){this._elementRegistry.forEach(e=>{this._colorCache[e.id]=this._elementColors.get(e),this._elementColors.set(e,{stroke:"#000",fill:"#fff"})})};jc.prototype.resetColors=function(){this._elementRegistry.forEach(e=>{const t=this._colorCache[e.id];t&&this._elementColors.set(e,t)}),this._colorCache={}};jc.$inject=["eventBus","elementRegistry","elementColors"];var t3={__depends__:[VE],__init__:["preserveElementColors"],preserveElementColors:["type",jc]};function Hc(e,t){var n=this;this._canvas=t,this.entries=[],this._init(),e.on(gt,function(i){var r=i.active;r?re(n.container).remove("hidden"):re(n.container).add("hidden")})}Hc.prototype._init=function(){this.container=ce('<div class="bts-palette hidden"></div>'),this._canvas.getContainer().appendChild(this.container)};Hc.prototype.addEntry=function(e,t){var n=0;this.entries.forEach(function(i){t>=i.index&&n++}),this.container.insertBefore(e,this.container.childNodes[n]),this.entries.push({entry:e,index:t})};Hc.$inject=["eventBus","canvas"];var n3={__init__:["tokenSimulationPalette"],tokenSimulationPalette:["type",Hc]},i3={__depends__:[CE,KD,QD,S5,P5,I5,O5,L5,j5,H5,Y5,K5,J5,t3,n3]};const r3=10001;function WE(e,t,n,i,r,o,a,s){let c=!1;e.on(gt,r3,f=>{c=f.active,c&&(i.cancel(),t.close(),n.cancel()),a._update()});function u(f,h,d){const g=f[h];f[h]=function(){return d.call(this,g,arguments)}}function l(f,h){u(f,h,function(d,g){if(!c)return d.apply(this,g)})}function p(f,h){u(f,h,function(d,g){if(c)throw new Error("model is read-only");return d.apply(this,g)})}l(t,"open"),l(n,"init"),l(i,"activate"),l(n,"init"),l(i,"activate"),p(o,"moveShape"),p(o,"updateAttachment"),p(o,"moveElements"),p(o,"moveConnection"),p(o,"layoutConnection"),p(o,"createConnection"),p(o,"createShape"),p(o,"createLabel"),p(o,"appendShape"),p(o,"removeElements"),p(o,"distributeElements"),p(o,"removeShape"),p(o,"removeConnection"),p(o,"replaceShape"),p(o,"pasteElements"),p(o,"alignElements"),p(o,"resizeShape"),p(o,"createSpace"),p(o,"updateWaypoints"),p(o,"reconnectStart"),p(o,"reconnectEnd"),u(r,"trigger",function(f,h){const d=h[0];if(!(c&&o3(["undo","redo","copy","paste","removeSelection","spaceTool","lassoTool","globalConnectTool","distributeElements","alignElements","directEditing"],d)))return f.apply(this,h)})}WE.$inject=["eventBus","contextPad","dragging","directEditing","editorActions","modeling","palette","paletteProvider"];function o3(e,t){return e.indexOf(t)>-1}var a3={__init__:["disableModeling"],disableModeling:["type",WE]};function zc(e,t,n,i){this._eventBus=e,this._canvas=t,this._selection=n,this._contextPad=i,this._active=!1,e.on("import.parse.start",()=>{this._active&&(this.toggleMode(!1),e.once("import.done",()=>{this.toggleMode(!0)}))}),e.on("diagram.init",()=>{this._canvasParent=this._canvas.getContainer().parentNode,this._palette=xe(".djs-palette",this._canvas.getContainer()),this._init()})}zc.prototype._init=function(){this._container=ce(`
    <div class="bts-toggle-mode">
      Token Simulation <span class="bts-toggle">${$E()}</span>
    </div>
  `),J.bind(this._container,"click",()=>this.toggleMode()),this._canvas.getContainer().appendChild(this._container)};zc.prototype.toggleMode=function(e=!this._active){if(e!==this._active){if(e)this._container.innerHTML=`Token Simulation <span class="bts-toggle">${_5()}</span>`,re(this._canvasParent).add("simulation"),re(this._palette).add("hidden");else{this._container.innerHTML=`Token Simulation <span class="bts-toggle">${$E()}</span>`,re(this._canvasParent).remove("simulation"),re(this._palette).remove("hidden");const t=this._selection.get();t.length===1&&this._contextPad.open(t[0])}this._eventBus.fire(gt,{active:e}),this._active=e}};zc.$inject=["eventBus","canvas","selection","contextPad"];var s3={__init__:["toggleMode"],toggleMode:["type",zc]};function UE(e,t,n,i,r,o){r.register({toggleTokenSimulation:function(){t.toggleMode()}}),r.register({togglePauseTokenSimulation:function(){n.toggle()}}),r.register({resetTokenSimulation:function(){i.resetSimulation()}});const a=o.get("log",!1);a&&r.register({toggleTokenSimulationLog:function(){a.toggle()}})}UE.$inject=["eventBus","toggleMode","pauseSimulation","resetSimulation","editorActions","injector"];var c3={__init__:["tokenSimulationEditorActions"],tokenSimulationEditorActions:["type",UE]};const u3=1e4;function YE(e,t){var n=t.get("editorActions",!1),i=t.get("keyboard",!1);if(!i||!n)return;var r=!1;function o(a){if(Qa(["t","T"],a))return n.trigger("toggleTokenSimulation"),!0;if(!!r){if(Qa(["l","L"],a))return n.trigger("toggleTokenSimulationLog"),!0;if(Qa([" ","Spacebar"],a))return n.trigger("togglePauseTokenSimulation"),!0;if(Qa(["r","R"],a))return n.trigger("resetTokenSimulation"),!0}}e.on("keyboard.init",function(){i.addListener(u3,function(a){var s=a.keyEvent;o(s)})}),e.on(gt,function(a){var s=a.active;s?r=!0:r=!1})}YE.$inject=["eventBus","injector"];function Qa(e,t){return e.indexOf(t.key)>-1}var l3={__init__:["tokenSimulationKeyboardBindings"],tokenSimulationKeyboardBindings:["type",YE]},p3={__depends__:[i3,a3,s3,c3,l3]},f3=function e(t,n){const i=n.enter||null,r=n.leave||null,o=i&&i(t),a=t.$descriptor;o!==!1&&!a.isGeneric&&a.properties.filter(c=>!c.isAttr&&!c.isReference&&c.type!=="String").forEach(c=>{if(c.name in t){const u=t[c.name];c.isMany?u.forEach(l=>{e(l,n)}):e(u,n)}}),r&&r(t)};const h3=f3,{isArray:d3,isObject:m3}=P0;class v3{constructor({moddleRoot:t,rule:n}){this.rule=n,this.moddleRoot=t,this.messages=[],this.report=this.report.bind(this)}report(t,n,i){let r={id:t,message:n};i&&d3(i)&&(r={...r,path:i}),i&&m3(i)&&(r={...r,...i}),this.messages.push(r)}}var g3=function({moddleRoot:t,rule:n}){const i=new v3({rule:n,moddleRoot:t}),r=n.check,o=r&&r.enter||r,a=r&&r.leave;if(!o&&!a)throw new Error("no check implemented");return h3(t,{enter:o?s=>o(s,i):null,leave:a?s=>a(s,i):null}),i.messages};const y3=g3,E3={0:"off",1:"warn",2:"error"};function Jt(e={}){const{config:t,resolver:n}=e;if(typeof n=="undefined")throw new Error("must provide <options.resolver>");this.config=t,this.resolver=n,this.cachedRules={},this.cachedConfigs={}}var _3=Jt;Jt.prototype.applyRule=function(t,n){const{config:i,rule:r,category:o,name:a}=n;try{return y3({moddleRoot:t,rule:r,config:i}).map(function(c){return{...c,category:o}})}catch(s){return console.error("rule <"+a+"> failed with error: ",s),[{message:"Rule error: "+s.message,category:"error"}]}};Jt.prototype.resolveRule=function(e,t){const{pkg:n,ruleName:i}=this.parseRuleName(e),r=`${n}-${i}`,o=this.cachedRules[r];return o?Promise.resolve(o):Promise.resolve(this.resolver.resolveRule(n,i)).then(a=>{if(!a)throw new Error(`unknown rule <${e}>`);return this.cachedRules[r]=a(t)})};Jt.prototype.resolveConfig=function(e){const{pkg:t,configName:n}=this.parseConfigName(e),i=`${t}-${n}`,r=this.cachedConfigs[i];return r?Promise.resolve(r):Promise.resolve(this.resolver.resolveConfig(t,n)).then(o=>{if(!o)throw new Error(`unknown config <${e}>`);return this.cachedConfigs[i]=this.normalizeConfig(o,t)})};Jt.prototype.resolveRules=function(e){return this.resolveConfiguredRules(e).then(t=>{const r=Object.entries(t).map(([o,a])=>{const{category:s,config:c}=this.parseRuleValue(a);return{name:o,category:s,config:c}}).filter(o=>o.category!=="off").map(o=>{const{name:a,config:s}=o;return this.resolveRule(a,s).then(function(c){return{...o,rule:c}})});return Promise.all(r)})};Jt.prototype.resolveConfiguredRules=function(e){let t=e.extends;return typeof t=="string"&&(t=[t]),typeof t=="undefined"&&(t=[]),Promise.all(t.map(n=>this.resolveConfig(n).then(i=>this.resolveConfiguredRules(i)))).then(n=>{const i=this.normalizeConfig(e,"bpmnlint").rules;return[...n,i].reduce((o,a)=>({...o,...a}),{})})};Jt.prototype.lint=function(e,t){return t=t||this.config,this.resolveRules(t).then(n=>{const i={};return n.forEach(r=>{const{name:o}=r,a=this.applyRule(e,r);a.length&&(i[o]=a)}),i})};Jt.prototype.parseRuleValue=function(e){let t,n;return Array.isArray(e)?(t=e[0],n=e[1]):(t=e,n={}),typeof t=="string"&&(t=t.toLowerCase()),t=E3[t]||t,{config:n,category:t}};Jt.prototype.parseRuleName=function(e,t="bpmnlint"){const n=/^(?:(?:(@[^/]+)\/)?([^@]{1}[^/]*)\/)?([^/]+)$/.exec(e);if(!n)throw new Error(`unparseable rule name <${e}>`);const[i,r,o,a]=n;return o?{pkg:`${r?r+"/":""}${qE(o)}`,ruleName:a}:{pkg:t,ruleName:a}};Jt.prototype.parseConfigName=function(e){const t=/^(?:(?:plugin:(?:(@[^/]+)\/)?([^@]{1}[^/]*)\/)|bpmnlint:)([^/]+)$/.exec(e);if(!t)throw new Error(`unparseable config name <${e}>`);const[n,i,r,o]=t;return r?{pkg:`${i?i+"/":""}${qE(r)}`,configName:o}:{pkg:"bpmnlint",configName:o}};Jt.prototype.getSimplePackageName=function(e){const t=/^(?:(@[^/]+)\/)?([^/]+)$/.exec(e);if(!t)throw new Error(`unparseable package name <${e}>`);const[n,i,r]=t;return`${i?i+"/":""}${b3(r)}`};Jt.prototype.normalizeConfig=function(e,t){const n=e.rules||{},i=Object.keys(n).reduce((r,o)=>{const a=n[o],{pkg:s,ruleName:c}=this.parseRuleName(o,t),u=s==="bpmnlint"?c:`${this.getSimplePackageName(s)}/${c}`;return r[u]=a,r},{});return{...e,rules:i}};function qE(e){return e==="bpmnlint"?"bpmnlint":e.startsWith("bpmnlint-plugin-")?e:`bpmnlint-plugin-${e}`}function b3(e){return e.startsWith("bpmnlint-plugin-")?e.substring(16):e}const x3=_3;var w3={Linter:x3};function KE(e,t){var n=e.get("editorActions",!1);n&&n.register({toggleLinting:function(){t.toggle()}})}KE.$inject=["injector","linting"];var XE='<svg width="12" height="12" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>',ZE='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 512 512"><path fill="currentColor" d="M288 328.83c-45.518 0-82.419 34.576-82.419 77.229 0 42.652 36.9 77.229 82.419 77.229 45.518 0 82.419-34.577 82.419-77.23 0-42.652-36.9-77.229-82.419-77.229zM207.439 57.034l11.61 204.348c.544 9.334 8.78 16.64 18.755 16.64h100.392c9.975 0 18.211-7.306 18.754-16.64l11.611-204.348c.587-10.082-7.98-18.56-18.754-18.56H226.192c-10.775 0-19.34 8.478-18.753 18.56z"/></svg>',Pm='<svg width="12" height="12" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"></path></svg>',S3=-7,C3=-7,T3=500,Dm={resolver:{resolveRule:function(){return null}},config:{}},QE={error:XE,warning:ZE,success:Pm,inactive:Pm};function Ue(e,t,n,i,r,o,a){this._bpmnjs=e,this._canvas=t,this._elementRegistry=i,this._eventBus=r,this._overlays=o,this._translate=a,this._issues={},this._active=n&&n.active||!1,this._linterConfig=Dm,this._overlayIds={};var s=this;r.on(["import.done","elements.changed","linting.configChanged","linting.toggle"],T3,function(u){s.isActive()&&s.update()}),r.on("linting.toggle",function(u){u.active||(s._clearIssues(),s._updateButton())}),r.on("diagram.clear",function(){s._clearIssues()});var c=n&&n.bpmnlint;c&&r.once("diagram.init",function(){if(s.getLinterConfig()===Dm)try{s.setLinterConfig(c)}catch{console.error("[bpmn-js-bpmnlint] Invalid lint rules configured. Please doublecheck your linting.bpmnlint configuration, cf. https://github.com/bpmn-io/bpmn-js-bpmnlint#configure-lint-rules")}}),this._init()}Ue.prototype.setLinterConfig=function(e){if(!e.config||!e.resolver)throw new Error("Expected linterConfig = { config, resolver }");this._linterConfig=e,this._eventBus.fire("linting.configChanged")};Ue.prototype.getLinterConfig=function(){return this._linterConfig};Ue.prototype._init=function(){this._createButton(),this._updateButton()};Ue.prototype.isActive=function(){return this._active};Ue.prototype._formatIssues=function(e){let t=this,n=Rt(e,function(o,a,s){return o.concat(a.map(function(c){return c.rule=s,c}))},[]);const i=t._elementRegistry.filter(o=>v(o,"bpmn:Participant")),r=i.map(o=>o.businessObject);return n=lt(n,function(o){if(!t._elementRegistry.get(o.id)){o.isChildIssue=!0,o.actualElementId=o.id;const s=r.filter(c=>c.processRef&&c.processRef.id&&c.processRef.id===o.id);s.length?o.id=s[0].id:o.id=t._canvas.getRootElement().id}return o}),n=qi(n,function(o){return o.id}),n};Ue.prototype.toggle=function(e){return e=typeof e=="undefined"?!this.isActive():e,this._setActive(e),e};Ue.prototype._setActive=function(e){this._active!==e&&(this._active=e,this._eventBus.fire("linting.toggle",{active:e}))};Ue.prototype.update=function(){var e=this,t=this._bpmnjs.getDefinitions();if(!!t){var n=this._lintStart=Math.random();this.lint().then(function(i){if(e._lintStart===n){i=e._formatIssues(i);var r={},o={},a={};for(var s in e._issues)i[s]||(r[s]=e._issues[s]);for(var c in i)e._issues[c]?i[c]!==e._issues[c]&&(o[c]=i[c]):a[c]=i[c];r=O(r,o),a=O(a,o),e._clearOverlays(),e._createIssues(a),e._issues=i,e._updateButton(),e._fireComplete(i)}})}};Ue.prototype._fireComplete=function(e){this._eventBus.fire("linting.completed",{issues:e})};Ue.prototype._createIssues=function(e){for(var t in e)this._createElementIssues(t,e[t])};Ue.prototype._createElementIssues=function(e,t){var n=this._elementRegistry.get(e);if(!!n){var i=this._elementRegistry.get(e+"_plane");i&&this._createElementIssues(i.id,t);var r,o,a=!n.parent;a&&v(n,"bpmn:Process")?(r="bottom-right",o={top:20,left:150}):a&&v(n,"bpmn:SubProcess")?(r="bottom-right",o={top:50,left:150}):(r="top-right",o={top:S3,left:C3});var s=qi(t,function(C){return(C.isChildIssue?"child":"")+C.category}),c=s.error,u=s.warn,l=s.childerror,p=s.childwarn;if(!(!c&&!u&&!l&&!p)){var f=ce('<div class="bjsl-overlay bjsl-issues-'+r+'"></div>'),h=ce(c||l?'<div class="bjsl-icon bjsl-icon-error">'+XE+"</div>":'<div class="bjsl-icon bjsl-icon-warning">'+ZE+"</div>"),d=ce('<div class="bjsl-dropdown"></div>'),g=ce('<div class="bjsl-dropdown-content"></div>'),y=ce('<div class="bjsl-issues"></div>'),A=ce('<div class="bjsl-current-element-issues"></div>'),_=ce("<ul></ul>");if(f.appendChild(h),f.appendChild(d),d.appendChild(g),g.appendChild(y),y.appendChild(A),A.appendChild(_),c&&this._addErrors(_,c),u&&this._addWarnings(_,u),l||p){var w=ce('<div class="bjsl-child-issues"></div>'),b=ce("<ul></ul>"),S=ce('<a class="bjsl-issue-heading">Issues for child elements:</a>');if(l&&this._addErrors(b,l),p&&this._addWarnings(b,p),c||u){var M=ce("<hr/>");w.appendChild(M)}w.appendChild(S),w.appendChild(b),y.appendChild(w)}this._overlayIds[e]=this._overlays.add(n,"linting",{position:o,html:f,scale:{min:.9}})}}};Ue.prototype._addErrors=function(e,t){var n=this;t.forEach(function(i){n._addEntry(e,"error",i)})};Ue.prototype._addWarnings=function(e,t){var n=this;t.forEach(function(i){n._addEntry(e,"warning",i)})};Ue.prototype._addEntry=function(e,t,n){var i=n.rule,r=this._translate(n.message),o=n.actualElementId,a=QE[t],s=ce('<li class="'+t+'"><span class="icon"> '+a+'</span><a title="'+On(i)+": "+On(r)+'" data-rule="'+On(i)+'" data-message="'+On(r)+'">'+On(r)+"</a>"+(o?'<a class="bjsl-id-hint"><code>'+o+"</code></a>":"")+"</li>");e.appendChild(s)};Ue.prototype._clearOverlays=function(){this._overlays.remove({type:"linting"}),this._overlayIds={}};Ue.prototype._clearIssues=function(){this._issues={},this._clearOverlays()};Ue.prototype._setButtonState=function(e,t,n){var i=this._button,r=QE[e],o=r+"<span>"+this._translate("{errors} Errors, {warnings} Warnings",{errors:t.toString(),warnings:n.toString()})+"</span>";["error","inactive","success","warning"].forEach(function(a){e===a?i.classList.add("bjsl-button-"+a):i.classList.remove("bjsl-button-"+a)}),i.innerHTML=o};Ue.prototype._updateButton=function(){if(!this.isActive()){this._setButtonState("inactive",0,0);return}var e=0,t=0;for(var n in this._issues)this._issues[n].forEach(function(r){r.category==="error"?e++:r.category==="warn"&&t++});var i=e&&"error"||t&&"warning"||"success";this._setButtonState(i,e,t)};Ue.prototype._createButton=function(){var e=this;this._button=ce('<button class="bjsl-button bjsl-button-inactive" title="'+this._translate("Toggle linting")+'"></button>'),this._button.addEventListener("click",function(){e.toggle()}),this._canvas.getContainer().appendChild(this._button)};Ue.prototype.lint=function(){var e=this._bpmnjs.getDefinitions(),t=new w3.Linter(this._linterConfig);return t.lint(e)};Ue.$inject=["bpmnjs","canvas","config.linting","elementRegistry","eventBus","overlays","translate"];var A3={__init__:["linting","lintingEditorActions"],linting:["type",Ue],lintingEditorActions:["type",KE]},Ja=50,Mm={min:.2,max:4},R3=10,P3=.1,D3=250;function Tt(e,t,n,i,r){var o=this;this._canvas=i,this._elementRegistry=r,this._eventBus=n,this._injector=t,this._state={isOpen:void 0,isDragging:!1,initialDragPosition:null,offsetViewport:null,cachedViewbox:null,dragger:null,svgClientRect:null,parentClientRect:null,zoomDelta:0},this._init(),this.toggle(e&&e.open||!1);function a(l){(!o._state._svgClientRect||ts(o._state._svgClientRect))&&(o._state._svgClientRect=o._svg.getBoundingClientRect());var p=es({x:l.clientX-o._state._svgClientRect.left,y:l.clientY-o._state._svgClientRect.top},o._svg,o._lastViewbox);Ru(p,o._canvas),o._update()}J.bind(this._svg,"click",function(l){l.preventDefault(),l.stopPropagation(),a(l)});function s(l){return function(f){(!o._state._svgClientRect||ts(o._state._svgClientRect))&&(o._state._svgClientRect=o._svg.getBoundingClientRect()),l&&a(f);var h=es({x:f.clientX-o._state._svgClientRect.left,y:f.clientY-o._state._svgClientRect.top},o._svg,o._lastViewbox),d=i.viewbox(),g=B3(h,d),y=o._viewportDom.getBoundingClientRect(),A={x:f.clientX-y.left+1,y:f.clientY-y.top+1};O(o._state,{cachedViewbox:d,initialDragPosition:{x:f.clientX,y:f.clientY},isDragging:!0,offsetViewport:g,offsetViewportDom:A,viewportClientRect:o._viewport.getBoundingClientRect(),parentClientRect:o._parent.getBoundingClientRect()}),J.bind(document,"mousemove",c),J.bind(document,"mouseup",u)}}function c(l){if(o._state.isDragging){(!o._state._svgClientRect||ts(o._state._svgClientRect))&&(o._state._svgClientRect=o._svg.getBoundingClientRect());var p=o._state.offsetViewportDom,f=o._state.viewportClientRect,h=o._state.parentClientRect;O(o._viewportDom.style,{top:l.clientY-p.y-h.top+"px",left:l.clientX-p.x-h.left+"px"});var d=JE(h,{top:l.clientY-p.y-h.top,left:l.clientX-p.x-h.left,width:f.width,height:f.height});O(o._overlay.style,{clipPath:d});var g=es({x:l.clientX-o._state._svgClientRect.left,y:l.clientY-o._state._svgClientRect.top},o._svg,o._lastViewbox);Ru({x:g.x-o._state.offsetViewport.x,y:g.y-o._state.offsetViewport.y},o._canvas)}}function u(l){o._state.isDragging&&(o._state.initialDragPosition.x===l.clientX&&o._state.initialDragPosition.y===l.clientY&&a(l),o._update(),O(o._state,{cachedViewbox:null,initialDragPosition:null,isDragging:!1,offsetViewport:null,offsetViewportDom:null}),J.unbind(document,"mousemove",c),J.unbind(document,"mouseup",u))}J.bind(this._viewportDom,"mousedown",s(!1)),J.bind(this._svg,"mousedown",s(!0)),J.bind(this._parent,"wheel",function(l){if(l.preventDefault(),l.stopPropagation(),!!l.ctrlKey&&((!o._state._svgClientRect||ts(o._state._svgClientRect))&&(o._state._svgClientRect=o._svg.getBoundingClientRect()),!!k3(l,o._state._svgClientRect))){var p=l.deltaMode===0?.02:.32,f=Math.sqrt(Math.pow(l.deltaY,2)+Math.pow(l.deltaX,2))*N3(l.deltaY)*-p;if(o._state.zoomDelta+=f,Math.abs(o._state.zoomDelta)>P3){var h=f>0?1:-1,d=Math.log(i.zoom())/Math.log(10),g=L3(Mm,R3*2),y=Math.round(d/g)*g;y+=g*h;var A=Math.pow(10,y);i.zoom($3(Mm,A),_),o._state.zoomDelta=0;var _=es({x:l.clientX-o._state._svgClientRect.left,y:l.clientY-o._state._svgClientRect.top},o._svg,o._lastViewbox);Ru(_,o._canvas),o._update()}}}),J.bind(this._toggle,"click",function(l){l.preventDefault(),l.stopPropagation(),o.toggle()}),n.on(["shape.added","connection.added"],function(l){var p=l.element;o._addElement(p),o._update()}),n.on(["shape.removed","connection.removed"],function(l){var p=l.element;o._removeElement(p),o._update()}),n.on("elements.changed",D3,function(l){var p=l.elements;p.forEach(function(f){o._updateElement(f)}),o._update()}),n.on("element.updateId",function(l){var p=l.element,f=l.newId;o._updateElementId(p,f)}),n.on("canvas.viewbox.changed",function(){o._state.isDragging||o._update()}),n.on("canvas.resized",function(){document.body.contains(o._parent)&&(o._state.isDragging||o._update(),o._state._svgClientRect=o._svg.getBoundingClientRect())}),n.on(["root.set","plane.set"],function(l){o._clear();var p=l.element||l.plane.rootElement;p.children.forEach(function(f){o._addElement(f)}),o._update()})}Tt.$inject=["config.minimap","injector","eventBus","canvas","elementRegistry"];Tt.prototype._init=function(){var e=this._canvas,t=e.getContainer(),n=this._parent=document.createElement("div");re(n).add("djs-minimap"),t.appendChild(n);var i=this._toggle=document.createElement("div");re(i).add("toggle"),n.appendChild(i);var r=this._map=document.createElement("div");re(r).add("map"),n.appendChild(r);var o=this._svg=ae("svg");W(o,{width:"100%",height:"100%"}),pe(r,o);var a=this._elementsGroup=ae("g");pe(o,a);var s=this._viewportGroup=ae("g");pe(o,s);var c=this._viewport=ae("rect");Se(c).add("viewport"),pe(s,c),J.bind(n,"mousedown",function(p){p.stopPropagation()});var u=this._viewportDom=document.createElement("div");re(u).add("viewport-dom"),this._parent.appendChild(u);var l=this._overlay=document.createElement("div");re(l).add("overlay"),this._parent.appendChild(l)};Tt.prototype._update=function(){var e=this._canvas.viewbox(),t=e.inner,n=e.outer;if(!!e0(e)){var i,r,o,a,s=n.width-t.width,c=n.height-t.height;t.width<n.width?(i=t.x-s/2,o=n.width,t.x+t.width<n.width&&(i=Math.min(0,t.x))):(i=t.x,o=t.width),t.height<n.height?(r=t.y-c/2,a=n.height,t.y+t.height<n.height&&(r=Math.min(0,t.y))):(r=t.y,a=t.height),i=i-Ja,r=r-Ja,o=o+Ja*2,a=a+Ja*2,this._lastViewbox={x:i,y:r,width:o,height:a},W(this._svg,{viewBox:i+", "+r+", "+o+", "+a}),W(this._viewport,{x:e.x,y:e.y,width:e.width,height:e.height});var u=this._state._parentClientRect=this._parent.getBoundingClientRect(),l=this._viewport.getBoundingClientRect(),p={top:l.top-u.top,left:l.left-u.left,width:l.width,height:l.height};O(this._viewportDom.style,{top:p.top+"px",left:p.left+"px",width:p.width+"px",height:p.height+"px"});var f=JE(u,p);O(this._overlay.style,{clipPath:f})}};Tt.prototype.open=function(){O(this._state,{isOpen:!0}),re(this._parent).add("open");var e=this._injector.get("translate",!1)||function(t){return t};Ve(this._toggle,"title",e("Close minimap")),this._update(),this._eventBus.fire("minimap.toggle",{open:!0})};Tt.prototype.close=function(){O(this._state,{isOpen:!1}),re(this._parent).remove("open");var e=this._injector.get("translate",!1)||function(t){return t};Ve(this._toggle,"title",e("Open minimap")),this._eventBus.fire("minimap.toggle",{open:!1})};Tt.prototype.toggle=function(e){var t=this.isOpen();typeof e=="undefined"&&(e=!t),e!=t&&(e?this.open():this.close())};Tt.prototype.isOpen=function(){return this._state.isOpen};Tt.prototype._updateElement=function(e){try{e.parent!==void 0&&e.parent!==null&&(this._removeElement(e),this._addElement(e))}catch(t){console.warn("Minimap#_updateElement errored",t)}};Tt.prototype._updateElementId=function(e,t){try{var n=xe("#"+mi(e.id),this._elementsGroup);n&&(n.id=t)}catch(i){console.warn("Minimap#_updateElementId errored",i)}};Tt.prototype.isOnActivePlane=function(e){var t=this._canvas;return t.findRoot?t.findRoot(e)===t.getRootElement():t.findPlane?t.findPlane(e)===t.getActivePlane():!0};Tt.prototype._addElement=function(e){var t=this;if(this._removeElement(e),!!this.isOnActivePlane(e)){var n,i,r,o=this._createElement(e),a=xe("#"+mi(e.parent.id),this._elementsGroup);if(o){var s=this._elementRegistry.getGraphics(e),c=this._elementRegistry.getGraphics(e.parent),u=F3(s,c);return u!=="undefined"?a?a.childNodes.length>u?Im(o,a,u):Im(o,a,a.childNodes.length-1):this._elementsGroup.appendChild(o):this._elementsGroup.appendChild(o),M3(e)?(n=e.parent,i=0,r=0,typeof n.x!="undefined"&&typeof n.y!="undefined"&&(i=-n.x,r=-n.y),W(o,{transform:"translate("+i+" "+r+")"})):(i=e.x,r=e.y,a&&(n=e.parent,i-=n.x,r-=n.y),W(o,{transform:"translate("+i+" "+r+")"})),e.children&&e.children.length&&e.children.forEach(function(l){t._addElement(l)}),o}}};Tt.prototype._removeElement=function(e){var t=this._svg.getElementById(e.id);t&&Le(t)};Tt.prototype._createElement=function(e){var t=this._elementRegistry.getGraphics(e),n;if(t&&(n=_o(t),n)){var i=_l(n);return W(i,{id:e.id}),i}};Tt.prototype._clear=function(){Ao(this._elementsGroup)};function M3(e){return e.waypoints}function B3(e,t){var n={x:t.x+t.width/2,y:t.y+t.height/2};return{x:e.x-n.x,y:e.y-n.y}}function es(e,t,n){var i=t.getBoundingClientRect(),r=I3(n,i.width/i.height),o=Bm(e.x,0,i.width,r.x,r.x+r.width),a=Bm(e.y,0,i.height,r.y,r.y+r.height);return{x:o,y:a}}function Ru(e,t){var n=t.viewbox(),i=n.width,r=n.height;t.viewbox({x:e.x-i/2,y:e.y-r/2,width:i,height:r})}function I3(e,t){var n=e.width/e.height,i=O({},{x:e.x,y:e.y,width:e.width,height:e.height});if(n>t){var r=i.width*(1/t),o=i.y-(r-i.height)/2;O(i,{y:o,height:r})}else if(n<t){var a=i.height*t,s=i.x-(a-i.width)/2;O(i,{x:s,width:a})}return i}function Bm(e,t,n,i,r){var o=n-t,a=r-i;return(e-t)*a/o+i}function F3(e,t){var n=xe(".djs-children",t.parentNode);if(!!n){var i=[].slice.call(n.childNodes),r=-1;return i.forEach(function(o,a){xe(".djs-element",o)===e&&(r=a)}),r}}function Im(e,t,n){var i=O3(t),r=[].slice.call(i.childNodes),o=r[n];o?t.insertBefore(e,o.nextSibling):t.appendChild(e)}function O3(e){var t=xe(".children",e);return t||(t=ae("g",{class:"children"}),pe(e,t)),t}function ts(e){return e.width===0&&e.height===0}function k3(e,t){return e.x>t.left&&e.x<t.left+t.width&&e.y>t.top&&e.y<t.top+t.height}var N3=Math.sign||function(e){return e>=0?1:-1};function L3(e,t){var n=Math.log(e.min)/Math.log(10),i=Math.log(e.max)/Math.log(10),r=Math.abs(n)+Math.abs(i);return r/t}function $3(e,t){return Math.max(e.min,Math.min(e.max,t))}function JE(e,t){var n=[gn(t.left,t.top),gn(t.left+t.width,t.top),gn(t.left+t.width,t.top+t.height),gn(t.left,t.top+t.height),gn(t.left,e.height),gn(e.width,e.height),gn(e.width,0),gn(0,0),gn(0,e.height),gn(t.left,e.height)].join(", ");return"polygon("+n+")"}function gn(e,t){return e+"px "+t+"px"}function e0(e){return gi(e,function(t){return ot(t)?e0(t):ge(t)&&isFinite(t)})}var j3={__init__:["minimap"],minimap:["type",Tt]};class t0{constructor(t,n,i,r,o,a){this.create=i,this.elementFactory=r,this.translate=a,t.autoPlace!==!1&&(this.autoPlace=o.get("autoPlace",!1)),n.registerProvider(this)}getContextPadEntries(t){const{autoPlace:n,create:i,elementFactory:r,translate:o}=this;function a(c,u){if(n){const l=r.createShape({type:"bpmn:UserTask"});n.append(u,l)}else s(c,u)}function s(c,u){const l=r.createShape({type:"bpmn:UserTask"});i.start(c,l,u)}return["bpmn:SequenceFlow","bpmn:EndEvent","bpmn:TextAnnotation"].includes(t.type)?{}:{"append.user-task":{group:"model",className:"bpmn-icon-user-task",title:o("User Task"),action:{click:a,dragstart:s}}}}}t0.$inject=["config","contextPad","create","elementFactory","injector","translate"];var H3={StartEvent:"\u5F00\u59CB\u4E8B\u4EF6",EndEvent:"\u7ED3\u675F\u4E8B\u4EF6",IntermediateThrowEvent:"\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6",IntermediateCatchEvent:"\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Message Start Event":"\u6D88\u606F\u5F00\u59CB\u4E8B\u4EF6","Timer Start Event":"\u5B9A\u65F6\u5F00\u59CB\u4E8B\u4EF6","Conditional Start Event":"\u6761\u4EF6\u5F00\u59CB\u4E8B\u4EF6","Signal Start Event":"\u4FE1\u53F7\u5F00\u59CB\u4E8B\u4EF6","Error Start Event":"\u9519\u8BEF\u5F00\u59CB\u4E8B\u4EF6","Escalation Start Event":"\u5347\u7EA7\u5F00\u59CB\u4E8B\u4EF6","Compensation Start Event":"\u8865\u507F\u5F00\u59CB\u4E8B\u4EF6","Message Start Event (non-interrupting)":"\u6D88\u606F\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Timer Start Event (non-interrupting)":"\u5B9A\u65F6\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Conditional Start Event (non-interrupting)":"\u6761\u4EF6\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Signal Start Event (non-interrupting)":"\u4FE1\u53F7\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Escalation Start Event (non-interrupting)":"\u5347\u7EA7\u5F00\u59CB\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Message Intermediate Catch Event":"\u6D88\u606F\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Message Intermediate Throw Event":"\u6D88\u606F\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Timer Intermediate Catch Event":"\u5B9A\u65F6\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Escalation Intermediate Throw Event":"\u5347\u7EA7\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Conditional Intermediate Catch Event":"\u6761\u4EF6\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Link Intermediate Catch Event":"\u94FE\u63A5\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Link Intermediate Throw Event":"\u94FE\u63A5\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Compensation Intermediate Throw Event":"\u8865\u507F\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Signal Intermediate Catch Event":"\u4FE1\u53F7\u4E2D\u95F4\u6355\u83B7\u4E8B\u4EF6","Signal Intermediate Throw Event":"\u4FE1\u53F7\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6","Message End Event":"\u6D88\u606F\u7ED3\u675F\u4E8B\u4EF6","Escalation End Event":"\u5B9A\u65F6\u7ED3\u675F\u4E8B\u4EF6","Error End Event":"\u9519\u8BEF\u7ED3\u675F\u4E8B\u4EF6","Cancel End Event":"\u53D6\u6D88\u7ED3\u675F\u4E8B\u4EF6","Compensation End Event":"\u8865\u507F\u7ED3\u675F\u4E8B\u4EF6","Signal End Event":"\u4FE1\u53F7\u7ED3\u675F\u4E8B\u4EF6","Terminate End Event":"\u7EC8\u6B62\u7ED3\u675F\u4E8B\u4EF6","Message Boundary Event":"\u6D88\u606F\u8FB9\u754C\u4E8B\u4EF6","Message Boundary Event (non-interrupting)":"\u6D88\u606F\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Timer Boundary Event":"\u5B9A\u65F6\u8FB9\u754C\u4E8B\u4EF6","Timer Boundary Event (non-interrupting)":"\u5B9A\u65F6\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Escalation Boundary Event":"\u5347\u7EA7\u8FB9\u754C\u4E8B\u4EF6","Escalation Boundary Event (non-interrupting)":"\u5347\u7EA7\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Conditional Boundary Event":"\u6761\u4EF6\u8FB9\u754C\u4E8B\u4EF6","Conditional Boundary Event (non-interrupting)":"\u6761\u4EF6\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Error Boundary Event":"\u9519\u8BEF\u8FB9\u754C\u4E8B\u4EF6","Cancel Boundary Event":"\u53D6\u6D88\u8FB9\u754C\u4E8B\u4EF6","Signal Boundary Event":"\u4FE1\u53F7\u8FB9\u754C\u4E8B\u4EF6","Signal Boundary Event (non-interrupting)":"\u4FE1\u53F7\u8FB9\u754C\u4E8B\u4EF6\uFF08\u975E\u4E2D\u65AD\uFF09","Compensation Boundary Event":"\u8865\u507F\u8FB9\u754C\u4E8B\u4EF6",Gateway:"\u7F51\u5173","Exclusive Gateway":"\u4E92\u65A5\u7F51\u5173","Parallel Gateway":"\u5E76\u884C\u7F51\u5173","Inclusive Gateway":"\u76F8\u5BB9\u7F51\u5173","Complex Gateway":"\u590D\u6742\u7F51\u5173","Event based Gateway":"\u4E8B\u4EF6\u7F51\u5173",ExclusiveGateway:"\u4E92\u65A5\u7F51\u5173",ParallelGateway:"\u5E76\u884C\u7F51\u5173",InclusiveGateway:"\u76F8\u5BB9\u7F51\u5173",ComplexGateway:"\u590D\u6742\u7F51\u5173",EventBasedGateway:"\u4E8B\u4EF6\u7F51\u5173",Task:"\u4EFB\u52A1","Send Task":"\u53D1\u9001\u4EFB\u52A1","Receive Task":"\u63A5\u6536\u4EFB\u52A1","User Task":"\u7528\u6237\u4EFB\u52A1","Manual Task":"\u624B\u5DE5\u4EFB\u52A1","Business Rule Task":"\u4E1A\u52A1\u89C4\u5219\u4EFB\u52A1","Service Task":"\u670D\u52A1\u4EFB\u52A1","Script Task":"\u811A\u672C\u4EFB\u52A1","Call Activity":"\u8C03\u7528\u6D3B\u52A8","Sub Process (collapsed)":"\u5B50\u6D41\u7A0B\uFF08\u6298\u53E0\u7684\uFF09","Sub Process (expanded)":"\u5B50\u6D41\u7A0B\uFF08\u5C55\u5F00\u7684\uFF09","Start Event":"\u5F00\u59CB\u4E8B\u4EF6","Intermediate Throw Event":"\u4E2D\u95F4\u4E8B\u4EF6","End Event":"\u7ED3\u675F\u4E8B\u4EF6",SendTask:"\u53D1\u9001\u4EFB\u52A1",ReceiveTask:"\u63A5\u6536\u4EFB\u52A1",UserTask:"\u7528\u6237\u4EFB\u52A1",ManualTask:"\u624B\u5DE5\u4EFB\u52A1",BusinessRuleTask:"\u4E1A\u52A1\u89C4\u5219\u4EFB\u52A1",ServiceTask:"\u670D\u52A1\u4EFB\u52A1",ScriptTask:"\u811A\u672C\u4EFB\u52A1",CallActivity:"\u8C03\u7528\u6D3B\u52A8",SubProcess:"\u5B50\u6D41\u7A0B",Process:"\u4E1A\u52A1\u6D41\u7A0B","Append EndEvent":"\u8FFD\u52A0\u7ED3\u675F\u4E8B\u4EF6","Append Gateway":"\u8FFD\u52A0\u7F51\u5173","Append Task":"\u8FFD\u52A0\u4EFB\u52A1","Append Intermediate/Boundary Event":"\u8FFD\u52A0\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6/\u8FB9\u754C\u4E8B\u4EF6","Activate the global connect tool":"\u6FC0\u6D3B\u5168\u5C40\u8FDE\u63A5\u5DE5\u5177","Append {type}":"\u6DFB\u52A0 {type}","Add Lane above":"\u5728\u4E0A\u9762\u6DFB\u52A0\u9053","Divide into two Lanes":"\u5206\u5272\u6210\u4E24\u4E2A\u9053","Divide into three Lanes":"\u5206\u5272\u6210\u4E09\u4E2A\u9053","Add Lane below":"\u5728\u4E0B\u9762\u6DFB\u52A0\u9053","Append compensation activity":"\u8FFD\u52A0\u8865\u507F\u6D3B\u52A8","Change type":"\u4FEE\u6539\u7C7B\u578B","Connect using Association":"\u4F7F\u7528\u5173\u8054\u8FDE\u63A5","Connect using Sequence/MessageFlow or Association":"\u4F7F\u7528\u987A\u5E8F/\u6D88\u606F\u6D41\u6216\u8005\u5173\u8054\u8FDE\u63A5","Connect using DataInputAssociation":"\u4F7F\u7528\u6570\u636E\u8F93\u5165\u5173\u8054\u8FDE\u63A5",Remove:"\u79FB\u9664","Activate the hand tool":"\u6FC0\u6D3B\u6293\u624B\u5DE5\u5177","Activate the lasso tool":"\u6FC0\u6D3B\u5957\u7D22\u5DE5\u5177","Activate the create/remove space tool":"\u6FC0\u6D3B\u521B\u5EFA/\u5220\u9664\u7A7A\u95F4\u5DE5\u5177","Create expanded SubProcess":"\u521B\u5EFA\u6269\u5C55\u5B50\u8FC7\u7A0B","Create IntermediateThrowEvent/BoundaryEvent":"\u521B\u5EFA\u4E2D\u95F4\u629B\u51FA\u4E8B\u4EF6/\u8FB9\u754C\u4E8B\u4EF6","Create Pool/Participant":"\u521B\u5EFA\u6C60/\u53C2\u4E0E\u8005","Parallel Multi Instance":"\u5E76\u884C\u591A\u91CD\u4E8B\u4EF6","Sequential Multi Instance":"\u65F6\u5E8F\u591A\u91CD\u4E8B\u4EF6",DataObjectReference:"\u6570\u636E\u5BF9\u8C61\u53C2\u8003",DataStoreReference:"\u6570\u636E\u5B58\u50A8\u53C2\u8003",Loop:"\u5FAA\u73AF","Ad-hoc":"\u5373\u5E2D","Create {type}":"\u521B\u5EFA {type}","Create StartEvent":"\u521B\u5EFA\u5F00\u59CB\u4E8B\u4EF6","Create EndEvent":"\u521B\u5EFA\u7ED3\u675F\u4E8B\u4EF6","Create Task":"\u521B\u5EFA\u4EFB\u52A1","Create User Task":"\u521B\u5EFA\u7528\u6237\u4EFB\u52A1","Create Gateway":"\u521B\u5EFA\u7F51\u5173","Create DataObjectReference":"\u521B\u5EFA\u6570\u636E\u5BF9\u8C61","Create DataStoreReference":"\u521B\u5EFA\u6570\u636E\u5B58\u50A8","Create Group":"\u521B\u5EFA\u5206\u7EC4","Create Intermediate/Boundary Event":"\u521B\u5EFA\u4E2D\u95F4/\u8FB9\u754C\u4E8B\u4EF6","Collapsed Pool":"\u6298\u53E0\u6C60","Expanded Pool":"\u5C55\u5F00\u6C60","no parent for {element} in {parent}":"\u5728{parent}\u91CC\uFF0C{element}\u6CA1\u6709\u7236\u7C7B","no shape type specified":"\u6CA1\u6709\u6307\u5B9A\u7684\u5F62\u72B6\u7C7B\u578B","flow elements must be children of pools/participants":"\u6D41\u5143\u7D20\u5FC5\u987B\u662F\u6C60/\u53C2\u4E0E\u8005\u7684\u5B50\u7C7B","out of bounds release":"out of bounds release","more than {count} child lanes":"\u5B50\u9053\u5927\u4E8E{count} ","element required":"\u5143\u7D20\u4E0D\u80FD\u4E3A\u7A7A","diagram not part of bpmn:Definitions":"\u6D41\u7A0B\u56FE\u4E0D\u7B26\u5408bpmn\u89C4\u8303","no diagram to display":"\u6CA1\u6709\u53EF\u5C55\u793A\u7684\u6D41\u7A0B\u56FE","no process or collaboration to display":"\u6CA1\u6709\u53EF\u5C55\u793A\u7684\u6D41\u7A0B/\u534F\u4F5C","element {element} referenced by {referenced}#{property} not yet drawn":"\u7531{referenced}#{property}\u5F15\u7528\u7684{element}\u5143\u7D20\u4ECD\u672A\u7ED8\u5236","already rendered {element}":"{element} \u5DF2\u88AB\u6E32\u67D3","failed to import {element}":"\u5BFC\u5165{element}\u5931\u8D25",Id:"\u7F16\u53F7",Name:"\u540D\u79F0",General:"\u5E38\u89C4",Details:"\u8BE6\u60C5","Message Name":"\u6D88\u606F\u540D\u79F0",Message:"\u6D88\u606F",Initiator:"\u521B\u5EFA\u8005","Asynchronous Continuations":"\u6301\u7EED\u5F02\u6B65","Asynchronous Before":"\u5F02\u6B65\u524D","Asynchronous After":"\u5F02\u6B65\u540E","Job Configuration":"\u5DE5\u4F5C\u914D\u7F6E",Exclusive:"\u6392\u9664","Job Priority":"\u5DE5\u4F5C\u4F18\u5148\u7EA7","Retry Time Cycle":"\u91CD\u8BD5\u65F6\u95F4\u5468\u671F",Documentation:"\u6587\u6863","Element Documentation":"\u5143\u7D20\u6587\u6863","History Configuration":"\u5386\u53F2\u914D\u7F6E","History Time To Live":"\u5386\u53F2\u7684\u751F\u5B58\u65F6\u95F4",Forms:"\u8868\u5355","Form Key":"\u8868\u5355key","Form Fields":"\u8868\u5355\u5B57\u6BB5","Business Key":"\u4E1A\u52A1key","Form Field":"\u8868\u5355\u5B57\u6BB5",ID:"\u7F16\u53F7",Type:"\u7C7B\u578B",Label:"\u540D\u79F0","Default Value":"\u9ED8\u8BA4\u503C","Default Flow":"\u9ED8\u8BA4\u6D41\u8F6C\u8DEF\u5F84","Conditional Flow":"\u6761\u4EF6\u6D41\u8F6C\u8DEF\u5F84","Sequence Flow":"\u666E\u901A\u6D41\u8F6C\u8DEF\u5F84",Validation:"\u6821\u9A8C","Add Constraint":"\u6DFB\u52A0\u7EA6\u675F",Config:"\u914D\u7F6E",Properties:"\u5C5E\u6027","Add Property":"\u6DFB\u52A0\u5C5E\u6027",Value:"\u503C",Listeners:"\u76D1\u542C\u5668","Execution Listener":"\u6267\u884C\u76D1\u542C","Event Type":"\u4E8B\u4EF6\u7C7B\u578B","Listener Type":"\u76D1\u542C\u5668\u7C7B\u578B","Java Class":"Java\u7C7B",Expression:"\u8868\u8FBE\u5F0F","Must provide a value":"\u5FC5\u987B\u63D0\u4F9B\u4E00\u4E2A\u503C","Delegate Expression":"\u4EE3\u7406\u8868\u8FBE\u5F0F",Script:"\u811A\u672C","Script Format":"\u811A\u672C\u683C\u5F0F","Script Type":"\u811A\u672C\u7C7B\u578B","Inline Script":"\u5185\u8054\u811A\u672C","External Script":"\u5916\u90E8\u811A\u672C",Resource:"\u8D44\u6E90","Field Injection":"\u5B57\u6BB5\u6CE8\u5165",Extensions:"\u6269\u5C55","Input/Output":"\u8F93\u5165/\u8F93\u51FA","Input Parameters":"\u8F93\u5165\u53C2\u6570","Output Parameters":"\u8F93\u51FA\u53C2\u6570",Parameters:"\u53C2\u6570","Output Parameter":"\u8F93\u51FA\u53C2\u6570","Timer Definition Type":"\u5B9A\u65F6\u5668\u5B9A\u4E49\u7C7B\u578B","Timer Definition":"\u5B9A\u65F6\u5668\u5B9A\u4E49",Date:"\u65E5\u671F",Duration:"\u6301\u7EED",Cycle:"\u5FAA\u73AF",Signal:"\u4FE1\u53F7","Signal Name":"\u4FE1\u53F7\u540D\u79F0",Escalation:"\u5347\u7EA7",Error:"\u9519\u8BEF","Link Name":"\u94FE\u63A5\u540D\u79F0",Condition:"\u6761\u4EF6\u540D\u79F0","Variable Name":"\u53D8\u91CF\u540D\u79F0","Variable Event":"\u53D8\u91CF\u4E8B\u4EF6","Specify more than one variable change event as a comma separated list.":"\u591A\u4E2A\u53D8\u91CF\u4E8B\u4EF6\u4EE5\u9017\u53F7\u9694\u5F00","Wait for Completion":"\u7B49\u5F85\u5B8C\u6210","Activity Ref":"\u6D3B\u52A8\u53C2\u8003","Version Tag":"\u7248\u672C\u6807\u7B7E",Executable:"\u53EF\u6267\u884C\u6587\u4EF6","External Task Configuration":"\u6269\u5C55\u4EFB\u52A1\u914D\u7F6E","Task Priority":"\u4EFB\u52A1\u4F18\u5148\u7EA7",External:"\u5916\u90E8",Connector:"\u8FDE\u63A5\u5668","Must configure Connector":"\u5FC5\u987B\u914D\u7F6E\u8FDE\u63A5\u5668","Connector Id":"\u8FDE\u63A5\u5668\u7F16\u53F7",Implementation:"\u5B9E\u73B0\u65B9\u5F0F","Field Injections":"\u5B57\u6BB5\u6CE8\u5165",Fields:"\u5B57\u6BB5","Result Variable":"\u7ED3\u679C\u53D8\u91CF",Topic:"\u4E3B\u9898","Configure Connector":"\u914D\u7F6E\u8FDE\u63A5\u5668","Input Parameter":"\u8F93\u5165\u53C2\u6570",Assignee:"\u4EE3\u7406\u4EBA","Candidate Users":"\u5019\u9009\u7528\u6237","Candidate Groups":"\u5019\u9009\u7EC4","Due Date":"\u5230\u671F\u65F6\u95F4","Follow Up Date":"\u8DDF\u8E2A\u65E5\u671F",Priority:"\u4F18\u5148\u7EA7","The follow up date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"\u8DDF\u8E2A\u65E5\u671F\u5FC5\u987B\u7B26\u5408EL\u8868\u8FBE\u5F0F\uFF0C\u5982\uFF1A ${someDate} ,\u6216\u8005\u4E00\u4E2AISO\u6807\u51C6\u65E5\u671F\uFF0C\u5982\uFF1A2015-06-26T09:54:00","The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"\u8DDF\u8E2A\u65E5\u671F\u5FC5\u987B\u7B26\u5408EL\u8868\u8FBE\u5F0F\uFF0C\u5982\uFF1A ${someDate} ,\u6216\u8005\u4E00\u4E2AISO\u6807\u51C6\u65E5\u671F\uFF0C\u5982\uFF1A2015-06-26T09:54:00",Variables:"\u53D8\u91CF","Candidate Starter Configuration":"\u5019\u9009\u4EBA\u8D77\u52A8\u5668\u914D\u7F6E","Candidate Starter Groups":"\u5019\u9009\u4EBA\u8D77\u52A8\u5668\u7EC4","This maps to the process definition key.":"\u8FD9\u6620\u5C04\u5230\u6D41\u7A0B\u5B9A\u4E49\u952E\u3002","Candidate Starter Users":"\u5019\u9009\u4EBA\u8D77\u52A8\u5668\u7684\u7528\u6237","Specify more than one user as a comma separated list.":"\u6307\u5B9A\u591A\u4E2A\u7528\u6237\u4F5C\u4E3A\u9017\u53F7\u5206\u9694\u7684\u5217\u8868\u3002","Tasklist Configuration":"Tasklist\u914D\u7F6E",Startable:"\u542F\u52A8","Specify more than one group as a comma separated list.":"\u6307\u5B9A\u591A\u4E2A\u7EC4\u4F5C\u4E3A\u9017\u53F7\u5206\u9694\u7684\u5217\u8868\u3002","Execution listeners":"\u6267\u884C\u76D1\u542C\u5668","Toggle linting":"\u5207\u6362","Process has multiple blank start events":"\u6D41\u7A0B\u6709\u591A\u4E2A\u7A7A\u767D\u5F00\u59CB\u4E8B\u4EF6","Process is missing start event":"\u6D41\u7A0B\u7F3A\u5C11\u5F00\u59CB\u4E8B\u4EF6","Process is missing end event":"\u6D41\u7A0B\u7F3A\u5C11\u7ED3\u675F\u4E8B\u4EF6","Element is missing label/name":"\u5143\u7D20\u7F3A\u5C11\u540D\u79F0","Flow splits implicitly":"\u6D41\u8F6C\u65B9\u5411\u672A\u77E5","Sequence flow is missing condition":"\u7F3A\u5C11\u6D41\u8F6C\u6761\u4EF6","Incoming flows do not join":"\u53EF\u80FD\u9700\u8981\u7EDF\u4E00\u7684\u5165\u53E3","Element is not connected":"\u5143\u7D20\u672A\u8FDE\u63A5",Errors:"\u9519\u8BEF",Warnings:"\u8B66\u544A","Token Simulation":"\u6D41\u7A0B\u6A21\u62DF","Open minimap":"\u25B2","Close minimap":"\u2573"};function z3(e,t){return t=t||{},e=H3[e]||e,e.replace(/{([^}]+)}/g,function(n,i){return t[i]||"{"+i+"}"})}var G3={__init__:["translate","customContextPad"],translate:["value",z3],customContextPad:["type",t0]};const V3="Bpmn",W3="http://www.omg.org/spec/BPMN/20100524/MODEL",U3="bpmn",Y3={tagAlias:"lowerCase"},q3=[],K3=[{name:"Button",superClass:["Element"],properties:[]},{name:"Assignee",superClass:["Element"],properties:[]},{name:"Serial",superClass:["Element"],properties:[]},{name:"TaskListener",superClass:["Element"],properties:[{name:"fields",type:"Field",isMany:!0}]},{name:"ExecutionListener",superClass:["Element"],properties:[{name:"fields",type:"Field",isMany:!0}]},{name:"Field",superClass:["Element"],properties:[{name:"string",type:"String"},{name:"expression",type:"String"}]},{name:"Property",superClass:["Element"],properties:[]},{name:"Timelimit",superClass:["Element"],properties:[]},{name:"Formproperty",superClass:["Element"],properties:[]}];var X3={name:V3,uri:W3,prefix:U3,xml:Y3,associations:q3,types:K3};const Z3="Activiti",Q3="http://activiti.org/bpmn",J3="activiti",eM={tagAlias:"lowerCase"},tM=[],nM=[{name:"Button",superClass:["Element"],properties:[]},{name:"Assignee",superClass:["Element"],properties:[]},{name:"Serial",superClass:["Element"],properties:[]},{name:"TaskListener",superClass:["Element"],properties:[{name:"fields",type:"Field",isMany:!0}]},{name:"ExecutionListener",superClass:["Element"],properties:[{name:"fields",type:"Field",isMany:!0}]},{name:"Field",superClass:["Element"],properties:[{name:"string",type:"String"},{name:"expression",type:"String"}]},{name:"Property",superClass:["Element"],properties:[]},{name:"Timelimit",superClass:["Element"],properties:[]},{name:"Formproperty",superClass:["Element"],properties:[]}];var iM={name:Z3,uri:Q3,prefix:J3,xml:eM,associations:tM,types:nM};const rM="Flowable",oM="http://flowable.org/bpmn",aM="flowable",sM={tagAlias:"lowerCase"},cM=[],uM=[{name:"Button",superClass:["Element"],properties:[]},{name:"Assignee",superClass:["Element"],properties:[]},{name:"Serial",superClass:["Element"],properties:[]},{name:"TaskListener",superClass:["Element"],properties:[{name:"fields",type:"Field",isMany:!0}]},{name:"ExecutionListener",superClass:["Element"],properties:[{name:"fields",type:"Field",isMany:!0}]},{name:"Field",superClass:["Element"],properties:[{name:"string",type:"String"},{name:"expression",type:"String"}]},{name:"Property",superClass:["Element"],properties:[]},{name:"Timelimit",superClass:["Element"],properties:[]},{name:"Formproperty",superClass:["Element"],properties:[]}];var lM={name:rM,uri:oM,prefix:aM,xml:sM,associations:cM,types:uM};const pM="Camunda",fM="http://camunda.org/schema/1.0/bpmn",hM="camunda",dM={tagAlias:"lowerCase"},mM=[],vM=[{name:"Button",superClass:["Element"],properties:[]},{name:"Assignee",superClass:["Element"],properties:[]},{name:"Serial",superClass:["Element"],properties:[]},{name:"TaskListener",superClass:["Element"],properties:[{name:"fields",type:"Field",isMany:!0}]},{name:"ExecutionListener",superClass:["Element"],properties:[{name:"fields",type:"Field",isMany:!0}]},{name:"Field",superClass:["Element"],properties:[{name:"string",type:"String"},{name:"expression",type:"String"}]},{name:"Property",superClass:["Element"],properties:[]},{name:"Timelimit",superClass:["Element"],properties:[]},{name:"Formproperty",superClass:["Element"],properties:[]}];var gM={name:pM,uri:fM,prefix:hM,xml:dM,associations:mM,types:vM},yM={bpmn:X3,activiti:iM,flowable:lM,camunda:gM};function EM({state:e,props:t,emit:n,bpmnCanvasId:i}){var d,g,y,A,_;const{modeler:r,modeling:o,moddle:a,elementRegistry:s}=e,{additionalModules:c=[],moddleExtensions:u=[],simulation:l=!0,linting:p,minimap:f=!0}=t.initOptions,h={container:document.getElementById(i),...t.initOptions,additionalModules:[G3,p?A3:{},l?p3:{},f?j3:{},...c],moddleExtensions:{[t.prefix]:yM[t.prefix],...u}};r.value=new xn(h),o.value=(d=r.value)==null?void 0:d.get("modeling"),a.value=(g=r.value)==null?void 0:g.get("moddle"),s.value=(y=r.value)==null?void 0:y.get("elementRegistry"),p&&((A=r.value.get("linting"))==null||A.toggle()),f&&((_=r.value.get("minimap"))==null||_.toggle()),n("update:modeler",r.value)}function _M({props:e,emit:t}){const n=Fn(),i=Fn(),r=Fn(),o=Fn(),a=Fn(),s=so(),c=so(e.modelValue),u=so({menuBtn:!1,span:24,size:e.size,column:[],group:[]}),l=p=>e.prefix?`${e.prefix}:${p}`:p;return ds(()=>e.modelValue,p=>c.value=p,{deep:!0}),ds(()=>c.value,p=>t("update:modelValue",p),{deep:!0}),{modeler:n,modeling:i,moddle:r,elementRegistry:o,element:a,formData:c,formOption:u,formRef:s,props:e,prefix:l}}const LM={id:"",name:"",documentation:"",category:"",icon:"",skipFirstNode:"",rollbackNode:"",priority:"",backToRejecter:"",multiInstanceType:"",completionCondition:"",collection:"",class:"",async:"",elementVariable:"",flowType:"",conditionExpression:"",skipExpression:"",assignee:[],button:[],executionListener:[],formproperty:[],property:[],serial:[],taskListener:[],timelimit:[]};function bM(e){const t=new Map,{element:n,formOption:i,formRef:r,props:o}=e,a=Du(async()=>{var s;t.forEach(c=>c==null?void 0:c()),n.value&&(i.value.group=[...o.formOptions[n.value.type]||D0],i.value.column=[...xM(i.value.group)],(s=r.value)==null||s.resetForm(),await Mu(),SM(e,t),await Mu(),wM(e))},100);ds(()=>[n,o.formOptions],a,{deep:!0})}function xM(e){return e.map(t=>t.column).flat().map(t=>({...t,display:!1}))}function wM(e){var s,c;const{element:t,formOption:n,formData:i,prefix:r}=e,{businessObject:o}=(s=t.value)!=null?s:{},{$attrs:a}=o!=null?o:{};(c=n.value.column)==null||c.forEach(u=>{var l;u.updateFormData?(l=u.updateFormData)==null||l.call(u,{...e,businessObject:o,$attrs:a}):i.value[u.prop]=a[r(u.prop)]||u.value||""})}function SM(e,t){const{element:n,formOption:i,formData:r,modeling:o,prefix:a}=e;i.value.column.forEach(s=>{const c=ds(()=>r.value[s.prop],u=>{var f,h,d;const{businessObject:l}=(f=n.value)!=null?f:{},{$attrs:p}=l!=null?l:{};s.updateProperties?(h=s.updateProperties)==null||h.call(s,{...e,businessObject:l,$attrs:p}):(d=o.value)==null||d.updateProperties(n.value,{[a(s.prop)]:u||void 0})},{deep:!0});t.set(s.prop,c)})}function CM({state:e,emit:t}){var s,c;const{modeler:n,elementRegistry:i,element:r}=e,o=Du(async u=>{var f;r.value=void 0;const l=u.newSelection[0],p=(f=i.value)==null?void 0:f.find(h=>h.type==="bpmn:Process");await Mu(),r.value=l||p,t("update:element",r.value)},100),a=Du(async()=>{var l,p;const u=await((p=(l=n.value)==null?void 0:l.saveXML)==null?void 0:p.call(l,{format:!0}));u!=null&&u.xml&&t("update:xml",u==null?void 0:u.xml)},100);(s=n.value)==null||s.on("selection.changed",o),(c=n.value)==null||c.on("commandStack.changed",a)}const TM={value:{type:Object,default:()=>({})},modelValue:{type:Object,default:()=>({})},xml:{type:String},prefix:{type:String,default:"bpmn"},size:{type:String,default:"default"},formWidth:{type:String,default:"30%"},formOptions:{type:Object,default:()=>({})},initOptions:{type:Object,default:()=>({})}},AM={input:e=>e,"update:modelValue":e=>e,"update:modeler":e=>e,"update:element":e=>e,"update:xml":e=>e},RM=vl({name:"BpmnModeler",props:TM,emits:AM,setup(e,{emit:t,slots:n}){const i=_M({props:e,emit:t}),{modeler:r,formData:o,formOption:a,formRef:s}=i;N0("modelerState",i);const{importXML:c}=gl(i.modeler),u=Nm("bpmn-modeler-canvas");Lm(()=>{var p;EM({props:e,state:i,emit:t,bpmnCanvasId:u}),CM({state:i,emit:t}),bM(i),e.xml?c(e.xml):(p=r.value)==null||p.createDiagram()});const l=vr("avue-form");return()=>mt("div",{class:"bpmn-modeler"},[mt("div",{class:"bpmn-canvas",attrs:{id:u},style:`width:calc(100% - ${e.formWidth})`}),mt(l,{class:"bpmn-form",ref:p=>s.value=p,props:{value:o.value,modelValue:o.value,option:a.value},on:{["update:modelValue"]:p=>o.value=p},scopedSlots:n,style:`width:${e.formWidth}`}),mt($m,{props:{modeler:r.value,size:e.size}},Fm(n["bpmn-tools"]))])}});function PM({props:e,state:t}){const{viewer:n,elementRegistry:i,modeling:r,tooltips:o}=t,{importXML:a}=gl(n);L0(async()=>{!e.xml||(await a(e.xml),e.data.forEach(s=>{var y,A,_;const{elementId:c}=s;if(!c)return;const u=(y=i.value)==null?void 0:y.get(c);if(!u||!s.colors||((A=r.value)==null||A.setColor([u],s.colors),!s.tooltips))return;const{html:l="",position:{offsetX:p=0,offsetY:f=0}={}}=s.tooltips,{x:h,y:d}=u,g={x:(h||0)+(p||0),y:(d||0)+(f||0)};(_=o.value)==null||_.add({html:l,position:g})}))})}function DM({props:e,emit:t,state:n,canvasId:i}){const{viewer:r,modeling:o,tooltips:a,elementRegistry:s}=n,{additionalModules:c=[]}=e.initOptions;r.value=new Yn({container:document.getElementById(i),additionalModules:[zl,Vl,eE,Fy,...c]}),o.value=r.value.get("modeling"),a.value=r.value.get("tooltips"),s.value=r.value.get("elementRegistry"),t("update:viewer",r.value)}function MM(){const e=Fn(),t=Fn(),n=Fn(),i=Fn();return{viewer:e,modeling:t,elementRegistry:n,tooltips:i}}const BM={xml:{type:String},data:{type:Array,default:()=>[]},initOptions:{type:Object,default:()=>({})}},IM={"update:viewer":e=>e},FM=vl({name:"BpmnViewer",props:BM,emits:IM,setup(e,{emit:t}){const n=MM(),i=Nm("bpmn-viewer-canvas");return Lm(()=>{DM({props:e,emit:t,state:n,canvasId:i}),PM({props:e,state:n})}),()=>mt("div",{class:"bpmn-viewer"},[mt("div",{class:"bpmn-canvas",attrs:{id:i}})])}});var OM={BpmnModeler:RM,BpmnViewer:FM,BpmnTools:$m,BpmnSelect:M0,BpmnCheckbox:B0,BpmnText:I0},$M={install(e){Object.values(OM).forEach(t=>{e.component(t.name,t)})}};export{zM as BpmnCheckbox,RM as BpmnModeler,GM as BpmnSelect,VM as BpmnText,$m as BpmnTools,FM as BpmnViewer,$0 as ToolsProps,IM as ViewerEmits,BM as ViewerProps,WM as adaptOnsV3,UM as assigneeColumn,YM as asyncColumn,qM as backToRejecterColumn,KM as baseColumns,XM as buttonColumn,ZM as classColumn,QM as collectionColumn,JM as completionConditionColumn,eB as conditionExpressionColumn,$M as default,LM as defaultFormData,tB as defaultGroup,nB as defaultOptions,iB as defaultXml,rB as documentationColumn,oB as dynamicComponent,aB as elementVariableColumn,sB as executionListenerColumn,cB as filterObj,uB as flowButtonApprovalDict,lB as flowButtonDisplayDict,pB as flowTypeColumn,fB as formpropertyColumn,hB as h,dB as idColumn,AM as modelerEmits,TM as modelerProps,mB as multiInstanceColumns,vB as multiInstanceTypeColumn,gB as nameColumn,yB as priorityColumn,EB as processCategoryColumn,_B as processColumns,bB as processDocumentationColumn,xB as processIconColumn,wB as processIdColumn,SB as processNameColumn,CB as processRollbackNodeColumn,TB as processSkipFirstNodeColumn,AB as propertyColumn,RB as rollbackNodeColumn,PB as sequenceFlowColumns,DB as serialColumn,MB as serviceTaskColumns,BB as slot,IB as taskListenerColumn,FB as timelimitColumn,j0 as toolsEmits,OB as updateExtensionElements,kB as updateListenerFormData,NB as updateListenerProperties,LB as useInject,$B as useListenerColumn,gl as useMethods,jB as useOptions,HB as userTaskColumns,zB as uuid};
